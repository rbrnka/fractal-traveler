(()=>{"use strict";var t=0,n=2,e=n,r="debug",o=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n&&"[".concat(n,"]")},i={MANDELBROT:0,JULIA:1,RIEMANN:2},a={NONE:function(t){return t},QUAD:function(t){return t<.5?2*t*t:(4-2*t)*t-1},CUBIC:function(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2},QUINT:function(t){return t<.5?16*Math.pow(t,5):1-Math.pow(-2*t+2,5)/2}},s=-1,c=1,u="#B4FF6A",l="rgba(24, 48, 13, 0.2)",f=("color: ".concat(u),"color: ".concat("#fff"),[{id:"Cosmos",keyColor:"#fefe66",theme:[0,0,0,1,.647,0,0,0,0,1.2,1.2,1,.1,.1,.1]},{id:"Blue Mist",keyColor:"#4c4cb3",theme:[0,0,0,1,.647,0,1,1,1,0,0,1,0,0,.5]},{id:"Fire",keyColor:"#663300",theme:[.4,.2,0,1,144/255,10/255,.2,0,0,.8,.7,0,49/255,45/255,4/255]},{id:"Ocean",keyColor:"#0F52BA",theme:[230/255,243/255,1,49/255,141/255,178/255,0,13/255,26/255,4/255,105/255,151/255,0,40/255,77/255]},{id:"Forest",keyColor:"#25591f",theme:[129/255,140/255,60/255,137/255,89/255,31/255,45/255,22/255,6/255,25/255,89/255,13/255,0,21/255,0]}]),h=[95/255,134/255,56/255],m=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255,e=G(t,n);return[e.r,e.g,e.b]}(f[0].keyColor),d=Math.PI;function p(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return v(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(v(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,v(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,v(f,"constructor",u),v(u,"constructor",c),c.displayName="GeneratorFunction",v(u,o,"GeneratorFunction"),v(f),v(f,o,"Generator"),v(f,r,function(){return this}),v(f,"toString",function(){return"[object Generator]"}),(p=function(){return{w:i,m:h}})()}function v(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}v=function(t,n,e,r){function i(n,e){v(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},v(t,n,e,r)}function y(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function b(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||_(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,n){if(t){if("string"==typeof t)return T(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?T(t,n):void 0}}function T(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var w=!1;function A(t,n,e,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=function(t){return null==t?null:Number(t).toPrecision(17)},u={mode:null!=t?t.toFixed(0):i.MANDELBROT,px:c(n),py:c(e),zoom:c(r),r:null!=o?Number(o).toPrecision(17):0,cx:c(a),cy:c(s)};if(!([n,e,r,o].some(function(t){return null==t})||t===i.JULIA&&[a,s].some(function(t){return null==t}))){var l=btoa(JSON.stringify(u)),f=t===i.JULIA?"#julia":"#";window.history.pushState({},"","".concat(f,"?view=").concat(l)),w=!0}}function x(){var t=new URL(window.location.href).hash;if(!t)return{mode:i.MANDELBROT};var n=g(t.slice(1).split("?"),2),e=n[0],r=n[1];if(!r)return{mode:"julia"===e?i.JULIA:i.MANDELBROT};var o=new URLSearchParams(r).get("view");try{var a=JSON.parse(atob(o));return w=!0,{mode:"julia"===e?i.JULIA:i.MANDELBROT,px:null!=a.px?parseFloat(a.px):null,py:null!=a.py?parseFloat(a.py):null,zoom:null!=a.zoom?parseFloat(a.zoom):null,r:null!=a.r?parseFloat(a.r):0,cx:null!=a.cx?parseFloat(a.cx):null,cy:null!=a.cy?parseFloat(a.cy):null}}catch(t){return w=!0,{mode:"julia"===e?i.JULIA:i.MANDELBROT}}}function E(){if(w){var t=window.location.hash.split("?")[0],n="".concat(window.location.origin,"/").concat(t);window.history.pushState({},"",n),w=!1}}var P=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0};function S(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(function(t){return navigator.userAgent.match(t)})}function D(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[NaN,void 0,null,""],o=function(t){return"number"==typeof t&&isFinite(t)},i="[";if(r.some(function(n){return n===t[0]})||r.some(function(n){return n===t[1]})||!o(t[0])||!o(t[1]))return i+="?, ?]";var a=parseFloat(t[0].toFixed(n)).toString(),s=parseFloat(t[1].toFixed(n)).toString();return(i+="".concat(a,", ").concat(s))+(e&&0!==t[1]?"i]":"]")}var L="vd",O="ed",k=function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:L)===O?function(t){var n=Math.fround(t),e=Math.fround(t-n);return{high:n,low:e}}(t):function(t){var n=Math.pow(2,27)+1,e=t*n,r=e-(e-t),o=t-r;return{high:r,low:o}}(t)};function F(){return{hi:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,lo:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}function R(t,n){var e=t+n,r=e-t;return{s:e,err:t-(e-r)+(n-r)}}function C(t,n){var e=t+n;return{s:e,err:n-(e-t)}}function z(t,n){var e=R(t.hi,n),r=t.lo+e.err,o=C(e.s,r);return t.hi=o.s,t.lo=o.err,t}function M(t,n){return t.hi=n,t.lo=0,t}function I(t){return t.hi+t.lo}function N(t,n){return function(t,n){var e=R(t.hi,n.hi),r=t.lo+n.lo+e.err,o=C(e.s,r);return{hi:o.s,lo:o.err}}(t,{hi:-n.hi,lo:-n.lo})}function j(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return t[0].toFixed(e)===n[0].toFixed(e)&&t[1].toFixed(e)===n[1].toFixed(e)}function U(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return t[0].toFixed(e)===n[0].toFixed(e)&&t[1].toFixed(e)===n[1].toFixed(e)&&t[2].toFixed(e)===n[2].toFixed(e)}function X(t,n,e){var r,o,i,a=Math.floor(6*t),s=6*t-a,c=e*(1-n),u=e*(1-s*n),l=e*(1-(1-s)*n);switch(a%6){case 0:r=e,o=l,i=c;break;case 1:r=u,o=e,i=c;break;case 2:r=c,o=e,i=l;break;case 3:r=c,o=u,i=e;break;case 4:r=l,o=c,i=e;break;case 5:r=e,o=c,i=u}return[r,o,i]}function Z(t,n,e){var r,o,i;if(0===n)r=o=i=e;else{var a=function(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+(n-t)*(2/3-e)*6:t},s=e<.5?e*(1+n):e+n-e*n,c=2*e-s;r=a(c,s,t+1/3),o=a(c,s,t),i=a(c,s,t-1/3)}return[r,o,i]}function B(t,n,e){var r,o,i=Math.max(t,n,e),a=Math.min(t,n,e),s=(i+a)/2;if(i===a)r=o=0;else{var c=i-a;o=s>.5?c/(2-i-a):c/(i+a),r=i===t?(n-e)/c+(n<e?6:0):i===n?(e-t)/c+2:(t-n)/c+4,r/=6}return[r,o,s]}function G(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return 3===(t=t.toLowerCase().replace(/^#/,"")).length&&(t=t.split("").map(function(t){return t+t}).join("")),/^([\da-f]{6})$/i.test(t)?{r:parseInt(t.substring(0,2),16)/n,g:parseInt(t.substring(2,4),16)/n,b:parseInt(t.substring(4,6),16)/n}:null}function H(t,n,e){return t+(n-t)*e}function V(t){return t*(d/180)}function q(t){var n=2*d;return(t%n+n)%n}function J(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=0,i=function(){if(Object.prototype.hasOwnProperty.call(e,a)){var t=void 0!==r[a]?r[a]:1,i=n[a],s=e[a],c=0;"number"==typeof s&&"number"==typeof i?c=Math.abs(s-i):Array.isArray(s)&&Array.isArray(i)&&(c=Math.hypot.apply(Math,b(s.map(function(t,n){return t-(i[n]||0)})))),o+=t*c}};for(var a in e)i();return Math.round(t*o)}function W(t){return K.apply(this,arguments)}function K(){var t;return t=p().m(function t(n){return p().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t){return setTimeout(t,n)}))},t)}),K=function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){y(i,r,o,a,s,"next",t)}function s(t){y(i,r,o,a,s,"throw",t)}a(void 0)})},K.apply(this,arguments)}function Y(t){Array.isArray(t)&&(t.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)}),t.length=0)}function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function $(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return tt(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(tt(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,tt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,tt(f,"constructor",u),tt(u,"constructor",c),c.displayName="GeneratorFunction",tt(u,o,"GeneratorFunction"),tt(f),tt(f,o,"Generator"),tt(f,r,function(){return this}),tt(f,"toString",function(){return"[object Generator]"}),($=function(){return{w:i,m:h}})()}function tt(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}tt=function(t,n,e,r){function i(n,e){tt(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},tt(t,n,e,r)}function nt(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function et(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){nt(i,r,o,a,s,"next",t)}function s(t){nt(i,r,o,a,s,"throw",t)}a(void 0)})}}function rt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||it(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(t){return function(t){if(Array.isArray(t))return at(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||it(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,n){if(t){if("string"==typeof t)return at(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?at(t,n):void 0}}function at(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function st(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ct(r.key),r)}}function ct(t){var n=function(t,n){if("object"!=Q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==Q(n)?n:n+""}var ut=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=n,this.gl=this.canvas.getContext("webgl",{antialias:!1,alpha:!1,depth:!1,stencil:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance"}),this.gl?(this.MAX_ITER=2e3,this.DEFAULT_ROTATION=0,this.DEFAULT_ZOOM=3,this.DEFAULT_PAN=[0,0],this.DEFAULT_PALETTE=[1,1,1],this.MAX_ZOOM=1e-80,this.MIN_ZOOM=40,this.PRESETS=[],this.zoom=this.DEFAULT_ZOOM,this.pan=ot(this.DEFAULT_PAN),this.panDD={x:F(this.pan[0],0),y:F(this.pan[1],0)},this.rotation=this.DEFAULT_ROTATION,this.currentPanAnimationFrame=null,this.currentZoomAnimationFrame=null,this.currentRotationAnimationFrame=null,this.currentColorAnimationFrame=null,this.demoActive=!1,this.currentPresetIndex=0,this.interactionActive=!1,this.interactionTimer=null,this.iterations=0,this.extraIterations=0,this.bestScore=NaN,this.probeIters=NaN,this.colorPalette=ot(this.DEFAULT_PALETTE),this.vertexShaderSource="/*\r\n * Vertex Shader Initializer\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n * @license   MIT\r\n */\r\n\r\nprecision mediump float;\r\nattribute vec4 a_position;\r\n\r\nvoid main() {\r\n    gl_Position = a_position;\r\n}",this.onWebGLContextLost=this.onWebGLContextLost.bind(this),this.canvas.addEventListener("webglcontextlost",this.onWebGLContextLost)):alert("WebGL is not supported by your browser or crashed.")},n=[{key:"markOrbitDirty",value:function(){}},{key:"getPan",value:function(){return[this.pan[0],this.pan[1]]}},{key:"setPan",value:function(t,n){M(this.panDD.x,t),M(this.panDD.y,n),this.pan[0]=I(this.panDD.x),this.pan[1]=I(this.panDD.y)}},{key:"addPan",value:function(t,n){z(this.panDD.x,t),z(this.panDD.y,n),this.pan[0]=I(this.panDD.x),this.pan[1]=I(this.panDD.y)}},{key:"setPanFromAnchor",value:function(t,n,e,r){var o=t-e*this.zoom,i=n-r*this.zoom;this.setPan(o,i)}},{key:"setZoomKeepingAnchor",value:function(t,n,e){var r=rt(this.screenToViewVector(n,e),2),o=r[0],i=r[1],a=this.zoom-t;this.addPan(o*a,i*a),this.zoom=t}},{key:"noteInteraction",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:160;this.interactionActive=!0,this.interactionTimer&&(clearTimeout(this.interactionTimer),this.interactionTimer=null),this.interactionTimer=setTimeout(function(){t.interactionActive=!1,t.markOrbitDirty(),t.draw(),Yr(!0)},n)}},{key:"onWebGLContextLost",value:function(t){t.preventDefault(),this.init()}},{key:"destroy",value:function(){this.stopAllNonColorAnimations(),this.stopCurrentColorAnimations(),this.canvas&&this.canvas.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.vertexShader&&(this.gl.deleteShader(this.vertexShader),this.vertexShader=null),this.fragmentShader&&(this.gl.deleteShader(this.fragmentShader),this.fragmentShader=null),this.interactionTimer&&(clearTimeout(this.interactionTimer),this.interactionTimer=null),this.canvas=null,this.gl=null}},{key:"generatePresetIDs",value:function(){this.PRESETS.forEach(function(t,n){t.id=n})}},{key:"init",value:function(){this.generatePresetIDs(),this.initGLProgram(),this.draw()}},{key:"resizeCanvas",value:function(){o("resizeCanvas",this.constructor.name),this.gl.useProgram(this.program);var t=this.canvas.getBoundingClientRect(),n=t.width/2,e=t.height/2,r=rt(this.screenToFractal(n,e),2),i=r[0],a=r[1],s=window.devicePixelRatio||1;this.canvas.width=Math.floor(t.width*s),this.canvas.height=Math.floor(t.height*s),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.resolutionLoc&&this.gl.uniform2f(this.resolutionLoc,this.canvas.width,this.canvas.height);var c=rt(this.screenToViewVector(n,e),2),u=c[0],l=c[1];this.setPanFromAnchor(i,a,u,l),this.markOrbitDirty(),this.draw()}},{key:"createFragmentShaderSource",value:function(){throw new Error("The draw method must be implemented in child classes")}},{key:"compileShader",value:function(t,n){var e=this.gl.createShader(n);return this.gl.shaderSource(e,t),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)?e:(this.gl.deleteShader(e),null)}},{key:"initGLProgram",value:function(){this.program&&this.gl.deleteProgram(this.program),this.fragmentShader&&this.gl.deleteShader(this.fragmentShader),this.vertexShader||(this.vertexShader=this.compileShader(this.vertexShaderSource,this.gl.VERTEX_SHADER)),this.fragmentShader=this.compileShader(this.createFragmentShaderSource(),this.gl.FRAGMENT_SHADER),this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS),this.gl.useProgram(this.program);var t=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t);var n=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW);var e=this.gl.getAttribLocation(this.program,"a_position");this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,0,0),this.updateUniforms(),"function"==typeof this.onProgramCreated&&this.onProgramCreated()}},{key:"onProgramCreated",value:function(){throw new Error("The onProgramCreated method must be implemented in child classes")}},{key:"needsRebase",value:function(){throw new Error("The needsRebase method must be implemented in child classes")}},{key:"updateUniforms",value:function(){this.gl.useProgram(this.program),this.panLoc=this.gl.getUniformLocation(this.program,"u_pan"),this.zoomLoc=this.gl.getUniformLocation(this.program,"u_zoom"),this.iterLoc=this.gl.getUniformLocation(this.program,"u_iterations"),this.colorLoc=this.gl.getUniformLocation(this.program,"u_colorPalette"),this.rotationLoc=this.gl.getUniformLocation(this.program,"u_rotation"),this.resolutionLoc=this.gl.getUniformLocation(this.program,"u_resolution")}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=this.canvas.width,n=this.canvas.height;this.gl.viewport(0,0,t,n),this.resolutionLoc&&this.gl.uniform2f(this.resolutionLoc,t,n),this.panLoc&&this.gl.uniform2fv(this.panLoc,this.pan),this.zoomLoc&&this.gl.uniform1f(this.zoomLoc,this.zoom),this.rotationLoc&&this.gl.uniform1f(this.rotationLoc,this.rotation),this.iterLoc&&this.gl.uniform1f(this.iterLoc,this.iterations),this.colorLoc&&this.gl.uniform3fv(this.colorLoc,this.colorPalette),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),null==Tr||Tr.beginGpuTimer(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),null==Tr||Tr.endGpuTimer()}},{key:"reset",value:function(){this.stopAllNonColorAnimations(),this.stopCurrentColorAnimations(),this.colorPalette=ot(this.DEFAULT_PALETTE),this.setPan(this.DEFAULT_PAN[0],this.DEFAULT_PAN[1]),this.zoom=this.DEFAULT_ZOOM,this.rotation=this.DEFAULT_ROTATION,this.extraIterations=0,this.currentPresetIndex=0,this.resizeCanvas(),this.markOrbitDirty(),this.draw(),Yr()}},{key:"screenToFractal",value:function(t,n){var e=window.devicePixelRatio||1,r=this.canvas.getBoundingClientRect(),o=r.width*e,i=r.height*e,a=t*e/o-.5,s=1-n*e/i-.5;a*=o/i;var c=Math.cos(this.rotation),u=Math.sin(this.rotation),l=u*a+c*s;return[(c*a-u*s)*this.zoom+this.pan[0],l*this.zoom+this.pan[1]]}},{key:"screenToViewVector",value:function(t,n){var e=window.devicePixelRatio||1,r=this.canvas.getBoundingClientRect(),o=r.width*e,i=r.height*e,a=t*e/o-.5,s=1-n*e/i-.5;a*=o/i;var c=Math.cos(this.rotation),u=Math.sin(this.rotation);return[c*a-u*s,u*a+c*s]}},{key:"getCanvasCssCenter",value:function(){var t=this.canvas.getBoundingClientRect();return[t.width/2,t.height/2]}},{key:"stopAllNonColorAnimations",value:function(){this.stopCurrentPanAnimation(),this.stopCurrentZoomAnimation(),this.stopCurrentRotationAnimation()}},{key:"stopCurrentPanAnimation",value:function(){null!==this.currentPanAnimationFrame&&(cancelAnimationFrame(this.currentPanAnimationFrame),this.currentPanAnimationFrame=null)}},{key:"stopCurrentZoomAnimation",value:function(){null!==this.currentZoomAnimationFrame&&(cancelAnimationFrame(this.currentZoomAnimationFrame),this.currentZoomAnimationFrame=null)}},{key:"stopCurrentRotationAnimation",value:function(){null!==this.currentRotationAnimationFrame&&(cancelAnimationFrame(this.currentRotationAnimationFrame),this.currentRotationAnimationFrame=null)}},{key:"stopCurrentColorAnimations",value:function(){null!==this.currentColorAnimationFrame&&(cancelAnimationFrame(this.currentColorAnimationFrame),this.currentColorAnimationFrame=null)}},{key:"stopDemo",value:function(){this.demoActive=!1,this.currentPresetIndex=0,this.stopAllNonColorAnimations()}},{key:"onAnimationFinished",value:function(){setTimeout(function(){return Yr()},50)}},{key:"animateColorPaletteTransition",value:(y=et($().m(function t(n){var e,r,o,i=this,a=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=a.length>1&&void 0!==a[1]?a[1]:250,r=a.length>2&&void 0!==a[2]?a[2]:null,this.stopCurrentColorAnimations(),!U(this.colorPalette,n)){t.n=1;break}return t.a(2);case 1:return o=ot(this.colorPalette),t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1);i.colorPalette=[H(o[0],n[0],u),H(o[1],n[1],u),H(o[2],n[2],u)],i.draw(),r&&r(),u<1?i.currentColorAnimationFrame=requestAnimationFrame(s):(i.stopCurrentColorAnimations(),t())};i.currentColorAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return y.apply(this,arguments)})},{key:"animateFullColorSpaceCycle",value:(v=et($().m(function t(){var n,e,r,o,i,a=this,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:15e3,e=s.length>1&&void 0!==s[1]?s[1]:null,this.stopCurrentColorAnimations(),r=this.colorPalette,o=B(r[0],r[1],r[2]),i=o[0],t.n=1,new Promise(function(){var t=null,r=function(o){t||(t=o);var s=Math.min((o-t)/n,1),c=(i+s)%1;a.colorPalette=Z(c,1,.6),a.draw(),e&&e(),a.currentColorAnimationFrame=requestAnimationFrame(r)};a.currentColorAnimationFrame=requestAnimationFrame(r)});case 1:return t.a(2)}},t,this)})),function(){return v.apply(this,arguments)})},{key:"animatePanTo",value:(p=et($().m(function t(n){var e,r,o,i=this,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:200,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentPanAnimation(),this.markOrbitDirty(),!j(this.pan,n,6)){t.n=1;break}return t.a(2);case 1:return o=ot(this.pan),t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u),f=H(o[0],n[0],l),h=H(o[1],n[1],l);i.setPan(f,h),i.draw(),Yr(!0),u<1?i.currentPanAnimationFrame=requestAnimationFrame(s):(i.markOrbitDirty(),i.draw(),i.stopCurrentPanAnimation(),i.onAnimationFinished(),t())};i.currentPanAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return p.apply(this,arguments)})},{key:"animatePanBy",value:(m=et($().m(function t(n){var e,r,o=this,i=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=i.length>1&&void 0!==i[1]?i[1]:200,r=i.length>2&&void 0!==i[2]?i[2]:a.NONE,this.stopCurrentPanAnimation(),this.markOrbitDirty(),!(Math.abs(n[0])<1e-30&&Math.abs(n[1])<1e-30)){t.n=1;break}return t.a(2);case 1:return t.n=2,new Promise(function(t){var i=null,a=0,s=function(c){i||(i=c);var u=Math.min((c-i)/e,1),l=r(u),f=l-a;a=l,0!==f&&o.addPan(n[0]*f,n[1]*f),o.draw(),Yr(!0),u<1?o.currentPanAnimationFrame=requestAnimationFrame(s):(o.markOrbitDirty(),o.draw(),o.stopCurrentPanAnimation(),o.onAnimationFinished(),t())};o.currentPanAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return m.apply(this,arguments)})},{key:"animateZoomTo",value:(h=et($().m(function t(n){var e,r,o,i,s,c,u,l,f,h,m,d,p,v,y,b,g=this,_=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=_.length>1&&void 0!==_[1]?_[1]:500,r=_.length>2&&void 0!==_[2]?_[2]:a.NONE,o=_.length>3&&void 0!==_[3]?_[3]:null,i=_.length>4&&void 0!==_[4]?_[4]:null,this.stopCurrentZoomAnimation(),this.zoom.toFixed(20)!==n.toFixed(20)){t.n=1;break}return t.a(2);case 1:return null!==o&&null!==i||(s=this.getCanvasCssCenter(),c=rt(s,2),u=c[0],l=c[1],o=u,i=l),f=this.zoom,h=n/f,m=this.screenToViewVector(o,i),d=rt(m,2),p=d[0],v=d[1],y=p*f+this.pan[0],b=v*f+this.pan[1],this.markOrbitDirty(),t.n=2,new Promise(function(t){var o=null,i=function(s){o||(o=s);var c=Math.min((s-o)/e,1);if(r!==a.NONE){var u=r(c);g.zoom=f+(n-f)*u}else g.zoom=f*Math.pow(h,c);g.setPanFromAnchor(y,b,p,v),g.markOrbitDirty(),g.draw(),Yr(!0),c<1?g.currentZoomAnimationFrame=requestAnimationFrame(i):(g.markOrbitDirty(),g.draw(),g.stopCurrentZoomAnimation(),g.onAnimationFinished(),t())};g.currentZoomAnimationFrame=requestAnimationFrame(i)});case 2:return t.a(2)}},t,this)})),function(t){return h.apply(this,arguments)})},{key:"animateZoomToNoPan",value:(f=et($().m(function t(n){var e,r,o,i=this,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentZoomAnimation(),this.markOrbitDirty(),this.zoom.toFixed(12)!==n.toFixed(12)){t.n=1;break}return t.a(2);case 1:return o=this.zoom,t.n=2,new Promise(function(t){var s=null,c=function(u){s||(s=u);var l=Math.min((u-s)/e,1);if(r!==a.NONE){var f=r(l);i.zoom=o+(n-o)*f}else i.zoom=o*Math.pow(n/o,l);i.draw(),Yr(!0),l<1?i.currentZoomAnimationFrame=requestAnimationFrame(c):(i.markOrbitDirty(),i.draw(),i.stopCurrentZoomAnimation(),i.onAnimationFinished(),t())};i.currentZoomAnimationFrame=requestAnimationFrame(c)});case 2:return t.a(2)}},t,this)})),function(t){return f.apply(this,arguments)})},{key:"animateRotationTo",value:(l=et($().m(function t(n){var e,r,o,i=this,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentRotationAnimation(),n=q(n),this.rotation.toFixed(6)!==n.toFixed(6)){t.n=1;break}return t.a(2);case 1:return o=this.rotation,t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u);i.rotation=H(o,n,l),i.draw(),Yr(!0),u<1?i.currentRotationAnimationFrame=requestAnimationFrame(s):(i.stopCurrentRotationAnimation(),i.onAnimationFinished(),t())};i.currentRotationAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"animatePanThenZoomTo",value:(u=et($().m(function t(n,e,r,o){var i,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:a.NONE,t.n=1,this.animatePanTo(n,r,i);case 1:return t.n=2,this.animateZoomTo(e,o,i);case 2:case 3:return t.a(2)}},t,this)})),function(t,n,e,r){return u.apply(this,arguments)})},{key:"animatePanAndZoomTo",value:(c=et($().m(function t(n,e){var r,o,i=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:1e3,o=i.length>3&&void 0!==i[3]?i[3]:a.NONE,t.n=1,Promise.all([this.animatePanTo(n,r,o),this.animateZoomToNoPan(e,r,o)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n){return c.apply(this,arguments)})},{key:"animateZoomRotationTo",value:(s=et($().m(function t(n,e){var r,o,i=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:500,o=i.length>3&&void 0!==i[3]?i[3]:a.NONE,t.n=1,Promise.all([this.animateZoomTo(n,r,o),this.animateRotationTo(e,r,a.CUBIC)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n){return s.apply(this,arguments)})},{key:"animatePanZoomRotationTo",value:(i=et($().m(function t(n,e,r){var o,i,s=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:500,i=s.length>4&&void 0!==s[4]?s[4]:a.NONE,t.n=1,Promise.all([this.animatePanTo(n,o,i),this.animateZoomToNoPan(e,o,i),this.animateRotationTo(r,o,i)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n,e){return i.apply(this,arguments)})},{key:"animateInfiniteRotation",value:(r=et($().m(function t(n){var e,r,o=this,i=arguments;return $().w(function(t){for(;;)switch(t.n){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:.001,this.stopCurrentRotationAnimation(),r=n>=0?1:-1,t.n=1,new Promise(function(){var t=function(){o.rotation=q(o.rotation+r*e+2*d),o.draw(),Yr(!0),o.currentRotationAnimationFrame=requestAnimationFrame(t)};o.currentRotationAnimationFrame=requestAnimationFrame(t)});case 1:case 2:return t.a(2)}},t,this)})),function(t){return r.apply(this,arguments)})}],n&&st(t.prototype,n),e&&st(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,i,s,c,u,l,f,h,m,p,v,y}();const lt=ut;function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return mt(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(mt(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,mt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,mt(f,"constructor",u),mt(u,"constructor",c),c.displayName="GeneratorFunction",mt(u,o,"GeneratorFunction"),mt(f),mt(f,o,"Generator"),mt(f,r,function(){return this}),mt(f,"toString",function(){return"[object Generator]"}),(ht=function(){return{w:i,m:h}})()}function mt(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}mt=function(t,n,e,r){function i(n,e){mt(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},mt(t,n,e,r)}function dt(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function pt(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){dt(i,r,o,a,s,"next",t)}function s(t){dt(i,r,o,a,s,"throw",t)}a(void 0)})}}function vt(t){return function(t){if(Array.isArray(t))return yt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return yt(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?yt(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function bt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gt(r.key),r)}}function gt(t){var n=function(t,n){if("object"!=ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==ft(n)?n:n+""}function _t(t,n,e){return n=xt(n),function(t,n){if(n&&("object"==ft(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tt()?Reflect.construct(n,e||[],xt(t).constructor):n.apply(t,e))}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Tt=function(){return!!t})()}function wt(t,n,e,r){var o=At(xt(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function At(){return At="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=xt(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},At.apply(null,arguments)}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}function Et(t,n){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Et(t,n)}var Pt=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=_t(this,n,[t])).MAX_ITER=500,e.extraIterations=0,e.DEFAULT_ZOOM=2.5,e.DEFAULT_C=[-.246,.64235],e.zoom=e.DEFAULT_ZOOM,e.pan=vt(e.DEFAULT_PAN),e.rotation=e.DEFAULT_ROTATION,e.colorPalette=vt(e.DEFAULT_PALETTE),e.c=vt(e.DEFAULT_C),e.PRESETS=[],e.DIVES=[],e.currentPaletteIndex=0,e.innerStops=new Float32Array(f[e.currentPaletteIndex].theme),e.currentCAnimationFrame=null,e.demoTime=0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Et(t,n)}(n,t),e=n,r=[{key:"createFragmentShaderSource",value:function(){return'/*\r\n * Julia Fragment Shader (Legacy, for preview purposes)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n *\r\n * @description\r\n * Julia set basic implementation in mediump float precision\r\n *\r\n * @license   MIT\r\n */\r\n\r\n\r\n#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\r\n\r\n// Uniforms\r\nuniform vec2 u_resolution;// Canvas resolution in pixels\r\nuniform vec2 u_pan;// Pan offset in fractal space\r\nuniform float u_zoom;// Zoom factor\r\nuniform float u_iterations;// For normalizing the smooth iteration count\r\nuniform float u_rotation;// Rotation (in radians)\r\nuniform vec2 u_c;// Julia set constant\r\nuniform vec3 u_colorPalette;// Color palette\r\nuniform vec3 u_innerStops[5];// Color palette inner stops\r\n\r\n// Maximum iterations (compile-time constant required by GLSL ES 1.00).\r\nconst int MAX_ITERATIONS = 1000;\r\n\r\n// Define color stops as individual constants (RGB values in [0,1]).\r\n// Default stops (black, orange, white, blue, dark blue).\r\n\r\n// Interpolates between the five color stops.\r\n// 5 stops = 4 segments.\r\nvec3 getColorFromMap(float t) {\r\n    float segment = 1.0 / 4.0;// 4 segments for 5 stops.\r\n    if (t <= segment) {\r\n        return mix(u_innerStops[0], u_innerStops[1], t / segment);\r\n    } else if (t <= 2.0 * segment) {\r\n        return mix(u_innerStops[1], u_innerStops[2], (t - segment) / segment);\r\n    } else if (t <= 3.0 * segment) {\r\n        return mix(u_innerStops[2], u_innerStops[3], (t - 2.0 * segment) / segment);\r\n    } else {\r\n        return mix(u_innerStops[3], u_innerStops[4], (t - 3.0 * segment) / segment);\r\n    }\r\n}\r\n\r\nvoid main() {\r\n    // Map fragment coordinates to normalized device coordinates\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;// center at (0,0)\r\n    st.x *= aspect;// adjust x for aspect ratio\r\n\r\n    // Apply rotation\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 rotated = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    // Map screen coordinates to Julia space\r\n    vec2 z = rotated * u_zoom + u_pan;\r\n\r\n    // Determine escape iterations\r\n    int iterCount = MAX_ITERATIONS;\r\n    for (int i = 0; i < MAX_ITERATIONS; i++) {\r\n        if (dot(z, z) > 4.0) {\r\n            iterCount = i;\r\n            break;\r\n        }\r\n        // Julia set iteration.\r\n        z = vec2(z.x*z.x - z.y*z.y, 2.0*z.x*z.y) + u_c;\r\n    }\r\n\r\n    // If the point never escaped, render as simple color\r\n    if (iterCount == MAX_ITERATIONS) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        // Compute a smooth iteration value\r\n        float smoothColor = float(iterCount) - log2(log2(dot(z, z)));\r\n        float t = clamp(smoothColor / u_iterations, 0.0, 1.0);\r\n\r\n        // Apply a sine modulation to mimic the "sine" color mapping effect\r\n        // Frequency: 4Ï€\r\n        t = 0.5 + 0.6 * sin(t * 4.0 * 3.14159265);\r\n\r\n        // Lookup the color from the map\r\n        vec3 col = getColorFromMap(t);\r\n\r\n        // Use the user-defined color palette as a tint\r\n        // col *= u_colorPalette;\r\n\r\n        gl_FragColor = vec4(col, 1.0);\r\n    }\r\n}'.toString()}},{key:"updateUniforms",value:function(){wt(n,"updateUniforms",this,3)([]),this.cLoc=this.gl.getUniformLocation(this.program,"u_c"),this.innerStopsLoc=this.gl.getUniformLocation(this.program,"u_innerStops")}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.floor(3e3*Math.pow(2,-Math.log2(this.zoom)));this.iterations=Math.min(2e3,t+this.extraIterations),this.gl.uniform2fv(this.cLoc,this.c),this.gl.uniform3fv(this.innerStopsLoc,this.innerStops),wt(n,"draw",this,3)([])}},{key:"reset",value:function(){this.c=vt(this.DEFAULT_C),this.innerStops=new Float32Array(f[0].theme),this.currentPaletteIndex=0,wt(n,"reset",this,3)([])}},{key:"getNextColorThemeId",value:function(){return f[(this.currentPaletteIndex+1)%f.length].id||"Random"}},{key:"animateInnerStopsTransition",value:(a=pt(ht().m(function t(n){var e,r,o,i=this,a=arguments;return ht().w(function(t){for(;;)switch(t.n){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:250,r=a.length>2&&void 0!==a[2]?a[2]:null,this.stopCurrentColorAnimations(),o=Array.from(this.innerStops),t.n=1,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u,l=Math.min((c-a)/e,1),f=o.map(function(t,e){return H(t,n.theme[e],l)});i.innerStops=new Float32Array(f),n.keyColor&&(u=hexToRGB(n.keyColor))&&(i.colorPalette=[u.r,u.g,u.b]),u||(i.colorPalette=[1.5*n.theme[9],1.5*n.theme[10],1.5*n.theme[11]]),i.gl.useProgram(i.program),i.innerStopsLoc&&i.gl.uniform3fv(i.innerStopsLoc,i.innerStops),i.draw(),r&&r(),l<1?i.currentColorAnimationFrame=requestAnimationFrame(s):(i.stopCurrentColorAnimations(),t())};i.currentColorAnimationFrame=requestAnimationFrame(s)});case 1:return t.a(2)}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"animateColorPaletteTransition",value:(i=pt(ht().m(function t(){var n,e,r=arguments;return ht().w(function(t){for(;;)switch(t.n){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:250,e=r.length>1&&void 0!==r[1]?r[1]:null,this.currentPaletteIndex=(this.currentPaletteIndex+1)%f.length,t.n=1,this.animateInnerStopsTransition(f[this.currentPaletteIndex],n,e);case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"needsRebase",value:function(){return!1}},{key:"onProgramCreated",value:function(){}}],r&&bt(e.prototype,r),o&&bt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,i,a}(lt),St=null,Dt=null,Lt=!1,Ot=250,kt=250;function Ft(){(St=document.getElementById("floatingCanvas"))&&(St.width=Ot*window.devicePixelRatio,St.height=kt*window.devicePixelRatio,St.style.width="".concat(Ot,"px"),St.style.height="".concat(kt,"px"))}function Rt(t,n){if(St){var e=window.innerWidth,r=window.innerHeight,o=t+20,i=n+20;o+Ot>e&&(o=t-Ot-20),i+kt>r&&(i=n-kt-20),o=Math.max(0,Math.min(o,e-Ot)),i=Math.max(0,Math.min(i,r-kt)),St.style.left="".concat(o,"px"),St.style.top="".concat(i,"px")}}function Ct(){Lt&&(Lt=!1,St&&(St.style.display="none"))}function zt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Mt(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Mt(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var It,Nt,jt,Ut,Xt,Zt,Bt,Gt=300,Ht=.05,Vt=!1,qt=0,Jt=0,Wt=0,Kt=0,Yt=null,Qt=null,$t=!1,tn=!1,nn=!1,en=0,rn=!1,on=0,an=0,sn=!1,cn=0,un=0,ln=0,fn=null,hn=0,mn=0,dn=!1;function pn(){Nt&&"function"==typeof Nt.markOrbitDirty&&Nt.markOrbitDirty()}function vn(t){Nt=t,(It=t.canvas).addEventListener("contextmenu",function(t){return t.preventDefault()}),Ft(),yn()}function yn(){Vt||(jt=function(t){return function(t){if(t.preventDefault(),!dn){var n=Nt.canvas.getBoundingClientRect();hn=n.left,mn=n.top,dn=!0}cn+=t.deltaY,un=t.clientX,ln=t.clientY,fn||(fn=requestAnimationFrame(gn));Qt&&clearTimeout(Qt);Qt=setTimeout(function(){dn=!1,Kr()},150),Nt.noteInteraction(160)}(t)},Ut=function(t){return function(t){if(0===t.button){$t=!1,qt=t.clientX,Jt=t.clientY,Wt=t.clientX,Kt=t.clientY;var n=It.getBoundingClientRect();on=n.left,an=n.top,sn=!0}else if(2===t.button)en=t.clientX;else if(1===t.button&&(t.preventDefault(),!Gr())){rn=!0;var e=It.getBoundingClientRect(),r=t.clientX-e.left,o=t.clientY-e.top,i=zt(Nt.screenToFractal(r,o),2),a=i[0],s=i[1];c=t.clientX,u=t.clientY,l=a,f=s,St||Ft(),Dt||((Dt=new Pt(St)).MAX_ITER=500,Dt.extraIterations=0),Dt.c=[l,f],Dt.markOrbitDirty(),Rt(c,u),St.style.display="block",Lt=!0,Dt.draw()}var c,u,l,f}(t)},Xt=function(t){return function(t){var n=t.clientX-qt,e=t.clientY-Jt;if(1===t.buttons&&(!$t&&(Math.abs(n)>5||Math.abs(e)>5)&&($t=!0),$t)){It.style.cursor="move",Yt&&(clearTimeout(Yt),Yt=null);var r=on,o=an;if(!sn){var i=It.getBoundingClientRect();r=i.left,o=i.top}var a=Wt-r,s=Kt-o,c=t.clientX-r,u=t.clientY-o,l=zt(Nt.screenToViewVector(a,s),2),f=l[0],h=l[1],m=zt(Nt.screenToViewVector(c,u),2),d=m[0],p=m[1];if(Number.isFinite(Nt.zoom)){var v=(f-d)*Nt.zoom,y=(h-p)*Nt.zoom;Nt.addPan(v,y),pn(),Nt.noteInteraction(160)}Wt=t.clientX,Kt=t.clientY,Nt.draw(),Yr(!0)}if(2===t.buttons&&(!nn&&(Math.abs(n)>5||Math.abs(e)>5)&&(nn=!0),nn)){t.preventDefault();var b=t.clientX-en;Nt.rotation=q(Nt.rotation+.01*b),Nt.draw(),en=t.clientX,tn=!0,It.style.cursor="grabbing",Yr()}if(4===t.buttons&&rn&&!Gr()){var g=It.getBoundingClientRect(),_=t.clientX-g.left,T=t.clientY-g.top,w=zt(Nt.screenToFractal(_,T),2),A=w[0],x=w[1];E=t.clientX,P=t.clientY,S=A,D=x,Lt&&Dt&&(Dt.c=[S,D],Dt.markOrbitDirty(),Rt(E,P),Dt.draw())}var E,P,S,D}(t)},Zt=function(t){return function(t){if(![0,1,2].includes(t.button))return;if(t.preventDefault(),t.stopPropagation(),1===t.button)return void(rn&&(rn=!1,Ct()));if(0===t.button)if(sn=!1,$t)Kr(),$t=!1,pn(),Nt.draw();else{var n=It.getBoundingClientRect(),e=t.clientX-n.left,r=t.clientY-n.top,o=zt(Nt.screenToFractal(e,r),2),s=o[0],c=o[1];if(null!==Yt){clearTimeout(Yt),Yt=null;var u=Nt.zoom*Ht;u>Nt.MAX_ZOOM&&Nt.animatePanAndZoomTo([s,c],u,1e3,a.QUINT).then(Kr)}else Yt=setTimeout(function(){Nt.animatePanTo([s,c],500).then(function(){Kr(),Gr()?A(i.JULIA,s,c,Nt.zoom,Nt.rotation,Nt.c[0],Nt.c[1]):A(i.MANDELBROT,s,c,Nt.zoom,Nt.rotation)}),navigator.clipboard.writeText(window.location.href).then(function(){},function(t){}),Yt=null},Gt)}if(2===t.button){if(nn)return nn=!1,tn&&Kr(),tn=!1,void(It.style.cursor="crosshair");var l=It.getBoundingClientRect(),f=t.clientX-l.left,h=t.clientY-l.top,m=zt(Nt.screenToFractal(f,h),2),d=m[0],p=m[1];if(null!==Yt){clearTimeout(Yt),Yt=null;var v=Nt.zoom/Ht;v<Nt.MIN_ZOOM&&Nt.animatePanAndZoomTo([d,p],v,1e3,a.QUINT).then(Kr)}else Yt=setTimeout(function(){Yt=null},Gt);nn=!1}It.style.cursor="crosshair"}(t)},Bt=function(){rn&&(rn=!1,Ct())},It.addEventListener("wheel",jt,{passive:!1}),It.addEventListener("mousedown",Ut),It.addEventListener("mousemove",Xt),It.addEventListener("mouseup",Zt),It.addEventListener("mouseleave",Bt),Vt=!0)}function bn(){Vt&&(It.removeEventListener("wheel",jt,{passive:!1}),It.removeEventListener("mousedown",Ut),It.removeEventListener("mousemove",Xt),It.removeEventListener("mouseup",Zt),It.removeEventListener("mouseleave",Bt),Vt=!1)}function gn(){if(fn=null,Nt&&Number.isFinite(Nt.zoom)){var t=un-hn,n=ln-mn,e=Math.pow(1.1,cn/120),r=Nt.zoom*e;cn=0,r<Nt.MAX_ZOOM||r>Nt.MIN_ZOOM||(Nt.setZoomKeepingAnchor(r,t,n),pn(),Yr(!0),Nt.draw())}}function _n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Tn(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Tn(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var wn,An,xn,En,Pn,Sn=!1,Dn=0,Ln=0,On=0,kn=0,Fn=null,Rn=!1,Cn=0,zn=0,Mn=!1,In=!1,Nn=null,jn=null;function Un(){An&&"function"==typeof An.markOrbitDirty&&An.markOrbitDirty()}function Xn(t){An=t,(wn=t.canvas).addEventListener("contextmenu",function(t){return t.preventDefault()}),Zn()}function Zn(){Sn||(xn=function(t){return function(t){if(!An)return;if(1===t.touches.length){t.preventDefault(),Rn=!1,In=!1,Nn=null,jn=null;var n=t.touches[0];Dn=n.clientX,Ln=n.clientY,On=n.clientX,kn=n.clientY;var e=wn.getBoundingClientRect();return Cn=e.left,zn=e.top,void(Mn=!0)}if(2===t.touches.length){t.preventDefault(),In=!0,Rn=!1,Mn=!1;var r=t.touches[0],o=t.touches[1];Nn=Math.hypot(r.clientX-o.clientX,r.clientY-o.clientY),jn=Math.atan2(o.clientY-r.clientY,o.clientX-r.clientX),Fn&&(clearTimeout(Fn),Fn=null),An.noteInteraction(160)}}(t)},En=function(t){return function(t){if(!An)return;if(1===t.touches.length&&!In){t.preventDefault();var n=t.touches[0],e=n.clientX-Dn,r=n.clientY-Ln;if(!Rn&&(Math.abs(e)>5||Math.abs(r)>5)&&(Rn=!0,Fn&&(clearTimeout(Fn),Fn=null)),Rn){var o=Cn,i=zn;if(!Mn){var a=wn.getBoundingClientRect();o=a.left,i=a.top}var s=On-o,c=kn-i,u=n.clientX-o,l=n.clientY-i,f=_n(An.screenToViewVector(s,c),2),h=f[0],m=f[1],d=_n(An.screenToViewVector(u,l),2),p=d[0],v=d[1];if(Number.isFinite(An.zoom)){var y=(h-p)*An.zoom,b=(m-v)*An.zoom;An.addPan(y,b),Un(),An.noteInteraction(160)}On=n.clientX,kn=n.clientY,An.draw(),Yr(!0)}return}if(2===t.touches.length){t.preventDefault(),In=!0;var g=t.touches[0],_=t.touches[1],T=Math.hypot(g.clientX-_.clientX,g.clientY-_.clientY),w=Math.atan2(_.clientY-g.clientY,_.clientX-g.clientX),A=(g.clientX+_.clientX)/2,x=(g.clientY+_.clientY)/2,E=wn.getBoundingClientRect(),P=A-E.left,S=x-E.top;if(!Nn||!jn)return Nn=T,void(jn=w);var D=An.zoom;if(T>0){var L=Nn/T;D=An.zoom*L}D<An.MAX_ZOOM&&(D=An.MAX_ZOOM),D>An.MIN_ZOOM&&(D=An.MIN_ZOOM),An.setZoomKeepingAnchor(D,P,S);var O=w-jn;Math.abs(O)>.05&&(An.rotation=q(An.rotation+1*O)),Nn=T,jn=w,Un(),An.noteInteraction(160),An.draw(),Yr()}}(t)},Pn=function(t){return function(t){if(!An)return;t.touches.length<2&&(Nn=null,jn=null);if(0===t.touches.length){if(In)return In=!1,Kr(),Un(),void An.draw();if(Mn=!1,Rn)Kr(),Rn=!1,Un(),An.draw();else{var n=t.changedTouches[0],e=wn.getBoundingClientRect(),r=n.clientX-e.left,o=n.clientY-e.top,a=_n(An.screenToFractal(r,o),2),s=a[0],c=a[1];if(null!==Fn){clearTimeout(Fn),Fn=null;var u=.05*An.zoom;u>An.MAX_ZOOM&&An.animatePanAndZoomTo([s,c],u).then(Kr)}else Fn=setTimeout(function(){An.animatePanTo([s,c],400).then(function(){Kr(),Gr()?A(i.JULIA,s,c,An.zoom,An.rotation,An.c[0],An.c[1]):A(i.MANDELBROT,s,c,An.zoom,An.rotation)}),Fn=null},300)}Rn=!1}}(t)},wn.addEventListener("touchstart",xn,{passive:!1}),wn.addEventListener("touchmove",En,{passive:!1}),wn.addEventListener("touchend",Pn,{passive:!1}),Sn=!0)}function Bn(){Sn&&(wn.removeEventListener("touchstart",xn,{passive:!1}),wn.removeEventListener("touchmove",En,{passive:!1}),wn.removeEventListener("touchend",Pn,{passive:!1}),Sn=!1)}function Gn(t,n,e){n.draw();var r=document.createElement("canvas");r.width=t.width,r.height=t.height;var o=r.getContext("2d");if(o){o.drawImage(t,0,0);var i=function(t){var n=Gr()?"Julia":"Mandelbrot";return"Created by ".concat("Synaptory Fractal Traveler"," (").concat(n,": ")+"p=".concat(D(t.pan.slice(),6),", zoom=").concat(t.zoom.toExponential(2))+"".concat(t instanceof Qo?", c=".concat(D(t.c),")"):")")}(n);o.font="".concat(12,"px sans-serif"),o.textAlign="center",o.textBaseline="middle";var a=o.measureText(i).width+12+2,s=r.width-a-6,c=r.height-26-6;o.fillStyle="rgba(0, 0, 0, 0.7)",function(t,n,e,r,o,i){t.beginPath(),t.moveTo(n+i,e),t.lineTo(n+r-i,e),t.quadraticCurveTo(n+r,e,n+r,e+i),t.lineTo(n+r,e+o-i),t.quadraticCurveTo(n+r,e+o,n+r-i,e+o),t.lineTo(n+i,e+o),t.quadraticCurveTo(n,e+o,n,e+o-i),t.lineTo(n,e+i),t.quadraticCurveTo(n,e,n+i,e),t.closePath()}(o,s,c,a,26,8),o.fill();var u=s+a/2,l=c+13+1;o.fillStyle=e,o.fillText(i,u,l);var f,h,m=document.createElement("a");m.setAttribute("download",(f=new Date,h=function(t){return String(t).padStart(2,"0")},"fractal-".concat(f.getFullYear(),"-").concat(h(f.getMonth()+1),"-").concat(h(f.getDate()),"_").concat(h(f.getHours()),"-").concat(h(f.getMinutes()),"-").concat(h(f.getSeconds()),".jpg"))),m.setAttribute("href",r.toDataURL("image/jpeg",.95)),m.click()}}function Hn(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Vn(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(Vn(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Vn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Vn(f,"constructor",u),Vn(u,"constructor",c),c.displayName="GeneratorFunction",Vn(u,o,"GeneratorFunction"),Vn(f),Vn(f,o,"Generator"),Vn(f,r,function(){return this}),Vn(f,"toString",function(){return"[object Generator]"}),(Hn=function(){return{w:i,m:h}})()}function Vn(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Vn=function(t,n,e,r){function i(n,e){Vn(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Vn(t,n,e,r)}function qn(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}var Jn,Wn=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Space","KeyQ","KeyW"],Kn=.1,Yn=.01,Qn=5e-4,$n=.1,te=!1,ne=!1;function ee(t){return re.apply(this,arguments)}function re(){var t;return t=Hn().m(function t(r){var a,u,l,m,d,p,v,y,b,g,_,T,w,A,x,E,P,S,D,L,O,k;return Hn().w(function(t){for(;;)switch(t.n){case 0:if(u=r.target,l=null==u||null===(a=u.tagName)||void 0===a?void 0:a.toLowerCase(),!u||"input"!==l&&"textarea"!==l&&"select"!==l&&!u.isContentEditable){t.n=1;break}return t.a(2);case 1:if(m=!1,d=r.shiftKey?.01:.1,p=c,v=0,y=0,b=0,g=0,_=r.altKey||"Alt"===r.code,!Qr()||!Wn.includes(r.code)){t.n=2;break}return r.preventDefault(),t.a(2);case 2:k=r.code,t.n="KeyQ"===k?3:"KeyW"===k?4:"KeyE"===k?7:"KeyR"===k?8:"KeyL"===k?10:"KeyZ"===k?11:"KeyT"===k?14:"KeyA"===k?23:"KeyS"===k?24:"KeyD"===k?25:"KeyM"===k?27:"KeyN"===k?29:"ArrowLeft"===k?30:"ArrowRight"===k?31:"ArrowDown"===k?32:"ArrowUp"===k?33:"Space"===k?34:"Enter"===k?37:38;break;case 3:p=s;case 4:if(!te){t.n=5;break}Jn.stopCurrentRotationAnimation(),te=!1,t.n=6;break;case 5:return te=!0,t.n=6,Jn.animateInfiniteRotation(p,d);case 6:return m=!0,t.a(3,43);case 7:return ho(),m=!0,t.a(3,43);case 8:if(!r.shiftKey){t.n=9;break}return t.n=9,_o();case 9:return m=!0,t.a(3,43);case 10:return fo(),m=!0,t.a(3,43);case 11:t.n=12;break;case 12:return t.n=13,Zr(Gr()?i.MANDELBROT:i.JULIA);case 13:return m=!0,t.a(3,43);case 14:if(!_){t.n=18;break}if(!Gr()){t.n=16;break}return t.n=15,Jn.animateInnerStopsTransition(f[0],250,Wr);case 15:t.n=17;break;case 16:return t.n=17,Jn.animateColorPaletteTransition(h,250,Wr);case 17:t.n=22;break;case 18:if(!r.shiftKey){t.n=21;break}if(!Jn.currentColorAnimationFrame){t.n=19;break}return Jn.stopCurrentColorAnimations(),t.a(3,43);case 19:return t.n=20,Jn.animateFullColorSpaceCycle(Gr()?1e4:15e3,Wr);case 20:t.n=22;break;case 21:return t.n=22,vo();case 22:return m=!0,t.a(3,43);case 23:return Jn.resizeCanvas(),m=!0,t.a(3,43);case 24:return r.shiftKey&&bo(),m=!0,t.a(3,43);case 25:return t.n=26,no();case 26:return m=!0,t.a(3,43);case 27:if(e!==n){t.n=28;break}return t.n=28,Ur(i.RIEMANN);case 28:return m=!0,t.a(3,43);case 29:return e&&(o("Analytic Extension toggled."),Jn.useAnalyticExtension=!Jn.useAnalyticExtension,Jn.draw()),m=!0,t.a(3,43);case 30:return v=_?0:-(r.shiftKey?Yn:Kn),b=_?Qn*(r.shiftKey?$n:1):0,m=!0,t.a(3,43);case 31:return v=_?0:r.shiftKey?Yn:Kn,b=_?Qn*(r.shiftKey?-.1:-1):0,m=!0,t.a(3,43);case 32:return y=_?0:-(r.shiftKey?Yn:Kn),g=_?Qn*(r.shiftKey?-.1:-1):0,m=!0,t.a(3,43);case 33:return y=_?0:r.shiftKey?Yn:Kn,g=_?Qn*(r.shiftKey?$n:1):0,m=!0,t.a(3,43);case 34:if(T=r.shiftKey?.01:.1,w=r.ctrlKey||_?1+T:1-T,!((A=Jn.zoom*w)>=Jn.MAX_ZOOM&&A<=Jn.MIN_ZOOM)){t.n=36;break}return t.n=35,Jn.animateZoomTo(A,20);case 35:Kr();case 36:return m=!0,t.a(3,43);case 37:return go(),m=!0,t.a(3,43);case 38:if(!(x=r.code.match(/^(Digit|Numpad)(\d)$/))){t.n=42;break}if(E=parseInt(x[2],0),!r.shiftKey||!Gr()){t.n=40;break}return t.n=39,io(Jn.DIVES,E);case 39:t.n=41;break;case 40:return t.n=41,uo(Jn.PRESETS,E);case 41:m=!0;case 42:return t.a(3,43);case 43:if(!v&&!y){t.n=45;break}return P=Jn.rotation,S=v*Jn.zoom*Math.cos(P)-y*Jn.zoom*Math.sin(P),D=v*Jn.zoom*Math.sin(P)+y*Jn.zoom*Math.cos(P),t.n=44,Jn.animatePanBy([S,D],50);case 44:Jn.noteInteraction(160),Kr();case 45:if(!b&&!g||!Gr()){t.n=47;break}return L=b*Jn.zoom,O=g*Jn.zoom,t.n=46,Jn.animateToC([Jn.c[0]+L,Jn.c[1]+O],10);case 46:Kr();case 47:m&&r.preventDefault();case 48:return t.a(2)}},t)}),re=function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){qn(i,r,o,a,s,"next",t)}function s(t){qn(i,r,o,a,s,"throw",t)}a(void 0)})},re.apply(this,arguments)}function oe(t){ne||(Jn=t,document.addEventListener("keydown",ee),ne=!0,o("Initialized.","initHotKeys"))}function ie(){ne&&(Jn=null,ne=!1,document.removeEventListener("keydown",ee))}const ae=JSON.parse('{"v4":[{"id":0,"title":"Default","pan":[-0.5,0],"zoom":3,"rotation":0},{"id":1,"title":"Misiurewicz Point 1","speed":5,"pan":[0.3514237590525219,0.0638665598132929],"rotation":0,"zoom":3.0177077833226633e-16},{"id":2,"title":"Kaleidoscope Valley","speed":5,"pan":[0.2549996194371581,0.0005684340597555177],"rotation":0,"zoom":1.395817829563278e-17},{"id":3,"title":"Tip of the spear","speed":5,"pan":[-1.9990961121566266,2.8541655645072767e-16],"rotation":5.4382185221694925,"zoom":1.2995863762636767e-13},{"id":4,"title":"Tentacles","speed":5,"pan":[-0.743644784243975,0.13182914354891018],"rotation":0.8749616210243012,"zoom":3.304183377903384e-10},{"id":5,"title":"Spiral","speed":5,"pan":[-0.7668654471115035,-0.10747310068867935],"rotation":1.5065924365935786,"zoom":2.266530562848193e-14},{"id":6,"title":"Eyes","speed":5,"pan":[-0.8535650370330192,-0.2107813458112579],"rotation":4.217344329507167,"zoom":2.3639582790335785e-22},{"id":7,"title":"Wormhole","speed":5,"pan":[0.3260010801403236,0.05090212275634712],"rotation":3.695917207994011,"zoom":3.610452343636546e-16},{"id":8,"title":"Tip of the Branch","speed":5,"pan":[-0.2281554936539617,1.1151425080399369],"rotation":5.574310838854462,"zoom":3.7267390083662553e-16},{"id":9,"title":"Rabbits","speed":5,"pan":[-0.12479143490517397,0.8403941246800949],"rotation":0.0026613829226800334,"zoom":1.147242954504696e-16},{"id":10,"title":"Devil\'s Eye","speed":10,"pan":[-1.999096112156626,-1.0944307204017597e-18],"rotation":0,"zoom":3.3682845781180966e-14},{"id":11,"title":"Misiurewicz Point 2","speed":10,"pan":[0.11650145207876453,-0.6635454379133249],"rotation":2.610174541746648,"zoom":3.493264360283514e-16},{"id":12,"title":"Julia Core","speed":5,"pan":[0.34763451415265645,0.644195943232777],"rotation":3.231857941193079,"zoom":3.8155588343004964e-13},{"id":13,"title":"Hyperspace","speed":5,"pan":[-0.16454216570937188,1.0384395470826784],"rotation":1.0399999999999796,"zoom":1.0070206965970002e-15},{"id":14,"title":"Microbrot","speed":5,"pan":[0.11654740401415453,-0.6636148998875822],"rotation":2.610174541746648,"zoom":1.0267582908408742e-7},{"id":15,"title":"Plasma Storm","speed":5,"pan":[0.2625017727522711,0.6113502800557138],"rotation":0.9088831624158438,"zoom":6.228752917993604e-14},{"id":16,"title":"Where the Math Ends","speed":5,"pan":[-1.9999991175876528,-3.194092143034014e-39],"rotation":0,"zoom":6.130263511531091e-36},{"id":17,"title":"Nucleus","speed":5,"pan":[0.11654740531325179,-0.6636149160665515],"rotation":0.42681868968169034,"zoom":2.318964706881093e-15},{"id":18,"title":"The Julia","speed":5,"pan":[-1.769582878493225,-0.00947401887333753],"rotation":5.155475788649225,"zoom":3.556856738712547e-18},{"id":19,"title":"Seahorse Valley","speed":5,"pan":[-0.7436399999999269,0.13182000000014288],"rotation":2.063121784131649,"zoom":4.2563398808307913e-13},{"id":20,"title":"Julia World","speed":5,"pan":[-0.5925376025591513,0.6218580534997632],"rotation":0,"zoom":2.1116123693585906e-15},{"id":21,"title":"Nova Core","speed":5,"pan":[0.11651278779150401,0.6625979215565223],"rotation":1.6016343574412808,"zoom":8.653283042641697e-15}]}');function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function ce(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ue(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(ue(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ue(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ue(f,"constructor",u),ue(u,"constructor",c),c.displayName="GeneratorFunction",ue(u,o,"GeneratorFunction"),ue(f),ue(f,o,"Generator"),ue(f,r,function(){return this}),ue(f,"toString",function(){return"[object Generator]"}),(ce=function(){return{w:i,m:h}})()}function ue(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ue=function(t,n,e,r){function i(n,e){ue(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},ue(t,n,e,r)}function le(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||de(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function he(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){fe(i,r,o,a,s,"next",t)}function s(t){fe(i,r,o,a,s,"throw",t)}a(void 0)})}}function me(t){return function(t){if(Array.isArray(t))return pe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||de(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(t,n){if(t){if("string"==typeof t)return pe(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?pe(t,n):void 0}}function pe(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function ve(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ae(r.key),r)}}function ye(t,n,e){return n=Te(n),function(t,n){if(n&&("object"==se(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,be()?Reflect.construct(n,e||[],Te(t).constructor):n.apply(t,e))}function be(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(be=function(){return!!t})()}function ge(t,n,e,r){var o=_e(Te(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function _e(){return _e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Te(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},_e.apply(null,arguments)}function Te(t){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Te(t)}function we(t,n){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},we(t,n)}function Ae(t){var n=function(t,n){if("object"!=se(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==se(n)?n:n+""}var xe=function(t){function n(t){var e,r,o,i;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),e=ye(this,n,[t]),r=e,i=function(){return e.orbitDirty=!0},(o=Ae(o="markOrbitDirty"))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,e.DEFAULT_PAN=[-.5,0],e.setPan(e.DEFAULT_PAN[0],e.DEFAULT_PAN[1]),e.refPan=me(e.DEFAULT_PAN),e.refPanDD={x:{hi:e.DEFAULT_PAN[0],lo:0},y:{hi:e.DEFAULT_PAN[1],lo:0}},e.orbitDirty=!0,e.MAX_ITER=2e3,e.REF_SEARCH_GRID=7,e.REF_SEARCH_RADIUS=.5,e.rebaseArmed=!0,e.orbitTex=null,e.orbitData=null,e.floatTexExt=null,e.PRESETS=ae.v4,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&we(t,n)}(n,t),e=n,r=[{key:"onProgramCreated",value:function(){this.floatTexExt=this.gl.getExtension("OES_texture_float"),this.floatTexExt&&(this.orbitTex=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.orbitData=new Float32Array(4*this.MAX_ITER),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER),this.orbitDirty=!0)}},{key:"createFragmentShaderSource",value:function(){return"/*\r\n * Mandelbrot Fragment Shader (Rebased Perturbation)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n * @description\r\n * High-precision Mandelbrot implementation using Double-Float (df) arithmetic.\r\n * Implements perturbation: dz_{n+1} = 2*zref*dz + dz^2 + dc.\r\n * Requires OES_texture_float for orbit reference sampling.\r\n *\r\n * @license   MIT\r\n */\r\n\r\nprecision highp float;\r\n\r\nuniform vec2 u_resolution;\r\n\r\n// delta pan (viewPan - refPan) computed on JS side for float64 precision\r\nuniform vec2 u_delta_pan_h;\r\nuniform vec2 u_delta_pan_l;\r\n\r\n// zoom (hi+lo)\r\nuniform float u_zoom_h;\r\nuniform float u_zoom_l;\r\n\r\nuniform float u_iterations;\r\nuniform vec3  u_colorPalette;\r\nuniform float u_rotation;\r\n\r\nuniform sampler2D u_orbitTex;\r\nuniform float u_orbitW;\r\n\r\nconst int MAX_ITER = __MAX_ITER__;\r\n\r\n// --- df helpers ---\r\nstruct df  { float hi; float lo; };\r\nstruct df2 { df x; df y; };\r\n\r\ndf df_make(float hi, float lo){ df a; a.hi=hi; a.lo=lo; return a; }\r\ndf df_from(float a){ return df_make(a, 0.0); }\r\nfloat df_to_float(df a){ return a.hi + a.lo; }\r\n\r\ndf twoSum(float a, float b) {\r\n    float s  = a + b;\r\n    float bb = s - a;\r\n    float err = (a - (s - bb)) + (b - bb);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf quickTwoSum(float a, float b) {\r\n    float s = a + b;\r\n    float err = b - (s - a);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf df_add(df a, df b) {\r\n    df s = twoSum(a.hi, b.hi);\r\n    float t = a.lo + b.lo;\r\n    df u = twoSum(s.lo, t);\r\n    df v = twoSum(s.hi, u.hi);\r\n    float lo = u.lo + v.lo;\r\n    return quickTwoSum(v.hi, lo);\r\n}\r\n\r\ndf df_sub(df a, df b) { return df_add(a, df_make(-b.hi, -b.lo)); }\r\n\r\nconst float SPLIT = 4097.0;\r\n\r\ndf twoProd(float a, float b) {\r\n    float p = a * b;\r\n\r\n    float aSplit = a * SPLIT;\r\n    float aHi = aSplit - (aSplit - a);\r\n    float aLo = a - aHi;\r\n\r\n    float bSplit = b * SPLIT;\r\n    float bHi = bSplit - (bSplit - b);\r\n    float bLo = b - bHi;\r\n\r\n    float err = ((aHi * bHi - p) + aHi * bLo + aLo * bHi) + aLo * bLo;\r\n    return df_make(p, err);\r\n}\r\n\r\ndf df_mul(df a, df b) {\r\n    df p = twoProd(a.hi, b.hi);\r\n    float err = a.hi * b.lo + a.lo * b.hi + a.lo * b.lo;\r\n    df s = twoSum(p.lo, err);\r\n    df r = twoSum(p.hi, s.hi);\r\n    float lo = s.lo + r.lo;\r\n    return quickTwoSum(r.hi, lo);\r\n}\r\n\r\ndf df_mul_f(df a, float b) { return df_mul(a, df_from(b)); }\r\n\r\ndf2 df2_make(df x, df y){ df2 r; r.x=x; r.y=y; return r; }\r\ndf2 df2_add(df2 a, df2 b){ return df2_make(df_add(a.x, b.x), df_add(a.y, b.y)); }\r\n\r\ndf2 df2_mul(df2 a, df2 b){\r\n    // (ax + i ay)(bx + i by) = (axbx - ayby) + i(axby + aybx)\r\n    df axbx = df_mul(a.x, b.x);\r\n    df ayby = df_mul(a.y, b.y);\r\n    df axby = df_mul(a.x, b.y);\r\n    df aybx = df_mul(a.y, b.x);\r\n    return df2_make(df_sub(axbx, ayby), df_add(axby, aybx));\r\n}\r\n\r\ndf2 df2_sqr(df2 a){\r\n    df xx = df_mul(a.x, a.x);\r\n    df yy = df_mul(a.y, a.y);\r\n    df xy = df_mul(a.x, a.y);\r\n    return df2_make(df_sub(xx, yy), df_mul_f(xy, 2.0));\r\n}\r\n\r\ndf2 sampleZRef(int n){\r\n    float x = (float(n) + 0.5) / u_orbitW;\r\n    vec4 t = texture2D(u_orbitTex, vec2(x, 0.5));\r\n    return df2_make(df_make(t.r, t.g), df_make(t.b, t.a));\r\n}\r\n\r\nvec4 calculateColor(float i, vec3 u_colorPalette) {\r\n    float color = i / 100.0;\r\n    vec3 fractalColor = vec3(\r\n    sin(color * 3.1415),\r\n    sin(color * 6.2830),\r\n    sin(color * 1.7200)\r\n    ) * u_colorPalette;\r\n    return vec4(fractalColor, 1.0);\r\n}\r\n\r\nvoid main() {\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;\r\n    st.x *= aspect;\r\n\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 r = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    df zoom = df_make(u_zoom_h, u_zoom_l);\r\n\r\n    // deltaPan = viewPan - refPan (computed on JS side with float64 precision)\r\n    df2 deltaPan = df2_make(\r\n        df_make(u_delta_pan_h.x, u_delta_pan_l.x),\r\n        df_make(u_delta_pan_h.y, u_delta_pan_l.y)\r\n    );\r\n\r\n    // dc = deltaPan + zoom * r\r\n    df2 dc = df2_make(df_mul_f(zoom, r.x), df_mul_f(zoom, r.y));\r\n    dc = df2_add(dc, deltaPan);\r\n\r\n    df2 dz = df2_make(df_from(0.0), df_from(0.0));\r\n\r\n    float i = 0.0;\r\n\r\n    for (int n = 0; n < MAX_ITER; n++) {\r\n        float fn = float(n);\r\n        if (fn >= u_iterations) { i = fn; break; }\r\n\r\n        df2 zref = sampleZRef(n);\r\n\r\n        // bailout approx using float\r\n        float zx = df_to_float(zref.x) + df_to_float(dz.x);\r\n        float zy = df_to_float(zref.y) + df_to_float(dz.y);\r\n        if (zx*zx + zy*zy > 4.0) { i = fn; break; }\r\n\r\n        // dz_{n+1} = 2*zref*dz + dz^2 + dc\r\n        df2 zref_dz = df2_mul(zref, dz);\r\n        zref_dz.x = df_mul_f(zref_dz.x, 2.0);\r\n        zref_dz.y = df_mul_f(zref_dz.y, 2.0);\r\n\r\n        df2 dz2 = df2_sqr(dz);\r\n\r\n        dz = df2_add(df2_add(zref_dz, dz2), dc);\r\n\r\n        if (n == MAX_ITER - 1) i = u_iterations;\r\n    }\r\n\r\n    if (i >= u_iterations) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        gl_FragColor = calculateColor(i, u_colorPalette);\r\n    }\r\n}".replace("__MAX_ITER__",this.MAX_ITER).toString()}},{key:"updateUniforms",value:function(){ge(n,"updateUniforms",this,3)([]),this.deltaPanHLoc=this.gl.getUniformLocation(this.program,"u_delta_pan_h"),this.deltaPanLLoc=this.gl.getUniformLocation(this.program,"u_delta_pan_l"),this.zoomHLoc=this.gl.getUniformLocation(this.program,"u_zoom_h"),this.zoomLLoc=this.gl.getUniformLocation(this.program,"u_zoom_l"),this.orbitTexLoc=this.gl.getUniformLocation(this.program,"u_orbitTex"),this.orbitWLoc=this.gl.getUniformLocation(this.program,"u_orbitW")}},{key:"escapeItersDouble",value:function(t,n,e){for(var r=0,o=0,i=0;i<e;i++){var a=2*r*o+n;if((r=r*r-o*o+t)*r+(o=a)*o>4)return i}return e}},{key:"pickReferenceNearViewCenter",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.refPan[0]=this.pan[0],this.refPan[1]=this.pan[1],this.refPanDD.x.hi=this.panDD.x.hi,this.refPanDD.x.lo=this.panDD.x.lo,this.refPanDD.y.hi=this.panDD.y.hi,void(this.refPanDD.y.lo=this.panDD.y.lo);var t=this.REF_SEARCH_GRID,n=(t-1)/2,e=2*this.REF_SEARCH_RADIUS/(t-1),r=this.zoom,o=Math.min(this.MAX_ITER,Math.max(200,Math.floor(this.iterations))),i=-1;Math.hypot(this.refPan[0]-this.pan[0],this.refPan[1]-this.pan[1])<r*this.REF_SEARCH_RADIUS*2.5&&(i=this.escapeItersDouble(this.refPan[0],this.refPan[1],o));for(var a=this.pan[0],s=this.pan[1],c=this.escapeItersDouble(this.pan[0],this.pan[1],o),u=0;u<t;u++)for(var l=0;l<t;l++){var f=(l-n)*e,h=(u-n)*e,m=this.pan[0]+f*r,d=this.pan[1]+h*r,p=this.escapeItersDouble(m,d,o);p>c&&(c=p,a=m,s=d)}var v=Math.max(.1*i,50);(i<0||c-i>v)&&(this.refPan[0]=a,this.refPan[1]=s,this.refPanDD.x.hi=a,this.refPanDD.x.lo=0,this.refPanDD.y.hi=s,this.refPanDD.y.lo=0),this.bestScore=c,this.probeIters=o}},{key:"computeReferenceOrbit",value:function(){if(this.orbitData&&this.orbitTex){for(var t=this.refPan[0],n=this.refPan[1],e=0,r=0,o=0;o<this.MAX_ITER;o++){var i=k(e),a=k(r),s=4*o;this.orbitData[s]=i.high,this.orbitData[s+1]=i.low,this.orbitData[s+2]=a.high,this.orbitData[s+3]=a.low;var c=2*e*r+n;if((e=e*e-r*r+t)*e+(r=c)*r>4){for(var u=k(e),l=k(r),f=o+1;f<this.MAX_ITER;f++){var h=4*f;this.orbitData[h]=u.high,this.orbitData[h+1]=u.low,this.orbitData[h+2]=l.high,this.orbitData[h+3]=l.low}break}}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.MAX_ITER,1,0,this.gl.RGBA,this.gl.FLOAT,this.orbitData),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER)}}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.max(this.zoom,1e-300),e=Math.floor(300+120*Math.log10(this.DEFAULT_ZOOM/t));this.iterations=Math.max(50,Math.min(this.MAX_ITER,e+this.extraIterations));var r=this.needsRebase(),o=!this.interactionActive||r;this.orbitDirty&&o&&(this.pickReferenceNearViewCenter(),this.computeReferenceOrbit(),this.orbitDirty=!1);var i=N(this.panDD.x,this.refPanDD.x),a=N(this.panDD.y,this.refPanDD.y);this.deltaPanHLoc&&this.gl.uniform2f(this.deltaPanHLoc,i.hi,a.hi),this.deltaPanLLoc&&this.gl.uniform2f(this.deltaPanLLoc,i.lo,a.lo);var s=k(this.zoom);this.zoomHLoc&&this.gl.uniform1f(this.zoomHLoc,s.high),this.zoomLLoc&&this.gl.uniform1f(this.zoomLLoc,s.low),ge(n,"draw",this,3)([])}},{key:"needsRebase",value:function(){var t=this.pan[0]-this.refPan[0],n=this.pan[1]-this.refPan[1];return Math.hypot(t,n)>.75*this.zoom}},{key:"animateColorPaletteTransition",value:(l=he(ce().m(function t(e){var r,o,i,a,s,c=arguments;return ce().w(function(t){for(;;)switch(t.n){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:250,o=c.length>2&&void 0!==c[2]?c[2]:null,i=function(t,n,e){return Math.max(n,Math.min(e,t))},a=function(t){var n,e,r;if(Array.isArray(t)){var o=le(t,3);n=o[0],e=o[1],r=o[2]}else n=t.r,e=t.g,r=t.b;return(n>1||e>1||r>1)&&(n/=255,e/=255,r/=255),[n,e,r]},s=function(){var t=Math.random(),n=.85+.15*Math.random(),e=.9+.1*Math.random(),r=le(a(X(t,n,e)),3),o=r[0],s=r[1],c=r[2];Math.max(o,s,c)-Math.min(o,s,c)<.25&&(o=i(1.15*o,0,1),s=i(1.15*s,0,1),c=i(1.15*c,0,1));var u=1.2+.5*Math.random(),l=.9+1.1*Math.random(),f=.25;return[u+(f+.75*o)*l,u+(f+.75*s)*l,u+(f+.75*c)*l]},e||(e=s()),t.n=1,ge(n,"animateColorPaletteTransition",this,3)([e,r,o]);case 1:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"animateTravelToPreset",value:(u=he(ce().m(function t(n){var e,r,i,s,c=arguments;return ce().w(function(t){for(;;)switch(t.n){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:1e3,i=c.length>2&&void 0!==c[2]?c[2]:3500,o("Traveling to preset: ".concat(JSON.stringify(n))),s=n.rotation||0,n.zoom.toFixed(24)!==this.zoom.toFixed(24)){t.n=2;break}return t.n=1,this.animatePanTo(n.pan,r);case 1:t.n=5;break;case 2:if(!j(n.pan,this.pan)){t.n=4;break}return t.n=3,this.animateZoomTo(n.zoom,r);case 3:t.n=5;break;case 4:return t.n=5,this.animateZoomTo(this.DEFAULT_ZOOM,r);case 5:return t.n=6,Promise.all([this.animatePanThenZoomTo(n.pan,n.zoom,1e3,i*(null!==(e=n.speed)&&void 0!==e?e:1)),this.animateRotationTo(s,1e3,a.QUINT)]);case 6:this.currentPresetIndex=n.id||0;case 7:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"animateTravelToPresetWithRandomRotation",value:(c=he(ce().m(function t(n,e,r,o){var i,s,c,u,l,f;return ce().w(function(t){for(;;)switch(t.n){case 0:if(c=this.rotation+(Math.random()*d*2-d),u=q(null!==(i=n.rotation)&&void 0!==i?i:this.DEFAULT_ROTATION),l=(Math.random()>.5?1:-1)*(2*d+Math.random()*d*2),f=u+l,this.rotation===this.DEFAULT_ROTATION){t.n=1;break}return t.n=1,this.animateZoomRotationTo(this.DEFAULT_ZOOM,c,e);case 1:return t.n=2,this.animatePanTo(n.pan,r,a.CUBIC);case 2:return t.n=3,this.animateZoomRotationTo(n.zoom,f,o*(null!==(s=n.speed)&&void 0!==s?s:1));case 3:this.currentPresetIndex=n.id||0;case 4:return t.a(2)}},t,this)})),function(t,n,e,r){return c.apply(this,arguments)})},{key:"animateDemo",value:(s=he(ce().m(function t(){var n,e,r,o=this,i=arguments;return ce().w(function(t){for(;;)switch(t.n){case 0:if(n=!(i.length>0&&void 0!==i[0])||i[0],this.stopAllNonColorAnimations(),this.PRESETS.length){t.n=1;break}return t.a(2);case 1:this.demoActive=!0,e=function(t){if(t){var n;do{n=Math.floor(Math.random()*o.PRESETS.length)}while(n===o.currentPresetIndex||0===n);return n}var e=(o.currentPresetIndex+1)%o.PRESETS.length;return 0===e?1:e};case 2:if(!this.demoActive){t.n=5;break}return this.currentPresetIndex=e(n),r=this.PRESETS[this.currentPresetIndex],t.n=3,this.animateTravelToPresetWithRandomRotation(r,2e3,1e3,5e3);case 3:return t.n=4,W(3500);case 4:t.n=2;break;case 5:case 6:return t.a(2)}},t,this)})),function(){return s.apply(this,arguments)})}],r&&ve(e.prototype,r),i&&ve(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,s,c,u,l}(lt);const Ee=xe;function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Se(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,De(r.key),r)}}function De(t){var n=function(t,n){if("object"!=Pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==Pe(n)?n:n+""}function Le(t,n,e){return n=Re(n),function(t,n){if(n&&("object"==Pe(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Oe()?Reflect.construct(n,e||[],Re(t).constructor):n.apply(t,e))}function Oe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Oe=function(){return!!t})()}function ke(t,n,e,r){var o=Fe(Re(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Re(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},Fe.apply(null,arguments)}function Re(t){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Re(t)}function Ce(t,n){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ce(t,n)}var ze=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Le(this,n,[t])).termCount=100,e.useAnalyticExtension=!0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Ce(t,n)}(n,t),e=n,(r=[{key:"updateUniforms",value:function(){this.termCountLoc=this.gl.getUniformLocation(this.program,"u_termCount"),this.useAnalyticExtensionLoc=this.gl.getUniformLocation(this.program,"u_useAnalyticExtension"),ke(n,"updateUniforms",this,3)([])}},{key:"draw",value:function(){this.gl.uniform1i(this.termCountLoc,this.termCount),this.gl.uniform1i(this.useAnalyticExtensionLoc,this.useAnalyticExtension?1:0),ke(n,"draw",this,3)([])}},{key:"createFragmentShaderSource",value:function(){return"precision highp float;\r\n\r\nuniform vec2 u_resolution;\r\nuniform float u_zoom;\r\nuniform vec2 u_pan;\r\nuniform int u_termCount;\r\nuniform bool u_useAnalyticExtension;// Toggle for analytic extension\r\n\r\nconst float PI = 3.14159265359;\r\n\r\n// HSL to RGB conversion function.\r\nvec3 hsl2rgb(vec3 hsl) {\r\n    float h = hsl.x, s = hsl.y, l = hsl.z;\r\n    float c = (1.0 - abs(2.0 * l - 1.0)) * s;\r\n    float hprime = h * 6.0;\r\n    float x = c * (1.0 - abs(mod(hprime, 2.0) - 1.0));\r\n    vec3 rgb;\r\n    if (0.0 <= hprime && hprime < 1.0) {\r\n        rgb = vec3(c, x, 0.0);\r\n    } else if (1.0 <= hprime && hprime < 2.0) {\r\n        rgb = vec3(x, c, 0.0);\r\n    } else if (2.0 <= hprime && hprime < 3.0) {\r\n        rgb = vec3(0.0, c, x);\r\n    } else if (3.0 <= hprime && hprime < 4.0) {\r\n        rgb = vec3(0.0, x, c);\r\n    } else if (4.0 <= hprime && hprime < 5.0) {\r\n        rgb = vec3(x, 0.0, c);\r\n    } else {\r\n        rgb = vec3(c, 0.0, x);\r\n    }\r\n    float m = l - 0.5 * c;\r\n    return rgb + vec3(m);\r\n}\r\n\r\n// Basic complex division.\r\nvec2 c_div(vec2 a, vec2 b) {\r\n    float denom = b.x * b.x + b.y * b.y;\r\n    return vec2((a.x * b.x + a.y * b.y) / denom, (a.y * b.x - a.x * b.y) / denom);\r\n}\r\n\r\n// Original zeta series (for Re(s) > 1)\r\nvec2 zeta(vec2 s) {\r\n    vec2 sum = vec2(0.0);\r\n    for (int n = 1; n <= 100; ++n) {\r\n        if (n > u_termCount) break;\r\n        float nf = float(n);\r\n        float scale = 1.0 / pow(nf, s.x);\r\n        float angle = -s.y * log(nf);\r\n        vec2 term = vec2(scale * cos(angle), scale * sin(angle));\r\n        if (length(term) < 1e-6) break;\r\n        sum += term;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// Dirichlet eta series (alternating series)\r\nvec2 eta(vec2 s) {\r\n    vec2 sum = vec2(0.0);\r\n    for (int n = 1; n <= 100; ++n) {\r\n        if (n > u_termCount) break;\r\n        float nf = float(n);\r\n        float sign = (mod(nf, 2.0) < 1.0) ? -1.0 : 1.0;\r\n        float scale = 1.0 / pow(nf, s.x);\r\n        float angle = -s.y * log(nf);\r\n        vec2 term = sign * vec2(scale * cos(angle), scale * sin(angle));\r\n        if (length(term) < 1e-6) break;\r\n        sum += term;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// Analytic continuation: Î¶(s) = Î·(s) / (1 - 2^(1-s))\r\nvec2 analyticZeta(vec2 s) {\r\n    vec2 etaVal = eta(s);\r\n    float log2 = 0.69314718;// ln(2)\r\n    float expReal = exp((1.0 - s.x) * log2);\r\n    float expImag = -s.y * log2;\r\n    vec2 twoPow = vec2(expReal * cos(expImag), expReal * sin(expImag));\r\n    vec2 denom = vec2(1.0 - twoPow.x, 0.0 - twoPow.y);\r\n    return c_div(etaVal, denom);\r\n}\r\n\r\nvoid main() {\r\n    // Map pixel coordinates to the fractal plane.\r\n    vec2 uv = (gl_FragCoord.xy - 0.5 * u_resolution) / u_resolution.y;\r\n    vec2 coord = uv * u_zoom + u_pan;\r\n\r\n    // Choose zeta computation based on analytic extension toggle.\r\n    vec2 z;\r\n    if (u_useAnalyticExtension)\r\n    z = analyticZeta(coord);\r\n\r\n    else\r\n    z = zeta(coord);\r\n\r\n    float mag = length(z);\r\n    float phase = atan(z.y, z.x);\r\n\r\n    // Fractal-inspired HSL coloring:\r\n    // Map phase (angle) to hue (normalized to [0, 1]).\r\n    float hue = mod((phase / (2.0 * PI)) + 1.0, 1.0);\r\n    // Lightness based on the logarithm of the magnitude.\r\n    float lightness = smoothstep(0.0, 1.0, log(mag + 1.0));\r\n    // Full saturation for vivid colors.\r\n    float saturation = 1.0;\r\n\r\n    vec3 color = hsl2rgb(vec3(hue, saturation, lightness));\r\n    gl_FragColor = vec4(color, 1.0);\r\n}"}},{key:"onProgramCreated",value:function(){}}])&&Se(e.prototype,r),o&&Se(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o}(lt);const Me=ze;var Ie,Ne,je,Ue,Xe,Ze,Be=0;function Ge(t){t instanceof Qo&&(Ze=t,Ne=document.getElementById("realSlider"),Ue=document.getElementById("realSliderValue"),je=document.getElementById("imagSlider"),Xe=document.getElementById("imagSliderValue"),Ne.addEventListener("input",Ve),je.addEventListener("input",qe),(Ie=document.getElementById("sliders")).style.display="flex")}function He(){Ze.draw(),Yr(),E(),mo(),Ze.demoTime=0}var Ve=function(){Ze.c[0]=parseFloat(Ne.value),Ue.textContent=Ze.c[0].toFixed(4),He()},qe=function(){Ze.c[1]=parseFloat(je.value),Xe.textContent="".concat(Ze.c[1].toFixed(4),"i"),He()};function Je(){Gr()&&(Ne.value=parseFloat(Ze.c[0].toFixed(2)),je.value=parseFloat(Ze.c[1].toFixed(2)),Ue.innerText=Ne.value,Xe.innerText=je.value+"i",Ze.demoTime=0)}function We(){var t=performance.now();t-Be<10||(Be=t,Ue.innerText=Ze.c[0].toFixed(4),Xe.innerText=Ze.c[1].toFixed(4)+"i",Ne.value=parseFloat(Ze.c[0].toFixed(4)),je.value=parseFloat(Ze.c[1].toFixed(4)))}function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function Ye(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$e(r.key),r)}}function Qe(t,n,e){return(n=$e(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function $e(t){var n=function(t,n){if("object"!=Ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=Ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==Ke(n)?n:n+""}var tr,nr,er=function(){return t=function t(n,e){var i,a,s,c=this;if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),Qe(this,"panelSelector","debugInfo"),Qe(this,"update",function(t){var n,e,r,o,i,a,s,u;if(c.debugInfo&&c.fractalApp){var l=performance.now();c.pollGpuTimers();var f=t-c.perf.lastRafTs;c.perf.lastRafTs=t,c.perf.frameMs=f,c.perf.frameMsSmoothed=c.smooth(c.perf.frameMsSmoothed,f,.1),c.perf.fps=f>0?1e3/f:0;var h=window.devicePixelRatio||1,m=c.canvas.getBoundingClientRect(),d=c.gl;if(d&&"function"==typeof d.getShaderPrecisionFormat){var p=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT),v={precision:p.precision,rangeMin:p.rangeMin,rangeMax:p.rangeMax},y=I(c.fractalApp.panDD.x),b=I(c.fractalApp.panDD.y),g=Gr()?c.fractalApp.c[0]:0,_=Gr()?c.fractalApp.c[1]:0,T=c.fractalApp.pan[0],w=c.fractalApp.pan[1],A=c.fractalApp.zoom,x=Math.max(A,1e-300),E=c.canvas.width/x,P=x/c.canvas.width,S=Math.hypot(y,b),D=S/x,L=Math.log2(Math.max(D,1e-300)),O=Math.hypot(y-T,b-w),k=O/x,F=c.fractalApp.orbitDirty?"DIRTY":"cached",R=Math.floor(-Math.log10(x)),C=function(t){return String(t).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")},z=function(t){return"bad"===t?"dbg-bad":"warn"===t?"dbg-warn":"dbg-ok"},M=100,N="ok";L>44?(N="bad",M-=40):L>34?(N="warn",M-=20):L>28&&(N="warn",M-=10);var j="ok";k>1?(j="bad",M-=25):k>.5?(j="warn",M-=12):k>.25&&(j="warn",M-=6);var U="ok";E<.75&&(U="warn",M-=10),E<.25&&(U="bad",M-=20);var X="ok";(M=Math.max(0,Math.min(100,Math.round(M))))<70&&(X="warn"),M<45&&(X="bad");var Z="bad"===X||"warn"===X?" (pan:".concat(N,", drift:").concat(j,", scale:").concat(U,")"):"",B=c.perf.gpuMsSmoothed,G=Number.isFinite(B)?B>22?"bad":B>14?"warn":"ok":"ok",H=c.perf.fps<30?"bad":c.perf.fps<50?"warn":"ok",V=performance.now()-l;c.perf.panelCpuMs=V,c.perf.panelCpuMsSmoothed=c.smooth(c.perf.panelCpuMsSmoothed,V,.2);var q=c.perf.gpuSupported?Number.isFinite(B)?B>1e3/60?"Likely GPU-bound":"GPU OK":"GPU timer available (wrap draw with begin/end)":"No GPU timer support",J=c.gpu.unmaskedVendor||c.gpu.vendor||"unknown",W=c.gpu.unmaskedRenderer||c.gpu.renderer||"unknown";c.debugInfo.innerHTML='\n            <span class="dbg-title" id="copyDebugInfo">DEBUG PANEL</span><span class="dbg-dim"> (\'L\' to toggle, draggable, middle-click to log)</span>|<br/>\n            <span class="dbg-dim">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br/>\n            <span class="dbg-title">FRAG highp</span>: precision='.concat(C(v.precision)," range=[").concat(C(v.rangeMin),", ").concat(C(v.rangeMax),']<br/>\n            <span class="dbg-title">mode:</span> <span class="dbg-dim">').concat(jr(),'</span> <span class="dbg-title">css</span>=').concat(C(m.width.toFixed(1)),"x").concat(C(m.height.toFixed(1)),' <span class="dbg-dim">dpr=').concat(C(h),'<span class="dbg-title"> \n            buf</span>=').concat(C(c.canvas.width),"x").concat(C(c.canvas.height),'<br/>\n            <br/>\n            <span class="dbg-title">viewPan</span>=[').concat(C(y.toFixed(24)),", ").concat(C(b.toFixed(24)),']<br/>\n            <span class="dbg-title">refPan</span>     =[').concat(C(T.toFixed(24)),", ").concat(C(w.toFixed(24)),']<br/>\n            <span class="dbg-title">c</span>=[').concat(C(g.toFixed(24)),", ").concat(C(_.toFixed(24)),']<br/>\n            <span class="dbg-title">zoom</span>=').concat(C(A.toFixed(20)),'<br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Scale â€”â€”â€”â€”</span><br/>\n            zoomExp=[').concat(C(A.toExponential(1)),']  <span class="dbg-dim">zoomBucket=1e-').concat(C(R),'</span><br/>\n            px/unit=<span class="').concat(z(U),'">').concat(C(E.toExponential(3)),'</span><br/>\n            unit/px=<span class="').concat(z(U),'">').concat(C(P.toExponential(3)),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Precision Stress (heuristics) â€”â€”â€”â€”</span><br/>\n            <span class="dbg-title">iters</span>=').concat(C(c.fractalApp.iterations.toFixed(0))," (MAX_ITER=").concat(C(c.fractalApp.MAX_ITER),')<br/>\n            Precision health:<span class="dbg-badge ').concat(z(X),'">').concat(M,'/100</span><span class="dbg-dim">').concat(C(Z),"</span><br/>\n            |pan|=").concat(C(S.toExponential(3)),'<br/>\n            |pan|/zoom=<span class="').concat(z(N),'">').concat(C(D.toExponential(3)),'</span><br/>\n            log2(|pan|/zoom)â‰ˆ<span class="').concat(z(N),'">').concat(C(L.toFixed(1)),'</span> <span class="dbg-dim">(larger â‡’ cancellation risk â†‘)</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Perturbation â€”â€”â€”â€”</span><br/>\n            ref drift (abs)=').concat(C(O.toExponential(3)),'<br/>\n            ref drift/zoom=<span class="').concat(z(j),'">').concat(C(k.toFixed(3)),'</span> <span class="dbg-dim">view-units</span><br/>\n            refPick=').concat(C(c.fractalApp?c.fractalApp.bestScore+"/"+c.fractalApp.probeIters:"cached"),'<br/>\n            orbit=<span class="').concat(c.fractalApp.orbitDirty?"dbg-warn":"dbg-ok",'">').concat(C(F),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Performance â€”â€”â€”â€”</span><br/>\n            FPS=<span class="').concat(z(H),'">').concat(C(c.perf.fps.toFixed(1)),'</span> <span class="dbg-dim">(frame ').concat(C(null!==(n=null===(e=c.perf.frameMsSmoothed)||void 0===e||null===(r=e.toFixed)||void 0===r?void 0:r.call(e,2))&&void 0!==n?n:"n/a"),' ms)</span><br/>\n            debugUI=<span class="dbg-dim">').concat(C(null!==(o=null===(i=c.perf.panelCpuMsSmoothed)||void 0===i||null===(a=i.toFixed)||void 0===a?void 0:a.call(i,2))&&void 0!==o?o:"n/a")," ms</span><br/>\n            gpuTimer=").concat(C(c.perf.gpuSupported?"yes":"no"),'<br/>\n            gpuMs=<span class="').concat(z(G),'">').concat(C(Number.isFinite(B)?B.toFixed(2):"n/a"),'</span> <span class="dbg-dim">').concat(C(c.perf.gpuDisjoint?"(disjoint)":""),'</span><br/>\n            hint=<span class="dbg-dim">').concat(C(q),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Renderer â€”â€”â€”â€”</span><br/>\n            Vendor: ').concat(C(J),"<br/>\n            GPU: ").concat(C(W),'<br/>\n            <span class="dbg-dim">').concat(C(c.gpu.webglVersion)," on ").concat((null===(s=navigator)||void 0===s||null===(s=s.userAgentData)||void 0===s?void 0:s.platform)||(null===(u=navigator)||void 0===u?void 0:u.platform),"</span><br/>\n            "),requestAnimationFrame(c.update)}}}),Qe(this,"toggle",function(){c.debugInfo&&(c.debugInfo.style.display="block"===c.debugInfo.style.display?"none":"block")}),this.canvas=n,this.fractalApp=e,this.gl=null==e?void 0:e.gl,this.debugInfo=document.getElementById(this.panelSelector),this.debugInfo){if(P()){var u=0;this.debugInfo.addEventListener("pointerdown",function(t){var n=Date.now();n-u<300&&c.toggle(),u=n,t.preventDefault()})}this.debugInfo.addEventListener("auxclick",function(t){if(1===t.button){o(c.debugInfo.innerText,c.constructor.name,r);var n=c.debugInfo.innerText.substring(c.debugInfo.innerText.indexOf("FRAG"));navigator.clipboard.writeText(n).then(function(){},function(t){})}}),this.extTimer=(null===(i=this.gl)||void 0===i?void 0:i.getExtension("EXT_disjoint_timer_query"))||(null===(a=this.gl)||void 0===a?void 0:a.getExtension("EXT_disjoint_timer_query_webgl2"))||null,this.extRendererInfo=(null===(s=this.gl)||void 0===s?void 0:s.getExtension("WEBGL_debug_renderer_info"))||null,this.gpu={vendor:"unknown",renderer:"unknown",unmaskedVendor:null,unmaskedRenderer:null,webglVersion:"unknown",shadingLanguageVersion:"unknown",maxTextureSize:null,maxVaryings:null,maxFragUniforms:null,maxVertUniforms:null,maxViewportDims:null},this._initGpuInfo(),this.perf={lastRafTs:performance.now(),fps:0,frameMs:0,frameMsSmoothed:NaN,panelCpuMs:0,panelCpuMsSmoothed:NaN,gpuSupported:!!this.extTimer,gpuMs:NaN,gpuMsSmoothed:NaN,gpuDisjoint:!1,queryInFlight:null,pendingQueries:[]},this.toggle(),requestAnimationFrame(this.update)}},(n=[{key:"setRenderer",value:function(t){this.fractalApp=t||null,this.gl=(null==t?void 0:t.gl)||null,this.precisionInfo=null;var n=this.gl;if(n&&"function"==typeof n.getShaderPrecisionFormat){var e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);this.precisionInfo=e?{precision:e.precision,rangeMin:e.rangeMin,rangeMax:e.rangeMax}:null}}},{key:"_initGpuInfo",value:function(){var t=this.gl;if(t)try{if(this.gpu.webglVersion=t.getParameter(t.VERSION)||"unknown",this.gpu.shadingLanguageVersion=t.getParameter(t.SHADING_LANGUAGE_VERSION)||"unknown",this.gpu.vendor=t.getParameter(t.VENDOR)||"unknown",this.gpu.renderer=t.getParameter(t.RENDERER)||"unknown",this.gpu.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.gpu.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.gpu.maxFragUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.gpu.maxVertUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.gpu.maxViewportDims=t.getParameter(t.MAX_VIEWPORT_DIMS),this.extRendererInfo){var n=t.getParameter(this.extRendererInfo.UNMASKED_VENDOR_WEBGL),e=t.getParameter(this.extRendererInfo.UNMASKED_RENDERER_WEBGL);this.gpu.unmaskedVendor=n||null,this.gpu.unmaskedRenderer=e||null}}catch(t){}}},{key:"beginGpuTimer",value:function(){if(this.extTimer&&this.gl&&!this.perf.queryInFlight){var t=this.extTimer.createQueryEXT();this.extTimer.beginQueryEXT(this.extTimer.TIME_ELAPSED_EXT,t),this.perf.queryInFlight=t}}},{key:"endGpuTimer",value:function(){this.extTimer&&this.gl&&this.perf.queryInFlight&&(this.extTimer.endQueryEXT(this.extTimer.TIME_ELAPSED_EXT),this.perf.pendingQueries.push(this.perf.queryInFlight),this.perf.queryInFlight=null)}},{key:"pollGpuTimers",value:function(){if(this.extTimer&&this.gl){var t=this.gl.getParameter(this.extTimer.GPU_DISJOINT_EXT);if(this.perf.gpuDisjoint=!!t,0!==this.perf.pendingQueries.length){var n=this.perf.pendingQueries[0];if(this.extTimer.getQueryObjectEXT(n,this.extTimer.QUERY_RESULT_AVAILABLE_EXT)){var e=this.extTimer.getQueryObjectEXT(n,this.extTimer.QUERY_RESULT_EXT);if(this.extTimer.deleteQueryEXT(n),this.perf.pendingQueries.shift(),this.perf.gpuDisjoint)this.perf.gpuMs=NaN;else{var r=e/1e6;this.perf.gpuMs=r,this.perf.gpuMsSmoothed=this.smooth(this.perf.gpuMsSmoothed,r,.15)}}}}}},{key:"smooth",value:function(t,n,e){return Number.isFinite(n)?Number.isFinite(t)?t+(n-t)*e:n:t}}])&&Ye(t.prototype,n),e&&Ye(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e}();function rr(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return or(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(or(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,or(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,or(f,"constructor",u),or(u,"constructor",c),c.displayName="GeneratorFunction",or(u,o,"GeneratorFunction"),or(f),or(f,o,"Generator"),or(f,r,function(){return this}),or(f,"toString",function(){return"[object Generator]"}),(rr=function(){return{w:i,m:h}})()}function or(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}or=function(t,n,e,r){function i(n,e){or(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},or(t,n,e,r)}function ir(t){return function(t){if(Array.isArray(t))return ar(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return ar(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ar(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function sr(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function cr(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){sr(i,r,o,a,s,"next",t)}function s(t){sr(i,r,o,a,s,"throw",t)}a(void 0)})}}var ur,lr,fr,hr,mr,dr,pr,vr,yr,br,gr,_r,Tr,wr=i.MANDELBROT,Ar=u,xr=l,Er=l,Pr=null,Sr=!1,Dr=!0,Lr=!1,Or=-1,kr=0,Fr=[],Rr=[],Cr=[],zr=0,Mr=100,Ir=null,Nr=!1,jr=function(){return t=wr,Object.keys(i).find(function(n){return i[n]===t})||"UNKNOWN";var t};function Ur(t){return Xr.apply(this,arguments)}function Xr(){return Xr=cr(rr().m(function t(n){var e,r,o,a,s,c,u=arguments;return rr().w(function(t){for(;;)switch(t.n){case 0:if(s=u.length>1&&void 0!==u[1]?u[1]:null,n!==wr){t.n=1;break}return t.a(2);case 1:$r(),nr.destroy(),c=n,t.n=c===i.MANDELBROT?2:c===i.JULIA?3:c===i.RIEMANN?4:5;break;case 2:return Hr(),t.a(3,6);case 3:return Vr(),t.a(3,6);case 4:return qr(),t.a(3,6);case 5:return t.a(2);case 6:if(null===(e=Tr)||void 0===e||null===(r=e.setRenderer)||void 0===r||r.call(e,null),null===(o=Tr)||void 0===o||null===(a=o.setRenderer)||void 0===a||a.call(o,nr),P()?(Bn(),Xn(nr)):(ie(),oe(nr),bn(),vn(nr)),nr.reset(),!s){t.n=10;break}if(mo(),to(),!Gr()){t.n=8;break}return t.n=7,nr.animateTravelToPreset({pan:[0,0],c:s.c,zoom:s.zoom,rotation:0},1e3);case 7:t.n=9;break;case 8:return t.n=9,nr.animateTravelToPreset({pan:s.pan,zoom:s.zoom,rotation:0},500,1e3);case 9:$r(),A(wr,nr.pan[0],nr.pan[1],nr.zoom,nr.rotation,nr.c?nr.c[0]:null,nr.c?nr.c[1]:null);case 10:case 11:return t.a(2)}},t)})),Xr.apply(this,arguments)}function Zr(t){return Br.apply(this,arguments)}function Br(){return(Br=cr(rr().m(function t(n){var e;return rr().w(function(t){for(;;)switch(t.n){case 0:if(n!==wr){t.n=1;break}return t.a(2);case 1:if(n!==i.MANDELBROT){t.n=3;break}return e=Math.max(nr.MAX_ZOOM,.1*nr.zoom),t.n=2,Ur(i.MANDELBROT,{pan:nr.c.slice(),zoom:e,rotation:0});case 2:t.n=4;break;case 3:return t.n=4,Ur(i.JULIA,{pan:[0,0],c:nr.pan.slice(),zoom:1.5,rotation:0});case 4:case 5:return t.a(2)}},t)}))).apply(this,arguments)}var Gr=function(){return wr===i.JULIA};function Hr(){mr.classList.remove("active"),hr.classList.add("active"),Y(Rr),document.getElementById("dives").style.display="none",Ne&&je&&Ie&&(Ne.removeEventListener("input",Ve),je.removeEventListener("input",qe),Ie.style.display="none"),nr=new Ee(tr),wr=i.MANDELBROT,Y(Fr),0!==kr&&po(),xo(),Wr(h),Jr(),window.location.hash=""}function Vr(){nr=new Qo(tr),wr=i.JULIA,mr.classList.add("active"),hr.classList.remove("active"),Y(Fr),xo(),Ge(nr),We(),Y(Rr),Po(),0!==kr&&po(),Wr(m),lr.style.background="rgba(20, 20, 20, 0.8)",gr.style.background="rgba(20, 20, 20, 0.8)",Jr(),window.location.hash="#julia"}function qr(){(nr=new Me(tr)).useAnalyticExtension=!1,wr=i.RIEMANN,Y(Fr),window.location.hash="#zeta"}function Jr(){if(Gr()){var t=nr.getNextColorThemeId();t&&(vr.title='Next theme: "'+t+'" (T)')}else vr.title="Randomize Color Palette (T)"}function Wr(t){t||(t=ir(nr.colorPalette));var n=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.9;return Math.min(255,Math.floor(255*t*n))};Ar="rgba(".concat(n(t[0]),", ").concat(n(t[1]),", ").concat(n(t[2]),", 1)"),xr="rgba(".concat(n(t[0],.5),", ").concat(n(t[1],.5),", ").concat(n(t[2],.5),", 0.2)"),Er="rgba(".concat(Math.floor(200*t[0]),", ").concat(Math.floor(200*t[1]),", ").concat(Math.floor(200*t[2]),", 0.1)");var e=document.querySelector(":root");e.style.setProperty("--bg-color",Er),e.style.setProperty("--mid-color",xr),e.style.setProperty("--accent-color",Ar)}function Kr(){mo(),po(),E()}function Yr(){var t,n,e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=performance.now(),a=o-zr;if(!r&&a<Mr){if(Nr=Nr||r,!Ir){var s=Math.max(Mr-a,0);Ir=setTimeout(function(){Ir=null;var t=Nr;Nr=!1,Yr(t||!0)},s)}}else if(zr=o,tr&&nr){var c=Lr?" [AUTO] ":"",u=null!==(t=I(nr.panDD.x))&&void 0!==t?t:0,l=null!==(n=I(nr.panDD.y))&&void 0!==n?n:0;if(c+="p: [".concat(u.toFixed(8),", ").concat(l.toFixed(8),"i] Â· "),wr===i.JULIA){var f,h,m=null!==(f=nr.c[0])&&void 0!==f?f:0,p=null!==(h=nr.c[1])&&void 0!==h?h:0;c+="c: [".concat(m.toFixed(4),", ").concat(p.toFixed(4),"i] Â· ")}var v=null!==(e=nr.zoom)&&void 0!==e?e:0,y=180*nr.rotation/d%360;c+="r: ".concat((y<0?y+360:y).toFixed(0),"Â° Â· zoom:&nbsp;").concat(v.toExponential(0)),Lr?_r.classList.contains("animationActive")||_r.classList.add("animationActive"):_r.classList.contains("animationActive")&&_r.classList.remove("animationActive"),_r.innerHTML!==c&&(_r.innerHTML=c)}}var Qr=function(){return Lr};function $r(){Lr&&(Lr=!1,_r.classList.remove("animation"),nr.stopAllNonColorAnimations(),br.innerText="Demo",br.classList.remove("active"),P()?Zn():yn(),Gr()&&(je.disabled=Ne.disabled=!1,Ne.classList.remove("thumbDisabled"),je.classList.remove("thumbDisabled")),setTimeout(function(){Yr()},150))}function to(){Lr||(Lr=!0,_r.classList.add("animation"),br.innerText="Stop",br.classList.add("active"),P()?Bn():bn(),Gr()&&(je.disabled=Ne.disabled=!0,Ne.classList.add("thumbDisabled"),je.classList.add("thumbDisabled")),E())}function no(){return eo.apply(this,arguments)}function eo(){return(eo=cr(rr().m(function t(){var n;return rr().w(function(t){for(;;)switch(t.n){case 0:if(!Lr){t.n=1;break}return mo(),Or=-1,nr.stopDemo(),$r(),t.a(2);case 1:mo(),to(),n=wr,t.n=n===i.MANDELBROT?2:n===i.JULIA?4:6;break;case 2:return t.n=3,ro();case 3:case 5:return t.a(3,7);case 4:return t.n=5,so();case 6:return $r(),t.a(3,7);case 7:case 8:return t.a(2)}},t)}))).apply(this,arguments)}function ro(){return oo.apply(this,arguments)}function oo(){return(oo=cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,nr.animateDemo();case 1:case 2:return t.a(2)}},t)}))).apply(this,arguments)}function io(t,n){return ao.apply(this,arguments)}function ao(){return(ao=cr(rr().m(function t(n,e){var r;return rr().w(function(t){for(;;)switch(t.n){case 0:if(!Lr||e!==Or){t.n=1;break}return t.a(2);case 1:if(Lr&&$r(),mo(),Or=e,Rr[e].classList.add("active"),!((r=n[e]).cxDirection<0&&r.endC[0]>=r.startC[0])){t.n=2;break}return t.a(2);case 2:if(!(r.cxDirection>0&&r.endC[0]<=r.startC[0])){t.n=3;break}return t.a(2);case 3:if(!(r.cyDirection<0&&r.endC[1]>=r.startC[1])){t.n=4;break}return t.a(2);case 4:if(!(r.cyDirection>0&&r.endC[1]<=r.startC[1])){t.n=5;break}return t.a(2);case 5:return to(),J(500,nr,{c:r.startC,pan:r.pan,zoom:r.zoom},{pan:.5,zoom:2,c:1}),t.n=6,nr.animateToZoomAndC(nr.DEFAULT_ZOOM,r.startC,1500);case 6:return t.n=7,Promise.all([nr.animateDive(r),nr.animatePanZoomRotationTo(r.pan,r.zoom,r.rotation,1500)]);case 7:return t.a(2)}},t)}))).apply(this,arguments)}function so(){return co.apply(this,arguments)}function co(){return(co=cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:if(Lr&&$r(),to(),mo(),0!==nr.demoTime){t.n=1;break}return t.n=1,nr.animateTravelToPreset({pan:nr.DEFAULT_PAN,c:[-.25,.7],zoom:nr.DEFAULT_ZOOM,rotation:nr.DEFAULT_ROTATION},1e3);case 1:return t.n=2,nr.animateDemo();case 2:$r();case 3:return t.a(2)}},t)}))).apply(this,arguments)}function uo(t,n){return lo.apply(this,arguments)}function lo(){return(lo=cr(rr().m(function t(n,e){return rr().w(function(t){for(;;)switch(t.n){case 0:if(Lr&&$r(),e!==kr){t.n=1;break}return t.a(2);case 1:if(mo(),to(),Fr[e].classList.add("active"),!Gr()){t.n=3;break}return nr.demoTime=0,t.n=2,nr.animateTravelToPreset(n[e],1500);case 2:t.n=6;break;case 3:return t.n=4,nr.animateTravelToPresetWithRandomRotation(n[e],2e3,500,1500);case 4:t.n=6;break;case 5:return t.n=6,nr.animateTravelToPreset(n[e]);case 6:kr=e,$r(),A(wr,nr.pan[0],nr.pan[1],nr.zoom,nr.rotation,nr.c?nr.c[0]:null,nr.c?nr.c[1]:null);case 7:return t.a(2)}},t)}))).apply(this,arguments)}function fo(){Tr?Tr.toggle():(Tr=new er(tr,nr,Ar),ho())}function ho(){var t=document.getElementById("verticalLine"),n=document.getElementById("horizontalLine");"block"===t.style.display&&"block"===n.style.display?(t.style.display="none",n.style.display="none"):(t.style.display="block",n.style.display="block")}function mo(){Fr.concat(Rr).forEach(function(t){return t.classList.remove("active")})}function po(){kr=-1}function vo(){return yo.apply(this,arguments)}function yo(){return(yo=cr(rr().m(function t(){var n,e,r,o;return rr().w(function(t){for(;;)switch(t.n){case 0:if(!Gr()){t.n=2;break}return t.n=1,nr.animateColorPaletteTransition(250,Wr);case 1:Jr(),t.n=3;break;case 2:return n=Math.random(),e=.5*Math.random()+.5,r=.5*Math.random()+.5,o=X(n,e,r),t.n=3,nr.animateColorPaletteTransition(o,250,function(){Wr(o)});case 3:return t.a(2)}},t)}))).apply(this,arguments)}function bo(){Gn(tr,nr,Ar)}function go(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=document.getElementById("headerContainer");null===t&&(t=!Dr),t?n.classList.remove("minimized"):n.classList.add("minimized"),Dr=t}function _o(){return To.apply(this,arguments)}function To(){return(To=cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:Wr(Gr()?m:h),$r(),nr.reset(),Gr()&&Je(),Kr(),Jr(),Fr[0].classList.add("active");case 1:return t.a(2)}},t)}))).apply(this,arguments)}function wo(){fr.addEventListener("pointerenter",function(){Pr&&(clearTimeout(Pr),Pr=null),go(!0)}),e>t&&fr.addEventListener("click",function(){go()}),lr.addEventListener("pointerleave",cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:Dr&&!e&&(Pr=setTimeout(function(){go(!1),Pr=null},3e3));case 1:return t.a(2)}},t)}))),tr.addEventListener("pointerdown",function(){e||go(!1)}),o("Initialized.","initHeaderEvents")}function Ao(){pr.addEventListener("click",cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,_o();case 1:return t.a(2)}},t)}))),vr.addEventListener("click",vo),br.addEventListener("click",no),yr.addEventListener("click",bo),o("Initialized.","initControlButtonEvents")}function xo(){var t=document.getElementById("presets");Fr=[];var n=ir(nr.PRESETS);n.forEach(function(e,r){var o=document.createElement("button");o.id="preset"+r,o.className="preset",o.title=(e.title||"Preset "+r)+(r<10?" (Num ".concat(r,")"):" (".concat(r,")")),o.textContent=(e.title||r).toString(),o.addEventListener("click",cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,uo(n,r);case 1:return t.a(2)}},t)}))),t.appendChild(o),Fr.push(o),Fr[0].classList.add("active")}),o("Initialized.","initPresetButtonEvents")}function Eo(){(Cr=Rr.concat(Fr)).push(pr,vr,yr,br),Cr.forEach(function(t){t.addEventListener("mouseleave",function(){t.blur()}),t.addEventListener("mouseup",function(){t.blur()})}),o("Initialized.","initCommonButtonEvents")}function Po(){if(Gr()){var t=document.getElementById("dives");Rr=[];var n=ir(nr.DIVES);n.forEach(function(e,r){var o=document.createElement("button");o.id="dive"+r,o.className="dive",o.title=(e.title||"Preset "+r)+" (Shift+".concat(r,")"),o.textContent=e.title||r.toString(),o.addEventListener("click",cr(rr().m(function t(){return rr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,io(n,r);case 1:return t.a(2)}},t)}))),t.appendChild(o),Rr.push(o)}),t.style.display="inline-flex"}o("Initialized.","initDiveButtons")}function So(){hr.addEventListener("click",function(){var t=cr(rr().m(function t(n){return rr().w(function(t){for(;;)switch(t.n){case 0:if(!n.ctrlKey){t.n=2;break}return t.n=1,Zr(i.MANDELBROT);case 1:t.n=3;break;case 2:return t.n=3,Ur(i.MANDELBROT);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),mr.addEventListener("click",function(){var t=cr(rr().m(function t(n){return rr().w(function(t){for(;;)switch(t.n){case 0:if(!n.ctrlKey){t.n=2;break}return t.n=1,Zr(i.JULIA);case 1:t.n=3;break;case 2:return t.n=3,Ur(i.JULIA);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),dr.addEventListener("click",function(){var t=cr(rr().m(function t(n){return rr().w(function(t){for(;;)switch(t.n){case 0:if(!Gr()){t.n=2;break}return t.n=1,Zr(i.MANDELBROT);case 1:t.n=3;break;case 2:return t.n=3,Zr(i.JULIA);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),dr.style.display="inline-flex",o("Initialized.","initFractalSwitchButtons")}function Do(){window.addEventListener("resize",function(){clearTimeout(ur),ur=setTimeout(function(){nr.resizeCanvas()},200)});var t=document.querySelectorAll(".draggable");t.forEach(function(t){t.addEventListener("mousedown",function(){var n=function(n){return function(t,n){var e=parseInt(window.getComputedStyle(n).left),r=parseInt(window.getComputedStyle(n).top);n.style.left="".concat(e+t.movementX,"px"),n.style.top="".concat(r+t.movementY,"px")}(n,t)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",n)},{once:!0})})}),o("Initialized.","initWindowEvents")}function Lo(){_r.addEventListener("mouseenter",function(){_r.innerHTML="Click to copy fractal state to clipboard."}),_r.addEventListener("mouseleave",function(){Yr()}),_r.addEventListener("click",function(){var t='"pan": ['.concat(nr.pan,'], "rotation": ').concat(q(nr.rotation),', "zoom": ').concat(nr.zoom)+(Gr()?', "c": ['.concat(nr.c,"]}"):"}");navigator.clipboard.writeText(t).then(function(){_r.innerHTML="Copied to clipboard!"},function(t){})})}function Oo(){hr=document.getElementById("mandelbrotSwitch"),mr=document.getElementById("juliaSwitch"),dr=document.getElementById("persistSwitch"),lr=document.getElementById("headerContainer"),fr=document.getElementById("logo"),gr=document.getElementById("infoLabel"),_r=document.getElementById("infoText"),pr=document.getElementById("reset"),vr=document.getElementById("randomize"),yr=document.getElementById("screenshot"),br=document.getElementById("demo")}function ko(t){return Fo.apply(this,arguments)}function Fo(){return Fo=cr(rr().m(function t(r){return rr().w(function(t){for(;;)switch(t.n){case 0:if(!Sr){t.n=1;break}return t.a(2);case 1:tr=(nr=r).canvas,Oo(),r instanceof Qo&&(wr=i.JULIA,mr.classList.add("active"),hr.classList.remove("active"),Ge(nr),We(),Po(),Wr(m),lr.style.background="rgba(20, 20, 20, 0.8)",gr.style.background="rgba(20, 20, 20, 0.8)",window.location.hash="#julia"),xo(),Do(),wo(),Ao(),Lo(),So(),Eo(),P()?Xn(nr):(oe(nr),vn(nr)),Jr(),e!==n||S()||fo(),Sr=!0;case 2:return t.a(2)}},t)})),Fo.apply(this,arguments)}const Ro=JSON.parse('{"v4":[{"c":[-0.8,0.156],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Default"},{"c":[-0.7269,0.1889],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Seahorses"},{"c":[0.34,-0.05],"zoom":3.5,"rotation":90,"pan":[0,0],"title":"Spiral Galaxies"},{"c":[0.285,0.01],"zoom":3.5,"rotation":90,"pan":[-0.01,0.01],"title":"Near Julia Border"},{"c":[-1.76733,0.00002],"zoom":0.5,"rotation":0,"pan":[0,0],"title":"Mandelbrothers"},{"c":[-0.4,0.6],"zoom":3.5,"rotation":120,"pan":[0,0],"title":"Black Holes"},{"c":[-0.70176,-0.3842],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Dancing Snowflakes"},{"c":[-0.835,-0.232],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Kissing Dragons"},{"c":[-0.75,0.1],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Main Cardioid"},{"c":[-0.744539860355905,0.121723773894425],"zoom":1.8,"rotation":30,"pan":[0,0],"title":"Seahorse Valley"},{"c":[-1.74876455,0],"zoom":0.45,"rotation":90,"pan":[0,0],"title":"Cauliflower Medallion"},{"c":[-0.1060055299522249,0.9257297130853293],"rotation":340,"pan":[0,0],"zoom":0.11,"title":"Mitochondria"},{"c":[-0.7500162952792153,0.0032826017747574765],"zoom":1.7,"rotation":0,"pan":[0,0],"title":"Clown"},{"c":[-0.12129038469447653,0.649576297434808],"pan":[0.1045565992379065,0.0073015054986378],"rotation":313.6,"zoom":1.6581189769919353,"title":"Mandebulbs"},{"c":[-0.1,0.651],"zoom":3.5,"rotation":90,"pan":[0,0],"title":"Elephants"},{"c":[-1.25066,0.02012],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Deep zoom"},{"c":[-1.768967328653661,0.0019446820495425676],"pan":[0,0],"rotation":0,"zoom":0.2589096374896196,"title":"Serpent"},{"c":[0.3072075408559901,0.48395526205533185],"pan":[0,0],"rotation":310.15,"zoom":2.1068875547385417,"title":"Misiurewicz Point"},{"c":[-0.5925376099331446,0.6218581017272109],"pan":[0,0],"rotation":135.8,"zoom":0.12255613179332117,"title":"Brain"},{"c":[-1.768927341692215,-0.009640117346988308],"pan":[0,0],"rotation":0,"zoom":0.29302566239489597,"title":"Flowers"},{"c":[0.3633977303405407,0.3166912692104581],"pan":[0.12908510596292824,-0.13588306846615342],"rotation":97.4,"zoom":0.12982442828873209,"title":"Black Holes"},{"c":[0.3586059096423313,0.32287599414730545],"pan":[0.10410036735673252,-0.10610085351477151],"rotation":278.6,"zoom":1.8513247913869684,"title":"Darkness"},{"c":[0.1294753560021048,0.6256313013048348],"pan":[0,0],"rotation":110.58,"zoom":1.322314018297482,"title":"Chromozome"}],"gf":[{"pan":[0,0],"rotation":0,"zoom":1.7,"startC":[-0.246,0.64],"step":0.000005,"cxDirection":1,"cyDirection":1,"endC":[-0.2298,0.67],"title":"Orbiting Black holes"},{"pan":[0,0],"startC":[-0.25190652273600045,0.637461568487061],"endC":[-0.2526,0.6355],"cxDirection":-1,"cyDirection":-1,"rotation":0,"zoom":0.05,"step":5e-8,"title":"Dimensional Collision"},{"pan":[-0.31106,0.3937],"rotation":85.9,"zoom":0.3829,"startC":[-0.2523,0.6386],"step":0.00001,"cxDirection":-1,"cyDirection":-1,"endC":[-0.335,0.62],"title":"Life of a Star"},{"pan":[-0.6838,0.4699],"rotation":0,"zoom":0.0447,"startC":[-0.246,0.6427],"step":5e-7,"cxDirection":-1,"cyDirection":-1,"endC":[-0.247,0.638],"title":"Tipping points"},{"pan":[0.516,-0.0541],"rotation":150,"zoom":0.1107,"startC":[-0.78,0.11],"step":0.00001,"cxDirection":1,"cyDirection":1,"endC":[-0.7425,0.25],"title":"Hypnosis"}]}');function Co(t){return Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(t)}function zo(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Mo(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(Mo(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Mo(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Mo(f,"constructor",u),Mo(u,"constructor",c),c.displayName="GeneratorFunction",Mo(u,o,"GeneratorFunction"),Mo(f),Mo(f,o,"Generator"),Mo(f,r,function(){return this}),Mo(f,"toString",function(){return"[object Generator]"}),(zo=function(){return{w:i,m:h}})()}function Mo(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Mo=function(t,n,e,r){function i(n,e){Mo(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Mo(t,n,e,r)}function Io(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function No(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){Io(i,r,o,a,s,"next",t)}function s(t){Io(i,r,o,a,s,"throw",t)}a(void 0)})}}function jo(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function Uo(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?jo(Object(e),!0).forEach(function(n){Ko(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):jo(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Xo(t){return function(t){if(Array.isArray(t))return Zo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return Zo(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Zo(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zo(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function Bo(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yo(r.key),r)}}function Go(t,n,e){return n=Jo(n),function(t,n){if(n&&("object"==Co(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ho()?Reflect.construct(n,e||[],Jo(t).constructor):n.apply(t,e))}function Ho(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ho=function(){return!!t})()}function Vo(t,n,e,r){var o=qo(Jo(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function qo(){return qo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Jo(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},qo.apply(null,arguments)}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}function Wo(t,n){return Wo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Wo(t,n)}function Ko(t,n,e){return(n=Yo(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Yo(t){var n=function(t,n){if("object"!=Co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=Co(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==Co(n)?n:n+""}var Qo=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Ko(e=Go(this,n,[t]),"markOrbitDirty",function(){return e.orbitDirty=!0}),e.LEGACY_JULIA_RENDER=!1,e.DEFAULT_ZOOM=Ro.v4[0].zoom,e.MAX_ZOOM=1e-17,e.zoom=e.DEFAULT_ZOOM,e.DEFAULT_ROTATION=Ro.v4[0].rotation,e.rotation=e.DEFAULT_ROTATION,e.DEFAULT_C=[Ro.v4[0].c[0],Ro.v4[0].c[1]],e.c=Xo(e.DEFAULT_C),e.setPan(e.DEFAULT_PAN[0],e.DEFAULT_PAN[1]),e.colorPalette=Xo(e.DEFAULT_PALETTE),e.refZ0=[0,0],e.refZ0DD={x:{hi:0,lo:0},y:{hi:0,lo:0}},e.refPan=Xo(e.DEFAULT_PAN),e.refPanDD={x:{hi:e.DEFAULT_PAN[0],lo:0},y:{hi:e.DEFAULT_PAN[1],lo:0}},e.orbitDirty=!0,e._prevPan0=NaN,e._prevPan1=NaN,e._prevZoom=NaN,e._prevC0=NaN,e._prevC1=NaN,e.MAX_ITER=2e3,e.REF_SEARCH_GRID=7,e.REF_SEARCH_RADIUS=.5,e.orbitTex=null,e.orbitData=null,e.floatTexExt=null,e.rebaseArmed=!0,e.PRESETS=Ro.v4.map(function(t){return Uo(Uo({},t),{},{rotation:V(t.rotation||0)})}),e.DIVES=Ro.gf.map(function(t){return Uo(Uo({},t),{},{rotation:V(t.rotation||0)})}),e.currentPaletteIndex=0,e.innerStops=new Float32Array(f[e.currentPaletteIndex].theme),e.currentCAnimationFrame=null,e.demoTime=0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Wo(t,n)}(n,t),e=n,r=[{key:"onProgramCreated",value:function(){this.floatTexExt=this.gl.getExtension("OES_texture_float"),this.floatTexExt&&(this.orbitTex=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.orbitData=new Float32Array(4*this.MAX_ITER),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER),this.orbitDirty=!0)}},{key:"createFragmentShaderSource",value:function(){return"/*\r\n * Julia Fragment Shader (Rebased Perturbation)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n *\r\n * @description\r\n * Julia set implementation using perturbation math relative to a\r\n * pre-calculated Mandelbrot reference orbit.\r\n * Formula: dz_{n+1} = 2*zref*dz + dz^2 + (c_julia - c_ref).\r\n *\r\n * @license   MIT\r\n */\r\n\r\nprecision highp float;\r\n\r\nuniform vec2  u_resolution;\r\nuniform float u_rotation;\r\n\r\n// delta z0 (pan - refZ0) computed on JS side for float64 precision\r\nuniform vec2  u_delta_z0_h;\r\nuniform vec2  u_delta_z0_l;\r\n\r\n// zoom hi/lo\r\nuniform float u_zoom_h;\r\nuniform float u_zoom_l;\r\n\r\n// Julia constant\r\nuniform vec2  u_c;\r\n\r\nuniform float u_iterations;\r\nuniform vec3  u_innerStops[5];\r\n\r\nuniform sampler2D u_orbitTex;\r\nuniform float     u_orbitW;\r\n\r\nconst int MAX_ITER = __MAX_ITER__;\r\n\r\n// --- df helpers ---\r\nstruct df  { float hi; float lo; };\r\nstruct df2 { df x; df y; };\r\n\r\ndf df_make(float hi, float lo){ df a; a.hi=hi; a.lo=lo; return a; }\r\ndf df_from(float a){ return df_make(a, 0.0); }\r\nfloat df_to_float(df a){ return a.hi + a.lo; }\r\n\r\ndf twoSum(float a, float b) {\r\n    float s  = a + b;\r\n    float bb = s - a;\r\n    float err = (a - (s - bb)) + (b - bb);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf quickTwoSum(float a, float b) {\r\n    float s = a + b;\r\n    float err = b - (s - a);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf df_add(df a, df b) {\r\n    df s = twoSum(a.hi, b.hi);\r\n    float t = a.lo + b.lo;\r\n    df u = twoSum(s.lo, t);\r\n    df v = twoSum(s.hi, u.hi);\r\n    float lo = u.lo + v.lo;\r\n    return quickTwoSum(v.hi, lo);\r\n}\r\n\r\ndf df_sub(df a, df b) { return df_add(a, df_make(-b.hi, -b.lo)); }\r\n\r\nconst float SPLIT = 4097.0;\r\n\r\ndf twoProd(float a, float b) {\r\n    float p = a * b;\r\n\r\n    float aSplit = a * SPLIT;\r\n    float aHi = aSplit - (aSplit - a);\r\n    float aLo = a - aHi;\r\n\r\n    float bSplit = b * SPLIT;\r\n    float bHi = bSplit - (bSplit - b);\r\n    float bLo = b - bHi;\r\n\r\n    float err = ((aHi * bHi - p) + aHi * bLo + aLo * bHi) + aLo * bLo;\r\n    return df_make(p, err);\r\n}\r\n\r\ndf df_mul(df a, df b) {\r\n    df p = twoProd(a.hi, b.hi);\r\n    float err = a.hi * b.lo + a.lo * b.hi + a.lo * b.lo;\r\n    df s = twoSum(p.lo, err);\r\n    df r = twoSum(p.hi, s.hi);\r\n    float lo = s.lo + r.lo;\r\n    return quickTwoSum(r.hi, lo);\r\n}\r\n\r\ndf df_mul_f(df a, float b) { return df_mul(a, df_from(b)); }\r\n\r\ndf2 df2_make(df x, df y){ df2 r; r.x=x; r.y=y; return r; }\r\ndf2 df2_add(df2 a, df2 b){ return df2_make(df_add(a.x, b.x), df_add(a.y, b.y)); }\r\n\r\ndf2 df2_mul(df2 a, df2 b) {\r\n    df axbx = df_mul(a.x, b.x);\r\n    df ayby = df_mul(a.y, b.y);\r\n    df axby = df_mul(a.x, b.y);\r\n    df aybx = df_mul(a.y, b.x);\r\n    return df2_make(df_sub(axbx, ayby), df_add(axby, aybx));\r\n}\r\n\r\ndf2 df2_sqr(df2 a){\r\n    df xx = df_mul(a.x, a.x);\r\n    df yy = df_mul(a.y, a.y);\r\n    df xy = df_mul(a.x, a.y);\r\n    return df2_make(df_sub(xx, yy), df_mul_f(xy, 2.0));\r\n}\r\n\r\nvec3 getColorFromMap(float t) {\r\n    float segment = 1.0 / 4.0;\r\n    if (t <= segment) {\r\n        return mix(u_innerStops[0], u_innerStops[1], t / segment);\r\n    } else if (t <= 2.0 * segment) {\r\n        return mix(u_innerStops[1], u_innerStops[2], (t - segment) / segment);\r\n    } else if (t <= 3.0 * segment) {\r\n        return mix(u_innerStops[2], u_innerStops[3], (t - 2.0 * segment) / segment);\r\n    } else {\r\n        return mix(u_innerStops[3], u_innerStops[4], (t - 3.0 * segment) / segment);\r\n    }\r\n}\r\n\r\ndf2 sampleZRef(int n) {\r\n    float x = (float(n) + 0.5) / u_orbitW;\r\n    vec4 t = texture2D(u_orbitTex, vec2(x, 0.5));\r\n    return df2_make(df_make(t.r, t.g), df_make(t.b, t.a));\r\n}\r\n\r\nvoid main() {\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;\r\n    st.x *= aspect;\r\n\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 r = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    df zoom = df_make(u_zoom_h, u_zoom_l);\r\n\r\n    // deltaZ0 = pan - refZ0 (computed on JS side with float64 precision)\r\n    df2 deltaZ0 = df2_make(\r\n        df_make(u_delta_z0_h.x, u_delta_z0_l.x),\r\n        df_make(u_delta_z0_h.y, u_delta_z0_l.y)\r\n    );\r\n\r\n    // dz0 = deltaZ0 + zoom * r\r\n    df2 dz = df2_add(\r\n        deltaZ0,\r\n        df2_make(df_mul_f(zoom, r.x), df_mul_f(zoom, r.y))\r\n    );\r\n\r\n    float it = 0.0;\r\n    float zx = 0.0;\r\n    float zy = 0.0;\r\n\r\n    for (int n = 0; n < MAX_ITER; n++) {\r\n        float fn = float(n);\r\n        if (fn >= u_iterations) { it = fn; break; }\r\n\r\n        df2 zref = sampleZRef(n);\r\n\r\n        zx = df_to_float(zref.x) + df_to_float(dz.x);\r\n        zy = df_to_float(zref.y) + df_to_float(dz.y);\r\n        if (zx*zx + zy*zy > 4.0) { it = fn; break; }\r\n\r\n        // Correct Julia perturbation:\r\n        // dz_{n+1} = 2*zref*dz + dz^2   (NO +dc term)\r\n        df2 zref_dz = df2_mul(zref, dz);\r\n        zref_dz.x = df_mul_f(zref_dz.x, 2.0);\r\n        zref_dz.y = df_mul_f(zref_dz.y, 2.0);\r\n\r\n        df2 dz2 = df2_sqr(dz);\r\n\r\n        dz = df2_add(zref_dz, dz2);\r\n\r\n        if (n == MAX_ITER - 1) it = u_iterations;\r\n    }\r\n\r\n    if (it >= u_iterations) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        float r2 = max(zx*zx + zy*zy, 1e-30);\r\n        float smoothColor = it - log2(log2(sqrt(r2)));\r\n\r\n        // Normalize\r\n        float t = clamp(smoothColor / u_iterations, 0.0, 1.0);\r\n\r\n        t = 0.5 + 0.6 * sin(t * 4.0 * 3.14159265);\r\n\r\n        vec3 col = getColorFromMap(t);\r\n        gl_FragColor = vec4(col, 1.0);\r\n    }\r\n}".replace("__MAX_ITER__",this.MAX_ITER).toString()}},{key:"updateUniforms",value:function(){Vo(n,"updateUniforms",this,3)([]),this.cLoc=this.gl.getUniformLocation(this.program,"u_c"),this.innerStopsLoc=this.gl.getUniformLocation(this.program,"u_innerStops"),this.deltaZ0HLoc=this.gl.getUniformLocation(this.program,"u_delta_z0_h"),this.deltaZ0LLoc=this.gl.getUniformLocation(this.program,"u_delta_z0_l"),this.zoomHLoc=this.gl.getUniformLocation(this.program,"u_zoom_h"),this.zoomLLoc=this.gl.getUniformLocation(this.program,"u_zoom_l"),this.orbitTexLoc=this.gl.getUniformLocation(this.program,"u_orbitTex"),this.orbitWLoc=this.gl.getUniformLocation(this.program,"u_orbitW")}},{key:"escapeItersJulia",value:function(t,n,e){for(var r=t,o=n,i=this.c[0],a=this.c[1],s=0;s<e;s++){var c=2*r*o+a;if((r=r*r-o*o+i)*r+(o=c)*o>4)return s}return e}},{key:"pickReferenceNearViewCenter",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.refZ0[0]=this.pan[0],this.refZ0[1]=this.pan[1],this.refZ0DD.x.hi=this.panDD.x.hi,this.refZ0DD.x.lo=this.panDD.x.lo,this.refZ0DD.y.hi=this.panDD.y.hi,this.refZ0DD.y.lo=this.panDD.y.lo,this.refPan[0]=this.pan[0],this.refPan[1]=this.pan[1],this.refPanDD.x.hi=this.panDD.x.hi,this.refPanDD.x.lo=this.panDD.x.lo,this.refPanDD.y.hi=this.panDD.y.hi,void(this.refPanDD.y.lo=this.panDD.y.lo);var t=this.REF_SEARCH_GRID,n=(t-1)/2,e=2*this.REF_SEARCH_RADIUS/(t-1),r=this.zoom,o=Math.min(this.MAX_ITER,Math.max(200,Math.floor(this.iterations))),i=-1;Math.hypot(this.refZ0[0]-this.pan[0],this.refZ0[1]-this.pan[1])<r*this.REF_SEARCH_RADIUS*2.5&&(i=this.escapeItersJulia(this.refZ0[0],this.refZ0[1],o));for(var a=this.pan[0],s=this.pan[1],c=this.escapeItersJulia(this.pan[0],this.pan[1],o),u=0;u<t;u++)for(var l=0;l<t;l++){var f=(l-n)*e,h=(u-n)*e,m=this.pan[0]+f*r,d=this.pan[1]+h*r,p=this.escapeItersJulia(m,d,o);p>c&&(c=p,a=m,s=d)}var v=Math.max(.1*i,50);(i<0||c-i>v)&&(this.refZ0[0]=a,this.refZ0[1]=s,this.refZ0DD.x.hi=a,this.refZ0DD.x.lo=0,this.refZ0DD.y.hi=s,this.refZ0DD.y.lo=0,this.refPan[0]=a,this.refPan[1]=s,this.refPanDD.x.hi=a,this.refPanDD.x.lo=0,this.refPanDD.y.hi=s,this.refPanDD.y.lo=0)}},{key:"computeReferenceOrbit",value:function(){if(this.orbitData&&this.orbitTex){for(var t=this.c[0],n=this.c[1],e=this.refZ0[0],r=this.refZ0[1],o=0;o<this.MAX_ITER;o++){var i=k(e),a=k(r),s=4*o;this.orbitData[s]=i.high,this.orbitData[s+1]=i.low,this.orbitData[s+2]=a.high,this.orbitData[s+3]=a.low;var c=2*e*r+n;if((e=e*e-r*r+t)*e+(r=c)*r>4){for(var u=k(e),l=k(r),f=o+1;f<this.MAX_ITER;f++){var h=4*f;this.orbitData[h]=u.high,this.orbitData[h+1]=u.low,this.orbitData[h+2]=l.high,this.orbitData[h+3]=l.low}break}}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.MAX_ITER,1,0,this.gl.RGBA,this.gl.FLOAT,this.orbitData),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER)}}},{key:"needsRebase",value:function(){if(void 0===this.rebaseArmed&&(this.rebaseArmed=!0),!this.refPan)return!0;if(!Number.isFinite(this.zoom))return!1;var t=Math.max(this.zoom,1e-300),n=this.pan[0]-this.refPan[0],e=this.pan[1]-this.refPan[1],r=Math.hypot(n,e)/t;return!this.rebaseArmed&&r<.9?(this.rebaseArmed=!0,!1):!!(this.rebaseArmed&&r>1.75)&&(this.rebaseArmed=!1,!0)}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.max(this.zoom,1e-300),e=Math.floor(200+50*Math.log10(this.DEFAULT_ZOOM/t));this.iterations=Math.max(50,Math.min(this.MAX_ITER,e+this.extraIterations));var r=!Number.isFinite(this._prevPan0)||!Number.isFinite(this._prevPan1)||Math.abs(this.pan[0]-this._prevPan0)+Math.abs(this.pan[1]-this._prevPan1)>1e-6*this.zoom,o=!Number.isFinite(this._prevZoom)||Math.abs(this.zoom-this._prevZoom)>1e-8*this.zoom,i=!Number.isFinite(this._prevC0)||!Number.isFinite(this._prevC1)||Math.abs(this.c[0]-this._prevC0)+Math.abs(this.c[1]-this._prevC1)>0;(r||o||i)&&(this.orbitDirty=!0,this._prevPan0=this.pan[0],this._prevPan1=this.pan[1],this._prevZoom=this.zoom,this._prevC0=this.c[0],this._prevC1=this.c[1]);var a=i||this.needsRebase(),s=!this.interactionActive||a;this.orbitDirty&&s&&(this.pickReferenceNearViewCenter(this.interactionActive),this.computeReferenceOrbit(),this.orbitDirty=!1);var c=N(this.panDD.x,this.refZ0DD.x),u=N(this.panDD.y,this.refZ0DD.y);this.deltaZ0HLoc&&this.gl.uniform2f(this.deltaZ0HLoc,c.hi,u.hi),this.deltaZ0LLoc&&this.gl.uniform2f(this.deltaZ0LLoc,c.lo,u.lo);var l=k(this.zoom);this.zoomHLoc&&this.gl.uniform1f(this.zoomHLoc,l.high),this.zoomLLoc&&this.gl.uniform1f(this.zoomLLoc,l.low),this.cLoc&&this.gl.uniform2fv(this.cLoc,this.c),this.innerStopsLoc&&this.gl.uniform3fv(this.innerStopsLoc,this.innerStops),Vo(n,"draw",this,3)([])}},{key:"reset",value:function(){this.c=Xo(this.DEFAULT_C),this.innerStops=new Float32Array(f[0].theme),this.currentPaletteIndex=0,this.orbitDirty=!0,this._prevPan0=NaN,this._prevPan1=NaN,this._prevZoom=NaN,this._prevC0=NaN,this._prevC1=NaN,Vo(n,"reset",this,3)([])}},{key:"stopCurrentCAnimation",value:function(){null!==this.currentCAnimationFrame&&(cancelAnimationFrame(this.currentCAnimationFrame),this.currentCAnimationFrame=null)}},{key:"stopAllNonColorAnimations",value:function(){this.stopCurrentCAnimation(),Vo(n,"stopAllNonColorAnimations",this,3)([])}},{key:"getNextColorThemeId",value:function(){return f[(this.currentPaletteIndex+1)%f.length].id||"Random"}},{key:"animateInnerStopsTransition",value:(d=No(zo().m(function t(n){var e,r,o,i=this,a=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:250,r=a.length>2&&void 0!==a[2]?a[2]:null,this.stopCurrentColorAnimations(),o=Array.from(this.innerStops),t.n=1,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u,l=Math.min((c-a)/e,1),f=o.map(function(t,e){return H(t,n.theme[e],l)});i.innerStops=new Float32Array(f),n.keyColor&&(u=G(n.keyColor))&&(i.colorPalette=[u.r,u.g,u.b]),u||(i.colorPalette=[1.5*n.theme[9],1.5*n.theme[10],1.5*n.theme[11]]),i.draw(),r&&r(),l<1?i.currentColorAnimationFrame=requestAnimationFrame(s):(i.stopCurrentColorAnimations(),t())};i.currentColorAnimationFrame=requestAnimationFrame(s)});case 1:return t.a(2)}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"animateColorPaletteTransition",value:(m=No(zo().m(function t(){var n,e,r=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:250,e=r.length>1&&void 0!==r[1]?r[1]:null,this.currentPaletteIndex=(this.currentPaletteIndex+1)%f.length,t.n=1,this.animateInnerStopsTransition(f[this.currentPaletteIndex],n,e);case 1:return t.a(2)}},t,this)})),function(){return m.apply(this,arguments)})},{key:"animateFullColorSpaceCycle",value:(h=No(zo().m(function t(){var n,e,r=this,o=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:15e3,e=o.length>1&&void 0!==o[1]?o[1]:null,t.n=1,new Promise(function(){r.animateColorPaletteTransition(n,e)});case 1:return t.a(2)}},t)})),function(){return h.apply(this,arguments)})},{key:"animateToC",value:(l=No(zo().m(function t(){var n,e,r,o,i=this,s=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:if(n=s.length>0&&void 0!==s[0]?s[0]:Xo(this.DEFAULT_C),e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.QUINT,this.stopCurrentCAnimation(),!j(this.c,n)){t.n=1;break}return t.a(2);case 1:return o=Xo(this.c),t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u);i.c[0]=H(o[0],n[0],l),i.c[1]=H(o[1],n[1],l),i.markOrbitDirty(),i.draw(),Yr(!0),We(),u<1?i.currentCAnimationFrame=requestAnimationFrame(s):(i.stopCurrentCAnimation(),i.onAnimationFinished(),t())};i.currentCAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(){return l.apply(this,arguments)})},{key:"animateToZoomAndC",value:(u=No(zo().m(function t(n){var e,r,o,i=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:Xo(this.DEFAULT_C),r=i.length>2&&void 0!==i[2]?i[2]:500,o=i.length>3&&void 0!==i[3]?i[3]:a.QUINT,this.stopCurrentCAnimation(),t.n=1,Promise.all([this.animateZoomTo(n,r,o),this.animateToC(e,r,o)]);case 1:case 2:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"animateTravelToPreset",value:(c=No(zo().m(function t(n){var e,r=arguments;return zo().w(function(t){for(;;)switch(t.n){case 0:return e=r.length>1&&void 0!==r[1]?r[1]:500,this.stopAllNonColorAnimations(),t.n=1,this.animatePanAndZoomTo(this.DEFAULT_PAN,this.DEFAULT_ZOOM,1e3);case 1:return t.n=2,Promise.all([this.animateZoomTo(n.zoom,e,a.QUINT),this.animateToC(n.c,e),this.animateRotationTo(n.rotation,e,a.QUINT),this.animatePanTo(n.pan,e,a.QUINT)]);case 2:this.currentPresetIndex=n.id||0;case 3:return t.a(2)}},t,this)})),function(t){return c.apply(this,arguments)})},{key:"animateDive",value:(s=No(zo().m(function t(n){var e=this;return zo().w(function(t){for(;;)switch(t.n){case 0:return this.stopCurrentCAnimation(),t.n=1,new Promise(function(){n.phases||(n.phases=[1,2,3,4]);var t=n.phases[0],r=function(){var o=n.step;1===t?(e.c[0]+=n.cxDirection*o,(n.cxDirection<0&&e.c[0]<=n.endC[0]||n.cxDirection>0&&e.c[0]>=n.endC[0])&&(e.c[0]=n.endC[0],t=2)):2===t?(e.c[1]+=n.cyDirection*o,(n.cyDirection<0&&e.c[1]<=n.endC[1]||n.cyDirection>0&&e.c[1]>=n.endC[1])&&(e.c[1]=n.endC[1],t=3)):3===t?(e.c[0]-=n.cxDirection*o,(n.cxDirection<0&&e.c[0]>=n.startC[0]||n.cxDirection>0&&e.c[0]<=n.startC[0])&&(e.c[0]=n.startC[0],t=4)):4===t&&(e.c[1]-=n.cyDirection*o,(n.cyDirection<0&&e.c[1]>=n.startC[1]||n.cyDirection>0&&e.c[1]<=n.startC[1])&&(e.c[1]=n.startC[1],t=1)),e.markOrbitDirty(),e.draw(),Yr(!0),We(),e.currentCAnimationFrame=requestAnimationFrame(r)};e.currentCAnimationFrame=requestAnimationFrame(r)});case 1:return t.a(2)}},t,this)})),function(t){return s.apply(this,arguments)})},{key:"animateDemo",value:(i=No(zo().m(function t(){var n=this;return zo().w(function(t){for(;;)switch(t.n){case 0:return this.stopAllNonColorAnimations(),this.demoActive=!0,t.n=1,new Promise(function(){var t=function(){n.c=[(Math.sin(n.demoTime)+1)/2*1.5-1,(Math.cos(n.demoTime)+1)/2*1.4-.7],n.rotation=q(n.rotation-.001),n.demoTime+=5e-4,n.markOrbitDirty(),n.draw(),Yr(!0),We(),n.currentCAnimationFrame=requestAnimationFrame(t)};n.currentCAnimationFrame=requestAnimationFrame(t)});case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})}],r&&Bo(e.prototype,r),o&&Bo(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,i,s,c,u,l,h,m,d}(lt);function $o(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ti(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(ti(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ti(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ti(f,"constructor",u),ti(u,"constructor",c),c.displayName="GeneratorFunction",ti(u,o,"GeneratorFunction"),ti(f),ti(f,o,"Generator"),ti(f,r,function(){return this}),ti(f,"toString",function(){return"[object Generator]"}),($o=function(){return{w:i,m:h}})()}function ti(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ti=function(t,n,e,r){function i(n,e){ti(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},ti(t,n,e,r)}function ni(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function ei(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){ni(i,r,o,a,s,"next",t)}function s(t){ni(i,r,o,a,s,"throw",t)}a(void 0)})}}function ri(){return oi.apply(this,arguments)}function oi(){return oi=ei($o().m(function t(){var n,e,r,o,a,s,c,u;return $o().w(function(t){for(;;)switch(t.n){case 0:(n=document.getElementById("fractalCanvas")).width=window.innerWidth,n.height=window.innerHeight,e=x(),r=null!=e.px&&null!=e.py&&null!=e.zoom&&null!=e.r,o=r&&null!=e.cx&&null!=e.cy,a={pan:[e.px,e.py],zoom:e.zoom,c:[e.cx,e.cy],rotation:e.r},s=function(){c.resizeCanvas(),E()},u=e.mode,t.n=u===i.JULIA?1:u===i.MANDELBROT?2:u===i.RIEMANN?3:4;break;case 1:return c=new Qo(n),t.a(3,5);case 2:return c=new Ee(n),t.a(3,5);case 3:return c=new Me(n),t.a(3,5);case 4:return t.a(3,5);case 5:return t.n=6,W(100);case 6:return t.n=7,ko(c);case 7:if(!o){t.n=9;break}return t.n=8,c.animateTravelToPreset(a,1e3);case 8:t.n=12;break;case 9:if(!r){t.n=11;break}return t.n=10,c.animateTravelToPreset(a,100,1e3);case 10:t.n=12;break;case 11:s();case 12:return t.n=13,W(100);case 13:return t.n=14,new Promise(function(t){document.getElementById("headerContainer").classList.add("ready"),document.getElementById("infoLabel").classList.add("ready"),t()});case 14:(r||o)&&(mo(),po());case 15:return t.a(2)}},t)})),oi.apply(this,arguments)}document.addEventListener("DOMContentLoaded",ei($o().m(function t(){return $o().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ri();case 1:return t.n=2,W(2e3);case 2:Yr();case 3:return t.a(2)}},t)})),{once:!0})})();
//# sourceMappingURL=bundle.js.map