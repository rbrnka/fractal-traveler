(()=>{"use strict";var t=0,n=2,e=n,r="debug",o=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n&&"[".concat(n,"]")},i={MANDELBROT:0,JULIA:1,RIEMANN:2},a={NONE:function(t){return t},QUAD:function(t){return t<.5?2*t*t:(4-2*t)*t-1},CUBIC:function(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2},QUINT:function(t){return t<.5?16*Math.pow(t,5):1-Math.pow(-2*t+2,5)/2}},s=-1,c=1,u="#B4FF6A",l="rgba(24, 48, 13, 0.2)",f=("color: ".concat(u),"color: ".concat("#fff"),{id:"Default",keyColor:"#fefe66",theme:[0,0,0,1,.647,0,0,0,0,1.2,1.2,1,.1,.1,.1]}),h=[95/255,134/255,56/255],m=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255,e=H(t,n);return[e.r,e.g,e.b]}(f.keyColor),d=Math.PI;function p(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return v(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(v(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,v(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,v(f,"constructor",u),v(u,"constructor",c),c.displayName="GeneratorFunction",v(u,o,"GeneratorFunction"),v(f),v(f,o,"Generator"),v(f,r,function(){return this}),v(f,"toString",function(){return"[object Generator]"}),(p=function(){return{w:i,m:h}})()}function v(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}v=function(t,n,e,r){function i(n,e){v(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},v(t,n,e,r)}function y(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function b(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||_(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,n){if(t){if("string"==typeof t)return T(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?T(t,n):void 0}}function T(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var w=!1;function A(t,n,e,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=function(t){return null==t?null:Number(t).toPrecision(17)},u={mode:null!=t?t.toFixed(0):i.MANDELBROT,px:c(n),py:c(e),zoom:c(r),r:null!=o?Number(o).toPrecision(17):0,cx:c(a),cy:c(s)};if(!([n,e,r,o].some(function(t){return null==t})||t===i.JULIA&&[a,s].some(function(t){return null==t}))){var l=btoa(JSON.stringify(u)),f=t===i.JULIA?"#julia":"#";window.history.pushState({},"","".concat(f,"?view=").concat(l)),w=!0}}function E(){var t=new URL(window.location.href).hash;if(!t)return{mode:i.MANDELBROT};var n=g(t.slice(1).split("?"),2),e=n[0],r=n[1];if(!r)return{mode:"julia"===e?i.JULIA:i.MANDELBROT};var o=new URLSearchParams(r).get("view");try{var a=JSON.parse(atob(o));return w=!0,{mode:"julia"===e?i.JULIA:i.MANDELBROT,px:null!=a.px?parseFloat(a.px):null,py:null!=a.py?parseFloat(a.py):null,zoom:null!=a.zoom?parseFloat(a.zoom):null,r:null!=a.r?parseFloat(a.r):0,cx:null!=a.cx?parseFloat(a.cx):null,cy:null!=a.cy?parseFloat(a.cy):null}}catch(t){return w=!0,{mode:"julia"===e?i.JULIA:i.MANDELBROT}}}function x(){if(w){var t=window.location.hash.split("?")[0],n="".concat(window.location.origin,"/").concat(t);window.history.pushState({},"",n),w=!1}}var P=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0};function S(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(function(t){return navigator.userAgent.match(t)})}function D(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[NaN,void 0,null,""],o=function(t){return"number"==typeof t&&isFinite(t)},i="[";if(r.some(function(n){return n===t[0]})||r.some(function(n){return n===t[1]})||!o(t[0])||!o(t[1]))return i+="?, ?]";var a=parseFloat(t[0].toFixed(n)).toString(),s=parseFloat(t[1].toFixed(n)).toString();return(i+="".concat(a,", ").concat(s))+(e&&0!==t[1]?"i]":"]")}var L="vd",O="ed",k=function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:L)===O?function(t){var n=Math.fround(t),e=Math.fround(t-n);return{high:n,low:e}}(t):function(t){var n=t*C,e=n-(n-t),r=t-e;return{high:e,low:r}}(t)},C=134217729;function R(){return{hi:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,lo:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}function F(t,n){var e=t+n,r=e-t;return{s:e,err:t-(e-r)+(n-r)}}function z(t,n){var e=t+n;return{s:e,err:n-(e-t)}}function M(t,n){var e=F(t.hi,n),r=t.lo+e.err,o=z(e.s,r);return t.hi=o.s,t.lo=o.err,t}function I(t,n){return t.hi=n,t.lo=0,t}function N(t){return t.hi+t.lo}function j(t,n){return function(t,n){var e=F(t.hi,n.hi),r=t.lo+n.lo+e.err,o=z(e.s,r);return{hi:o.s,lo:o.err}}(t,{hi:-n.hi,lo:-n.lo})}function U(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return t[0].toFixed(e)===n[0].toFixed(e)&&t[1].toFixed(e)===n[1].toFixed(e)}function B(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return t[0].toFixed(e)===n[0].toFixed(e)&&t[1].toFixed(e)===n[1].toFixed(e)&&t[2].toFixed(e)===n[2].toFixed(e)}function X(t,n,e){var r,o,i,a=Math.floor(6*t),s=6*t-a,c=e*(1-n),u=e*(1-s*n),l=e*(1-(1-s)*n);switch(a%6){case 0:r=e,o=l,i=c;break;case 1:r=u,o=e,i=c;break;case 2:r=c,o=e,i=l;break;case 3:r=c,o=u,i=e;break;case 4:r=l,o=c,i=e;break;case 5:r=e,o=c,i=u}return[r,o,i]}function Z(t,n,e){var r,o,i;if(0===n)r=o=i=e;else{var a=function(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+(n-t)*(2/3-e)*6:t},s=e<.5?e*(1+n):e+n-e*n,c=2*e-s;r=a(c,s,t+1/3),o=a(c,s,t),i=a(c,s,t-1/3)}return[r,o,i]}function G(t,n,e){var r,o,i=Math.max(t,n,e),a=Math.min(t,n,e),s=(i+a)/2;if(i===a)r=o=0;else{var c=i-a;o=s>.5?c/(2-i-a):c/(i+a),r=i===t?(n-e)/c+(n<e?6:0):i===n?(e-t)/c+2:(t-n)/c+4,r/=6}return[r,o,s]}function H(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return 3===(t=t.toLowerCase().replace(/^#/,"")).length&&(t=t.split("").map(function(t){return t+t}).join("")),/^([\da-f]{6})$/i.test(t)?{r:parseInt(t.substring(0,2),16)/n,g:parseInt(t.substring(2,4),16)/n,b:parseInt(t.substring(4,6),16)/n}:null}function V(t,n,e){return t+(n-t)*e}function q(t){return t*(d/180)}function J(t){var n=2*d;return(t%n+n)%n}function W(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=0,i=function(){if(Object.prototype.hasOwnProperty.call(e,a)){var t=void 0!==r[a]?r[a]:1,i=n[a],s=e[a],c=0;"number"==typeof s&&"number"==typeof i?c=Math.abs(s-i):Array.isArray(s)&&Array.isArray(i)&&(c=Math.hypot.apply(Math,b(s.map(function(t,n){return t-(i[n]||0)})))),o+=t*c}};for(var a in e)i();return Math.round(t*o)}function K(t){return Y.apply(this,arguments)}function Y(){var t;return t=p().m(function t(n){return p().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t){return setTimeout(t,n)}))},t)}),Y=function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){y(i,r,o,a,s,"next",t)}function s(t){y(i,r,o,a,s,"throw",t)}a(void 0)})},Y.apply(this,arguments)}function Q(t){Array.isArray(t)&&(t.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)}),t.length=0)}function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function tt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nt(r.key),r)}}function nt(t){var n=function(t,n){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==$(n)?n:n+""}var et=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=n,this.gl=this.canvas.getContext("webgl",{antialias:!1,alpha:!1,depth:!1,stencil:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance"}),this.gl?(this.onWebGLContextLost=this.onWebGLContextLost.bind(this),this.canvas.addEventListener("webglcontextlost",this.onWebGLContextLost)):alert("WebGL is not supported by your browser or crashed.")},(n=[{key:"onWebGLContextLost",value:function(t){t.preventDefault(),this.init()}},{key:"init",value:function(){throw new Error("Not implemented")}},{key:"draw",value:function(){throw new Error("Not implemented")}},{key:"reset",value:function(){throw new Error("Not implemented")}},{key:"destroy",value:function(){this.gl=null,this.canvas=null}}])&&tt(t.prototype,n),e&&tt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return it(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(it(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,it(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,it(f,"constructor",u),it(u,"constructor",c),c.displayName="GeneratorFunction",it(u,o,"GeneratorFunction"),it(f),it(f,o,"Generator"),it(f,r,function(){return this}),it(f,"toString",function(){return"[object Generator]"}),(ot=function(){return{w:i,m:h}})()}function it(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}it=function(t,n,e,r){function i(n,e){it(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},it(t,n,e,r)}function at(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function st(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){at(i,r,o,a,s,"next",t)}function s(t){at(i,r,o,a,s,"throw",t)}a(void 0)})}}function ct(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||lt(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(t){return function(t){if(Array.isArray(t))return ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||lt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(t,n){if(t){if("string"==typeof t)return ft(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ft(t,n):void 0}}function ft(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function ht(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mt(r.key),r)}}function mt(t){var n=function(t,n){if("object"!=rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==rt(n)?n:n+""}function dt(t,n,e){return n=yt(n),function(t,n){if(n&&("object"==rt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,pt()?Reflect.construct(n,e||[],yt(t).constructor):n.apply(t,e))}function pt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pt=function(){return!!t})()}function vt(){return vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=yt(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},vt.apply(null,arguments)}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}function bt(t,n){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},bt(t,n)}var gt=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=dt(this,n,[t])).MAX_ITER=2e3,e.DEFAULT_ROTATION=0,e.DEFAULT_ZOOM=3,e.DEFAULT_PAN=[0,0],e.DEFAULT_PALETTE=[1,1,1],e.MAX_ZOOM=1e-80,e.MIN_ZOOM=40,e.PRESETS=[],e.zoom=e.DEFAULT_ZOOM,e.pan=ut(e.DEFAULT_PAN),e.panDD={x:R(e.pan[0],0),y:R(e.pan[1],0)},e.rotation=e.DEFAULT_ROTATION,e.currentPanAnimationFrame=null,e.currentZoomAnimationFrame=null,e.currentRotationAnimationFrame=null,e.currentColorAnimationFrame=null,e.demoActive=!1,e.currentPresetIndex=0,e.interactionActive=!1,e.interactionTimer=null,e.iterations=0,e.extraIterations=0,e.bestScore=NaN,e.probeIters=NaN,e.colorPalette=ut(e.DEFAULT_PALETTE),e._uniformCache={resW:-1,resH:-1,pan0:NaN,pan1:NaN,zoom:NaN,rotation:NaN,iterations:NaN,color0:NaN,color1:NaN,color2:NaN},e.vertexShaderSource="/*\r\n * Vertex Shader Initializer\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n * @license   MIT\r\n */\r\n\r\nprecision mediump float;\r\nattribute vec4 a_position;\r\n\r\nvoid main() {\r\n    gl_Position = a_position;\r\n}",e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&bt(t,n)}(n,t),e=n,r=[{key:"markOrbitDirty",value:function(){}},{key:"invalidateUniformCache",value:function(){this._uniformCache.resW=-1,this._uniformCache.resH=-1,this._uniformCache.pan0=NaN,this._uniformCache.pan1=NaN,this._uniformCache.zoom=NaN,this._uniformCache.rotation=NaN,this._uniformCache.iterations=NaN,this._uniformCache.color0=NaN,this._uniformCache.color1=NaN,this._uniformCache.color2=NaN}},{key:"getPan",value:function(){return[this.pan[0],this.pan[1]]}},{key:"setPan",value:function(t,n){I(this.panDD.x,t),I(this.panDD.y,n),this.pan[0]=N(this.panDD.x),this.pan[1]=N(this.panDD.y)}},{key:"addPan",value:function(t,n){M(this.panDD.x,t),M(this.panDD.y,n),this.pan[0]=N(this.panDD.x),this.pan[1]=N(this.panDD.y)}},{key:"setPanFromAnchor",value:function(t,n,e,r){var o=t-e*this.zoom,i=n-r*this.zoom;this.setPan(o,i)}},{key:"setZoomKeepingAnchor",value:function(t,n,e){var r=ct(this.screenToViewVector(n,e),2),o=r[0],i=r[1],a=this.zoom-t;this.addPan(o*a,i*a),this.zoom=t}},{key:"noteInteraction",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:160;this.interactionActive=!0,this.interactionTimer&&(clearTimeout(this.interactionTimer),this.interactionTimer=null),this.interactionTimer=setTimeout(function(){t.interactionActive=!1,t.markOrbitDirty(),t.draw(),yo(!0)},n)}},{key:"destroy",value:function(){var t,e,r,o,i;this.stopAllNonColorAnimations(),this.stopCurrentColorAnimations(),this.canvas&&this.canvas.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.vertexShader&&(this.gl.deleteShader(this.vertexShader),this.vertexShader=null),this.fragmentShader&&(this.gl.deleteShader(this.fragmentShader),this.fragmentShader=null),this.interactionTimer&&(clearTimeout(this.interactionTimer),this.interactionTimer=null),(t=n,e="destroy",r=this,i=vt(yt(1&(o=3)?t.prototype:t),e,r),2&o&&"function"==typeof i?function(t){return i.apply(r,t)}:i)([])}},{key:"generatePresetIDs",value:function(){this.PRESETS.forEach(function(t,n){t.id=n})}},{key:"init",value:function(){this.generatePresetIDs(),this.initGLProgram(),this.draw()}},{key:"resizeCanvas",value:function(){o("resizeCanvas",this.constructor.name),this.gl.useProgram(this.program);var t=this.canvas.getBoundingClientRect(),n=t.width/2,e=t.height/2,r=ct(this.screenToFractal(n,e),2),i=r[0],a=r[1],s=window.devicePixelRatio||1;this.canvas.width=Math.floor(t.width*s),this.canvas.height=Math.floor(t.height*s),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.resolutionLoc&&this.gl.uniform2f(this.resolutionLoc,this.canvas.width,this.canvas.height);var c=ct(this.screenToViewVector(n,e),2),u=c[0],l=c[1];this.setPanFromAnchor(i,a,u,l),this.markOrbitDirty(),this.draw()}},{key:"createFragmentShaderSource",value:function(){throw new Error("The draw method must be implemented in child classes")}},{key:"compileShader",value:function(t,n){var e=this.gl.createShader(n);return this.gl.shaderSource(e,t),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)?e:(this.gl.deleteShader(e),null)}},{key:"initGLProgram",value:function(){this.program&&this.gl.deleteProgram(this.program),this.fragmentShader&&this.gl.deleteShader(this.fragmentShader),this.vertexShader||(this.vertexShader=this.compileShader(this.vertexShaderSource,this.gl.VERTEX_SHADER)),this.fragmentShader=this.compileShader(this.createFragmentShaderSource(),this.gl.FRAGMENT_SHADER),this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS),this.gl.useProgram(this.program);var t=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t);var n=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW);var e=this.gl.getAttribLocation(this.program,"a_position");this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,0,0),this.updateUniforms(),this.invalidateUniformCache(),"function"==typeof this.onProgramCreated&&this.onProgramCreated()}},{key:"onProgramCreated",value:function(){throw new Error("The onProgramCreated method must be implemented in child classes")}},{key:"needsRebase",value:function(){throw new Error("The needsRebase method must be implemented in child classes")}},{key:"updateUniforms",value:function(){this.gl.useProgram(this.program),this.panLoc=this.gl.getUniformLocation(this.program,"u_pan"),this.zoomLoc=this.gl.getUniformLocation(this.program,"u_zoom"),this.iterLoc=this.gl.getUniformLocation(this.program,"u_iterations"),this.colorLoc=this.gl.getUniformLocation(this.program,"u_colorPalette"),this.rotationLoc=this.gl.getUniformLocation(this.program,"u_rotation"),this.resolutionLoc=this.gl.getUniformLocation(this.program,"u_resolution")}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=this.canvas.width,n=this.canvas.height,e=this._uniformCache;this.gl.viewport(0,0,t,n),!this.resolutionLoc||e.resW===t&&e.resH===n||(this.gl.uniform2f(this.resolutionLoc,t,n),e.resW=t,e.resH=n),!this.panLoc||e.pan0===this.pan[0]&&e.pan1===this.pan[1]||(this.gl.uniform2fv(this.panLoc,this.pan),e.pan0=this.pan[0],e.pan1=this.pan[1]),this.zoomLoc&&e.zoom!==this.zoom&&(this.gl.uniform1f(this.zoomLoc,this.zoom),e.zoom=this.zoom),this.rotationLoc&&e.rotation!==this.rotation&&(this.gl.uniform1f(this.rotationLoc,this.rotation),e.rotation=this.rotation),this.iterLoc&&e.iterations!==this.iterations&&(this.gl.uniform1f(this.iterLoc,this.iterations),e.iterations=this.iterations),!this.colorLoc||e.color0===this.colorPalette[0]&&e.color1===this.colorPalette[1]&&e.color2===this.colorPalette[2]||(this.gl.uniform3fv(this.colorLoc,this.colorPalette),e.color0=this.colorPalette[0],e.color1=this.colorPalette[1],e.color2=this.colorPalette[2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),null==Ur||Ur.beginGpuTimer(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),null==Ur||Ur.endGpuTimer()}},{key:"reset",value:function(){this.stopAllNonColorAnimations(),this.stopCurrentColorAnimations(),this.colorPalette=ut(this.DEFAULT_PALETTE),this.setPan(this.DEFAULT_PAN[0],this.DEFAULT_PAN[1]),this.zoom=this.DEFAULT_ZOOM,this.rotation=this.DEFAULT_ROTATION,this.extraIterations=0,this.currentPresetIndex=0,this.resizeCanvas(),this.markOrbitDirty(),this.draw(),yo()}},{key:"screenToFractal",value:function(t,n){var e=window.devicePixelRatio||1,r=this.canvas.getBoundingClientRect(),o=r.width*e,i=r.height*e,a=t*e/o-.5,s=1-n*e/i-.5;a*=o/i;var c=Math.cos(this.rotation),u=Math.sin(this.rotation),l=u*a+c*s;return[(c*a-u*s)*this.zoom+this.pan[0],l*this.zoom+this.pan[1]]}},{key:"screenToViewVector",value:function(t,n){var e=window.devicePixelRatio||1,r=this.canvas.getBoundingClientRect(),o=r.width*e,i=r.height*e,a=t*e/o-.5,s=1-n*e/i-.5;a*=o/i;var c=Math.cos(this.rotation),u=Math.sin(this.rotation);return[c*a-u*s,u*a+c*s]}},{key:"getCanvasCssCenter",value:function(){var t=this.canvas.getBoundingClientRect();return[t.width/2,t.height/2]}},{key:"stopAllNonColorAnimations",value:function(){this.stopCurrentPanAnimation(),this.stopCurrentZoomAnimation(),this.stopCurrentRotationAnimation()}},{key:"stopCurrentPanAnimation",value:function(){null!==this.currentPanAnimationFrame&&(cancelAnimationFrame(this.currentPanAnimationFrame),this.currentPanAnimationFrame=null)}},{key:"stopCurrentZoomAnimation",value:function(){null!==this.currentZoomAnimationFrame&&(cancelAnimationFrame(this.currentZoomAnimationFrame),this.currentZoomAnimationFrame=null)}},{key:"stopCurrentRotationAnimation",value:function(){null!==this.currentRotationAnimationFrame&&(cancelAnimationFrame(this.currentRotationAnimationFrame),this.currentRotationAnimationFrame=null)}},{key:"stopCurrentColorAnimations",value:function(){null!==this.currentColorAnimationFrame&&(cancelAnimationFrame(this.currentColorAnimationFrame),this.currentColorAnimationFrame=null)}},{key:"stopDemo",value:function(){this.demoActive=!1,this.currentPresetIndex=0,this.stopAllNonColorAnimations()}},{key:"onAnimationFinished",value:function(){setTimeout(function(){return yo()},50)}},{key:"animateColorPaletteTransition",value:(g=st(ot().m(function t(n){var e,r,o,i=this,a=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=a.length>1&&void 0!==a[1]?a[1]:250,r=a.length>2&&void 0!==a[2]?a[2]:null,this.stopCurrentColorAnimations(),!B(this.colorPalette,n)){t.n=1;break}return t.a(2);case 1:return o=ut(this.colorPalette),t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1);i.colorPalette=[V(o[0],n[0],u),V(o[1],n[1],u),V(o[2],n[2],u)],i.draw(),r&&r(),u<1?i.currentColorAnimationFrame=requestAnimationFrame(s):(i.stopCurrentColorAnimations(),t())};i.currentColorAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return g.apply(this,arguments)})},{key:"animateFullColorSpaceCycle",value:(b=st(ot().m(function t(){var n,e,r,o,i,a=this,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:15e3,e=s.length>1&&void 0!==s[1]?s[1]:null,this.stopCurrentColorAnimations(),r=this.colorPalette,o=G(r[0],r[1],r[2]),i=o[0],t.n=1,new Promise(function(){var t=null,r=function(o){t||(t=o);var s=Math.min((o-t)/n,1),c=(i+s)%1;a.colorPalette=Z(c,1,.6),a.draw(),e&&e(),a.currentColorAnimationFrame=requestAnimationFrame(r)};a.currentColorAnimationFrame=requestAnimationFrame(r)});case 1:return t.a(2)}},t,this)})),function(){return b.apply(this,arguments)})},{key:"animatePanTo",value:(y=st(ot().m(function t(n){var e,r,o,i=this,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:200,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentPanAnimation(),this.markOrbitDirty(),!U(this.pan,n,6)){t.n=1;break}return t.a(2);case 1:return o=ut(this.pan),t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u),f=V(o[0],n[0],l),h=V(o[1],n[1],l);i.setPan(f,h),i.draw(),yo(!0),u<1?i.currentPanAnimationFrame=requestAnimationFrame(s):(i.markOrbitDirty(),i.draw(),i.stopCurrentPanAnimation(),i.onAnimationFinished(),t())};i.currentPanAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return y.apply(this,arguments)})},{key:"animatePanBy",value:(v=st(ot().m(function t(n){var e,r,o=this,i=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=i.length>1&&void 0!==i[1]?i[1]:200,r=i.length>2&&void 0!==i[2]?i[2]:a.NONE,this.stopCurrentPanAnimation(),this.markOrbitDirty(),!(Math.abs(n[0])<1e-30&&Math.abs(n[1])<1e-30)){t.n=1;break}return t.a(2);case 1:return t.n=2,new Promise(function(t){var i=null,a=0,s=function(c){i||(i=c);var u=Math.min((c-i)/e,1),l=r(u),f=l-a;a=l,0!==f&&o.addPan(n[0]*f,n[1]*f),o.draw(),yo(!0),u<1?o.currentPanAnimationFrame=requestAnimationFrame(s):(o.markOrbitDirty(),o.draw(),o.stopCurrentPanAnimation(),o.onAnimationFinished(),t())};o.currentPanAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return v.apply(this,arguments)})},{key:"animateZoomTo",value:(p=st(ot().m(function t(n){var e,r,o,i,s,c,u,l,f,h,m,d,p,v,y,b,g=this,_=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=_.length>1&&void 0!==_[1]?_[1]:500,r=_.length>2&&void 0!==_[2]?_[2]:a.NONE,o=_.length>3&&void 0!==_[3]?_[3]:null,i=_.length>4&&void 0!==_[4]?_[4]:null,this.stopCurrentZoomAnimation(),this.zoom.toFixed(20)!==n.toFixed(20)){t.n=1;break}return t.a(2);case 1:return null!==o&&null!==i||(s=this.getCanvasCssCenter(),c=ct(s,2),u=c[0],l=c[1],o=u,i=l),f=this.zoom,h=n/f,m=this.screenToViewVector(o,i),d=ct(m,2),p=d[0],v=d[1],y=p*f+this.pan[0],b=v*f+this.pan[1],this.markOrbitDirty(),t.n=2,new Promise(function(t){var o=null,i=function(s){o||(o=s);var c=Math.min((s-o)/e,1);if(r!==a.NONE){var u=r(c);g.zoom=f+(n-f)*u}else g.zoom=f*Math.pow(h,c);g.setPanFromAnchor(y,b,p,v),g.markOrbitDirty(),g.draw(),yo(!0),c<1?g.currentZoomAnimationFrame=requestAnimationFrame(i):(g.markOrbitDirty(),g.draw(),g.stopCurrentZoomAnimation(),g.onAnimationFinished(),t())};g.currentZoomAnimationFrame=requestAnimationFrame(i)});case 2:return t.a(2)}},t,this)})),function(t){return p.apply(this,arguments)})},{key:"animateZoomToNoPan",value:(m=st(ot().m(function t(n){var e,r,o,i=this,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentZoomAnimation(),this.markOrbitDirty(),this.zoom.toFixed(20)!==n.toFixed(20)){t.n=1;break}return t.a(2);case 1:return o=this.zoom,t.n=2,new Promise(function(t){var s=null,c=function(u){s||(s=u);var l=Math.min((u-s)/e,1);if(r!==a.NONE){var f=r(l);i.zoom=o+(n-o)*f}else i.zoom=o*Math.pow(n/o,l);i.draw(),yo(!0),l<1?i.currentZoomAnimationFrame=requestAnimationFrame(c):(i.markOrbitDirty(),i.draw(),i.stopCurrentZoomAnimation(),i.onAnimationFinished(),t())};i.currentZoomAnimationFrame=requestAnimationFrame(c)});case 2:return t.a(2)}},t,this)})),function(t){return m.apply(this,arguments)})},{key:"animateRotationTo",value:(h=st(ot().m(function t(n){var e,r,o,i=this,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.NONE,this.stopCurrentRotationAnimation(),n=J(n),this.rotation.toFixed(6)!==n.toFixed(6)){t.n=1;break}return t.a(2);case 1:return o=this.rotation,t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u);i.rotation=V(o,n,l),i.draw(),yo(!0),u<1?i.currentRotationAnimationFrame=requestAnimationFrame(s):(i.stopCurrentRotationAnimation(),i.onAnimationFinished(),t())};i.currentRotationAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(t){return h.apply(this,arguments)})},{key:"animatePanThenZoomTo",value:(f=st(ot().m(function t(n,e,r,o){var i,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:a.NONE,t.n=1,this.animatePanTo(n,r,i);case 1:return t.n=2,this.animateZoomTo(e,o,i);case 2:case 3:return t.a(2)}},t,this)})),function(t,n,e,r){return f.apply(this,arguments)})},{key:"animatePanAndZoomTo",value:(l=st(ot().m(function t(n,e){var r,o,i=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:1e3,o=i.length>3&&void 0!==i[3]?i[3]:a.NONE,t.n=1,Promise.all([this.animatePanTo(n,r,o),this.animateZoomToNoPan(e,r,o)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n){return l.apply(this,arguments)})},{key:"animateZoomRotationTo",value:(u=st(ot().m(function t(n,e){var r,o,i=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:500,o=i.length>3&&void 0!==i[3]?i[3]:a.NONE,t.n=1,Promise.all([this.animateZoomTo(n,r,o),this.animateRotationTo(e,r,a.CUBIC)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n){return u.apply(this,arguments)})},{key:"animatePanZoomRotationTo",value:(c=st(ot().m(function t(n,e,r){var o,i,s=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:500,i=s.length>4&&void 0!==s[4]?s[4]:a.NONE,t.n=1,Promise.all([this.animatePanTo(n,o,i),this.animateZoomToNoPan(e,o,i),this.animateRotationTo(r,o,i)]);case 1:case 2:return t.a(2)}},t,this)})),function(t,n,e){return c.apply(this,arguments)})},{key:"animateInfiniteRotation",value:(s=st(ot().m(function t(n){var e,r,o=this,i=arguments;return ot().w(function(t){for(;;)switch(t.n){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:.001,this.stopCurrentRotationAnimation(),r=n>=0?1:-1,t.n=1,new Promise(function(){var t=function(){o.rotation=J(o.rotation+r*e+2*d),o.draw(),yo(!0),o.currentRotationAnimationFrame=requestAnimationFrame(t)};o.currentRotationAnimationFrame=requestAnimationFrame(t)});case 1:case 2:return t.a(2)}},t,this)})),function(t){return s.apply(this,arguments)})}],r&&ht(e.prototype,r),i&&ht(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,s,c,u,l,f,h,m,p,v,y,b,g}(et);const _t=gt,Tt=JSON.parse('{"v4":[{"c":[-0.8,0.156],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Default"},{"c":[-0.7269,0.1889],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Seahorses"},{"c":[0.34,-0.05],"zoom":3.5,"rotation":90,"pan":[0,0],"title":"Spiral Galaxies"},{"c":[0.285,0.01],"zoom":3.5,"rotation":90,"pan":[-0.01,0.01],"title":"Near Julia Border"},{"c":[-1.76733,0.00002],"zoom":0.5,"rotation":0,"pan":[0,0],"title":"Mandelbrothers"},{"c":[-0.4,0.6],"zoom":3.5,"rotation":120,"pan":[0,0],"title":"Black Holes"},{"c":[-0.70176,-0.3842],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Dancing Snowflakes"},{"c":[-0.835,-0.232],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Kissing Dragons"},{"c":[-0.75,0.1],"zoom":3.5,"rotation":150,"pan":[0,0],"title":"Main Cardioid"},{"c":[-0.744539860355905,0.121723773894425],"zoom":1.8,"rotation":30,"pan":[0,0],"title":"Seahorse Valley"},{"c":[-1.74876455,0],"zoom":0.45,"rotation":90,"pan":[0,0],"title":"Cauliflower Medallion"},{"c":[-0.1060055299522249,0.9257297130853293],"rotation":340,"pan":[0,0],"zoom":0.11,"title":"Mitochondria"},{"c":[-0.7500162952792153,0.0032826017747574765],"zoom":1.7,"rotation":0,"pan":[0,0],"title":"Clown"},{"c":[-0.12129038469447653,0.649576297434808],"pan":[0.1045565992379065,0.0073015054986378],"rotation":313.6,"zoom":1.6581189769919353,"title":"Mandebulbs"},{"c":[-0.1,0.651],"zoom":3.5,"rotation":90,"pan":[0,0],"title":"Elephants"},{"c":[-1.25066,0.02012],"zoom":3.5,"rotation":0,"pan":[0,0],"title":"Deep zoom"},{"c":[-1.768967328653661,0.0019446820495425676],"pan":[0,0],"rotation":0,"zoom":0.2589096374896196,"title":"Serpent"},{"c":[0.3072075408559901,0.48395526205533185],"pan":[0,0],"rotation":310.15,"zoom":2.1068875547385417,"title":"Misiurewicz Point"},{"c":[-0.5925376099331446,0.6218581017272109],"pan":[0,0],"rotation":135.8,"zoom":0.12255613179332117,"title":"Brain"},{"c":[-1.768927341692215,-0.009640117346988308],"pan":[0,0],"rotation":0,"zoom":0.29302566239489597,"title":"Flowers"},{"c":[0.3633977303405407,0.3166912692104581],"pan":[0.12908510596292824,-0.13588306846615342],"rotation":97.4,"zoom":0.12982442828873209,"title":"Black Holes"},{"c":[0.3586059096423313,0.32287599414730545],"pan":[0.10410036735673252,-0.10610085351477151],"rotation":278.6,"zoom":1.8513247913869684,"title":"Darkness"},{"c":[0.1294753560021048,0.6256313013048348],"pan":[0,0],"rotation":110.58,"zoom":1.322314018297482,"title":"Chromozome"}],"gf":[{"pan":[0,0],"rotation":0,"zoom":1.7,"startC":[-0.246,0.64],"step":0.000005,"cxDirection":1,"cyDirection":1,"endC":[-0.2298,0.67],"title":"Orbiting Black holes"},{"pan":[0,0],"startC":[-0.25190652273600045,0.637461568487061],"endC":[-0.2526,0.6355],"cxDirection":-1,"cyDirection":-1,"rotation":0,"zoom":0.05,"step":5e-8,"title":"Dimensional Collision"},{"pan":[-0.31106,0.3937],"rotation":85.9,"zoom":0.3829,"startC":[-0.2523,0.6386],"step":0.00001,"cxDirection":-1,"cyDirection":-1,"endC":[-0.335,0.62],"title":"Life of a Star"},{"pan":[-0.6838,0.4699],"rotation":0,"zoom":0.0447,"startC":[-0.246,0.6427],"step":5e-7,"cxDirection":-1,"cyDirection":-1,"endC":[-0.247,0.638],"title":"Tipping points"},{"pan":[0.516,-0.0541],"rotation":150,"zoom":0.1107,"startC":[-0.78,0.11],"step":0.00001,"cxDirection":1,"cyDirection":1,"endC":[-0.7425,0.25],"title":"Hypnosis"}],"BG":[{"id":"Cosmos","keyColor":"#fefe66","theme":[0,0,0,1,0.647,0,0,0,0,1.2,1.2,1,0.1,0.1,0.1]},{"id":"Blue Mist","keyColor":"#4c4cb3","theme":[0,0,0,1,0.647,0,1,1,1,0,0,1,0,0,0.5]},{"id":"Fire","keyColor":"#663300","theme":[0.4,0.2,0,1,0.565,0.039,0.2,0,0,0.8,0.7,0,0.192,0.176,0.016]},{"id":"Ocean","keyColor":"#0F52BA","theme":[0.902,0.953,1,0.192,0.553,0.698,0,0.051,0.102,0.016,0.412,0.592,0,0.157,0.302]},{"id":"Forest","keyColor":"#25591f","theme":[0.506,0.549,0.235,0.537,0.349,0.122,0.176,0.086,0.024,0.098,0.349,0.051,0,0.082,0]}]}');function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function At(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Et(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(Et(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Et(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Et(f,"constructor",u),Et(u,"constructor",c),c.displayName="GeneratorFunction",Et(u,o,"GeneratorFunction"),Et(f),Et(f,o,"Generator"),Et(f,r,function(){return this}),Et(f,"toString",function(){return"[object Generator]"}),(At=function(){return{w:i,m:h}})()}function Et(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Et=function(t,n,e,r){function i(n,e){Et(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Et(t,n,e,r)}function xt(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function Pt(t){return function(t){if(Array.isArray(t))return St(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return St(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?St(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function Dt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lt(r.key),r)}}function Lt(t){var n=function(t,n){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==wt(n)?n:n+""}function Ot(t,n,e){return n=Ft(n),function(t,n){if(n&&("object"==wt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,kt()?Reflect.construct(n,e||[],Ft(t).constructor):n.apply(t,e))}function kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(kt=function(){return!!t})()}function Ct(t,n,e,r){var o=Rt(Ft(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function Rt(){return Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Ft(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},Rt.apply(null,arguments)}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}function zt(t,n){return zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},zt(t,n)}var Mt=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Ot(this,n,[t])).MAX_ITER=500,e.extraIterations=0,e.DEFAULT_ZOOM=2.5,e.DEFAULT_C=[-.246,.64235],e.zoom=e.DEFAULT_ZOOM,e.pan=Pt(e.DEFAULT_PAN),e.rotation=e.DEFAULT_ROTATION,e.DEFAULT_PALETTE=Tt.BG[0].theme||f.theme,e.colorPalette=Pt(e.DEFAULT_PALETTE),e.c=Pt(e.DEFAULT_C),e.PRESETS=[],e.DIVES=[],e.innerStops=new Float32Array(e.DEFAULT_PALETTE),e.currentCAnimationFrame=null,e.demoTime=0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&zt(t,n)}(n,t),e=n,r=[{key:"createFragmentShaderSource",value:function(){return'/*\r\n * Julia Fragment Shader (Legacy, for preview purposes)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n *\r\n * @description\r\n * Julia set basic implementation in mediump float precision\r\n *\r\n * @license   MIT\r\n */\r\n\r\n\r\n#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\r\n\r\n// Uniforms\r\nuniform vec2 u_resolution;// Canvas resolution in pixels\r\nuniform vec2 u_pan;// Pan offset in fractal space\r\nuniform float u_zoom;// Zoom factor\r\nuniform float u_iterations;// For normalizing the smooth iteration count\r\nuniform float u_rotation;// Rotation (in radians)\r\nuniform vec2 u_c;// Julia set constant\r\nuniform vec3 u_colorPalette;// Color palette\r\nuniform vec3 u_innerStops[5];// Color palette inner stops\r\n\r\n// Maximum iterations (compile-time constant required by GLSL ES 1.00).\r\nconst int MAX_ITERATIONS = __MAX_ITER__;\r\n\r\n// Define color stops as individual constants (RGB values in [0,1]).\r\n// Default stops (black, orange, white, blue, dark blue).\r\n\r\n// Interpolates between the five color stops.\r\n// 5 stops = 4 segments.\r\nvec3 getColorFromMap(float t) {\r\n    float segment = 1.0 / 4.0;// 4 segments for 5 stops.\r\n    if (t <= segment) {\r\n        return mix(u_innerStops[0], u_innerStops[1], t / segment);\r\n    } else if (t <= 2.0 * segment) {\r\n        return mix(u_innerStops[1], u_innerStops[2], (t - segment) / segment);\r\n    } else if (t <= 3.0 * segment) {\r\n        return mix(u_innerStops[2], u_innerStops[3], (t - 2.0 * segment) / segment);\r\n    } else {\r\n        return mix(u_innerStops[3], u_innerStops[4], (t - 3.0 * segment) / segment);\r\n    }\r\n}\r\n\r\nvoid main() {\r\n    // Map fragment coordinates to normalized device coordinates\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;// center at (0,0)\r\n    st.x *= aspect;// adjust x for aspect ratio\r\n\r\n    // Apply rotation\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 rotated = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    // Map screen coordinates to Julia space\r\n    vec2 z = rotated * u_zoom + u_pan;\r\n\r\n    // Determine escape iterations\r\n    int iterCount = MAX_ITERATIONS;\r\n    for (int i = 0; i < MAX_ITERATIONS; i++) {\r\n        if (dot(z, z) > 4.0) {\r\n            iterCount = i;\r\n            break;\r\n        }\r\n        // Julia set iteration.\r\n        z = vec2(z.x*z.x - z.y*z.y, 2.0*z.x*z.y) + u_c;\r\n    }\r\n\r\n    // If the point never escaped, render as simple color\r\n    if (iterCount == MAX_ITERATIONS) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        // Compute a smooth iteration value\r\n        float smoothColor = float(iterCount) - log2(log2(dot(z, z)));\r\n        float t = clamp(smoothColor / u_iterations, 0.0, 1.0);\r\n\r\n        // Apply a sine modulation to mimic the "sine" color mapping effect\r\n        // Frequency: 4Ï€\r\n        t = 0.5 + 0.6 * sin(t * 4.0 * 3.14159265);\r\n\r\n        // Lookup the color from the map\r\n        vec3 col = getColorFromMap(t);\r\n\r\n        // Use the user-defined color palette as a tint\r\n        // col *= u_colorPalette;\r\n\r\n        gl_FragColor = vec4(col, 1.0);\r\n    }\r\n}'.replace("__MAX_ITER__",this.MAX_ITER).toString()}},{key:"updateUniforms",value:function(){Ct(n,"updateUniforms",this,3)([]),this.cLoc=this.gl.getUniformLocation(this.program,"u_c"),this.innerStopsLoc=this.gl.getUniformLocation(this.program,"u_innerStops")}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.floor(3e3*Math.pow(2,-Math.log2(this.zoom)));this.iterations=Math.min(2e3,t+this.extraIterations),this.gl.uniform2fv(this.cLoc,this.c),this.gl.uniform3fv(this.innerStopsLoc,this.innerStops),Ct(n,"draw",this,3)([])}},{key:"reset",value:function(){this.c=Pt(this.DEFAULT_C),this.colorPalette=Pt(this.DEFAULT_PALETTE),this.innerStops=new Float32Array(this.colorPalette),this.extraIterations=0,this.draw()}},{key:"animateColorPaletteTransition",value:(i=At().m(function t(n){var e,r=arguments;return At().w(function(t){for(;;)switch(t.n){case 0:if(e=r.length>2&&void 0!==r[2]?r[2]:null,n){t.n=1;break}return t.a(2,Promise.resolve());case 1:return this.innerStops=new Float32Array(n),this.colorPalette=[1.5*n[9],1.5*n[10],1.5*n[11]],this.draw(),e&&e(),t.a(2,Promise.resolve())}},t,this)}),a=function(){var t=this,n=arguments;return new Promise(function(e,r){var o=i.apply(t,n);function a(t){xt(o,e,r,a,s,"next",t)}function s(t){xt(o,e,r,a,s,"throw",t)}a(void 0)})},function(t){return a.apply(this,arguments)})},{key:"needsRebase",value:function(){return!1}},{key:"onProgramCreated",value:function(){}}],r&&Dt(e.prototype,r),o&&Dt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,i,a}(_t),It=null,Nt=null,jt=!1,Ut=null,Bt=250,Xt=200;function Zt(){(It=document.getElementById("floatingCanvas"))&&(It.width=Bt*window.devicePixelRatio,It.height=Xt*window.devicePixelRatio,It.style.width="".concat(Bt,"px"),It.style.height="".concat(Xt,"px"))}function Gt(t,n){if(It){var e=window.innerWidth,r=window.innerHeight,o=t+20,i=n+20;o+Bt>e&&(o=t-Bt-20),i+Xt>r&&(i=n-Xt-20),o=Math.max(0,Math.min(o,e-Bt)),i=Math.max(0,Math.min(i,r-Xt)),It.style.left="".concat(o,"px"),It.style.top="".concat(i,"px")}}function Ht(){jt&&(jt=!1,It&&(It.style.display="none"))}function Vt(t){if(t&&!(t.length<3)){var n=new Float32Array([0,0,0,t[0],t[1],t[2],0,0,0,1.2*t[0],1.2*t[1],1.2*t[2],.1,.1,.1]);Nt?Nt.animateColorPaletteTransition(n).then():Ut=n}}function qt(){Nt&&Nt.reset()}function Jt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Wt(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Wt(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var Kt,Yt,Qt,$t,tn,nn,en,rn=300,on=.05,an=!1,sn=0,cn=0,un=0,ln=0,fn=null,hn=null,mn=!1,dn=!1,pn=!1,vn=0,yn=!1,bn=0,gn=0,_n=!1,Tn=0,wn=0,An=0,En=null,xn=0,Pn=0,Sn=!1;function Dn(){Yt&&"function"==typeof Yt.markOrbitDirty&&Yt.markOrbitDirty()}function Ln(t){Yt=t,(Kt=t.canvas).addEventListener("contextmenu",function(t){return t.preventDefault()}),Zt(),On()}function On(){an||(Qt=function(t){return function(t){if(t.preventDefault(),!Sn){var n=Yt.canvas.getBoundingClientRect();xn=n.left,Pn=n.top,Sn=!0}Tn+=t.deltaY,wn=t.clientX,An=t.clientY,En||(En=requestAnimationFrame(Cn));hn&&clearTimeout(hn);hn=setTimeout(function(){Sn=!1,vo()},150),Yt.noteInteraction(160)}(t)},$t=function(t){return function(t){if(0===t.button){mn=!1,sn=t.clientX,cn=t.clientY,un=t.clientX,ln=t.clientY;var n=Kt.getBoundingClientRect();bn=n.left,gn=n.top,_n=!0}else if(2===t.button)vn=t.clientX;else if(1===t.button&&(t.preventDefault(),!uo())){yn=!0;var e=Kt.getBoundingClientRect(),r=t.clientX-e.left,o=t.clientY-e.top,i=Jt(Yt.screenToFractal(r,o),2),a=i[0],s=i[1];c=t.clientX,u=t.clientY,l=a,f=s,It||Zt(),Nt||((Nt=new Mt(It)).MAX_ITER=500,Nt.extraIterations=0,Ut&&(Nt.innerStops=Ut,Ut=null)),Nt.c=[l,f],Nt.markOrbitDirty(),Gt(c,u),It.style.display="block",jt=!0,Nt.draw()}var c,u,l,f}(t)},tn=function(t){return function(t){var n=t.clientX-sn,e=t.clientY-cn;if(1===t.buttons&&(!mn&&(Math.abs(n)>5||Math.abs(e)>5)&&(mn=!0),mn)){Kt.style.cursor="move",fn&&(clearTimeout(fn),fn=null);var r=bn,o=gn;if(!_n){var i=Kt.getBoundingClientRect();r=i.left,o=i.top}var a=un-r,s=ln-o,c=t.clientX-r,u=t.clientY-o,l=Jt(Yt.screenToViewVector(a,s),2),f=l[0],h=l[1],m=Jt(Yt.screenToViewVector(c,u),2),d=m[0],p=m[1];if(Number.isFinite(Yt.zoom)){var v=(f-d)*Yt.zoom,y=(h-p)*Yt.zoom;Yt.addPan(v,y),Dn(),Yt.noteInteraction(160)}un=t.clientX,ln=t.clientY,Yt.draw(),yo(!0)}if(2===t.buttons&&(!pn&&(Math.abs(n)>5||Math.abs(e)>5)&&(pn=!0),pn)){t.preventDefault();var b=t.clientX-vn;Yt.rotation=J(Yt.rotation+.01*b),Yt.draw(),vn=t.clientX,dn=!0,Kt.style.cursor="grabbing",yo()}if(4===t.buttons&&yn&&!uo()){var g=Kt.getBoundingClientRect(),_=t.clientX-g.left,T=t.clientY-g.top,w=Jt(Yt.screenToFractal(_,T),2),A=w[0],E=w[1];x=t.clientX,P=t.clientY,S=A,D=E,jt&&Nt&&(Nt.c=[S,D],Nt.markOrbitDirty(),Gt(x,P),Nt.draw())}var x,P,S,D}(t)},nn=function(t){return function(t){if(![0,1,2].includes(t.button))return;if(t.preventDefault(),t.stopPropagation(),1===t.button)return void(yn&&(yn=!1,Ht()));if(0===t.button)if(_n=!1,mn)vo(),mn=!1,Dn(),Yt.draw();else{var n=Kt.getBoundingClientRect(),e=t.clientX-n.left,r=t.clientY-n.top,o=Jt(Yt.screenToFractal(e,r),2),s=o[0],c=o[1];if(null!==fn){clearTimeout(fn),fn=null;var u=Yt.zoom*on;u>Yt.MAX_ZOOM&&Yt.animatePanAndZoomTo([s,c],u,1e3,a.QUINT).then(vo)}else fn=setTimeout(function(){Yt.animatePanTo([s,c],500).then(function(){vo(),uo()?A(i.JULIA,s,c,Yt.zoom,Yt.rotation,Yt.c[0],Yt.c[1]):A(i.MANDELBROT,s,c,Yt.zoom,Yt.rotation)}),navigator.clipboard.writeText(window.location.href).then(function(){},function(t){}),fn=null},rn)}if(2===t.button){if(pn)return pn=!1,dn&&vo(),dn=!1,void(Kt.style.cursor="crosshair");var l=Kt.getBoundingClientRect(),f=t.clientX-l.left,h=t.clientY-l.top,m=Jt(Yt.screenToFractal(f,h),2),d=m[0],p=m[1];if(null!==fn){clearTimeout(fn),fn=null;var v=Yt.zoom/on;v<Yt.MIN_ZOOM&&Yt.animatePanAndZoomTo([d,p],v,1e3,a.QUINT).then(vo)}else fn=setTimeout(function(){fn=null},rn);pn=!1}Kt.style.cursor="crosshair"}(t)},en=function(){yn&&(yn=!1,Ht())},Kt.addEventListener("wheel",Qt,{passive:!1}),Kt.addEventListener("mousedown",$t),Kt.addEventListener("mousemove",tn),Kt.addEventListener("mouseup",nn),Kt.addEventListener("mouseleave",en),an=!0)}function kn(){an&&(Kt.removeEventListener("wheel",Qt,{passive:!1}),Kt.removeEventListener("mousedown",$t),Kt.removeEventListener("mousemove",tn),Kt.removeEventListener("mouseup",nn),Kt.removeEventListener("mouseleave",en),an=!1)}function Cn(){if(En=null,Yt&&Number.isFinite(Yt.zoom)){var t=wn-xn,n=An-Pn,e=Math.pow(1.1,Tn/120),r=Yt.zoom*e;Tn=0,r<Yt.MAX_ZOOM||r>Yt.MIN_ZOOM||(Yt.setZoomKeepingAnchor(r,t,n),Dn(),yo(!0),Yt.draw())}}function Rn(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Fn(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Fn(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var zn,Mn,In,Nn,jn,Un=!1,Bn=0,Xn=0,Zn=0,Gn=0,Hn=null,Vn=!1,qn=0,Jn=0,Wn=!1,Kn=!1,Yn=null,Qn=null;function $n(){Mn&&"function"==typeof Mn.markOrbitDirty&&Mn.markOrbitDirty()}function te(t){t&&t.canvas&&(Mn=t,(zn=t.canvas).addEventListener("contextmenu",function(t){return t.preventDefault()}),ne())}function ne(){zn&&(Un||(In=function(t){return function(t){if(!Mn)return;if(1===t.touches.length){t.preventDefault(),Vn=!1,Kn=!1,Yn=null,Qn=null;var n=t.touches[0];Bn=n.clientX,Xn=n.clientY,Zn=n.clientX,Gn=n.clientY;var e=zn.getBoundingClientRect();return qn=e.left,Jn=e.top,void(Wn=!0)}if(2===t.touches.length){t.preventDefault(),Kn=!0,Vn=!1,Wn=!1;var r=t.touches[0],o=t.touches[1];Yn=Math.hypot(r.clientX-o.clientX,r.clientY-o.clientY),Qn=Math.atan2(o.clientY-r.clientY,o.clientX-r.clientX),Hn&&(clearTimeout(Hn),Hn=null),Mn.noteInteraction(160)}}(t)},Nn=function(t){return function(t){if(!Mn)return;if(1===t.touches.length&&!Kn){t.preventDefault();var n=t.touches[0],e=n.clientX-Bn,r=n.clientY-Xn;if(!Vn&&(Math.abs(e)>5||Math.abs(r)>5)&&(Vn=!0,Hn&&(clearTimeout(Hn),Hn=null)),Vn){var o=qn,i=Jn;if(!Wn){var a=zn.getBoundingClientRect();o=a.left,i=a.top}var s=Zn-o,c=Gn-i,u=n.clientX-o,l=n.clientY-i,f=Rn(Mn.screenToViewVector(s,c),2),h=f[0],m=f[1],d=Rn(Mn.screenToViewVector(u,l),2),p=d[0],v=d[1];if(Number.isFinite(Mn.zoom)){var y=(h-p)*Mn.zoom,b=(m-v)*Mn.zoom;Mn.addPan(y,b),$n(),Mn.noteInteraction(160)}Zn=n.clientX,Gn=n.clientY,Mn.draw(),yo(!0)}return}if(2===t.touches.length){t.preventDefault(),Kn=!0;var g=t.touches[0],_=t.touches[1],T=Math.hypot(g.clientX-_.clientX,g.clientY-_.clientY),w=Math.atan2(_.clientY-g.clientY,_.clientX-g.clientX),A=(g.clientX+_.clientX)/2,E=(g.clientY+_.clientY)/2,x=zn.getBoundingClientRect(),P=A-x.left,S=E-x.top;if(!Yn||!Qn)return Yn=T,void(Qn=w);var D=Mn.zoom;if(T>0){var L=Yn/T;D=Mn.zoom*L}D<Mn.MAX_ZOOM&&(D=Mn.MAX_ZOOM),D>Mn.MIN_ZOOM&&(D=Mn.MIN_ZOOM),Mn.setZoomKeepingAnchor(D,P,S);var O=w-Qn;Math.abs(O)>.05&&(Mn.rotation=J(Mn.rotation+1*O)),Yn=T,Qn=w,$n(),Mn.noteInteraction(160),Mn.draw(),yo()}}(t)},jn=function(t){return function(t){if(!Mn)return;t.touches.length<2&&(Yn=null,Qn=null);if(0===t.touches.length){if(Kn)return Kn=!1,vo(),$n(),void Mn.draw();if(Wn=!1,Vn)vo(),Vn=!1,$n(),Mn.draw();else{var n=t.changedTouches[0],e=zn.getBoundingClientRect(),r=n.clientX-e.left,o=n.clientY-e.top,a=Rn(Mn.screenToFractal(r,o),2),s=a[0],c=a[1];if(null!==Hn){clearTimeout(Hn),Hn=null;var u=.05*Mn.zoom;u>Mn.MAX_ZOOM&&Mn.animatePanAndZoomTo([s,c],u).then(vo)}else Hn=setTimeout(function(){Mn.animatePanTo([s,c],400).then(function(){vo(),uo()?A(i.JULIA,s,c,Mn.zoom,Mn.rotation,Mn.c[0],Mn.c[1]):A(i.MANDELBROT,s,c,Mn.zoom,Mn.rotation)}),Hn=null},300)}Vn=!1}}(t)},zn.addEventListener("touchstart",In,{passive:!1}),zn.addEventListener("touchmove",Nn,{passive:!1}),zn.addEventListener("touchend",jn,{passive:!1}),Un=!0))}function ee(){zn&&Un&&(zn.removeEventListener("touchstart",In,{passive:!1}),zn.removeEventListener("touchmove",Nn,{passive:!1}),zn.removeEventListener("touchend",jn,{passive:!1}),Un=!1)}function re(t,n,e){n.draw();var r=document.createElement("canvas");r.width=t.width,r.height=t.height;var o=r.getContext("2d");if(o){o.drawImage(t,0,0);var i=function(t){var n=uo()?"Julia":"Mandelbrot";return"Created by ".concat("Synaptory Fractal Traveler"," (").concat(n,": ")+"p=".concat(D(t.pan.slice(),6),", zoom=").concat(t.zoom.toExponential(2))+"".concat(t instanceof Ai?", c=".concat(D(t.c),")"):")")}(n);o.font="".concat(12,"px sans-serif"),o.textAlign="center",o.textBaseline="middle";var a=o.measureText(i).width+12+2,s=r.width-a-6,c=r.height-26-6;o.fillStyle="rgba(0, 0, 0, 0.7)",function(t,n,e,r,o,i){t.beginPath(),t.moveTo(n+i,e),t.lineTo(n+r-i,e),t.quadraticCurveTo(n+r,e,n+r,e+i),t.lineTo(n+r,e+o-i),t.quadraticCurveTo(n+r,e+o,n+r-i,e+o),t.lineTo(n+i,e+o),t.quadraticCurveTo(n,e+o,n,e+o-i),t.lineTo(n,e+i),t.quadraticCurveTo(n,e,n+i,e),t.closePath()}(o,s,c,a,26,8),o.fill();var u=s+a/2,l=c+13+1;o.fillStyle=e,o.fillText(i,u,l);var f,h,m=document.createElement("a");m.setAttribute("download",(f=new Date,h=function(t){return String(t).padStart(2,"0")},"fractal-".concat(f.getFullYear(),"-").concat(h(f.getMonth()+1),"-").concat(h(f.getDate()),"_").concat(h(f.getHours()),"-").concat(h(f.getMinutes()),"-").concat(h(f.getSeconds()),".jpg"))),m.setAttribute("href",r.toDataURL("image/jpeg",.95)),m.click()}}function oe(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ie(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(ie(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ie(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ie(f,"constructor",u),ie(u,"constructor",c),c.displayName="GeneratorFunction",ie(u,o,"GeneratorFunction"),ie(f),ie(f,o,"Generator"),ie(f,r,function(){return this}),ie(f,"toString",function(){return"[object Generator]"}),(oe=function(){return{w:i,m:h}})()}function ie(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ie=function(t,n,e,r){function i(n,e){ie(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},ie(t,n,e,r)}function ae(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}var se,ce=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Space","KeyQ","KeyW"],ue=.1,le=.01,fe=5e-4,he=.1,me=!1,de=!1;function pe(t){return ve.apply(this,arguments)}function ve(){var t;return t=oe().m(function t(r){var a,u,l,f,m,d,p,v,y,b,g,_,T,w,A,E,x,P,S,D,L,O,k;return oe().w(function(t){for(;;)switch(t.n){case 0:if(u=r.target,l=null==u||null===(a=u.tagName)||void 0===a?void 0:a.toLowerCase(),!u||"input"!==l&&"textarea"!==l&&"select"!==l&&!u.isContentEditable){t.n=1;break}return t.a(2);case 1:if(f=!1,m=r.shiftKey?.01:.1,d=c,p=0,v=0,y=0,b=0,g=r.altKey||"Alt"===r.code,!bo()||!ce.includes(r.code)){t.n=2;break}return r.preventDefault(),t.a(2);case 2:k=r.code,t.n="KeyQ"===k?3:"KeyW"===k?4:"KeyE"===k?7:"KeyR"===k?8:"KeyL"===k?10:"KeyZ"===k?11:"KeyT"===k?14:"KeyA"===k?23:"KeyS"===k?24:"KeyD"===k?25:"KeyM"===k?27:"KeyN"===k?29:"ArrowLeft"===k?30:"ArrowRight"===k?31:"ArrowDown"===k?32:"ArrowUp"===k?33:"Space"===k?34:"Enter"===k?37:38;break;case 3:d=s;case 4:if(!me){t.n=5;break}se.stopCurrentRotationAnimation(),me=!1,t.n=6;break;case 5:return me=!0,t.n=6,se.animateInfiniteRotation(d,m);case 6:return f=!0,t.a(3,43);case 7:return Co(),f=!0,t.a(3,43);case 8:if(!r.shiftKey){t.n=9;break}return t.n=9,jo();case 9:return f=!0,t.a(3,43);case 10:return ko(),f=!0,t.a(3,43);case 11:t.n=12;break;case 12:return t.n=13,so(uo()?i.MANDELBROT:i.JULIA);case 13:return f=!0,t.a(3,43);case 14:if(!g){t.n=18;break}if(!(uo()&&(null===(_=se.PALETTES)||void 0===_?void 0:_.length)>0)){t.n=16;break}return t.n=15,se.applyPaletteByIndex(0,250,po);case 15:mo(),t.n=17;break;case 16:return t.n=17,se.animateColorPaletteTransition(h,250,po);case 17:t.n=22;break;case 18:if(!r.shiftKey){t.n=21;break}if(!se.currentColorAnimationFrame){t.n=19;break}return se.stopCurrentColorAnimations(),t.a(3,43);case 19:return t.n=20,se.animateFullColorSpaceCycle(uo()?1e4:15e3,po);case 20:t.n=22;break;case 21:return t.n=22,zo();case 22:return f=!0,t.a(3,43);case 23:return se.resizeCanvas(),f=!0,t.a(3,43);case 24:return r.shiftKey&&Io(),f=!0,t.a(3,43);case 25:return t.n=26,To();case 26:return f=!0,t.a(3,43);case 27:if(e!==n){t.n=28;break}return t.n=28,io(i.RIEMANN);case 28:return f=!0,t.a(3,43);case 29:return e&&(o("Analytic Extension toggled."),se.useAnalyticExtension=!se.useAnalyticExtension,se.draw()),f=!0,t.a(3,43);case 30:return p=g?0:-(r.shiftKey?le:ue),y=g?fe*(r.shiftKey?he:1):0,f=!0,t.a(3,43);case 31:return p=g?0:r.shiftKey?le:ue,y=g?fe*(r.shiftKey?-.1:-1):0,f=!0,t.a(3,43);case 32:return v=g?0:-(r.shiftKey?le:ue),b=g?fe*(r.shiftKey?-.1:-1):0,f=!0,t.a(3,43);case 33:return v=g?0:r.shiftKey?le:ue,b=g?fe*(r.shiftKey?he:1):0,f=!0,t.a(3,43);case 34:if(T=r.shiftKey?.01:.1,w=r.ctrlKey||g?1+T:1-T,!((A=se.zoom*w)>=se.MAX_ZOOM&&A<=se.MIN_ZOOM)){t.n=36;break}return t.n=35,se.animateZoomToNoPan(A,20);case 35:vo();case 36:return f=!0,t.a(3,43);case 37:return No(),f=!0,t.a(3,43);case 38:if(!(E=r.code.match(/^(Digit|Numpad)(\d)$/))){t.n=42;break}if(x=parseInt(E[2],0),!r.shiftKey||!uo()){t.n=40;break}return t.n=39,xo(se.DIVES,x);case 39:t.n=41;break;case 40:return t.n=41,Lo(se.PRESETS,x);case 41:f=!0;case 42:return t.a(3,43);case 43:if(!p&&!v){t.n=45;break}return P=se.rotation,S=p*se.zoom*Math.cos(P)-v*se.zoom*Math.sin(P),D=p*se.zoom*Math.sin(P)+v*se.zoom*Math.cos(P),t.n=44,se.animatePanBy([S,D],50);case 44:se.noteInteraction(160),vo();case 45:if(!y&&!b||!uo()){t.n=47;break}return L=y*se.zoom,O=b*se.zoom,t.n=46,se.animateToC([se.c[0]+L,se.c[1]+O],10);case 46:vo();case 47:f&&r.preventDefault();case 48:return t.a(2)}},t)}),ve=function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){ae(i,r,o,a,s,"next",t)}function s(t){ae(i,r,o,a,s,"throw",t)}a(void 0)})},ve.apply(this,arguments)}function ye(t){de||(se=t,document.addEventListener("keydown",pe),de=!0,o("Initialized.","initHotKeys"))}function be(){de&&(se=null,de=!1,document.removeEventListener("keydown",pe))}const ge=JSON.parse('{"v4":[{"id":0,"title":"Default","pan":[-0.5,0],"zoom":3,"rotation":0},{"id":1,"title":"Misiurewicz Point 1","speed":10,"pan":[0.3514237590525219,0.0638665598132929],"rotation":0,"zoom":3.0177077833226633e-16},{"id":2,"title":"Kaleidoscope Valley","speed":10,"pan":[0.2549996194371581,0.0005684340597555177],"rotation":0,"zoom":1.395817829563278e-17},{"id":3,"title":"Nova Core","speed":10,"pan":[0.11651278779150401,0.6625979215565223],"rotation":1.6016343574412808,"zoom":8.653283042641697e-15},{"id":4,"title":"Tentacles","speed":10,"pan":[-0.743644784243975,0.13182914354891018],"rotation":0.8749616210243012,"zoom":3.304183377903384e-10},{"id":5,"title":"Spiral","speed":10,"pan":[-0.7668654471115035,-0.10747310068867935],"rotation":1.5065924365935786,"zoom":2.266530562848193e-14},{"id":6,"title":"Eyes","speed":10,"pan":[-0.8535650370330192,-0.2107813458112579],"rotation":4.217344329507167,"zoom":2.3639582790335785e-22},{"id":7,"title":"Wormhole","speed":10,"pan":[0.3260010801403236,0.05090212275634712],"rotation":3.695917207994011,"zoom":3.610452343636546e-16},{"id":8,"title":"Tip of the Branch","speed":10,"pan":[-0.2281554936539617,1.1151425080399369],"rotation":5.574310838854462,"zoom":3.7267390083662553e-16},{"id":9,"title":"Rabbits","speed":10,"pan":[-0.12479143490517397,0.8403941246800949],"rotation":0.0026613829226800334,"zoom":1.147242954504696e-16},{"id":10,"title":"Devil\'s Eye","speed":10,"pan":[-1.999096112156626,-1.0944307204017597e-18],"rotation":0,"zoom":3.3682845781180966e-14},{"id":11,"title":"Misiurewicz Point 2","speed":10,"pan":[0.11650145207876453,-0.6635454379133249],"rotation":2.610174541746648,"zoom":3.493264360283514e-16},{"id":12,"title":"Julia Core","speed":10,"pan":[0.34763451415265645,0.644195943232777],"rotation":3.231857941193079,"zoom":3.8155588343004964e-13},{"id":13,"title":"Hyperspace","speed":20,"pan":[-0.164542165709372,1.0384395470826782],"rotation":0.8994343632012249,"zoom":2.349008199632514e-16},{"id":14,"title":"Microbrot","speed":10,"pan":[0.11654740401415453,-0.6636148998875822],"rotation":2.610174541746648,"zoom":1.0267582908408742e-7},{"id":15,"title":"Plasma Storm","speed":10,"pan":[0.2625017727522711,0.6113502800557138],"rotation":0.9088831624158438,"zoom":6.228752917993604e-14},{"id":16,"title":"Where the Math Ends","speed":10,"pan":[-1.9999991175876528,-3.194092143034014e-39],"rotation":0,"zoom":6.130263511531091e-36},{"id":17,"title":"Nucleus","speed":10,"pan":[0.11654740531325179,-0.6636149160665515],"rotation":0.42681868968169034,"zoom":2.318964706881093e-15},{"id":18,"title":"The Julia","speed":10,"pan":[-1.769582878493225,-0.00947401887333753],"rotation":5.155475788649225,"zoom":3.556856738712547e-18},{"id":19,"title":"Seahorse Valley","speed":10,"pan":[-0.7436399999999269,0.13182000000014288],"rotation":2.063121784131649,"zoom":4.2563398808307913e-13},{"id":20,"title":"Julia World","speed":10,"pan":[-0.5925376025591513,0.6218580534997632],"rotation":0,"zoom":2.1116123693585906e-15}],"BG":[]}');function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Te(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=i.call(e)).done)&&(s.push(r.value),s.length!==n);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,n)||Se(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ae(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(Ae(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ae(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ae(f,"constructor",u),Ae(u,"constructor",c),c.displayName="GeneratorFunction",Ae(u,o,"GeneratorFunction"),Ae(f),Ae(f,o,"Generator"),Ae(f,r,function(){return this}),Ae(f,"toString",function(){return"[object Generator]"}),(we=function(){return{w:i,m:h}})()}function Ae(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ae=function(t,n,e,r){function i(n,e){Ae(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Ae(t,n,e,r)}function Ee(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function xe(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){Ee(i,r,o,a,s,"next",t)}function s(t){Ee(i,r,o,a,s,"throw",t)}a(void 0)})}}function Pe(t){return function(t){if(Array.isArray(t))return De(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Se(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(t,n){if(t){if("string"==typeof t)return De(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?De(t,n):void 0}}function De(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function Le(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Me(r.key),r)}}function Oe(t,n,e){return n=Fe(n),function(t,n){if(n&&("object"==_e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ke()?Reflect.construct(n,e||[],Fe(t).constructor):n.apply(t,e))}function ke(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ke=function(){return!!t})()}function Ce(t,n,e,r){var o=Re(Fe(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function Re(){return Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Fe(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},Re.apply(null,arguments)}function Fe(t){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(t)}function ze(t,n){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},ze(t,n)}function Me(t){var n=function(t,n){if("object"!=_e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=_e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==_e(n)?n:n+""}var Ie=function(t){function n(t){var e,r,o,i;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),e=Oe(this,n,[t]),r=e,i=function(){return e.orbitDirty=!0},(o=Me(o="markOrbitDirty"))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,e.DEFAULT_PAN=[-.5,0],e.setPan(e.DEFAULT_PAN[0],e.DEFAULT_PAN[1]),e.refPan=Pe(e.DEFAULT_PAN),e.refPanDD={x:{hi:e.DEFAULT_PAN[0],lo:0},y:{hi:e.DEFAULT_PAN[1],lo:0}},e.orbitDirty=!0,e.MAX_ITER=5e3,e.REF_SEARCH_GRID=7,e.REF_SEARCH_RADIUS=.5,e.rebaseArmed=!0,e.orbitTex=null,e.orbitData=null,e.floatTexExt=null,e.PRESETS=ge.v4,e.PALETTES=ge.BG||[],e.currentPaletteIndex=-1,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ze(t,n)}(n,t),e=n,r=[{key:"onProgramCreated",value:function(){this.floatTexExt=this.gl.getExtension("OES_texture_float"),this.floatTexExt&&(this.orbitTex=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.orbitData=new Float32Array(4*this.MAX_ITER),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER),this.orbitDirty=!0)}},{key:"createFragmentShaderSource",value:function(){return"/*\r\n * Mandelbrot Fragment Shader (Rebased Perturbation)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n * @description\r\n * High-precision Mandelbrot implementation using Double-Float (df) arithmetic.\r\n * Implements perturbation: dz_{n+1} = 2*zref*dz + dz^2 + dc.\r\n * Requires OES_texture_float for orbit reference sampling.\r\n *\r\n * @license   MIT\r\n */\r\n\r\nprecision highp float;\r\n\r\nuniform vec2 u_resolution;\r\n\r\n// delta pan (viewPan - refPan) computed on JS side for float64 precision\r\nuniform vec2 u_delta_pan_h;\r\nuniform vec2 u_delta_pan_l;\r\n\r\n// zoom (hi+lo)\r\nuniform float u_zoom_h;\r\nuniform float u_zoom_l;\r\n\r\nuniform float u_iterations;\r\nuniform vec3  u_colorPalette;\r\nuniform float u_rotation;\r\n\r\nuniform sampler2D u_orbitTex;\r\nuniform float u_orbitW;\r\n\r\nconst int MAX_ITER = __MAX_ITER__;\r\n\r\n// --- df helpers ---\r\nstruct df  { float hi; float lo; };\r\nstruct df2 { df x; df y; };\r\n\r\ndf df_make(float hi, float lo){ df a; a.hi=hi; a.lo=lo; return a; }\r\ndf df_from(float a){ return df_make(a, 0.0); }\r\nfloat df_to_float(df a){ return a.hi + a.lo; }\r\n\r\ndf twoSum(float a, float b) {\r\n    float s  = a + b;\r\n    float bb = s - a;\r\n    float err = (a - (s - bb)) + (b - bb);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf quickTwoSum(float a, float b) {\r\n    float s = a + b;\r\n    float err = b - (s - a);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf df_add(df a, df b) {\r\n    df s = twoSum(a.hi, b.hi);\r\n    float t = a.lo + b.lo;\r\n    df u = twoSum(s.lo, t);\r\n    df v = twoSum(s.hi, u.hi);\r\n    float lo = u.lo + v.lo;\r\n    return quickTwoSum(v.hi, lo);\r\n}\r\n\r\ndf df_sub(df a, df b) { return df_add(a, df_make(-b.hi, -b.lo)); }\r\n\r\nconst float SPLIT = 4097.0;\r\n\r\ndf twoProd(float a, float b) {\r\n    float p = a * b;\r\n\r\n    float aSplit = a * SPLIT;\r\n    float aHi = aSplit - (aSplit - a);\r\n    float aLo = a - aHi;\r\n\r\n    float bSplit = b * SPLIT;\r\n    float bHi = bSplit - (bSplit - b);\r\n    float bLo = b - bHi;\r\n\r\n    float err = ((aHi * bHi - p) + aHi * bLo + aLo * bHi) + aLo * bLo;\r\n    return df_make(p, err);\r\n}\r\n\r\ndf df_mul(df a, df b) {\r\n    df p = twoProd(a.hi, b.hi);\r\n    float err = a.hi * b.lo + a.lo * b.hi + a.lo * b.lo;\r\n    df s = twoSum(p.lo, err);\r\n    df r = twoSum(p.hi, s.hi);\r\n    float lo = s.lo + r.lo;\r\n    return quickTwoSum(r.hi, lo);\r\n}\r\n\r\ndf df_mul_f(df a, float b) { return df_mul(a, df_from(b)); }\r\n\r\ndf2 df2_make(df x, df y){ df2 r; r.x=x; r.y=y; return r; }\r\ndf2 df2_add(df2 a, df2 b){ return df2_make(df_add(a.x, b.x), df_add(a.y, b.y)); }\r\n\r\ndf2 df2_mul(df2 a, df2 b){\r\n    // (ax + i ay)(bx + i by) = (axbx - ayby) + i(axby + aybx)\r\n    df axbx = df_mul(a.x, b.x);\r\n    df ayby = df_mul(a.y, b.y);\r\n    df axby = df_mul(a.x, b.y);\r\n    df aybx = df_mul(a.y, b.x);\r\n    return df2_make(df_sub(axbx, ayby), df_add(axby, aybx));\r\n}\r\n\r\ndf2 df2_sqr(df2 a){\r\n    df xx = df_mul(a.x, a.x);\r\n    df yy = df_mul(a.y, a.y);\r\n    df xy = df_mul(a.x, a.y);\r\n    return df2_make(df_sub(xx, yy), df_mul_f(xy, 2.0));\r\n}\r\n\r\ndf2 sampleZRef(int n){\r\n    float x = (float(n) + 0.5) / u_orbitW;\r\n    vec4 t = texture2D(u_orbitTex, vec2(x, 0.5));\r\n    return df2_make(df_make(t.r, t.g), df_make(t.b, t.a));\r\n}\r\n\r\nvoid main() {\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;\r\n    st.x *= aspect;\r\n\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 r = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    df zoom = df_make(u_zoom_h, u_zoom_l);\r\n\r\n    // deltaPan = viewPan - refPan (computed on JS side with float64 precision)\r\n    df2 deltaPan = df2_make(\r\n        df_make(u_delta_pan_h.x, u_delta_pan_l.x),\r\n        df_make(u_delta_pan_h.y, u_delta_pan_l.y)\r\n    );\r\n\r\n    // dc = deltaPan + zoom * r\r\n    df2 dc = df2_make(df_mul_f(zoom, r.x), df_mul_f(zoom, r.y));\r\n    dc = df2_add(dc, deltaPan);\r\n\r\n    df2 dz = df2_make(df_from(0.0), df_from(0.0));\r\n\r\n    float it = 0.0;\r\n    float zx = 0.0;\r\n    float zy = 0.0;\r\n\r\n    for (int n = 0; n < MAX_ITER; n++) {\r\n        float fn = float(n);\r\n        if (fn >= u_iterations) { it = fn; break; }\r\n\r\n        df2 zref = sampleZRef(n);\r\n\r\n        // bailout approx using float\r\n        zx = df_to_float(zref.x) + df_to_float(dz.x);\r\n        zy = df_to_float(zref.y) + df_to_float(dz.y);\r\n        if (zx*zx + zy*zy > 4.0) { it = fn; break; }\r\n\r\n        // dz_{n+1} = 2*zref*dz + dz^2 + dc\r\n        df2 zref_dz = df2_mul(zref, dz);\r\n        zref_dz.x = df_mul_f(zref_dz.x, 2.0);\r\n        zref_dz.y = df_mul_f(zref_dz.y, 2.0);\r\n\r\n        df2 dz2 = df2_sqr(dz);\r\n\r\n        dz = df2_add(df2_add(zref_dz, dz2), dc);\r\n\r\n        if (n == MAX_ITER - 1) it = u_iterations;\r\n    }\r\n\r\n    if (it >= u_iterations) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        // Smooth coloring using |z|Â² for crisp edge detail\r\n        float r2 = max(zx*zx + zy*zy, 1e-30);\r\n        float smoothIt = it - log2(log2(r2));\r\n\r\n        // Sine-based coloring with smooth iteration\r\n        float color = smoothIt / 100.0;\r\n        vec3 fractalColor = vec3(\r\n            sin(color * 3.1415),\r\n            sin(color * 6.2830),\r\n            sin(color * 1.7200)\r\n        ) * u_colorPalette;\r\n\r\n        gl_FragColor = vec4(fractalColor, 1.0);\r\n    }\r\n}".replace("__MAX_ITER__",this.MAX_ITER).toString()}},{key:"updateUniforms",value:function(){Ce(n,"updateUniforms",this,3)([]),this.deltaPanHLoc=this.gl.getUniformLocation(this.program,"u_delta_pan_h"),this.deltaPanLLoc=this.gl.getUniformLocation(this.program,"u_delta_pan_l"),this.zoomHLoc=this.gl.getUniformLocation(this.program,"u_zoom_h"),this.zoomLLoc=this.gl.getUniformLocation(this.program,"u_zoom_l"),this.orbitTexLoc=this.gl.getUniformLocation(this.program,"u_orbitTex"),this.orbitWLoc=this.gl.getUniformLocation(this.program,"u_orbitW")}},{key:"escapeItersDouble",value:function(t,n,e){for(var r=0,o=0,i=0;i<e;i++){var a=2*r*o+n;if((r=r*r-o*o+t)*r+(o=a)*o>4)return i}return e}},{key:"pickReferenceNearViewCenter",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.refPan[0]=this.pan[0],this.refPan[1]=this.pan[1],this.refPanDD.x.hi=this.panDD.x.hi,this.refPanDD.x.lo=this.panDD.x.lo,this.refPanDD.y.hi=this.panDD.y.hi,void(this.refPanDD.y.lo=this.panDD.y.lo);var t=this.REF_SEARCH_GRID,n=(t-1)/2,e=2*this.REF_SEARCH_RADIUS/(t-1),r=this.zoom,o=Math.min(this.MAX_ITER,Math.max(200,Math.floor(this.iterations))),i=-1;Math.hypot(this.refPan[0]-this.pan[0],this.refPan[1]-this.pan[1])<r*this.REF_SEARCH_RADIUS*2.5&&(i=this.escapeItersDouble(this.refPan[0],this.refPan[1],o));for(var a=this.pan[0],s=this.pan[1],c=this.escapeItersDouble(this.pan[0],this.pan[1],o),u=0;u<t;u++)for(var l=0;l<t;l++){var f=(l-n)*e,h=(u-n)*e,m=this.pan[0]+f*r,d=this.pan[1]+h*r,p=this.escapeItersDouble(m,d,o);p>c&&(c=p,a=m,s=d)}var v=Math.max(.1*i,50);(i<0||c-i>v)&&(this.refPan[0]=a,this.refPan[1]=s,this.refPanDD.x.hi=a,this.refPanDD.x.lo=0,this.refPanDD.y.hi=s,this.refPanDD.y.lo=0),this.bestScore=c,this.probeIters=o}},{key:"computeReferenceOrbit",value:function(){if(this.orbitData&&this.orbitTex){for(var t=this.refPan[0],n=this.refPan[1],e=0,r=0,o=0;o<this.MAX_ITER;o++){var i=k(e),a=k(r),s=4*o;this.orbitData[s]=i.high,this.orbitData[s+1]=i.low,this.orbitData[s+2]=a.high,this.orbitData[s+3]=a.low;var c=2*e*r+n;if((e=e*e-r*r+t)*e+(r=c)*r>4){for(var u=k(e),l=k(r),f=o+1;f<this.MAX_ITER;f++){var h=4*f;this.orbitData[h]=u.high,this.orbitData[h+1]=u.low,this.orbitData[h+2]=l.high,this.orbitData[h+3]=l.low}break}}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.MAX_ITER,1,0,this.gl.RGBA,this.gl.FLOAT,this.orbitData),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER)}}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.max(this.zoom,1e-300),e=Math.log2(this.DEFAULT_ZOOM/t),r=Math.floor(200+50*e);this.iterations=Math.max(50,Math.min(this.MAX_ITER,r+this.extraIterations));var o=this.needsRebase(),i=!this.interactionActive||o;this.orbitDirty&&i&&(this.pickReferenceNearViewCenter(),this.computeReferenceOrbit(),this.orbitDirty=!1);var a=j(this.panDD.x,this.refPanDD.x),s=j(this.panDD.y,this.refPanDD.y);this.deltaPanHLoc&&this.gl.uniform2f(this.deltaPanHLoc,a.hi,s.hi),this.deltaPanLLoc&&this.gl.uniform2f(this.deltaPanLLoc,a.lo,s.lo);var c=k(this.zoom);this.zoomHLoc&&this.gl.uniform1f(this.zoomHLoc,c.high),this.zoomLLoc&&this.gl.uniform1f(this.zoomLLoc,c.low),Ce(n,"draw",this,3)([])}},{key:"needsRebase",value:function(){var t=this.pan[0]-this.refPan[0],n=this.pan[1]-this.refPan[1];return Math.hypot(t,n)>.75*this.zoom}},{key:"applyPaletteByIndex",value:(l=xe(we().m(function t(n){var e,r,o=arguments;return we().w(function(t){for(;;)switch(t.n){case 0:return e=o.length>1&&void 0!==o[1]?o[1]:250,r=o.length>2&&void 0!==o[2]?o[2]:null,this.currentPaletteIndex=n,t.n=1,this.animateColorPaletteTransition(null,e,r);case 1:return t.a(2)}},t,this)})),function(t){return l.apply(this,arguments)})},{key:"animateColorPaletteTransition",value:(u=xe(we().m(function t(e){var r,o,i,a,s,c=arguments;return we().w(function(t){for(;;)switch(t.n){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:250,o=c.length>2&&void 0!==c[2]?c[2]:null,i=function(t,n,e){return Math.max(n,Math.min(e,t))},a=function(t){var n,e,r;if(Array.isArray(t)){var o=Te(t,3);n=o[0],e=o[1],r=o[2]}else n=t.r,e=t.g,r=t.b;return(n>1||e>1||r>1)&&(n/=255,e/=255,r/=255),[n,e,r]},s=function(){var t=Math.random(),n=.85+.15*Math.random(),e=.9+.1*Math.random(),r=Te(a(X(t,n,e)),3),o=r[0],s=r[1],c=r[2];Math.max(o,s,c)-Math.min(o,s,c)<.25&&(o=i(1.15*o,0,1),s=i(1.15*s,0,1),c=i(1.15*c,0,1));var u=1.2+.5*Math.random(),l=.9+1.1*Math.random(),f=.25;return[u+(f+.75*o)*l,u+(f+.75*s)*l,u+(f+.75*c)*l]},e||(e=s()),t.n=1,Ce(n,"animateColorPaletteTransition",this,3)([e,r,o]);case 1:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"animateTravelToPreset",value:(c=xe(we().m(function t(n){var e,r,i,s,c,u,l,f,h,m,p,v,y,b,g=arguments;return we().w(function(t){for(;;)switch(t.n){case 0:if(r=g.length>1&&void 0!==g[1]?g[1]:2e3,i=g.length>2&&void 0!==g[2]?g[2]:1e3,s=g.length>3&&void 0!==g[3]?g[3]:3500,o("Traveling to preset: ".concat(JSON.stringify(n))),c=J(null!==(e=n.rotation)&&void 0!==e?e:this.DEFAULT_ROTATION),u=Math.abs(this.zoom-n.zoom)<1e-35,l=U(n.pan,this.pan),!u||!l){t.n=2;break}return t.n=1,this.animateRotationTo(c,r,a.QUINT);case 1:t.n=7;break;case 2:if(!l){t.n=4;break}return h=(Math.random()>.5?1:-1)*(2*d+Math.random()*d*2),m=c+h,t.n=3,this.animateZoomRotationTo(n.zoom,m,s*(null!==(f=n.speed)&&void 0!==f?f:1),a.QUINT);case 3:t.n=7;break;case 4:if(!(this.zoom<.9*this.DEFAULT_ZOOM)){t.n=5;break}return v=this.rotation+(Math.random()*d*2-d),t.n=5,this.animateZoomRotationTo(this.DEFAULT_ZOOM,v,r,a.QUINT);case 5:return t.n=6,this.animatePanTo(n.pan,i,a.CUBIC);case 6:return y=(Math.random()>.5?1:-1)*(2*d+Math.random()*d*2),b=c+y,t.n=7,this.animateZoomRotationTo(n.zoom,b,s*(null!==(p=n.speed)&&void 0!==p?p:1),a.NONE);case 7:this.currentPresetIndex=n.id||0;case 8:return t.a(2)}},t,this)})),function(t){return c.apply(this,arguments)})},{key:"animateDemo",value:(s=xe(we().m(function t(){var n,e,r,o=this,i=arguments;return we().w(function(t){for(;;)switch(t.n){case 0:if(n=!(i.length>0&&void 0!==i[0])||i[0],this.stopAllNonColorAnimations(),this.PRESETS.length){t.n=1;break}return t.a(2);case 1:this.demoActive=!0,e=function(t){if(t){var n;do{n=Math.floor(Math.random()*o.PRESETS.length)}while(n===o.currentPresetIndex||0===n);return n}var e=(o.currentPresetIndex+1)%o.PRESETS.length;return 0===e?1:e};case 2:if(!this.demoActive){t.n=5;break}return this.currentPresetIndex=e(n),r=this.PRESETS[this.currentPresetIndex],t.n=3,this.animateTravelToPreset(r,3e3,1e3,3e3);case 3:return t.n=4,K(3500);case 4:t.n=2;break;case 5:case 6:return t.a(2)}},t,this)})),function(){return s.apply(this,arguments)})}],r&&Le(e.prototype,r),i&&Le(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,s,c,u,l}(_t);const Ne=Ie;function je(t){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function Ue(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Be(r.key),r)}}function Be(t){var n=function(t,n){if("object"!=je(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==je(n)?n:n+""}function Xe(t,n,e){return n=Ve(n),function(t,n){if(n&&("object"==je(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ze()?Reflect.construct(n,e||[],Ve(t).constructor):n.apply(t,e))}function Ze(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ze=function(){return!!t})()}function Ge(t,n,e,r){var o=He(Ve(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function He(){return He="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=Ve(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},He.apply(null,arguments)}function Ve(t){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ve(t)}function qe(t,n){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},qe(t,n)}var Je=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Xe(this,n,[t])).termCount=1e4,e.MIN_ZOOM=4e3,e.useAnalyticExtension=!0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&qe(t,n)}(n,t),e=n,(r=[{key:"updateUniforms",value:function(){this.termCountLoc=this.gl.getUniformLocation(this.program,"u_termCount"),this.useAnalyticExtensionLoc=this.gl.getUniformLocation(this.program,"u_useAnalyticExtension"),Ge(n,"updateUniforms",this,3)([])}},{key:"draw",value:function(){this.gl.uniform1i(this.termCountLoc,this.termCount),this.gl.uniform1i(this.useAnalyticExtensionLoc,this.useAnalyticExtension?1:0),Ge(n,"draw",this,3)([])}},{key:"createFragmentShaderSource",value:function(){return"precision highp float;\r\n\r\nuniform vec2 u_resolution;\r\nuniform float u_zoom;\r\nuniform vec2 u_pan;\r\nuniform int u_termCount;\r\nuniform bool u_useAnalyticExtension;// Toggle for analytic extension\r\n\r\nconst float PI = 3.14159265359;\r\n\r\n// HSL to RGB conversion function.\r\nvec3 hsl2rgb(vec3 hsl) {\r\n    float h = hsl.x, s = hsl.y, l = hsl.z;\r\n    float c = (1.0 - abs(2.0 * l - 1.0)) * s;\r\n    float hprime = h * 6.0;\r\n    float x = c * (1.0 - abs(mod(hprime, 2.0) - 1.0));\r\n    vec3 rgb;\r\n    if (0.0 <= hprime && hprime < 1.0) {\r\n        rgb = vec3(c, x, 0.0);\r\n    } else if (1.0 <= hprime && hprime < 2.0) {\r\n        rgb = vec3(x, c, 0.0);\r\n    } else if (2.0 <= hprime && hprime < 3.0) {\r\n        rgb = vec3(0.0, c, x);\r\n    } else if (3.0 <= hprime && hprime < 4.0) {\r\n        rgb = vec3(0.0, x, c);\r\n    } else if (4.0 <= hprime && hprime < 5.0) {\r\n        rgb = vec3(x, 0.0, c);\r\n    } else {\r\n        rgb = vec3(c, 0.0, x);\r\n    }\r\n    float m = l - 0.5 * c;\r\n    return rgb + vec3(m);\r\n}\r\n\r\n// Basic complex division.\r\nvec2 c_div(vec2 a, vec2 b) {\r\n    float denom = b.x * b.x + b.y * b.y;\r\n    return vec2((a.x * b.x + a.y * b.y) / denom, (a.y * b.x - a.x * b.y) / denom);\r\n}\r\n\r\n// Original zeta series (for Re(s) > 1)\r\nvec2 zeta(vec2 s) {\r\n    vec2 sum = vec2(0.0);\r\n    for (int n = 1; n <= 100; ++n) {\r\n        if (n > u_termCount) break;\r\n        float nf = float(n);\r\n        float scale = 1.0 / pow(nf, s.x);\r\n        float angle = -s.y * log(nf);\r\n        vec2 term = vec2(scale * cos(angle), scale * sin(angle));\r\n        if (length(term) < 1e-6) break;\r\n        sum += term;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// Dirichlet eta series (alternating series)\r\nvec2 eta(vec2 s) {\r\n    vec2 sum = vec2(0.0);\r\n    for (int n = 1; n <= 100; ++n) {\r\n        if (n > u_termCount) break;\r\n        float nf = float(n);\r\n        float sign = (mod(nf, 2.0) < 1.0) ? -1.0 : 1.0;\r\n        float scale = 1.0 / pow(nf, s.x);\r\n        float angle = -s.y * log(nf);\r\n        vec2 term = sign * vec2(scale * cos(angle), scale * sin(angle));\r\n        if (length(term) < 1e-6) break;\r\n        sum += term;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// Analytic continuation: Î¶(s) = Î·(s) / (1 - 2^(1-s))\r\nvec2 analyticZeta(vec2 s) {\r\n    vec2 etaVal = eta(s);\r\n    float log2 = 0.69314718;// ln(2)\r\n    float expReal = exp((1.0 - s.x) * log2);\r\n    float expImag = -s.y * log2;\r\n    vec2 twoPow = vec2(expReal * cos(expImag), expReal * sin(expImag));\r\n    vec2 denom = vec2(1.0 - twoPow.x, 0.0 - twoPow.y);\r\n    return c_div(etaVal, denom);\r\n}\r\n\r\nvoid main() {\r\n    // Map pixel coordinates to the fractal plane.\r\n    vec2 uv = (gl_FragCoord.xy - 0.5 * u_resolution) / u_resolution.y;\r\n    vec2 coord = uv * u_zoom + u_pan;\r\n\r\n    // Choose zeta computation based on analytic extension toggle.\r\n    vec2 z;\r\n    if (u_useAnalyticExtension)\r\n    z = analyticZeta(coord);\r\n\r\n    else\r\n    z = zeta(coord);\r\n\r\n    float mag = length(z);\r\n    float phase = atan(z.y, z.x);\r\n\r\n    // Fractal-inspired HSL coloring:\r\n    // Map phase (angle) to hue (normalized to [0, 1]).\r\n    float hue = mod((phase / (2.0 * PI)) + 1.0, 1.0);\r\n    // Lightness based on the logarithm of the magnitude.\r\n    float lightness = smoothstep(0.0, 1.0, log(mag + 1.0));\r\n    // Full saturation for vivid colors.\r\n    float saturation = 1.0;\r\n\r\n    vec3 color = hsl2rgb(vec3(hue, saturation, lightness));\r\n    gl_FragColor = vec4(color, 1.0);\r\n}"}},{key:"onProgramCreated",value:function(){}},{key:"needsRebase",value:function(){}}])&&Ue(e.prototype,r),o&&Ue(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o}(_t);const We=Je;var Ke,Ye,Qe,$e,tr,nr,er=0;function rr(t){t instanceof Ai&&(nr=t,Ye=document.getElementById("realSlider"),$e=document.getElementById("realSliderValue"),Qe=document.getElementById("imagSlider"),tr=document.getElementById("imagSliderValue"),Ye.addEventListener("input",ir),Qe.addEventListener("input",ar),(Ke=document.getElementById("sliders")).style.display="flex")}function or(){nr.draw(),yo(),x(),Ro(),nr.demoTime=0}var ir=function(){nr.c[0]=parseFloat(Ye.value),$e.textContent=nr.c[0].toFixed(4),or()},ar=function(){nr.c[1]=parseFloat(Qe.value),tr.textContent="".concat(nr.c[1].toFixed(4),"i"),or()};function sr(){uo()&&(Ye.value=parseFloat(nr.c[0].toFixed(2)),Qe.value=parseFloat(nr.c[1].toFixed(2)),$e.innerText=Ye.value,tr.innerText=Qe.value+"i",nr.demoTime=0)}function cr(){var t=performance.now();t-er<50||(er=t,$e.innerText=nr.c[0].toFixed(4),tr.innerText=nr.c[1].toFixed(4)+"i",Ye.value=parseFloat(nr.c[0].toFixed(4)),Qe.value=parseFloat(nr.c[1].toFixed(4)))}function ur(t){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ur(t)}function lr(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hr(r.key),r)}}function fr(t,n,e){return(n=hr(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function hr(t){var n=function(t,n){if("object"!=ur(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==ur(n)?n:n+""}var mr,dr,pr=function(){return t=function t(n,e){var i,a,s,c=this;if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),fr(this,"panelSelector","debugInfo"),fr(this,"update",function(t){var n,e,r,o,i,a,s,u;if(c.debugInfo&&c.fractalApp){var l=performance.now();c.pollGpuTimers();var f=t-c.perf.lastRafTs;c.perf.lastRafTs=t,c.perf.frameMs=f,c.perf.frameMsSmoothed=c.smooth(c.perf.frameMsSmoothed,f,.1),c.perf.fps=f>0?1e3/f:0;var h=window.devicePixelRatio||1,m=c.canvas.getBoundingClientRect(),d=c.gl;if(d&&"function"==typeof d.getShaderPrecisionFormat){var p=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT),v={precision:p.precision,rangeMin:p.rangeMin,rangeMax:p.rangeMax},y=N(c.fractalApp.panDD.x),b=N(c.fractalApp.panDD.y),g=uo()?c.fractalApp.c[0]:0,_=uo()?c.fractalApp.c[1]:0,T=c.fractalApp.pan[0],w=c.fractalApp.pan[1],A=c.fractalApp.zoom,E=Math.max(A,1e-300),x=c.canvas.width/E,P=E/c.canvas.width,S=Math.hypot(y,b),D=S/E,L=Math.log2(Math.max(D,1e-300)),O=Math.hypot(y-T,b-w),k=O/E,C=c.fractalApp.orbitDirty?"DIRTY":"cached",R=Math.floor(-Math.log10(E)),F=function(t){return String(t).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")},z=function(t){return"bad"===t?"dbg-bad":"warn"===t?"dbg-warn":"dbg-ok"},M=100,I="ok";L>44?(I="bad",M-=40):L>34?(I="warn",M-=20):L>28&&(I="warn",M-=10);var j="ok";k>1?(j="bad",M-=25):k>.5?(j="warn",M-=12):k>.25&&(j="warn",M-=6);var U="ok";x<.75&&(U="warn",M-=10),x<.25&&(U="bad",M-=20);var B="ok";(M=Math.max(0,Math.min(100,Math.round(M))))<70&&(B="warn"),M<45&&(B="bad");var X="bad"===B||"warn"===B?" (pan:".concat(I,", drift:").concat(j,", scale:").concat(U,")"):"",Z=c.perf.gpuMsSmoothed,G=Number.isFinite(Z)?Z>22?"bad":Z>14?"warn":"ok":"ok",H=c.perf.fps<30?"bad":c.perf.fps<50?"warn":"ok",V=performance.now()-l;c.perf.panelCpuMs=V,c.perf.panelCpuMsSmoothed=c.smooth(c.perf.panelCpuMsSmoothed,V,.2);var q=c.perf.gpuSupported?Number.isFinite(Z)?Z>1e3/60?"Likely GPU-bound":"GPU OK":"GPU timer available (wrap draw with begin/end)":"No GPU timer support",J=c.gpu.unmaskedVendor||c.gpu.vendor||"unknown",W=c.gpu.unmaskedRenderer||c.gpu.renderer||"unknown";c.debugInfo.innerHTML='\n            <span class="dbg-title" id="copyDebugInfo">DEBUG PANEL</span><span class="dbg-dim"> (\'L\' to toggle, draggable, middle-click to log)</span>|<br/>\n            <span class="dbg-dim">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br/>\n            <span class="dbg-title">FRAG highp</span>: precision='.concat(F(v.precision)," range=[").concat(F(v.rangeMin),", ").concat(F(v.rangeMax),']<br/>\n            <span class="dbg-title">mode:</span> <span class="dbg-dim">').concat(oo(),'</span> <span class="dbg-title">css</span>=').concat(F(m.width.toFixed(1)),"x").concat(F(m.height.toFixed(1)),' <span class="dbg-dim">dpr=').concat(F(h),'<span class="dbg-title"> \n            buf</span>=').concat(F(c.canvas.width),"x").concat(F(c.canvas.height),'<br/>\n            <br/>\n            <span class="dbg-title">viewPan</span>=[').concat(F(y.toFixed(24)),", ").concat(F(b.toFixed(24)),']<br/>\n            <span class="dbg-title">refPan</span>     =[').concat(F(T.toFixed(24)),", ").concat(F(w.toFixed(24)),']<br/>\n            <span class="dbg-title">c</span>=[').concat(F(g.toFixed(24)),", ").concat(F(_.toFixed(24)),']<br/>\n            <span class="dbg-title">zoom</span>=').concat(F(A.toFixed(20)),'<br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Scale â€”â€”â€”â€”</span><br/>\n            zoomExp=[').concat(F(A.toExponential(1)),']  <span class="dbg-dim">zoomBucket=1e-').concat(F(R),'</span><br/>\n            px/unit=<span class="').concat(z(U),'">').concat(F(x.toExponential(3)),'</span><br/>\n            unit/px=<span class="').concat(z(U),'">').concat(F(P.toExponential(3)),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Precision Stress (heuristics) â€”â€”â€”â€”</span><br/>\n            <span class="dbg-title">iters</span>=').concat(F(c.fractalApp.iterations.toFixed(0))," (MAX_ITER=").concat(F(c.fractalApp.MAX_ITER),')<br/>\n            Precision health:<span class="dbg-badge ').concat(z(B),'">').concat(M,'/100</span><span class="dbg-dim">').concat(F(X),"</span><br/>\n            |pan|=").concat(F(S.toExponential(3)),'<br/>\n            |pan|/zoom=<span class="').concat(z(I),'">').concat(F(D.toExponential(3)),'</span><br/>\n            log2(|pan|/zoom)â‰ˆ<span class="').concat(z(I),'">').concat(F(L.toFixed(1)),'</span> <span class="dbg-dim">(larger â‡’ cancellation risk â†‘)</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Perturbation â€”â€”â€”â€”</span><br/>\n            ref drift (abs)=').concat(F(O.toExponential(3)),'<br/>\n            ref drift/zoom=<span class="').concat(z(j),'">').concat(F(k.toFixed(3)),'</span> <span class="dbg-dim">view-units</span><br/>\n            refPick=').concat(F(c.fractalApp?c.fractalApp.bestScore+"/"+c.fractalApp.probeIters:"cached"),'<br/>\n            orbit=<span class="').concat(c.fractalApp.orbitDirty?"dbg-warn":"dbg-ok",'">').concat(F(C),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Performance â€”â€”â€”â€”</span><br/>\n            FPS=<span class="').concat(z(H),'">').concat(F(c.perf.fps.toFixed(1)),'</span> <span class="dbg-dim">(frame ').concat(F(null!==(n=null===(e=c.perf.frameMsSmoothed)||void 0===e||null===(r=e.toFixed)||void 0===r?void 0:r.call(e,2))&&void 0!==n?n:"n/a"),' ms)</span><br/>\n            debugUI=<span class="dbg-dim">').concat(F(null!==(o=null===(i=c.perf.panelCpuMsSmoothed)||void 0===i||null===(a=i.toFixed)||void 0===a?void 0:a.call(i,2))&&void 0!==o?o:"n/a")," ms</span><br/>\n            gpuTimer=").concat(F(c.perf.gpuSupported?"yes":"no"),'<br/>\n            gpuMs=<span class="').concat(z(G),'">').concat(F(Number.isFinite(Z)?Z.toFixed(2):"n/a"),'</span> <span class="dbg-dim">').concat(F(c.perf.gpuDisjoint?"(disjoint)":""),'</span><br/>\n            hint=<span class="dbg-dim">').concat(F(q),'</span><br/>\n            <br/>\n            <span class="dbg-title">â€”â€”â€”â€” Renderer â€”â€”â€”â€”</span><br/>\n            Vendor: ').concat(F(J),"<br/>\n            GPU: ").concat(F(W),'<br/>\n            <span class="dbg-dim">').concat(F(c.gpu.webglVersion)," on ").concat((null===(s=navigator)||void 0===s||null===(s=s.userAgentData)||void 0===s?void 0:s.platform)||(null===(u=navigator)||void 0===u?void 0:u.platform),"</span><br/>\n            "),requestAnimationFrame(c.update)}}}),fr(this,"toggle",function(){c.debugInfo&&(c.debugInfo.style.display="block"===c.debugInfo.style.display?"none":"block")}),this.canvas=n,this.fractalApp=e,this.gl=null==e?void 0:e.gl,this.debugInfo=document.getElementById(this.panelSelector),this.debugInfo){if(P()){var u=0;this.debugInfo.addEventListener("pointerdown",function(t){var n=Date.now();n-u<300&&c.toggle(),u=n,t.preventDefault()})}this.debugInfo.addEventListener("auxclick",function(t){if(1===t.button){o(c.debugInfo.innerText,c.constructor.name,r);var n=c.debugInfo.innerText.substring(c.debugInfo.innerText.indexOf("FRAG"));navigator.clipboard.writeText(n).then(function(){},function(t){})}}),this.extTimer=(null===(i=this.gl)||void 0===i?void 0:i.getExtension("EXT_disjoint_timer_query"))||(null===(a=this.gl)||void 0===a?void 0:a.getExtension("EXT_disjoint_timer_query_webgl2"))||null,this.extRendererInfo=(null===(s=this.gl)||void 0===s?void 0:s.getExtension("WEBGL_debug_renderer_info"))||null,this.gpu={vendor:"unknown",renderer:"unknown",unmaskedVendor:null,unmaskedRenderer:null,webglVersion:"unknown",shadingLanguageVersion:"unknown",maxTextureSize:null,maxVaryings:null,maxFragUniforms:null,maxVertUniforms:null,maxViewportDims:null},this._initGpuInfo(),this.perf={lastRafTs:performance.now(),fps:0,frameMs:0,frameMsSmoothed:NaN,panelCpuMs:0,panelCpuMsSmoothed:NaN,gpuSupported:!!this.extTimer,gpuMs:NaN,gpuMsSmoothed:NaN,gpuDisjoint:!1,queryInFlight:null,pendingQueries:[]},this.toggle(),requestAnimationFrame(this.update)}},n=[{key:"setRenderer",value:function(t){this.fractalApp=t||null,this.gl=(null==t?void 0:t.gl)||null,this.precisionInfo=null;var n=this.gl;if(n&&"function"==typeof n.getShaderPrecisionFormat){var e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);this.precisionInfo=e?{precision:e.precision,rangeMin:e.rangeMin,rangeMax:e.rangeMax}:null}}},{key:"_initGpuInfo",value:function(){var t=this.gl;if(t)try{if(this.gpu.webglVersion=t.getParameter(t.VERSION)||"unknown",this.gpu.shadingLanguageVersion=t.getParameter(t.SHADING_LANGUAGE_VERSION)||"unknown",this.gpu.vendor=t.getParameter(t.VENDOR)||"unknown",this.gpu.renderer=t.getParameter(t.RENDERER)||"unknown",this.gpu.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.gpu.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.gpu.maxFragUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.gpu.maxVertUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.gpu.maxViewportDims=t.getParameter(t.MAX_VIEWPORT_DIMS),this.extRendererInfo){var n=t.getParameter(this.extRendererInfo.UNMASKED_VENDOR_WEBGL),e=t.getParameter(this.extRendererInfo.UNMASKED_RENDERER_WEBGL);this.gpu.unmaskedVendor=n||null,this.gpu.unmaskedRenderer=e||null}}catch(t){}}},{key:"beginGpuTimer",value:function(){if(this.extTimer&&this.gl&&!this.perf.queryInFlight){var t=this.extTimer.createQueryEXT();this.extTimer.beginQueryEXT(this.extTimer.TIME_ELAPSED_EXT,t),this.perf.queryInFlight=t}}},{key:"endGpuTimer",value:function(){this.extTimer&&this.gl&&this.perf.queryInFlight&&(this.extTimer.endQueryEXT(this.extTimer.TIME_ELAPSED_EXT),this.perf.pendingQueries.push(this.perf.queryInFlight),this.perf.queryInFlight=null)}},{key:"pollGpuTimers",value:function(){if(this.extTimer&&this.gl){var t=this.gl.getParameter(this.extTimer.GPU_DISJOINT_EXT);if(this.perf.gpuDisjoint=!!t,0!==this.perf.pendingQueries.length){var n=this.perf.pendingQueries[0];if(this.extTimer.getQueryObjectEXT(n,this.extTimer.QUERY_RESULT_AVAILABLE_EXT)){var e=this.extTimer.getQueryObjectEXT(n,this.extTimer.QUERY_RESULT_EXT);if(this.extTimer.deleteQueryEXT(n),this.perf.pendingQueries.shift(),this.perf.gpuDisjoint)this.perf.gpuMs=NaN;else{var r=e/1e6;this.perf.gpuMs=r,this.perf.gpuMsSmoothed=this.smooth(this.perf.gpuMsSmoothed,r,.15)}}}}}},{key:"smooth",value:function(t,n,e){return Number.isFinite(n)?Number.isFinite(t)?t+(n-t)*e:n:t}}],n&&lr(t.prototype,n),e&&lr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e}();function vr(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return yr(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(yr(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,yr(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,yr(f,"constructor",u),yr(u,"constructor",c),c.displayName="GeneratorFunction",yr(u,o,"GeneratorFunction"),yr(f),yr(f,o,"Generator"),yr(f,r,function(){return this}),yr(f,"toString",function(){return"[object Generator]"}),(vr=function(){return{w:i,m:h}})()}function yr(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}yr=function(t,n,e,r){function i(n,e){yr(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},yr(t,n,e,r)}function br(t){return function(t){if(Array.isArray(t))return gr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return gr(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?gr(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gr(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function _r(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function Tr(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){_r(i,r,o,a,s,"next",t)}function s(t){_r(i,r,o,a,s,"throw",t)}a(void 0)})}}var wr,Ar,Er,xr,Pr,Sr,Dr,Lr,Or,kr,Cr,Rr,Fr,zr,Mr,Ir,Nr,jr,Ur,Br=i.MANDELBROT,Xr=u,Zr=l,Gr=l,Hr=null,Vr=!1,qr=!0,Jr=!1,Wr=-1,Kr=0,Yr=[],Qr=[],$r=[],to=[],no=0,eo=100,ro=null,oo=function(){return t=Br,Object.keys(i).find(function(n){return i[n]===t})||"UNKNOWN";var t};function io(t){return ao.apply(this,arguments)}function ao(){return ao=Tr(vr().m(function t(n){var e,r,o,a,s,c,u=arguments;return vr().w(function(t){for(;;)switch(t.n){case 0:if(s=u.length>1&&void 0!==u[1]?u[1]:null,n!==Br){t.n=1;break}return t.a(2);case 1:go(),dr.destroy(),c=n,t.n=c===i.MANDELBROT?2:c===i.JULIA?3:c===i.RIEMANN?4:5;break;case 2:return lo(),t.a(3,6);case 3:return fo(),t.a(3,6);case 4:return ho(),t.a(3,6);case 5:return t.a(2);case 6:if(null===(e=Ur)||void 0===e||null===(r=e.setRenderer)||void 0===r||r.call(e,null),null===(o=Ur)||void 0===o||null===(a=o.setRenderer)||void 0===a||a.call(o,dr),P()?(ee(),te(dr)):(be(),ye(dr),kn(),Ln(dr)),dr.reset(),!s){t.n=10;break}if(Ro(),_o(),!uo()){t.n=8;break}return t.n=7,dr.animateTravelToPreset({pan:[0,0],c:s.c,zoom:s.zoom,rotation:0},1e3);case 7:t.n=9;break;case 8:return t.n=9,dr.animateTravelToPreset({pan:s.pan,zoom:s.zoom,rotation:0},500,1e3);case 9:go(),A(Br,dr.pan[0],dr.pan[1],dr.zoom,dr.rotation,dr.c?dr.c[0]:null,dr.c?dr.c[1]:null);case 10:case 11:return t.a(2)}},t)})),ao.apply(this,arguments)}function so(t){return co.apply(this,arguments)}function co(){return(co=Tr(vr().m(function t(n){var e;return vr().w(function(t){for(;;)switch(t.n){case 0:if(n!==Br){t.n=1;break}return t.a(2);case 1:if(n!==i.MANDELBROT){t.n=3;break}return e=Math.max(dr.MAX_ZOOM,.1*dr.zoom),t.n=2,io(i.MANDELBROT,{pan:dr.c.slice(),zoom:e,rotation:0});case 2:t.n=4;break;case 3:return t.n=4,io(i.JULIA,{pan:[0,0],c:dr.pan.slice(),zoom:1.5,rotation:0});case 4:case 5:return t.a(2)}},t)}))).apply(this,arguments)}var uo=function(){return Br===i.JULIA};function lo(){Pr.classList.remove("active"),xr.classList.add("active"),Q(Qr),zr.style.display="none",Ye&&Qe&&Ke&&(Ye.removeEventListener("input",ir),Qe.removeEventListener("input",ar),Ke.style.display="none"),Ht(),Nt&&(Nt.destroy(),Nt=null),dr.destroy(),dr=new Ne(mr),Br=i.MANDELBROT,Q(Yr),0!==Kr&&Fo(),Zo(),Wo(),po(h),mo(),window.location.hash=""}function fo(){dr.destroy(),dr=new Ai(mr),Br=i.JULIA,Pr.classList.add("active"),xr.classList.remove("active"),Q(Yr),Zo(),rr(dr),cr(),Q(Qr),Qo(),Wo(),0!==Kr&&Fo(),po(m),Ar.style.background="rgba(20, 20, 20, 0.8)",Nr.style.background="rgba(20, 20, 20, 0.8)",mo(),window.location.hash="#julia"}function ho(){(dr=new We(mr)).useAnalyticExtension=!1,Br=i.RIEMANN,Q(Yr),window.location.hash="#zeta"}function mo(){if(Mr){var t=dr.PALETTES||[];if(t.length>0&&dr.currentPaletteIndex>=0){var n=t[dr.currentPaletteIndex];Mr.title='Current: "'.concat(n.id,'" (T to cycle)')}else Mr.title="Change Color Palette (T)"}}function po(t){t||(t=br(dr.colorPalette));var n=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.9;return Math.min(255,Math.floor(255*t*n))};Xr="rgba(".concat(n(t[0]),", ").concat(n(t[1]),", ").concat(n(t[2]),", 1)"),Zr="rgba(".concat(n(t[0],.5),", ").concat(n(t[1],.5),", ").concat(n(t[2],.5),", 0.2)"),Gr="rgba(".concat(Math.floor(200*t[0]),", ").concat(Math.floor(200*t[1]),", ").concat(Math.floor(200*t[2]),", 0.1)");var e=document.querySelector(":root");e.style.setProperty("--bg-color",Gr),e.style.setProperty("--mid-color",Zr),e.style.setProperty("--accent-color",Xr),Vt(t)}function vo(){Ro(),Fo(),x()}function yo(){var t,n,e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=performance.now(),a=o-no;if(a<eo){if(r&&!ro){var s=Math.max(eo-a,0);ro=setTimeout(function(){ro=null,yo(!0)},s)}}else if(no=o,mr&&dr){var c=Jr?" [AUTO] ":"",u=null!==(t=N(dr.panDD.x))&&void 0!==t?t:0,l=null!==(n=N(dr.panDD.y))&&void 0!==n?n:0;if(c+="p: [".concat(u.toFixed(8),", ").concat(l.toFixed(8),"i] Â· "),Br===i.JULIA){var f,h,m=null!==(f=dr.c[0])&&void 0!==f?f:0,p=null!==(h=dr.c[1])&&void 0!==h?h:0;c+="c: [".concat(m.toFixed(4),", ").concat(p.toFixed(4),"i] Â· ")}var v=null!==(e=dr.zoom)&&void 0!==e?e:0,y=180*dr.rotation/d%360;c+="r: ".concat((y<0?y+360:y).toFixed(0),"Â° Â· zoom:&nbsp;").concat(v.toExponential(0)),Jr?jr.classList.contains("animationActive")||jr.classList.add("animationActive"):jr.classList.contains("animationActive")&&jr.classList.remove("animationActive"),jr.innerHTML!==c&&(jr.innerHTML=c)}}var bo=function(){return Jr};function go(){Jr&&(Jr=!1,jr.classList.remove("animation"),dr.stopAllNonColorAnimations(),Or.innerText="Demo",Or.classList.remove("active"),kr.disabled=!1,Rr.disabled=!1,P()?ne():On(),uo()&&(Qe.disabled=Ye.disabled=!1,Ye.classList.remove("thumbDisabled"),Qe.classList.remove("thumbDisabled")),setTimeout(function(){yo()},150))}function _o(){Jr||(Jr=!0,jr.classList.add("animation"),Or.innerText="Stop",Or.classList.add("active"),Go(),kr.disabled=!0,Vo(),Rr.disabled=!0,P()?ee():kn(),uo()&&(Qe.disabled=Ye.disabled=!0,Ye.classList.add("thumbDisabled"),Qe.classList.add("thumbDisabled")),x())}function To(){return wo.apply(this,arguments)}function wo(){return(wo=Tr(vr().m(function t(){var n;return vr().w(function(t){for(;;)switch(t.n){case 0:if(!Jr){t.n=1;break}return Ro(),Wr=-1,dr.stopDemo(),go(),t.a(2);case 1:Ro(),_o(),n=Br,t.n=n===i.MANDELBROT?2:n===i.JULIA?4:6;break;case 2:return t.n=3,Ao();case 3:case 5:return t.a(3,7);case 4:return t.n=5,So();case 6:return go(),t.a(3,7);case 7:case 8:return t.a(2)}},t)}))).apply(this,arguments)}function Ao(){return Eo.apply(this,arguments)}function Eo(){return(Eo=Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,dr.animateDemo();case 1:case 2:return t.a(2)}},t)}))).apply(this,arguments)}function xo(t,n){return Po.apply(this,arguments)}function Po(){return(Po=Tr(vr().m(function t(n,e){var r;return vr().w(function(t){for(;;)switch(t.n){case 0:if(!Jr||e!==Wr){t.n=1;break}return t.a(2);case 1:if(Jr&&go(),Ro(),Wr=e,Qr[e].classList.add("active"),!((r=n[e]).cxDirection<0&&r.endC[0]>=r.startC[0])){t.n=2;break}return t.a(2);case 2:if(!(r.cxDirection>0&&r.endC[0]<=r.startC[0])){t.n=3;break}return t.a(2);case 3:if(!(r.cyDirection<0&&r.endC[1]>=r.startC[1])){t.n=4;break}return t.a(2);case 4:if(!(r.cyDirection>0&&r.endC[1]<=r.startC[1])){t.n=5;break}return t.a(2);case 5:return _o(),W(500,dr,{c:r.startC,pan:r.pan,zoom:r.zoom},{pan:.5,zoom:2,c:1}),t.n=6,dr.animateToZoomAndC(dr.DEFAULT_ZOOM,r.startC,1500);case 6:return t.n=7,Promise.all([dr.animateDive(r),dr.animatePanZoomRotationTo(r.pan,r.zoom,r.rotation,1500)]);case 7:return t.a(2)}},t)}))).apply(this,arguments)}function So(){return Do.apply(this,arguments)}function Do(){return(Do=Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:if(Jr&&go(),_o(),Ro(),0!==dr.demoTime){t.n=1;break}return t.n=1,dr.animateTravelToPreset({pan:dr.DEFAULT_PAN,c:[-.25,.7],zoom:dr.DEFAULT_ZOOM,rotation:dr.DEFAULT_ROTATION},1e3);case 1:return t.n=2,dr.animateDemo();case 2:go();case 3:return t.a(2)}},t)}))).apply(this,arguments)}function Lo(t,n){return Oo.apply(this,arguments)}function Oo(){return(Oo=Tr(vr().m(function t(n,e){return vr().w(function(t){for(;;)switch(t.n){case 0:if(Jr&&go(),e!==Kr){t.n=1;break}return t.a(2);case 1:if(Ro(),_o(),Yr[e].classList.add("active"),!uo()){t.n=3;break}return dr.demoTime=0,t.n=2,dr.animateTravelToPreset(n[e],1500);case 2:t.n=4;break;case 3:return t.n=4,dr.animateTravelToPreset(n[e],2e3,500,1500);case 4:Kr=e,go(),A(Br,dr.pan[0],dr.pan[1],dr.zoom,dr.rotation,dr.c?dr.c[0]:null,dr.c?dr.c[1]:null);case 5:return t.a(2)}},t)}))).apply(this,arguments)}function ko(){Ur?Ur.toggle():(Ur=new pr(mr,dr,Xr),Co())}function Co(){var t=document.getElementById("verticalLine"),n=document.getElementById("horizontalLine");"block"===t.style.display&&"block"===n.style.display?(t.style.display="none",n.style.display="none"):(t.style.display="block",n.style.display="block")}function Ro(){Yr.concat(Qr).forEach(function(t){return t.classList.remove("active")})}function Fo(){Kr=-1}function zo(){return Mo.apply(this,arguments)}function Mo(){return(Mo=Tr(vr().m(function t(){var n,e,r,o;return vr().w(function(t){for(;;)switch(t.n){case 0:if(!uo()){t.n=2;break}return t.n=1,dr.animateColorPaletteTransition(250,po);case 1:mo(),t.n=4;break;case 2:return n=Math.random(),e=.5*Math.random()+.5,r=.5*Math.random()+.5,o=X(n,e,r),t.n=3,dr.animateColorPaletteTransition(o,250,function(){po(o)});case 3:Vt(o);case 4:return t.a(2)}},t)}))).apply(this,arguments)}function Io(){re(mr,dr,Xr)}function No(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=document.getElementById("headerContainer");null===t&&(t=!qr),t?n.classList.remove("minimized"):n.classList.add("minimized"),qr=t}function jo(){return Uo.apply(this,arguments)}function Uo(){return(Uo=Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:po(uo()?m:h),go(),dr.reset(),uo()?sr():qt(),vo(),mo(),Yr[0].classList.add("active");case 1:return t.a(2)}},t)}))).apply(this,arguments)}function Bo(){var n="mouse";Er.addEventListener("pointerdown",function(t){n=t.pointerType}),Er.addEventListener("pointerenter",function(t){"touch"!==t.pointerType&&(Hr&&(clearTimeout(Hr),Hr=null),No(!0))}),Er.addEventListener("click",function(){("touch"===n||e>t)&&No()}),Ar.addEventListener("pointerleave",function(t){"touch"!==t.pointerType&&qr&&!e&&(Hr=setTimeout(function(){No(!1),Hr=null},3e3))}),mr.addEventListener("pointerdown",function(){e||No(!1)}),o("Initialized.","initHeaderEvents")}function Xo(){Dr.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,jo();case 1:return t.a(2)}},t)}))),Or.addEventListener("click",To),Lr.addEventListener("click",Io),o("Initialized.","initControlButtonEvents")}function Zo(){var t=document.getElementById("presets");Yr=[];var n=br(dr.PRESETS);n.forEach(function(e,r){var o=document.createElement("button");o.id="preset"+r,o.className="preset",o.title=(e.title||"Preset "+r)+(r<10?" (Num ".concat(r,")"):" (".concat(r,")")),o.textContent=(e.title||r).toString(),o.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return Go(),t.n=1,Lo(n,r);case 1:return t.a(2)}},t)}))),t.appendChild(o),Yr.push(o),Yr[0].classList.add("active")}),o("Initialized.","initPresetButtonEvents")}function Go(){Cr.classList.remove("show"),kr.textContent="View â–¾"}function Ho(){kr.addEventListener("click",function(t){t.stopPropagation(),Vo(),Jo(),function(){Cr.classList.toggle("show");var t=Cr.classList.contains("show");kr.textContent=t?"View â–´":"View â–¾"}()}),document.addEventListener("click",function(t){Cr.contains(t.target)||t.target===kr||Go()}),o("Initialized.","initPresetsDropdown")}function Vo(){Fr.classList.remove("show"),Rr.textContent="Dive â–¾"}function qo(){Rr.addEventListener("click",function(t){t.stopPropagation(),Go(),Jo(),function(){Fr.classList.toggle("show");var t=Fr.classList.contains("show");Rr.textContent=t?"Dive â–´":"Dive â–¾"}()}),document.addEventListener("click",function(t){Fr.contains(t.target)||t.target===Rr||Vo()}),o("Initialized.","initDivesDropdown")}function Jo(){Ir.classList.remove("show"),Mr.textContent="Palette â–¾"}function Wo(){$r=[],Ir.innerHTML="";var t=dr.PALETTES||[],n=document.createElement("button");n.id="palette-random",n.className="palette",n.title="Random color palette",n.innerHTML='<span class="color-swatch" style="background: linear-gradient(135deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);"></span>Random',n.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return Jo(),t.n=1,zo();case 1:return t.a(2)}},t)}))),Ir.appendChild(n),$r.push(n),t.forEach(function(t,n){var e=document.createElement("button");e.id="palette-"+n,e.className="palette",e.title=t.id;var r=t.keyColor||"#888";e.innerHTML='<span class="color-swatch" style="background: '.concat(r,';"></span>').concat(t.id),e.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return Jo(),t.n=1,dr.applyPaletteByIndex(n,250,po);case 1:mo();case 2:return t.a(2)}},t)}))),Ir.appendChild(e),$r.push(e)}),o("Initialized.","initPaletteButtonEvents")}function Ko(){Mr.addEventListener("click",function(t){t.stopPropagation(),Go(),Vo(),function(){Ir.classList.toggle("show");var t=Ir.classList.contains("show");Mr.textContent=t?"Palette â–´":"Palette â–¾"}()}),document.addEventListener("click",function(t){Ir.contains(t.target)||t.target===Mr||Jo()}),o("Initialized.","initPaletteDropdown")}function Yo(){(to=Qr.concat(Yr).concat($r)).push(Dr,Lr,Or),to.forEach(function(t){t.addEventListener("mouseleave",function(){t.blur()}),t.addEventListener("mouseup",function(){t.blur()})}),o("Initialized.","initCommonButtonEvents")}function Qo(){if(uo()){var t=document.getElementById("dives");Qr=[];var n=br(dr.DIVES);n.forEach(function(e,r){var o=document.createElement("button");o.id="dive"+r,o.className="dive",o.title=(e.title||"Preset "+r)+" (Shift+".concat(r,")"),o.textContent=e.title||r.toString(),o.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:return Vo(),t.n=1,xo(n,r);case 1:return t.a(2)}},t)}))),t.appendChild(o),Qr.push(o)}),zr.style.display="inline-block"}o("Initialized.","initDiveButtons")}function $o(){xr.addEventListener("click",function(){var t=Tr(vr().m(function t(n){return vr().w(function(t){for(;;)switch(t.n){case 0:if(!n.ctrlKey){t.n=2;break}return t.n=1,so(i.MANDELBROT);case 1:t.n=3;break;case 2:return t.n=3,io(i.MANDELBROT);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),Pr.addEventListener("click",function(){var t=Tr(vr().m(function t(n){return vr().w(function(t){for(;;)switch(t.n){case 0:if(!n.ctrlKey){t.n=2;break}return t.n=1,so(i.JULIA);case 1:t.n=3;break;case 2:return t.n=3,io(i.JULIA);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),Sr.addEventListener("click",Tr(vr().m(function t(){return vr().w(function(t){for(;;)switch(t.n){case 0:if(!uo()){t.n=2;break}return t.n=1,so(i.MANDELBROT);case 1:t.n=3;break;case 2:return t.n=3,so(i.JULIA);case 3:return t.a(2)}},t)}))),Sr.style.display="inline-flex",o("Initialized.","initFractalSwitchButtons")}function ti(){window.addEventListener("resize",function(){clearTimeout(wr),wr=setTimeout(function(){dr.resizeCanvas()},200)});var t=document.querySelectorAll(".draggable");t.forEach(function(t){t.addEventListener("mousedown",function(){var n=function(n){return function(t,n){var e=parseInt(window.getComputedStyle(n).left),r=parseInt(window.getComputedStyle(n).top);n.style.left="".concat(e+t.movementX,"px"),n.style.top="".concat(r+t.movementY,"px")}(n,t)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",n)},{once:!0})})}),o("Initialized.","initWindowEvents")}function ni(){jr.addEventListener("mouseenter",function(){jr.innerHTML="Click to copy fractal state to clipboard."}),jr.addEventListener("mouseleave",function(){yo()}),jr.addEventListener("click",function(){var t='"pan": ['.concat(dr.pan,'], "rotation": ').concat(J(dr.rotation),', "zoom": ').concat(dr.zoom)+(uo()?', "c": ['.concat(dr.c,"]}"):"}");navigator.clipboard.writeText(t).then(function(){jr.innerHTML="Copied to clipboard!"},function(t){})})}function ei(){xr=document.getElementById("mandelbrotSwitch"),Pr=document.getElementById("juliaSwitch"),Sr=document.getElementById("persistSwitch"),Ar=document.getElementById("headerContainer"),Er=document.getElementById("logo"),Nr=document.getElementById("infoLabel"),jr=document.getElementById("infoText"),Dr=document.getElementById("reset"),Lr=document.getElementById("screenshot"),Or=document.getElementById("demo"),kr=document.getElementById("presets-toggle"),Cr=document.getElementById("presets"),Rr=document.getElementById("dives-toggle"),Fr=document.getElementById("dives"),zr=document.getElementById("dives-dropdown"),Mr=document.getElementById("palette-toggle"),Ir=document.getElementById("palettes"),document.getElementById("palette-dropdown")}function ri(t){return oi.apply(this,arguments)}function oi(){return oi=Tr(vr().m(function t(r){return vr().w(function(t){for(;;)switch(t.n){case 0:if(!Vr){t.n=1;break}return t.a(2);case 1:mr=(dr=r).canvas,ei(),r instanceof Ai?(Br=i.JULIA,Pr.classList.add("active"),xr.classList.remove("active"),rr(dr),cr(),Qo(),po(m),Ar.style.background="rgba(20, 20, 20, 0.8)",Nr.style.background="rgba(20, 20, 20, 0.8)",window.location.hash="#julia"):Zt(),Zo(),Ho(),qo(),Wo(),Ko(),ti(),Bo(),Xo(),ni(),$o(),Yo(),P()?te(dr):(ye(dr),Ln(dr)),mo(),e!==n||S()||ko(),Vr=!0;case 2:return t.a(2)}},t)})),oi.apply(this,arguments)}function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function ai(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return si(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(si(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,si(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,si(f,"constructor",u),si(u,"constructor",c),c.displayName="GeneratorFunction",si(u,o,"GeneratorFunction"),si(f),si(f,o,"Generator"),si(f,r,function(){return this}),si(f,"toString",function(){return"[object Generator]"}),(ai=function(){return{w:i,m:h}})()}function si(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}si=function(t,n,e,r){function i(n,e){si(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},si(t,n,e,r)}function ci(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function ui(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){ci(i,r,o,a,s,"next",t)}function s(t){ci(i,r,o,a,s,"throw",t)}a(void 0)})}}function li(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function fi(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?li(Object(e),!0).forEach(function(n){Ti(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):li(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function hi(t){return function(t){if(Array.isArray(t))return mi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return mi(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?mi(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mi(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function di(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wi(r.key),r)}}function pi(t,n,e){return n=gi(n),function(t,n){if(n&&("object"==ii(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vi()?Reflect.construct(n,e||[],gi(t).constructor):n.apply(t,e))}function vi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(vi=function(){return!!t})()}function yi(t,n,e,r){var o=bi(gi(1&r?t.prototype:t),n,e);return 2&r&&"function"==typeof o?function(t){return o.apply(e,t)}:o}function bi(){return bi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var r=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=gi(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},bi.apply(null,arguments)}function gi(t){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gi(t)}function _i(t,n){return _i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},_i(t,n)}function Ti(t,n,e){return(n=wi(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function wi(t){var n=function(t,n){if("object"!=ii(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==ii(n)?n:n+""}var Ai=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),Ti(e=pi(this,n,[t]),"markOrbitDirty",function(){return e.orbitDirty=!0}),e.DEFAULT_ZOOM=Tt.v4[0].zoom,e.MAX_ZOOM=1e-17,e.zoom=e.DEFAULT_ZOOM,e.DEFAULT_ROTATION=Tt.v4[0].rotation,e.rotation=e.DEFAULT_ROTATION,e.DEFAULT_C=[Tt.v4[0].c[0],Tt.v4[0].c[1]],e.c=hi(e.DEFAULT_C),e.setPan(e.DEFAULT_PAN[0],e.DEFAULT_PAN[1]),e.colorPalette=hi(e.DEFAULT_PALETTE),e.refZ0=[0,0],e.refZ0DD={x:{hi:0,lo:0},y:{hi:0,lo:0}},e.refPan=hi(e.DEFAULT_PAN),e.refPanDD={x:{hi:e.DEFAULT_PAN[0],lo:0},y:{hi:e.DEFAULT_PAN[1],lo:0}},e.orbitDirty=!0,e._prevPan0=NaN,e._prevPan1=NaN,e._prevZoom=NaN,e._prevC0=NaN,e._prevC1=NaN,e.MAX_ITER=5e3,e.REF_SEARCH_GRID=7,e.REF_SEARCH_RADIUS=.5,e.orbitTex=null,e.orbitData=null,e.floatTexExt=null,e.rebaseArmed=!0,e.PRESETS=Tt.v4.map(function(t){return fi(fi({},t),{},{rotation:q(t.rotation||0)})}),e.DIVES=Tt.gf.map(function(t){return fi(fi({},t),{},{rotation:q(t.rotation||0)})}),e.PALETTES=Tt.BG||[],e.currentPaletteIndex=0,e.innerStops=e.PALETTES.length>0?new Float32Array(e.PALETTES[e.currentPaletteIndex].theme):new Float32Array(f.theme),e.currentCAnimationFrame=null,e.cAnimationActive=!1,e.demoTime=0,e.init(),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&_i(t,n)}(n,t),e=n,r=[{key:"onProgramCreated",value:function(){this.floatTexExt=this.gl.getExtension("OES_texture_float"),this.floatTexExt&&(this.orbitTex=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.orbitData=new Float32Array(4*this.MAX_ITER),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER),this.orbitDirty=!0)}},{key:"createFragmentShaderSource",value:function(){return"/*\r\n * Julia Fragment Shader (Rebased Perturbation)\r\n * @author    Radim Brnka\r\n * @project   Synaptory Fractal Traveler\r\n * @copyright 2025-2026\r\n *\r\n * @description\r\n * Julia set implementation using perturbation math relative to a\r\n * pre-calculated Mandelbrot reference orbit.\r\n * Formula: dz_{n+1} = 2*zref*dz + dz^2 + (c_julia - c_ref).\r\n *\r\n * @license   MIT\r\n */\r\n\r\nprecision highp float;\r\n\r\nuniform vec2  u_resolution;\r\nuniform float u_rotation;\r\n\r\n// delta z0 (pan - refZ0) computed on JS side for float64 precision\r\nuniform vec2  u_delta_z0_h;\r\nuniform vec2  u_delta_z0_l;\r\n\r\n// zoom hi/lo\r\nuniform float u_zoom_h;\r\nuniform float u_zoom_l;\r\n\r\n// Julia constant\r\nuniform vec2  u_c;\r\n\r\nuniform float u_iterations;\r\nuniform vec3  u_innerStops[5];\r\n\r\nuniform sampler2D u_orbitTex;\r\nuniform float     u_orbitW;\r\n\r\nconst int MAX_ITER = __MAX_ITER__;\r\n\r\n// --- df helpers ---\r\nstruct df  { float hi; float lo; };\r\nstruct df2 { df x; df y; };\r\n\r\ndf df_make(float hi, float lo){ df a; a.hi=hi; a.lo=lo; return a; }\r\ndf df_from(float a){ return df_make(a, 0.0); }\r\nfloat df_to_float(df a){ return a.hi + a.lo; }\r\n\r\ndf twoSum(float a, float b) {\r\n    float s  = a + b;\r\n    float bb = s - a;\r\n    float err = (a - (s - bb)) + (b - bb);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf quickTwoSum(float a, float b) {\r\n    float s = a + b;\r\n    float err = b - (s - a);\r\n    return df_make(s, err);\r\n}\r\n\r\ndf df_add(df a, df b) {\r\n    df s = twoSum(a.hi, b.hi);\r\n    float t = a.lo + b.lo;\r\n    df u = twoSum(s.lo, t);\r\n    df v = twoSum(s.hi, u.hi);\r\n    float lo = u.lo + v.lo;\r\n    return quickTwoSum(v.hi, lo);\r\n}\r\n\r\ndf df_sub(df a, df b) { return df_add(a, df_make(-b.hi, -b.lo)); }\r\n\r\nconst float SPLIT = 4097.0;\r\n\r\ndf twoProd(float a, float b) {\r\n    float p = a * b;\r\n\r\n    float aSplit = a * SPLIT;\r\n    float aHi = aSplit - (aSplit - a);\r\n    float aLo = a - aHi;\r\n\r\n    float bSplit = b * SPLIT;\r\n    float bHi = bSplit - (bSplit - b);\r\n    float bLo = b - bHi;\r\n\r\n    float err = ((aHi * bHi - p) + aHi * bLo + aLo * bHi) + aLo * bLo;\r\n    return df_make(p, err);\r\n}\r\n\r\ndf df_mul(df a, df b) {\r\n    df p = twoProd(a.hi, b.hi);\r\n    float err = a.hi * b.lo + a.lo * b.hi + a.lo * b.lo;\r\n    df s = twoSum(p.lo, err);\r\n    df r = twoSum(p.hi, s.hi);\r\n    float lo = s.lo + r.lo;\r\n    return quickTwoSum(r.hi, lo);\r\n}\r\n\r\ndf df_mul_f(df a, float b) { return df_mul(a, df_from(b)); }\r\n\r\ndf2 df2_make(df x, df y){ df2 r; r.x=x; r.y=y; return r; }\r\ndf2 df2_add(df2 a, df2 b){ return df2_make(df_add(a.x, b.x), df_add(a.y, b.y)); }\r\n\r\ndf2 df2_mul(df2 a, df2 b) {\r\n    df axbx = df_mul(a.x, b.x);\r\n    df ayby = df_mul(a.y, b.y);\r\n    df axby = df_mul(a.x, b.y);\r\n    df aybx = df_mul(a.y, b.x);\r\n    return df2_make(df_sub(axbx, ayby), df_add(axby, aybx));\r\n}\r\n\r\ndf2 df2_sqr(df2 a){\r\n    df xx = df_mul(a.x, a.x);\r\n    df yy = df_mul(a.y, a.y);\r\n    df xy = df_mul(a.x, a.y);\r\n    return df2_make(df_sub(xx, yy), df_mul_f(xy, 2.0));\r\n}\r\n\r\nvec3 getColorFromMap(float t) {\r\n    float segment = 1.0 / 4.0;\r\n    if (t <= segment) {\r\n        return mix(u_innerStops[0], u_innerStops[1], t / segment);\r\n    } else if (t <= 2.0 * segment) {\r\n        return mix(u_innerStops[1], u_innerStops[2], (t - segment) / segment);\r\n    } else if (t <= 3.0 * segment) {\r\n        return mix(u_innerStops[2], u_innerStops[3], (t - 2.0 * segment) / segment);\r\n    } else {\r\n        return mix(u_innerStops[3], u_innerStops[4], (t - 3.0 * segment) / segment);\r\n    }\r\n}\r\n\r\ndf2 sampleZRef(int n) {\r\n    float x = (float(n) + 0.5) / u_orbitW;\r\n    vec4 t = texture2D(u_orbitTex, vec2(x, 0.5));\r\n    return df2_make(df_make(t.r, t.g), df_make(t.b, t.a));\r\n}\r\n\r\nvoid main() {\r\n    float aspect = u_resolution.x / u_resolution.y;\r\n\r\n    vec2 st = gl_FragCoord.xy / u_resolution;\r\n    st -= 0.5;\r\n    st.x *= aspect;\r\n\r\n    float cosR = cos(u_rotation);\r\n    float sinR = sin(u_rotation);\r\n    vec2 r = vec2(\r\n    st.x * cosR - st.y * sinR,\r\n    st.x * sinR + st.y * cosR\r\n    );\r\n\r\n    df zoom = df_make(u_zoom_h, u_zoom_l);\r\n\r\n    // deltaZ0 = pan - refZ0 (computed on JS side with float64 precision)\r\n    df2 deltaZ0 = df2_make(\r\n        df_make(u_delta_z0_h.x, u_delta_z0_l.x),\r\n        df_make(u_delta_z0_h.y, u_delta_z0_l.y)\r\n    );\r\n\r\n    // dz0 = deltaZ0 + zoom * r\r\n    df2 dz = df2_add(\r\n        deltaZ0,\r\n        df2_make(df_mul_f(zoom, r.x), df_mul_f(zoom, r.y))\r\n    );\r\n\r\n    float it = 0.0;\r\n    float zx = 0.0;\r\n    float zy = 0.0;\r\n\r\n    for (int n = 0; n < MAX_ITER; n++) {\r\n        float fn = float(n);\r\n        if (fn >= u_iterations) { it = fn; break; }\r\n\r\n        df2 zref = sampleZRef(n);\r\n\r\n        zx = df_to_float(zref.x) + df_to_float(dz.x);\r\n        zy = df_to_float(zref.y) + df_to_float(dz.y);\r\n        if (zx*zx + zy*zy > 4.0) { it = fn; break; }\r\n\r\n        // Correct Julia perturbation:\r\n        // dz_{n+1} = 2*zref*dz + dz^2   (NO +dc term)\r\n        df2 zref_dz = df2_mul(zref, dz);\r\n        zref_dz.x = df_mul_f(zref_dz.x, 2.0);\r\n        zref_dz.y = df_mul_f(zref_dz.y, 2.0);\r\n\r\n        df2 dz2 = df2_sqr(dz);\r\n\r\n        dz = df2_add(zref_dz, dz2);\r\n\r\n        if (n == MAX_ITER - 1) it = u_iterations;\r\n    }\r\n\r\n    if (it >= u_iterations) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n        float r2 = max(zx*zx + zy*zy, 1e-30);\r\n        float smoothColor = it - log2(log2(r2));\r\n\r\n        // Normalize\r\n        float t = clamp(smoothColor / u_iterations, 0.0, 1.0);\r\n\r\n        t = 0.5 + 0.6 * sin(t * 4.0 * 3.14159265);\r\n\r\n        vec3 col = getColorFromMap(t);\r\n        gl_FragColor = vec4(col, 1.0);\r\n    }\r\n}".replace("__MAX_ITER__",this.MAX_ITER).toString()}},{key:"updateUniforms",value:function(){yi(n,"updateUniforms",this,3)([]),this.cLoc=this.gl.getUniformLocation(this.program,"u_c"),this.innerStopsLoc=this.gl.getUniformLocation(this.program,"u_innerStops"),this.deltaZ0HLoc=this.gl.getUniformLocation(this.program,"u_delta_z0_h"),this.deltaZ0LLoc=this.gl.getUniformLocation(this.program,"u_delta_z0_l"),this.zoomHLoc=this.gl.getUniformLocation(this.program,"u_zoom_h"),this.zoomLLoc=this.gl.getUniformLocation(this.program,"u_zoom_l"),this.orbitTexLoc=this.gl.getUniformLocation(this.program,"u_orbitTex"),this.orbitWLoc=this.gl.getUniformLocation(this.program,"u_orbitW")}},{key:"escapeItersJulia",value:function(t,n,e){for(var r=t,o=n,i=this.c[0],a=this.c[1],s=0;s<e;s++){var c=2*r*o+a;if((r=r*r-o*o+i)*r+(o=c)*o>4)return s}return e}},{key:"pickReferenceNearViewCenter",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.refZ0[0]=this.pan[0],this.refZ0[1]=this.pan[1],this.refZ0DD.x.hi=this.panDD.x.hi,this.refZ0DD.x.lo=this.panDD.x.lo,this.refZ0DD.y.hi=this.panDD.y.hi,this.refZ0DD.y.lo=this.panDD.y.lo,this.refPan[0]=this.pan[0],this.refPan[1]=this.pan[1],this.refPanDD.x.hi=this.panDD.x.hi,this.refPanDD.x.lo=this.panDD.x.lo,this.refPanDD.y.hi=this.panDD.y.hi,void(this.refPanDD.y.lo=this.panDD.y.lo);var t=this.REF_SEARCH_GRID,n=(t-1)/2,e=2*this.REF_SEARCH_RADIUS/(t-1),r=this.zoom,o=Math.min(this.MAX_ITER,Math.max(200,Math.floor(this.iterations))),i=-1;Math.hypot(this.refZ0[0]-this.pan[0],this.refZ0[1]-this.pan[1])<r*this.REF_SEARCH_RADIUS*2.5&&(i=this.escapeItersJulia(this.refZ0[0],this.refZ0[1],o));for(var a=this.pan[0],s=this.pan[1],c=this.escapeItersJulia(this.pan[0],this.pan[1],o),u=0;u<t;u++)for(var l=0;l<t;l++){var f=(l-n)*e,h=(u-n)*e,m=this.pan[0]+f*r,d=this.pan[1]+h*r,p=this.escapeItersJulia(m,d,o);p>c&&(c=p,a=m,s=d)}var v=Math.max(.1*i,50);(i<0||c-i>v)&&(this.refZ0[0]=a,this.refZ0[1]=s,this.refZ0DD.x.hi=a,this.refZ0DD.x.lo=0,this.refZ0DD.y.hi=s,this.refZ0DD.y.lo=0,this.refPan[0]=a,this.refPan[1]=s,this.refPanDD.x.hi=a,this.refPanDD.x.lo=0,this.refPanDD.y.hi=s,this.refPanDD.y.lo=0)}},{key:"computeReferenceOrbit",value:function(){if(this.orbitData&&this.orbitTex){for(var t=this.c[0],n=this.c[1],e=this.refZ0[0],r=this.refZ0[1],o=0;o<this.MAX_ITER;o++){var i=k(e),a=k(r),s=4*o;this.orbitData[s]=i.high,this.orbitData[s+1]=i.low,this.orbitData[s+2]=a.high,this.orbitData[s+3]=a.low;var c=2*e*r+n;if((e=e*e-r*r+t)*e+(r=c)*r>4){for(var u=k(e),l=k(r),f=o+1;f<this.MAX_ITER;f++){var h=4*f;this.orbitData[h]=u.high,this.orbitData[h+1]=u.low,this.orbitData[h+2]=l.high,this.orbitData[h+3]=l.low}break}}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.orbitTex),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.MAX_ITER,1,0,this.gl.RGBA,this.gl.FLOAT,this.orbitData),this.orbitTexLoc&&this.gl.uniform1i(this.orbitTexLoc,0),this.orbitWLoc&&this.gl.uniform1f(this.orbitWLoc,this.MAX_ITER)}}},{key:"needsRebase",value:function(){if(void 0===this.rebaseArmed&&(this.rebaseArmed=!0),!this.refPan)return!0;if(!Number.isFinite(this.zoom))return!1;var t=Math.max(this.zoom,1e-300),n=this.pan[0]-this.refPan[0],e=this.pan[1]-this.refPan[1],r=Math.hypot(n,e)/t;return!this.rebaseArmed&&r<.9?(this.rebaseArmed=!0,!1):!!(this.rebaseArmed&&r>1.75)&&(this.rebaseArmed=!1,!0)}},{key:"draw",value:function(){this.gl.useProgram(this.program);var t=Math.max(this.zoom,1e-300),e=Math.log2(this.DEFAULT_ZOOM/t),r=Math.floor(200+50*e);this.iterations=Math.max(50,Math.min(this.MAX_ITER,r+this.extraIterations));var o=!Number.isFinite(this._prevPan0)||!Number.isFinite(this._prevPan1)||Math.abs(this.pan[0]-this._prevPan0)+Math.abs(this.pan[1]-this._prevPan1)>1e-6*this.zoom,i=!Number.isFinite(this._prevZoom)||Math.abs(this.zoom-this._prevZoom)>1e-8*this.zoom,a=!Number.isFinite(this._prevC0)||!Number.isFinite(this._prevC1)||Math.abs(this.c[0]-this._prevC0)+Math.abs(this.c[1]-this._prevC1)>0;(o||i||a)&&(this.orbitDirty=!0,this._prevPan0=this.pan[0],this._prevPan1=this.pan[1],this._prevZoom=this.zoom,this._prevC0=this.c[0],this._prevC1=this.c[1]);var s=a||this.needsRebase(),c=this.cAnimationActive||this.interactionActive,u=!c||s;this.orbitDirty&&u&&(this.pickReferenceNearViewCenter(c),this.computeReferenceOrbit(),this.orbitDirty=!1);var l=j(this.panDD.x,this.refZ0DD.x),f=j(this.panDD.y,this.refZ0DD.y);this.deltaZ0HLoc&&this.gl.uniform2f(this.deltaZ0HLoc,l.hi,f.hi),this.deltaZ0LLoc&&this.gl.uniform2f(this.deltaZ0LLoc,l.lo,f.lo);var h=k(this.zoom);this.zoomHLoc&&this.gl.uniform1f(this.zoomHLoc,h.high),this.zoomLLoc&&this.gl.uniform1f(this.zoomLLoc,h.low),this.cLoc&&this.gl.uniform2fv(this.cLoc,this.c),this.innerStopsLoc&&this.gl.uniform3fv(this.innerStopsLoc,this.innerStops),yi(n,"draw",this,3)([])}},{key:"reset",value:function(){this.c=hi(this.DEFAULT_C),this.currentPaletteIndex=0,this.innerStops=this.PALETTES.length>0?new Float32Array(this.PALETTES[0].theme):new Float32Array([0,0,0,1,.647,0,0,0,0,1.2,1.2,1,.1,.1,.1]),this.orbitDirty=!0,this._prevPan0=NaN,this._prevPan1=NaN,this._prevZoom=NaN,this._prevC0=NaN,this._prevC1=NaN,yi(n,"reset",this,3)([])}},{key:"stopCurrentCAnimation",value:function(){null!==this.currentCAnimationFrame&&(cancelAnimationFrame(this.currentCAnimationFrame),this.currentCAnimationFrame=null),this.cAnimationActive&&(this.cAnimationActive=!1,this.markOrbitDirty())}},{key:"stopAllNonColorAnimations",value:function(){this.stopCurrentCAnimation(),yi(n,"stopAllNonColorAnimations",this,3)([])}},{key:"animateInnerStopsTransition",value:(p=ui(ai().m(function t(n){var e,r,o,i=this,a=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:250,r=a.length>2&&void 0!==a[2]?a[2]:null,this.stopCurrentColorAnimations(),o=Array.from(this.innerStops),t.n=1,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u,l=Math.min((c-a)/e,1),f=o.map(function(t,e){return V(t,n.theme[e],l)});i.innerStops=new Float32Array(f),n.keyColor&&(u=H(n.keyColor))&&(i.colorPalette=[u.r,u.g,u.b]),u||(i.colorPalette=[1.5*n.theme[9],1.5*n.theme[10],1.5*n.theme[11]]),i.draw(),r&&r(),l<1?i.currentColorAnimationFrame=requestAnimationFrame(s):(i.stopCurrentColorAnimations(),t())};i.currentColorAnimationFrame=requestAnimationFrame(s)});case 1:return t.a(2)}},t,this)})),function(t){return p.apply(this,arguments)})},{key:"animateColorPaletteTransition",value:(d=ui(ai().m(function t(){var e,r,o=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:250,r=o.length>1&&void 0!==o[1]?o[1]:null,0!==this.PALETTES.length){t.n=1;break}return t.a(2,yi(n,"animateColorPaletteTransition",this,3)([e,r]));case 1:return this.currentPaletteIndex=(this.currentPaletteIndex+1)%this.PALETTES.length,t.n=2,this.animateInnerStopsTransition(this.PALETTES[this.currentPaletteIndex],e,r);case 2:return t.a(2)}},t,this)})),function(){return d.apply(this,arguments)})},{key:"applyPaletteByIndex",value:(m=ui(ai().m(function t(n){var e,r,o=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:if(e=o.length>1&&void 0!==o[1]?o[1]:250,r=o.length>2&&void 0!==o[2]?o[2]:null,!(0===this.PALETTES.length||n<0||n>=this.PALETTES.length)){t.n=1;break}return t.a(2);case 1:return this.currentPaletteIndex=n,t.n=2,this.animateInnerStopsTransition(this.PALETTES[n],e,r);case 2:return t.a(2)}},t,this)})),function(t){return m.apply(this,arguments)})},{key:"animateFullColorSpaceCycle",value:(h=ui(ai().m(function t(){var n,e,r=this,o=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:15e3,e=o.length>1&&void 0!==o[1]?o[1]:null,t.n=1,new Promise(function(){r.animateColorPaletteTransition(n,e)});case 1:return t.a(2)}},t)})),function(){return h.apply(this,arguments)})},{key:"animateToC",value:(l=ui(ai().m(function t(){var n,e,r,o,i=this,s=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:if(n=s.length>0&&void 0!==s[0]?s[0]:hi(this.DEFAULT_C),e=s.length>1&&void 0!==s[1]?s[1]:500,r=s.length>2&&void 0!==s[2]?s[2]:a.QUINT,this.stopCurrentCAnimation(),!U(this.c,n)){t.n=1;break}return t.a(2);case 1:return o=hi(this.c),this.cAnimationActive=!0,t.n=2,new Promise(function(t){var a=null,s=function(c){a||(a=c);var u=Math.min((c-a)/e,1),l=r(u);i.c[0]=V(o[0],n[0],l),i.c[1]=V(o[1],n[1],l),i.draw(),yo(!0),cr(),u<1?i.currentCAnimationFrame=requestAnimationFrame(s):(i.cAnimationActive=!1,i.markOrbitDirty(),i.draw(),i.stopCurrentCAnimation(),i.onAnimationFinished(),t())};i.currentCAnimationFrame=requestAnimationFrame(s)});case 2:return t.a(2)}},t,this)})),function(){return l.apply(this,arguments)})},{key:"animateToZoomAndC",value:(u=ui(ai().m(function t(n){var e,r,o,i=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:hi(this.DEFAULT_C),r=i.length>2&&void 0!==i[2]?i[2]:500,o=i.length>3&&void 0!==i[3]?i[3]:a.QUINT,this.stopCurrentCAnimation(),t.n=1,Promise.all([this.animateZoomTo(n,r,o),this.animateToC(e,r,o)]);case 1:case 2:return t.a(2)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"animateTravelToPreset",value:(c=ui(ai().m(function t(n){var e,r=arguments;return ai().w(function(t){for(;;)switch(t.n){case 0:return e=r.length>1&&void 0!==r[1]?r[1]:500,this.stopAllNonColorAnimations(),t.n=1,this.animatePanAndZoomTo(this.DEFAULT_PAN,this.DEFAULT_ZOOM,1e3);case 1:return t.n=2,Promise.all([this.animateZoomTo(n.zoom,e,a.QUINT),this.animateToC(n.c,e),this.animateRotationTo(n.rotation,e,a.QUINT),this.animatePanTo(n.pan,e,a.QUINT)]);case 2:this.currentPresetIndex=n.id||0;case 3:return t.a(2)}},t,this)})),function(t){return c.apply(this,arguments)})},{key:"animateDive",value:(s=ui(ai().m(function t(n){var e=this;return ai().w(function(t){for(;;)switch(t.n){case 0:return this.stopCurrentCAnimation(),t.n=1,new Promise(function(){n.phases||(n.phases=[1,2,3,4]);var t=n.phases[0],r=function(){var o=n.step;1===t?(e.c[0]+=n.cxDirection*o,(n.cxDirection<0&&e.c[0]<=n.endC[0]||n.cxDirection>0&&e.c[0]>=n.endC[0])&&(e.c[0]=n.endC[0],t=2)):2===t?(e.c[1]+=n.cyDirection*o,(n.cyDirection<0&&e.c[1]<=n.endC[1]||n.cyDirection>0&&e.c[1]>=n.endC[1])&&(e.c[1]=n.endC[1],t=3)):3===t?(e.c[0]-=n.cxDirection*o,(n.cxDirection<0&&e.c[0]>=n.startC[0]||n.cxDirection>0&&e.c[0]<=n.startC[0])&&(e.c[0]=n.startC[0],t=4)):4===t&&(e.c[1]-=n.cyDirection*o,(n.cyDirection<0&&e.c[1]>=n.startC[1]||n.cyDirection>0&&e.c[1]<=n.startC[1])&&(e.c[1]=n.startC[1],t=1)),e.draw(),yo(!0),cr(),e.currentCAnimationFrame=requestAnimationFrame(r)};e.currentCAnimationFrame=requestAnimationFrame(r)});case 1:return t.a(2)}},t,this)})),function(t){return s.apply(this,arguments)})},{key:"animateDemo",value:(i=ui(ai().m(function t(){var n=this;return ai().w(function(t){for(;;)switch(t.n){case 0:return this.stopAllNonColorAnimations(),this.demoActive=!0,t.n=1,new Promise(function(){var t=function(){n.c=[(Math.sin(n.demoTime)+1)/2*1.5-1,(Math.cos(n.demoTime)+1)/2*1.4-.7],n.rotation=J(n.rotation-.001),n.demoTime+=5e-4,n.draw(),yo(!0),cr(),n.currentCAnimationFrame=requestAnimationFrame(t)};n.currentCAnimationFrame=requestAnimationFrame(t)});case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})}],r&&di(e.prototype,r),o&&di(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,i,s,c,u,l,h,m,d,p}(_t);function Ei(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return xi(u,"_invoke",function(e,r,o){var i,s,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,s=0,c=t,h.n=e,a}};function m(e,r){for(s=e,c=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,i=l[n],m=h.p,d=i[2];e>3?(o=d===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=e<2&&m<i[1])?(s=0,h.v=r,h.n=i[1]):m<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,h.n=d,s=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,d),s=l,c=d;(n=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(h.n=-1),m(s,c)):h.n=c:h.v=c);try{if(u=2,i){if(s||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=i.return)&&n.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((n=(f=h.n<0)?c:e.call(r,h))!==a)break}catch(n){i=t,s=1,c=n}finally{u=1}}return{value:n,done:f}}}(e,o,i),!0),u}var a={};function s(){}function c(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(xi(n={},r,function(){return this}),n),f=u.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,xi(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,xi(f,"constructor",u),xi(u,"constructor",c),c.displayName="GeneratorFunction",xi(u,o,"GeneratorFunction"),xi(f),xi(f,o,"Generator"),xi(f,r,function(){return this}),xi(f,"toString",function(){return"[object Generator]"}),(Ei=function(){return{w:i,m:h}})()}function xi(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}xi=function(t,n,e,r){function i(n,e){xi(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},xi(t,n,e,r)}function Pi(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function Si(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){Pi(i,r,o,a,s,"next",t)}function s(t){Pi(i,r,o,a,s,"throw",t)}a(void 0)})}}function Di(){return Li.apply(this,arguments)}function Li(){return Li=Si(Ei().m(function t(){var n,e,r,o,a,s,c,u;return Ei().w(function(t){for(;;)switch(t.n){case 0:(n=document.getElementById("fractalCanvas")).width=window.innerWidth,n.height=window.innerHeight,e=E(),r=null!=e.px&&null!=e.py&&null!=e.zoom&&null!=e.r,o=r&&null!=e.cx&&null!=e.cy,a={pan:[e.px,e.py],zoom:e.zoom,c:[e.cx,e.cy],rotation:e.r},s=function(){c.resizeCanvas(),x()},u=e.mode,t.n=u===i.JULIA?1:u===i.MANDELBROT?2:u===i.RIEMANN?3:4;break;case 1:return c=new Ai(n),t.a(3,5);case 2:return c=new Ne(n),t.a(3,5);case 3:return c=new We(n),t.a(3,5);case 4:return t.a(3,5);case 5:return t.n=6,K(100);case 6:return t.n=7,ri(c);case 7:if(!o){t.n=9;break}return t.n=8,c.animateTravelToPreset(a,1e3);case 8:t.n=12;break;case 9:if(!r){t.n=11;break}return t.n=10,c.animateTravelToPreset(a,100,1e3);case 10:t.n=12;break;case 11:s();case 12:return t.n=13,K(100);case 13:return t.n=14,new Promise(function(t){document.getElementById("headerContainer").classList.add("ready"),document.getElementById("infoLabel").classList.add("ready"),t()});case 14:(r||o)&&(Ro(),Fo());case 15:return t.a(2)}},t)})),Li.apply(this,arguments)}document.addEventListener("DOMContentLoaded",Si(Ei().m(function t(){return Ei().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Di();case 1:return t.n=2,K(2e3);case 2:yo();case 3:return t.a(2)}},t)})),{once:!0})})();
//# sourceMappingURL=bundle.js.map