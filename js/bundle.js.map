{"version":3,"file":"js/bundle.js","mappings":"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","sources":["webpack://fractal-traveler/./src/global/constants.js","webpack://fractal-traveler/./src/global/utils.js","webpack://fractal-traveler/./src/renderers/fractalRenderer.js","webpack://fractal-traveler/./src/renderers/juliaPreviewRenderer.js","webpack://fractal-traveler/./src/ui/juliaPreview.js","webpack://fractal-traveler/./src/ui/mouseEventHandlers.js","webpack://fractal-traveler/./src/ui/touchEventHandlers.js","webpack://fractal-traveler/./src/ui/screenshotController.js","webpack://fractal-traveler/./src/ui/hotkeyController.js","webpack://fractal-traveler/./src/renderers/mandelbrotRenderer.js","webpack://fractal-traveler/./src/renderers/riemannRenderer.js","webpack://fractal-traveler/./src/ui/juliaSlidersController.js","webpack://fractal-traveler/./src/ui/debugPanel.js","webpack://fractal-traveler/./src/ui/ui.js","webpack://fractal-traveler/./src/renderers/juliaRenderer.js","webpack://fractal-traveler/./src/main.js"],"sourcesContent":["/**\r\n * @module Constants\r\n * @author Radim Brnka\r\n * @description Global constants used across the app.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {easeInOut, easeInOutCubic, easeInOutQuint, hexToRGBArray} from \"./utils\";\r\n// region > DEBUG CONSTANTS ////////////////////////////////////////////////////////////////////////////////////////////\r\n/**\r\n * DEBUG_LEVEL\r\n * @enum {number}\r\n */\r\nexport const DEBUG_LEVEL = {\r\n    NONE: 0,\r\n    VERBOSE: 1, /** Logs only */\r\n    FULL: 2\r\n}\r\n\r\n/**\r\n * DEBUG MODE. Set to false for prod deployment!\r\n * @type {DEBUG_LEVEL}\r\n */\r\nexport const DEBUG_MODE = DEBUG_LEVEL.FULL;\r\n\r\n/**\r\n *\r\n * @type {{LOG: string, INFO: string, WARN: string, ERROR: string}}\r\n */\r\nexport const LOG_LEVEL = {\r\n    LOG: 'log',\r\n    DEBUG: 'debug',\r\n    WARN: 'warn',\r\n    ERROR: 'error'\r\n}\r\n\r\n/**\r\n * Logs a message with an optional scope and severity level.\r\n * @param {string} message - The message to log.\r\n * @param {string} [scope=''] - The scope/context of the message.\r\n * @param {string} [severity=LOG_LEVEL.LOG] - The severity level from LOG_LEVEL.\r\n */\r\nexport const log = (message, scope = '', severity = LOG_LEVEL.LOG) => {\r\n    const formattedScope = scope ? `[${scope}]` : '';\r\n\r\n    console[severity](\r\n        `%c${formattedScope}%c ${message}`,\r\n        CONSOLE_GROUP_STYLE,\r\n        CONSOLE_MESSAGE_STYLE\r\n    );\r\n}\r\n// endregion\r\n// region > FEATURE FLAGS\r\n/** Allows switching between fractal while keeping the params to allow Mandelbrot and Julia to match each other */\r\nexport const FF_PERSISTENT_FRACTAL_SWITCHING = true;\r\n\r\n/**\r\n * Feature flag controlling the display of the persistent fractal switching button in the UI.\r\n * When enabled, users can see a button to toggle between fractal types while maintaining\r\n * the current parameters for seamless transitions between Mandelbrot and Julia sets.\r\n * \r\n * @type {boolean}\r\n * @since 1.9\r\n */\r\nexport const FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED = true;\r\n\r\n/**\r\n * Enables bottom bar for user input for custom coords\r\n  */\r\nexport const FF_USER_INPUT_ALLOWED = false;\r\n\r\n/**\r\n *  When enabled, preset travel animations include random rotation during the zoom-in.\r\n * @since 1.9\r\n */\r\nexport const FF_TRAVEL_TO_PRESET_WITH_ROTATION = true;\r\n// endregion ///////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n/**\r\n * Application name\r\n * @type {string}\r\n */\r\nexport const APP_NAME = 'Synaptory Fractal Traveler';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Enum of fractal types\r\n * @enum {number}\r\n */\r\nexport const FRACTAL_TYPE = {\r\n    MANDELBROT: 0,\r\n    JULIA: 1,\r\n    RIEMANN: 2\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Ease in-out transition types matching functions in the Utils module\r\n * @enum {Function}\r\n */\r\nexport const EASE_TYPE = {\r\n    /** No easing (identity function) */\r\n    NONE: (x) => x,\r\n    /** Slow at the end */\r\n    QUAD: easeInOut,\r\n    /** Slower at the end */\r\n    CUBIC: easeInOutCubic,\r\n    /** Slowest at the end */\r\n    QUINT: easeInOutQuint\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Rotation directions\r\n * @enum {number}\r\n */\r\nexport const ROTATION_DIRECTION = {\r\n    /** Counter-clockwise */\r\n    CCW: -1,\r\n    /** Clockwise */\r\n    CW: 1\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Default main GUI color\r\n * @type {string}\r\n */\r\nexport const DEFAULT_ACCENT_COLOR = '#B4FF6A';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Default secondary (background) GUI color\r\n * @type {string}\r\n */\r\nexport const DEFAULT_BG_COLOR = 'rgba(24, 48, 13, 0.2)';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/***\r\n * Default color for console group labels\r\n * @type {string}\r\n */\r\nconst DEFAULT_CONSOLE_GROUP_COLOR = DEFAULT_ACCENT_COLOR;\r\n\r\nconst DEFAULT_CONSOLE_MESSAGE_COLOR = '#fff';\r\n\r\nexport const CONSOLE_GROUP_STYLE = `color: ${DEFAULT_CONSOLE_GROUP_COLOR}`;\r\n\r\nexport const CONSOLE_MESSAGE_STYLE = `color: ${DEFAULT_CONSOLE_MESSAGE_COLOR}`;\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Set of Julia-specific palettes. Keep the default first\r\n * @type {Array.<JULIA_PALETTE>}\r\n */\r\nexport const JULIA_PALETTES = [\r\n    {\r\n        id: 'Cosmos', keyColor: '#fefe66', theme: [\r\n            0.0, 0.0, 0.0,\r\n            1.0, 0.647, 0.0,\r\n            0.0, 0.0, 0.0,\r\n            1.2, 1.2, 1.0,\r\n            0.1, 0.1, 0.1\r\n        ]\r\n    },\r\n    {\r\n        id: 'Blue Mist', keyColor: '#4c4cb3', theme: [\r\n            0.0, 0.0, 0.0,\r\n            1.0, 0.647, 0.0,\r\n            1.0, 1.0, 1.0,\r\n            0.0, 0.0, 1.0,\r\n            0.0, 0.0, 0.5\r\n        ]\r\n    }, {\r\n        id: 'Fire', keyColor: '#663300', theme: [\r\n            0.4, 0.2, 0.0,\r\n            255 / 255, 144 / 255, 10 / 255,\r\n            0.2, 0.0, 0.0,\r\n            0.8, 0.7, 0.0,\r\n            49 / 255, 45 / 255, 4 / 255,\r\n        ]\r\n    },\r\n    {\r\n        id: 'Ocean', keyColor: '#0F52BA', theme: [\r\n            230 / 255, 243 / 255, 255 / 255,\r\n            49 / 255, 141 / 255, 178 / 255,\r\n            0.0, 13 / 255, 26 / 255,\r\n            4 / 255, 105 / 255, 151 / 255,\r\n            0, 40 / 255, 77 / 255\r\n        ]\r\n    },\r\n    {\r\n        id: 'Forest', keyColor: '#25591f', theme: [\r\n            129 / 255, 140 / 255, 60 / 255,\r\n            137 / 255, 89 / 255, 31 / 255,\r\n            45 / 255, 22 / 255, 6 / 255,\r\n            25 / 255, 89 / 255, 13 / 255,\r\n            0, 21 / 255, 0,\r\n        ]\r\n    },\r\n]\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/** Default color used based on the initial Mandelbrot coloring. It's an accent color / 1.9 brightness factor that\r\n * is hardcoded in the updateColorTheme method.\r\n * @type {PALETTE}\r\n */\r\nexport const DEFAULT_MANDELBROT_THEME_COLOR = [95 / 255, 134 / 255, 56 / 255];\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/** Default color used based on the initial Julia coloring. It's accent color / 1.9 brightness factor that\r\n * is hardcoded in the updateColorTheme method.\r\n * @type {PALETTE}\r\n */\r\nexport const DEFAULT_JULIA_THEME_COLOR = hexToRGBArray(JULIA_PALETTES[0].keyColor);\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * This is to allow switching between two precisions as the embedded PI constant is too accurate, which is not needed\r\n * in many cases (rotations etc.)\r\n * @type {boolean}\r\n * @default true\r\n */\r\nconst USE_PRECISE_PI = true;\r\n/**\r\n * PI\r\n * @type {number|number}\r\n */\r\nexport const PI = USE_PRECISE_PI ? Math.PI : 3.1415926535;\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Rotation constants for easy deg/rad conversion\r\n * @enum {number} radians\r\n */\r\nexport const DEG = {\r\n    _30: 30 * (PI / 180),\r\n    _90: 90 * (PI / 180),\r\n    _120: 120 * (PI / 180),\r\n    _150: 150 * (PI / 180),\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\nexport const RANDOMIZE_COLOR_BUTTON_DEFAULT_TITLE = 'Randomize Color Palette (T)';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Defines the compression quality for JPEG screenshots (0-1) in %\r\n * @type {number}\r\n */\r\nexport const SCREENSHOT_JPEG_COMPRESSION_QUALITY = 0.95;","/**\r\n * @module Utils\r\n * @author Radim Brnka\r\n * @description Contains helper functions for working with URL parameters, colors, etc.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, FRACTAL_TYPE, PI} from \"./constants\";\r\n\r\nlet urlParamsSet = false;\r\n\r\n/**\r\n * Updates browser URL with params of the selected point and zoom in the fractal\r\n * @param {FRACTAL_TYPE} mode\r\n * @param {number} px panX\r\n * @param {number} py panY\r\n * @param {number|null} cx Julia only\r\n * @param {number|null} cy Julia only\r\n * @param {number} zoom\r\n * @param {number} rotation\r\n */\r\nexport function updateURLParams(mode, px, py, zoom, rotation, cx = null, cy = null) {\r\n    const formatNumber = (value) => {\r\n        if (value == null) return null;\r\n        // 1517 digits is where JS double precision is meaningfully preserved.\r\n        // toPrecision also uses scientific notation for very small values (deep zoom).\r\n        return Number(value).toPrecision(17);\r\n    };\r\n\r\n    const params = {\r\n        mode: mode != null ? mode.toFixed(0) : FRACTAL_TYPE.MANDELBROT,\r\n        px: formatNumber(px),\r\n        py: formatNumber(py),\r\n        zoom: formatNumber(zoom),\r\n        r: rotation != null ? Number(rotation).toPrecision(17) : 0,\r\n        cx: formatNumber(cx),\r\n        cy: formatNumber(cy),\r\n    };\r\n\r\n    if (DEBUG_MODE) console.log(`%c updateURLParams: %c Setting URL: ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    if ([px, py, zoom, rotation].some(el => el == null)) {\r\n        console.error(`%c updateURLParams: %c Fractal params incomplete, can't generate URL! ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    if (mode === FRACTAL_TYPE.JULIA && [cx, cy].some(el => el == null)) {\r\n        console.error(`%c updateURLParams: %c Julia params incomplete, can't generate URL! ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    // Convert to Base64 for compact representation\r\n    const encodedParams = btoa(JSON.stringify(params));\r\n\r\n    // Update the URL with a single \"params\" field\r\n    const hashPath = mode === FRACTAL_TYPE.JULIA ? '#julia' : '#';\r\n    window.history.pushState({}, '', `${hashPath}?view=${encodedParams}`);\r\n\r\n    urlParamsSet = true;\r\n}\r\n\r\n/**\r\n * Fetches and recalculates coords and zoom from URL and sets them to the fractalApp instance\r\n * @return {URL_PRESET}\r\n */\r\nexport function loadFractalParamsFromURL() {\r\n    if (DEBUG_MODE) console.groupCollapsed(`%c loadFractalParamsFromURL`, CONSOLE_GROUP_STYLE);\r\n\r\n    const url = new URL(window.location.href);\r\n    const hash = url.hash; // Get the hash part of the URL (e.g., #julia?view=...)\r\n\r\n    if (!hash) {\r\n        if (DEBUG_MODE) console.log(`No hash found in the URL, return default mode.`);\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: FRACTAL_TYPE.MANDELBROT}; // Return default if no hash is present\r\n    }\r\n\r\n    // Split the hash to separate the mode and parameters\r\n    const [mode, queryString] = hash.slice(1).split('?'); // Remove the '#' and split by '?'\r\n\r\n    if (!queryString) {\r\n        if (DEBUG_MODE) console.log(`No query string is found in the URL, returning mode only.`);\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT};\r\n    }\r\n\r\n    // Parse the query parameters\r\n    const hashParams = new URLSearchParams(queryString);\r\n    const encodedParams = hashParams.get('view');\r\n\r\n    try {\r\n        // Decode the Base64 string and parse the JSON object\r\n        const decodedParams = JSON.parse(atob(encodedParams));\r\n        if (DEBUG_MODE) console.log(`Decoded params: ${JSON.stringify(decodedParams)}`);\r\n        urlParamsSet = true;\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        // Return the parsed parameters\r\n        return {\r\n            mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT,\r\n            px: decodedParams.px != null ? parseFloat(decodedParams.px) : null,\r\n            py: decodedParams.py != null ? parseFloat(decodedParams.py) : null,\r\n            zoom: decodedParams.zoom != null ? parseFloat(decodedParams.zoom) : null,\r\n            r: decodedParams.r != null ? parseFloat(decodedParams.r) : 0, // Rotation is not necessary to be defined\r\n            cx: decodedParams.cx != null ? parseFloat(decodedParams.cx) : null,\r\n            cy: decodedParams.cy != null ? parseFloat(decodedParams.cy) : null,\r\n        };\r\n    } catch (e) {\r\n        console.error(`%c loadFractalParamsFromURL: %c Error decoding URL parameters: ${e}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        urlParamsSet = true;\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT}; // Return only the mode if no query string is found\r\n    }\r\n}\r\n\r\n/** Clears browser URL, usually when it stops correspond with the position/zoom in the fractal */\r\nexport function clearURLParams() {\r\n    if (!urlParamsSet) return;\r\n\r\n    if (DEBUG_MODE) console.log(`%c clearURLParams: %c Clearing URL params.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    const hash = window.location.hash.split('?')[0]; // Keep only the hash part, discard any query parameters\r\n    const newUrl = `${window.location.origin}/${hash}`;\r\n    window.history.pushState({}, '', newUrl);\r\n    urlParamsSet = false;\r\n}\r\n\r\n/**\r\n * Detects touch device\r\n * @returns {boolean}\r\n */\r\nexport const isTouchDevice = () => 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\r\n\r\n/**\r\n * Detects mobile device\r\n * @returns {boolean} if the user device is mobile\r\n */\r\nexport function isMobileDevice() {\r\n    const toMatch = [/Android/i, /webOS/i, /iPhone/i, /iPad/i, /iPod/i, /BlackBerry/i, /Windows Phone/i];\r\n\r\n    return toMatch.some((toMatchItem) => {\r\n        return navigator.userAgent.match(toMatchItem);\r\n    });\r\n}\r\n\r\n/**\r\n * Generates string in [x, yi] format from the given complex number. Trailing zeroes are trimmed.\r\n * @param {COMPLEX} c\r\n * @param {number} precision Decimal point precision\r\n * @param {boolean} [withI] Append \"i\" to the imaginary member? Ignored if zero.\r\n * @return {string} [x, yi]|[x, 0]|[?, ?]\r\n */\r\nexport function expandComplexToString(c, precision = 6, withI = true) {\r\n    if (DEBUG_MODE) console.groupCollapsed(`%c expandComplexToString`, CONSOLE_GROUP_STYLE);\r\n\r\n    const invalidValues = [NaN, undefined, null, ''];\r\n    const isNumber = (value) => typeof value === 'number' && isFinite(value);\r\n\r\n    let expanded = `[`;\r\n\r\n    if (invalidValues.some(value => value === c[0]) || invalidValues.some(value => value === c[1]) || !isNumber(c[0]) || !isNumber(c[1])) {\r\n        expanded += `?, ?]`;\r\n        console.warn(`%c expandComplexToString: %c Invalid complex number: ${c}`, CONSOLE_GROUP_STYLE);\r\n        console.groupEnd();\r\n        return expanded;\r\n    } else {\r\n        const trimmedReal = parseFloat(c[0].toFixed(precision)).toString();\r\n        const trimmedImag = parseFloat(c[1].toFixed(precision)).toString();\r\n        expanded += `${trimmedReal}, ${trimmedImag}`;\r\n    }\r\n\r\n    if (DEBUG_MODE) console.groupEnd();\r\n    return expanded + ((withI && c[1] !== 0) ? 'i]' : ']');\r\n}\r\n\r\n// region > Double helpers ---------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @enum\r\n * @type {{VELTKAMP_DEKKER: string, GPU_EMULATED_DOUBLE: string}}\r\n */\r\nexport const SPLIT_FLOAT_METHOD = {\r\n    VELTKAMP_DEKKER: 'vd', // Default\r\n    GPU_EMULATED_DOUBLE: 'ed',\r\n}\r\n\r\n/**\r\n * Splits a 64-bit floating point number into two 32-bit parts\r\n * @param {number} value A standard JavaScript 64-bit number.\r\n * @param value\r\n * @param method\r\n * @returns {{high: number, low: number}}\r\n */\r\nexport const splitFloat = (value, method = SPLIT_FLOAT_METHOD.VELTKAMP_DEKKER) =>\r\n    (method === SPLIT_FLOAT_METHOD.GPU_EMULATED_DOUBLE) ? splitFloatED(value) : splitFloatVD(value);\r\n\r\n/**\r\n * The Veltkamp-Dekker Split: This implementation is the classic Veltkamp-Dekker algorithm. It is designed to split\r\n * a 64-bit double into two \"half-precision\" doubles so that their product can be calculated without losing precision.\r\n * @param {number} value A standard JavaScript 64-bit number.\r\n * @returns {{high: number, low: number}}\r\n */\r\nfunction splitFloatVD(value) {\r\n    // 2^27 + 1 is a common splitting point for 53-bit mantissa (JS number)\r\n    // The constant K must be large enough to shift the low bits outside the mantissa range.\r\n    const K = Math.pow(2, 27) + 1;\r\n\r\n    let temp = value * K;\r\n    let high = temp - (temp - value);\r\n    let low = value - high;\r\n\r\n    return {high, low};\r\n}\r\n\r\n/**\r\n * GPU Emulated Double. This is the standard approach for rendering high-precision or astronomical visualizations).\r\n * @param value\r\n * @returns {{high: number, low: number}}\r\n */\r\nfunction splitFloatED(value) {\r\n    // Force the high part to be *exactly* what will be stored in GPU float32.\r\n    const high = Math.fround(value);\r\n    // Residual in double, then quantize to float32 as well (matches GPU storage).\r\n    const low = Math.fround(value - high);\r\n\r\n    return {high, low};\r\n}\r\n\r\n/**\r\n * Creates a double-double precision number object with high and low parts.\r\n * Used for extended precision arithmetic beyond standard 64-bit floating point.\r\n *\r\n * @param {number} [hi=0] - The high-order (primary) part of the number.\r\n * @param {number} [lo=0] - The low-order (error correction) part of the number.\r\n * @returns {{hi: number, lo: number}} A double-double precision number object.\r\n */\r\nexport function ddMake(hi = 0, lo = 0) {\r\n    return {hi, lo};\r\n}\r\n\r\n/**\r\n * Computes the error-free sum of two floating-point numbers using Knuth's two-sum algorithm.\r\n * Returns both the sum and the rounding error, enabling extended precision arithmetic.\r\n *\r\n * @param {number} a - The first number to sum.\r\n * @param {number} b - The second number to sum.\r\n * @returns {{s: number, err: number}} An object containing the sum (s) and the rounding error (err).\r\n */\r\nexport function twoSum(a, b) {\r\n    const s = a + b;\r\n    const bb = s - a;\r\n    const err = (a - (s - bb)) + (b - bb);\r\n    return {s, err};\r\n}\r\n\r\n/**\r\n * Computes the error-free sum of two floating-point numbers where |a| >= |b|.\r\n * This is a faster variant of twoSum that assumes the first argument has greater magnitude.\r\n *\r\n * @param {number} a - The larger magnitude number (must satisfy |a| >= |b|).\r\n * @param {number} b - The smaller magnitude number to add.\r\n * @returns {{s: number, err: number}} An object containing the sum (s) and the rounding error (err).\r\n */\r\nexport function quickTwoSum(a, b) {\r\n    const s = a + b;\r\n    const err = b - (s - a);\r\n    return {s, err};\r\n}\r\n\r\n/**\r\n * Adds a standard floating-point number to a double-double precision number.\r\n * This function mutates the input double-double object and maintains extended precision.\r\n *\r\n * @param {{hi: number, lo: number}} dd - The double-double number to modify (mutated in place).\r\n * @param {number} n - The standard floating-point number to add.\r\n * @returns {{hi: number, lo: number}} The mutated double-double object with the sum.\r\n */\r\nexport function ddAdd(dd, n) {\r\n    const t = twoSum(dd.hi, n);\r\n    const lo = dd.lo + t.err;\r\n    const r = quickTwoSum(t.s, lo);\r\n    dd.hi = r.s;\r\n    dd.lo = r.err;\r\n    return dd;\r\n}\r\n\r\n/**\r\n * Sets the value of a double-double precision object from a standard number.\r\n * This effectively resets the high-precision value to a single 64-bit float,\r\n * clearing any existing low-precision error bits.\r\n *\r\n * @param {{hi: number, lo: number}} dd - The double-double object to modify.\r\n * @param {number} n - The number to assign to the high part.\r\n * @returns {{hi: number, lo: number}} The mutated double-double object.\r\n */\r\nexport function ddSet(dd, n) {\r\n    dd.hi = n;\r\n    dd.lo = 0;\r\n    return dd;\r\n}\r\n\r\n/**\r\n * Returns the standard 64-bit floating-point approximation of a double-double number.\r\n * This combines the high and low parts to reconstruct the full precision value.\r\n *\r\n * @param {{hi: number, lo: number}} dd The double-double number object with high and low precision parts.\r\n * @returns {number} The combined floating-point value.\r\n */\r\nexport function ddValue(dd) {\r\n    return dd.hi + dd.lo;\r\n}\r\n\r\n/**\r\n * Adds two double-double precision numbers and returns a new DD result.\r\n * Uses the Knuth two-sum algorithm for error-free addition.\r\n *\r\n * @param {{hi: number, lo: number}} a - First double-double number.\r\n * @param {{hi: number, lo: number}} b - Second double-double number.\r\n * @returns {{hi: number, lo: number}} The sum as a new double-double number.\r\n */\r\nexport function ddAddDD(a, b) {\r\n    const t = twoSum(a.hi, b.hi);\r\n    const lo = a.lo + b.lo + t.err;\r\n    const r = quickTwoSum(t.s, lo);\r\n    return {hi: r.s, lo: r.err};\r\n}\r\n\r\n/**\r\n * Subtracts two double-double precision numbers (a - b) and returns a new DD result.\r\n *\r\n * @param {{hi: number, lo: number}} a - The minuend (number to subtract from).\r\n * @param {{hi: number, lo: number}} b - The subtrahend (number to subtract).\r\n * @returns {{hi: number, lo: number}} The difference (a - b) as a new double-double number.\r\n */\r\nexport function ddSubDD(a, b) {\r\n    return ddAddDD(a, {hi: -b.hi, lo: -b.lo});\r\n}\r\n\r\n// endregion---------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Compares two complex numbers / arrays of two numbers with given precision\r\n * @param {COMPLEX} c1\r\n * @param {COMPLEX}c2\r\n * @param {number} [precision]\r\n * @return {boolean} true if numbers are equal, false if not\r\n */\r\nexport function compareComplex(c1, c2, precision = 12) {\r\n    return c1[0].toFixed(precision) === c2[0].toFixed(precision) && c1[1].toFixed(precision) === c2[1].toFixed(precision);\r\n}\r\n\r\n/**\r\n * Compares two palettes / arrays of three numbers with given precision (transitively uses the compareComplex)\r\n * @param {PALETTE} p1\r\n * @param {PALETTE} p2\r\n * @param {number} [precision]\r\n * @return {boolean} true if palettes are equal, false if not\r\n */\r\nexport function comparePalettes(p1, p2, precision = 6) {\r\n    return p1[0].toFixed(precision) === p2[0].toFixed(precision) &&\r\n        p1[1].toFixed(precision) === p2[1].toFixed(precision) &&\r\n        p1[2].toFixed(precision) === p2[2].toFixed(precision);\r\n}\r\n\r\n/**\r\n * HSB to RGB conversion helper function\r\n * @param h Hue\r\n * @param s Saturation\r\n * @param b Brightness\r\n * @returns {PALETTE} rgb\r\n */\r\nexport function hsbToRgb(h, s, b) {\r\n    const i = Math.floor(h * 6);\r\n    const f = h * 6 - i;\r\n    const p = b * (1 - s);\r\n    const q = b * (1 - f * s);\r\n    const t = b * (1 - (1 - f) * s);\r\n\r\n    let r, g, bl;\r\n    // @formatter:off\r\n    switch (i % 6) {\r\n        case 0: r = b; g = t; bl = p; break;\r\n        case 1: r = q; g = b; bl = p; break;\r\n        case 2: r = p; g = b; bl = t; break;\r\n        case 3: r = p; g = q; bl = b; break;\r\n        case 4: r = t; g = p; bl = b; break;\r\n        case 5: r = b; g = p; bl = q; break;\r\n    }\r\n    // @formatter:on\r\n    return [r, g, bl];\r\n}\r\n\r\n/**\r\n * Convert HSL (h in [0,1], s in [0,1], l in [0,1]) to RGB (each channel in [0,1])\r\n * @param {number} h Hue\r\n * @param {number} s Saturation\r\n * @param {number} l Lightness\r\n * @return {PALETTE} [r, g ,b]\r\n */\r\nexport function hslToRgb(h, s, l) {\r\n    let r, g, b;\r\n    if (s === 0) {\r\n        r = g = b = l; // achromatic\r\n    } else {\r\n        const hue2rgb = (p, q, t) => {\r\n            if (t < 0) t += 1;\r\n            if (t > 1) t -= 1;\r\n            if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n            if (t < 1 / 2) return q;\r\n            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n            return p;\r\n        };\r\n        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n        const p = 2 * l - q;\r\n        r = hue2rgb(p, q, h + 1 / 3);\r\n        g = hue2rgb(p, q, h);\r\n        b = hue2rgb(p, q, h - 1 / 3);\r\n    }\r\n    return [r, g, b];\r\n}\r\n\r\n/**\r\n * Converts RGB (each in [0,1]) to HSL (h in [0,1], s in [0,1], l in [0,1])\r\n * @param {number} r Red\r\n * @param {number} g Green\r\n * @param {number} b Blue\r\n * @return {Array<number, number, number>} [h, s, l]\r\n */\r\nexport function rgbToHsl(r, g, b) {\r\n    let max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n    let h, s, l = (max + min) / 2;\r\n    if (max === min) {\r\n        h = s = 0; // achromatic\r\n    } else {\r\n        let d = max - min;\r\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n        if (max === r) {\r\n            h = (g - b) / d + (g < b ? 6 : 0);\r\n        } else if (max === g) {\r\n            h = (b - r) / d + 2;\r\n        } else {\r\n            h = (r - g) / d + 4;\r\n        }\r\n        h /= 6;\r\n    }\r\n    return [h, s, l];\r\n}\r\n\r\n/**\r\n * Converts HTML hex color notation to rgb object\r\n * @param {string} hex HTML hex color\r\n * @param {number} [normalize] interval to normalize onto\r\n * @return {{r: number, g: number, b: number}|null}\r\n */\r\nexport function hexToRGB(hex, normalize = 255) {\r\n    // Ensure it's a string and remove any leading #\r\n    hex = hex.toLowerCase().replace(/^#/, \"\");\r\n\r\n    // Convert shorthand \"#abc\"  \"aabbcc\"\r\n    if (hex.length === 3) {\r\n        hex = hex.split(\"\").map(char => char + char).join(\"\");\r\n    }\r\n\r\n    // Validate format\r\n    if (!/^([\\da-f]{6})$/i.test(hex)) {\r\n        return null;\r\n    }\r\n\r\n    // Convert HEX to RGB (0-255)\r\n    const r = parseInt(hex.substring(0, 2), 16);\r\n    const g = parseInt(hex.substring(2, 4), 16);\r\n    const b = parseInt(hex.substring(4, 6), 16);\r\n\r\n    // Normalize to 0-1 range\r\n    return {\r\n        r: r / normalize,\r\n        g: g / normalize,\r\n        b: b / normalize\r\n    };\r\n}\r\n\r\n/**\r\n * Converts HTML hex color notation to rgb array\r\n * @param {string} hex HTML hex color\r\n * @param {number} [normalize] interval to normalize onto\r\n * @return {number[]|null} [r, g, b]\r\n */\r\nexport function hexToRGBArray(hex, normalize = 255) {\r\n    const rgb = hexToRGB(hex, normalize);\r\n    return [rgb.r, rgb.g, rgb.b];\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing. This function accelerates in the first half (using 2*t) and decelerates in\r\n * the second half.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOut(time) {\r\n    return time < 0.5 ? 2 * time * time : -1 + (4 - 2 * time) * time;\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing. The cubic version tends to have a smoother acceleration at the beginning and\r\n * a gentler deceleration at the end, to start more gradually and then slow down more smoothly toward the end.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOutCubic(time) {\r\n    return time < 0.5\r\n        ? 4 * time * time * time\r\n        : 1 - Math.pow(-2 * time + 2, 3) / 2;\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing using a quintic curve.\r\n * This function starts gradually, accelerates, then decelerates more gently near the end.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOutQuint(time) {\r\n    return time < 0.5\r\n        ? 16 * Math.pow(time, 5)\r\n        : 1 - Math.pow(-2 * time + 2, 5) / 2;\r\n}\r\n\r\n/**\r\n * Helper function for linear interpolation\r\n * @param {number} start\r\n * @param {number} end\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number}\r\n */\r\nexport function lerp(start, end, time) {\r\n    return start + (end - start) * time;\r\n}\r\n\r\n/**\r\n * Converts degrees from JSON to Radians for GLSL uniforms\r\n * @param {number} degrees\r\n * @returns {number} radians\r\n */\r\nexport function degToRad(degrees) {\r\n    return degrees * (PI / 180);\r\n}\r\n\r\n/**\r\n * Normalizes rotation into into [0, 2*PI] interval\r\n * @param {number} rotation in rad\r\n * @return {number} rotation in rad\r\n */\r\nexport function normalizeRotation(rotation) {\r\n    const twoPi = 2 * PI;\r\n    return (rotation % twoPi + twoPi) % twoPi;\r\n}\r\n\r\n/**\r\n * Computes a duration based on the travel distance between current and target parameters. Iterates over each property\r\n * in target (assuming current and target have the same structure)\r\n * @param {number} seed - A scaling factor to adjust the overall duration.\r\n * @param {object} current - An object with current values\r\n * @param {object} target - An object with target values\r\n * @param {object} [weights] - Optional weights\r\n * @returns {number} The computed duration.\r\n */\r\nexport function getAnimationDuration(seed, current, target, weights = {}) {\r\n    let compositeDistance = 0;\r\n    for (const key in target) {\r\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\r\n            const w = weights[key] !== undefined ? weights[key] : 1.0;\r\n            const currVal = current[key];\r\n            const targVal = target[key];\r\n            let diff = 0;\r\n\r\n            // If the property is a number, use absolute difference.\r\n            if (typeof targVal === 'number' && typeof currVal === 'number') {\r\n                diff = Math.abs(targVal - currVal);\r\n            }\r\n            // If the property is an array, compute the Euclidean distance between the two arrays.\r\n            else if (Array.isArray(targVal) && Array.isArray(currVal)) {\r\n                // Assume both arrays have the same length.\r\n                diff = Math.hypot(...targVal.map((v, i) => v - (currVal[i] || 0)));\r\n            }\r\n\r\n            compositeDistance += w * diff;\r\n        }\r\n    }\r\n    return Math.round(seed * compositeDistance);\r\n}\r\n\r\n/**\r\n * Helper function that returns a Promise that resolves after timeout.\r\n * @param {number} timeout in ms\r\n * @return {Promise<unknown>}\r\n */\r\nexport async function asyncDelay(timeout) {\r\n    return new Promise(resolve => setTimeout(resolve, timeout));\r\n}\r\n\r\n/**\r\n * Calculates the change in pan based on the movement delta, the canvas rectangle, current zoom, and rotation.\r\n *\r\n * @param {number} currentX The current X coordinate (clientX or touch.clientX).\r\n * @param {number} currentY The current Y coordinate.\r\n * @param {number} lastX The previous X coordinate.\r\n * @param {number} lastY The previous Y coordinate.\r\n * @param {DOMRect} rect The canvas bounding rectangle.\r\n * @param {number} rotation The current rotation (in radians).\r\n * @param {number} zoom The current zoom factor.\r\n * @returns {Array<number>} An array [deltaPanX, deltaPanY] that should be added to the current pan.\r\n */\r\nexport function calculatePanDelta(currentX, currentY, lastX, lastY, rect, rotation, zoom) {\r\n    const moveX = currentX - lastX;\r\n    const moveY = currentY - lastY;\r\n\r\n    const ref = Math.min(rect.width, rect.height);\r\n\r\n    // Apply inverse rotation to the movement, so it aligns with fractal pan direction.\r\n    const cosR = Math.cos(-rotation);\r\n    const sinR = Math.sin(-rotation);\r\n    const rotatedMoveX = cosR * moveX - sinR * moveY;\r\n    const rotatedMoveY = sinR * moveX + cosR * moveY;\r\n\r\n    // Scale movement relative to canvas size and zoom.\r\n    const deltaPanX = -(rotatedMoveX / ref) * zoom;\r\n    const deltaPanY = +(rotatedMoveY / ref) * zoom;\r\n\r\n    return [deltaPanX, deltaPanY];\r\n}\r\n\r\n/**\r\n * Removes array of buttons from the scene and clears it.\r\n * @param {Array<HTMLButtonElement>} buttons\r\n */\r\nexport function destroyArrayOfButtons(buttons) {\r\n    if (Array.isArray(buttons)) {\r\n        buttons.forEach(btn => {\r\n            if (btn.parentNode) {\r\n                btn.parentNode.removeChild(btn);\r\n            }\r\n        });\r\n        buttons.length = 0;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the name of the fractal mode.\r\n * @param {number} type\r\n */\r\nexport function getFractalName(type) {\r\n    return Object.keys(FRACTAL_TYPE).find(key => FRACTAL_TYPE[key] === type) || \"UNKNOWN\";\r\n}","import {debugPanel, updateInfo} from \"../ui/ui\";\r\nimport {\r\n    compareComplex,\r\n    comparePalettes,\r\n    ddAdd,\r\n    ddMake,\r\n    ddSet,\r\n    ddValue,\r\n    hslToRgb,\r\n    lerp,\r\n    normalizeRotation,\r\n    rgbToHsl\r\n} from \"../global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, EASE_TYPE, log, PI} from \"../global/constants\";\r\nimport vertexFragmentShaderRaw from '../shaders/vertexShaderInit.vert';\r\n\r\n/**\r\n * FractalRenderer\r\n *\r\n * @author Radim Brnka (c) 2025-2026\r\n * @description This module defines a fractalRenderer abstract class that encapsulates the WebGL code, including shader compilation, drawing, reset, and screenToFractal conversion. It also includes common animation methods.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n * @abstract\r\n */\r\nclass FractalRenderer {\r\n\r\n    /**\r\n     * @param {HTMLCanvasElement} canvas\r\n     */\r\n    constructor(canvas) {\r\n        this.canvas = canvas;\r\n        this.gl = this.canvas.getContext(\"webgl\", {\r\n            antialias: false,\r\n            alpha: false,\r\n            depth: false,\r\n            stencil: false,\r\n            preserveDrawingBuffer: false,\r\n            powerPreference: \"high-performance\",\r\n        });\r\n\r\n        if (!this.gl) {\r\n            alert('WebGL is not supported by your browser or crashed.');\r\n            return;\r\n        }\r\n\r\n        // Defaults:\r\n        this.MAX_ITER = 2000;\r\n\r\n        this.DEFAULT_ROTATION = 0;\r\n        this.DEFAULT_ZOOM = 3.0;\r\n        /** @type {COMPLEX} */\r\n        this.DEFAULT_PAN = [0, 0];\r\n        this.DEFAULT_PALETTE = [1.0, 1.0, 1.0];\r\n        this.MAX_ZOOM = 1e-80;\r\n        this.MIN_ZOOM = 40;\r\n\r\n        /**\r\n         * Interesting points / details / zooms / views\r\n         * @type {Array.<PRESET>}\r\n         */\r\n        this.PRESETS = [];\r\n\r\n        /** @type {number} */\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n\r\n        /** @type {COMPLEX} */\r\n        this.pan = [...this.DEFAULT_PAN];\r\n\r\n        /** DD accumulator mirrors into this.pan */\r\n        this.panDD = {\r\n            x: ddMake(this.pan[0], 0),\r\n            y: ddMake(this.pan[1], 0),\r\n        };\r\n\r\n        /**\r\n         * Rotation in rad\r\n         * @type {number}\r\n         */\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n\r\n        this.currentPanAnimationFrame = null;\r\n        this.currentZoomAnimationFrame = null;\r\n        this.currentRotationAnimationFrame = null;\r\n        this.currentColorAnimationFrame = null;\r\n\r\n        this.demoActive = false;\r\n        this.currentPresetIndex = 0;\r\n\r\n        this.interactionActive = false;\r\n        this.interactionTimer = null;\r\n\r\n        /** @type {number} */\r\n        this.iterations = 0;\r\n        this.extraIterations = 0;\r\n\r\n        this.bestScore = NaN;\r\n        this.probeIters = NaN;\r\n\r\n\r\n        /** @type PALETTE */\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        /** Vertex shader */\r\n        this.vertexShaderSource = vertexFragmentShaderRaw;\r\n\r\n        this.onWebGLContextLost = this.onWebGLContextLost.bind(this);\r\n        this.canvas.addEventListener('webglcontextlost', this.onWebGLContextLost);\r\n    }\r\n\r\n    /**\r\n     * Hook for perturbation renderers to request orbit rebuild.\r\n     * No-op by default.\r\n     */\r\n    markOrbitDirty() {}\r\n\r\n    // --------- Pan API (use these; they keep DD + array in sync) ---------\r\n\r\n    /** @returns {number[]} the canonical array */\r\n    getPan() {\r\n        return [this.pan[0], this.pan[1]];\r\n    }\r\n\r\n    /**\r\n     * Sets the pan values for the object.\r\n     *\r\n     * @param {number} x - The horizontal pan value.\r\n     * @param {number} y - The vertical pan value.\r\n     * @return {void}\r\n     */\r\n    setPan(x, y) {\r\n        ddSet(this.panDD.x, x);\r\n        ddSet(this.panDD.y, y);\r\n        this.pan[0] = ddValue(this.panDD.x);\r\n        this.pan[1] = ddValue(this.panDD.y);\r\n    }\r\n\r\n    /**\r\n     * Adjusts the pan values by adding the specified deltas to the current pan values.\r\n     *\r\n     * @param {number} dx - The change in the x-direction to be added to the pan.\r\n     * @param {number} dy - The change in the y-direction to be added to the pan.\r\n     * @return {void}\r\n     */\r\n    addPan(dx, dy) {\r\n        ddAdd(this.panDD.x, dx);\r\n        ddAdd(this.panDD.y, dy);\r\n        this.pan[0] = ddValue(this.panDD.x);\r\n        this.pan[1] = ddValue(this.panDD.y);\r\n    }\r\n\r\n    /**\r\n     * Set pan so that fractal point (fxAnchor,fyAnchor) remains under a screen point\r\n     * whose view vector is (vx,vy).\r\n     */\r\n    setPanFromAnchor(fxAnchor, fyAnchor, vx, vy) {\r\n        const px = fxAnchor - vx * this.zoom;\r\n        const py = fyAnchor - vy * this.zoom;\r\n        this.setPan(px, py);\r\n    }\r\n\r\n    /**\r\n     * Sets zoom while keeping the fractal point under a given screen anchor fixed.\r\n     * Uses DD-preserving arithmetic to avoid precision loss at deep zoom.\r\n     *\r\n     * @param {number} targetZoom\r\n     * @param {number} anchorX CSS px relative to canvas\r\n     * @param {number} anchorY CSS px relative to canvas\r\n     */\r\n    setZoomKeepingAnchor(targetZoom, anchorX, anchorY) {\r\n        // View vector (rotated + aspect corrected) is stable because it does not include pan/zoom.\r\n        const [vx, vy] = this.screenToViewVector(anchorX, anchorY);\r\n\r\n        // To keep fractal point under cursor fixed:\r\n        // Old: fractalPt = pan + v * oldZoom\r\n        // New: fractalPt = newPan + v * newZoom\r\n        // Therefore: newPan = pan + v * (oldZoom - newZoom)\r\n        // Using addPan preserves DD precision (unlike setPan which resets lo=0)\r\n        const deltaZoom = this.zoom - targetZoom;\r\n        this.addPan(vx * deltaZoom, vy * deltaZoom);\r\n\r\n        this.zoom = targetZoom;\r\n    }\r\n\r\n    /**\r\n     * Marks the app as \"in interaction\" (drag/wheel/key-pan) and schedules a settle phase.\r\n     * Perturbation renderers can use this to defer expensive orbit rebuilds until the user stops moving.\r\n     *\r\n     * @param {number} settleMs\r\n     */\r\n    noteInteraction(settleMs = 160) {\r\n        this.interactionActive = true;\r\n\r\n        if (this.interactionTimer) {\r\n            clearTimeout(this.interactionTimer);\r\n            this.interactionTimer = null;\r\n        }\r\n\r\n        this.interactionTimer = setTimeout(() => {\r\n            this.interactionActive = false;\r\n\r\n            // Request a clean rebuild at rest for perturbation renderers (safe no-op otherwise)\r\n            this.markOrbitDirty();\r\n\r\n            // One clean redraw at settle time (prevents swim and removes lingering error)\r\n            this.draw();\r\n            updateInfo(true);\r\n        }, settleMs);\r\n    }\r\n\r\n    onWebGLContextLost(event) {\r\n        event.preventDefault();\r\n        console.warn(\r\n            `%c ${this.constructor.name}: onWebGLContextLost %c WebGL context lost. Attempting to recover...`,\r\n            CONSOLE_GROUP_STYLE,\r\n            CONSOLE_MESSAGE_STYLE\r\n        );\r\n        this.init();\r\n    }\r\n\r\n    /** Destructor */\r\n    destroy() {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: %c destroy`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        // Cancel any ongoing animations.\r\n        this.stopAllNonColorAnimations();\r\n        this.stopCurrentColorAnimations();\r\n\r\n        // Remove event listeners from the canvas.\r\n        if (this.canvas) {\r\n            this.canvas.removeEventListener('webglcontextlost', this.onWebGLContextLost);\r\n        }\r\n\r\n        // Free WebGL resources.\r\n        if (this.program) {\r\n            this.gl.deleteProgram(this.program);\r\n            this.program = null;\r\n        }\r\n        if (this.vertexShader) {\r\n            this.gl.deleteShader(this.vertexShader);\r\n            this.vertexShader = null;\r\n        }\r\n        if (this.fragmentShader) {\r\n            this.gl.deleteShader(this.fragmentShader);\r\n            this.fragmentShader = null;\r\n        }\r\n\r\n        if (this.interactionTimer) {\r\n            clearTimeout(this.interactionTimer);\r\n            this.interactionTimer = null;\r\n        }\r\n\r\n        this.canvas = null;\r\n        this.gl = null;\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    //region > CONTROL METHODS -----------------------------------------------------------------------------------------\r\n\r\n    generatePresetIDs() {\r\n        this.PRESETS.forEach((preset, index) => {\r\n            preset.id = index;\r\n        });\r\n    }\r\n\r\n    init() {\r\n        this.generatePresetIDs();\r\n        this.initGLProgram();\r\n        this.draw();\r\n    }\r\n\r\n    resizeCanvas() {\r\n        log(`resizeCanvas`, this.constructor.name);\r\n\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Keep the center fixed\r\n        const oldRect = this.canvas.getBoundingClientRect();\r\n        const cx = oldRect.width / 2;\r\n        const cy = oldRect.height / 2;\r\n\r\n        const [centerFx, centerFy] = this.screenToFractal(cx, cy);\r\n\r\n        const dpr = window.devicePixelRatio || 1;\r\n        this.canvas.width = Math.floor(oldRect.width * dpr);\r\n        this.canvas.height = Math.floor(oldRect.height * dpr);\r\n\r\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n        if (this.resolutionLoc) this.gl.uniform2f(this.resolutionLoc, this.canvas.width, this.canvas.height);\r\n\r\n        const [vx, vy] = this.screenToViewVector(cx, cy);\r\n        this.setPanFromAnchor(centerFx, centerFy, vx, vy);\r\n\r\n        // After resizing, request a clean rebuild for perturbation renderers (safe no-op otherwise)\r\n        this.markOrbitDirty();\r\n        this.draw();\r\n    }\r\n\r\n\r\n    /**\r\n     * Defines the shader code for rendering the fractal shape\r\n     *\r\n     * @abstract\r\n     * @returns {string}\r\n     */\r\n    createFragmentShaderSource() {\r\n        throw new Error('The draw method must be implemented in child classes');\r\n    }\r\n\r\n    /**\r\n     * Compiles shader code\r\n     * @param {string} source\r\n     * @param {GLenum} type\r\n     * @return {WebGLShader|null}\r\n     */\r\n    compileShader(source, type) {\r\n        if (DEBUG_MODE) {\r\n            console.groupCollapsed(`%c ${this.constructor.name}: %c compileShader`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n            console.log(`Shader GLenum type: ${type}\\nShader code: ${source}`);\r\n        }\r\n\r\n        const shader = this.gl.createShader(type);\r\n        this.gl.shaderSource(shader, source);\r\n        this.gl.compileShader(shader);\r\n\r\n        if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\r\n            console.error(this.gl.getShaderInfoLog(shader));\r\n            this.gl.deleteShader(shader);\r\n            if (DEBUG_MODE) console.groupEnd();\r\n            return null;\r\n        }\r\n        if (DEBUG_MODE) console.groupEnd();\r\n\r\n        return shader;\r\n    }\r\n\r\n    /**\r\n     * Initializes WebGL program, shaders, quad, and uniform caches.\r\n     */\r\n    initGLProgram() {\r\n        if (DEBUG_MODE) console.groupCollapsed(`%c ${this.constructor.name}:%c initGLProgram`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.program) this.gl.deleteProgram(this.program);\r\n        if (this.fragmentShader) this.gl.deleteShader(this.fragmentShader);\r\n\r\n        if (!this.vertexShader) {\r\n            this.vertexShader = this.compileShader(this.vertexShaderSource, this.gl.VERTEX_SHADER);\r\n        }\r\n        this.fragmentShader = this.compileShader(this.createFragmentShaderSource(), this.gl.FRAGMENT_SHADER);\r\n\r\n        this.program = this.gl.createProgram();\r\n        this.gl.attachShader(this.program, this.vertexShader);\r\n        this.gl.attachShader(this.program, this.fragmentShader);\r\n        this.gl.linkProgram(this.program);\r\n\r\n        if (!this.gl.getProgramParameter(this.program, this.gl.LINK_STATUS)) {\r\n            console.error(this.gl.getProgramInfoLog(this.program));\r\n        }\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Full-screen quad\r\n        const positionBuffer = this.gl.createBuffer();\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, positionBuffer);\r\n        const positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, positions, this.gl.STATIC_DRAW);\r\n        const positionLoc = this.gl.getAttribLocation(this.program, \"a_position\");\r\n        this.gl.enableVertexAttribArray(positionLoc);\r\n        this.gl.vertexAttribPointer(positionLoc, 2, this.gl.FLOAT, false, 0, 0);\r\n\r\n        this.updateUniforms();\r\n\r\n        if (typeof this.onProgramCreated === \"function\") {\r\n            this.onProgramCreated();\r\n        }\r\n\r\n        if (DEBUG_MODE) console.groupEnd();\r\n    }\r\n\r\n    /** @abstract */\r\n    onProgramCreated() {\r\n        throw new Error(\"The onProgramCreated method must be implemented in child classes\");\r\n    }\r\n\r\n    /**\r\n     * kept for compatibility; perturbation renderers may ignore\r\n     * @abstract\r\n     */\r\n    needsRebase() {\r\n        throw new Error(\"The needsRebase method must be implemented in child classes\");\r\n    }\r\n\r\n    /**\r\n     * Cache common uniforms used by all renderers\r\n     */\r\n    updateUniforms() {\r\n        this.gl.useProgram(this.program);\r\n        this.panLoc = this.gl.getUniformLocation(this.program, \"u_pan\");\r\n        this.zoomLoc = this.gl.getUniformLocation(this.program, \"u_zoom\");\r\n        this.iterLoc = this.gl.getUniformLocation(this.program, \"u_iterations\");\r\n        this.colorLoc = this.gl.getUniformLocation(this.program, \"u_colorPalette\");\r\n        this.rotationLoc = this.gl.getUniformLocation(this.program, \"u_rotation\");\r\n        this.resolutionLoc = this.gl.getUniformLocation(this.program, \"u_resolution\");\r\n    }\r\n\r\n    /**\r\n     * Draws the fractal and sets basic uniforms.\r\n     * Subclasses can override draw() but must call super.draw() for viewport+common uniforms+draw call.\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        const w = this.canvas.width;\r\n        const h = this.canvas.height;\r\n\r\n        this.gl.viewport(0, 0, w, h);\r\n\r\n        if (this.resolutionLoc) this.gl.uniform2f(this.resolutionLoc, w, h);\r\n        if (this.panLoc) this.gl.uniform2fv(this.panLoc, this.pan);\r\n        if (this.zoomLoc) this.gl.uniform1f(this.zoomLoc, this.zoom);\r\n        if (this.rotationLoc) this.gl.uniform1f(this.rotationLoc, this.rotation);\r\n        if (this.iterLoc) this.gl.uniform1f(this.iterLoc, this.iterations);\r\n        if (this.colorLoc) this.gl.uniform3fv(this.colorLoc, this.colorPalette);\r\n\r\n        this.gl.clearColor(0, 0, 0, 1);\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n        debugPanel?.beginGpuTimer();\r\n        this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n        debugPanel?.endGpuTimer();\r\n    }\r\n\r\n    /**\r\n     * Resets the fractal to its initial state (default pan, zoom, palette, rotation, etc.), resizes and redraws.\r\n     */\r\n    reset() {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: reset`, CONSOLE_GROUP_STYLE);\r\n\r\n        this.stopAllNonColorAnimations();\r\n        this.stopCurrentColorAnimations();\r\n\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]);\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n        this.extraIterations = 0;\r\n        this.currentPresetIndex = 0;\r\n\r\n        this.resizeCanvas();\r\n\r\n        this.markOrbitDirty();\r\n        this.draw();\r\n\r\n        console.groupEnd();\r\n        updateInfo();\r\n    }\r\n\r\n    /**\r\n     * Screen point -> fractal coordinates (float64 JS side; fine for UI)\r\n     * @param {number} screenX\r\n     * @param {number} screenY\r\n     * @returns {COMPLEX}\r\n     */\r\n    screenToFractal(screenX, screenY) {\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        const w = rect.width * dpr;\r\n        const h = rect.height * dpr;\r\n\r\n        const bufferX = screenX * dpr;\r\n        const bufferY = screenY * dpr;\r\n\r\n        const normX = bufferX / w;\r\n        const normY = bufferY / h;\r\n\r\n        let stX = normX - 0.5;\r\n        let stY = (1 - normY) - 0.5;\r\n\r\n        const aspect = w / h;\r\n        stX *= aspect;\r\n\r\n        const cosR = Math.cos(this.rotation);\r\n        const sinR = Math.sin(this.rotation);\r\n        const rotatedX = cosR * stX - sinR * stY;\r\n        const rotatedY = sinR * stX + cosR * stY;\r\n\r\n        return [rotatedX * this.zoom + this.pan[0], rotatedY * this.zoom + this.pan[1]];\r\n    }\r\n\r\n    /**\r\n     * Convert a screen point to the rotated, aspect-corrected \"view vector\" (no pan/zoom applied).\r\n     * This is exactly what your shader calls `rotated`.\r\n     *\r\n     * @param {number} screenX CSS pixels relative to canvas (like your handlers use)\r\n     * @param {number} screenY CSS pixels relative to canvas\r\n     * @returns {number[]} view-space rotated vector\r\n     */\r\n    screenToViewVector(screenX, screenY) {\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        const w = rect.width * dpr;\r\n        const h = rect.height * dpr;\r\n\r\n        const bufferX = screenX * dpr;\r\n        const bufferY = screenY * dpr;\r\n\r\n        const normX = bufferX / w;\r\n        const normY = bufferY / h;\r\n\r\n        let stX = normX - 0.5;\r\n        let stY = (1 - normY) - 0.5;\r\n\r\n        const aspect = w / h;\r\n        stX *= aspect;\r\n\r\n        const cosR = Math.cos(this.rotation);\r\n        const sinR = Math.sin(this.rotation);\r\n\r\n        return [cosR * stX - sinR * stY, sinR * stX + cosR * stY];\r\n    }\r\n\r\n    /**\r\n     * Compute CSS-space center of the canvas (for default anchored zoom).\r\n     * @returns {number[]}\r\n     */\r\n    getCanvasCssCenter() {\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        return [rect.width / 2, rect.height / 2];\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /** Stops all currently running animations that are not a color transition */\r\n    stopAllNonColorAnimations() {\r\n        console.log(`%c ${this.constructor.name}: %c stopAllNonColorAnimations`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        this.stopCurrentPanAnimation();\r\n        this.stopCurrentZoomAnimation();\r\n        this.stopCurrentRotationAnimation();\r\n    }\r\n\r\n    /** Stops currently running pan animation */\r\n    stopCurrentPanAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentPanAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentPanAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentPanAnimationFrame);\r\n            this.currentPanAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running zoom animation */\r\n    stopCurrentZoomAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentZoomAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentZoomAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentZoomAnimationFrame);\r\n            this.currentZoomAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running rotation animation */\r\n    stopCurrentRotationAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentRotationAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentRotationAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentRotationAnimationFrame);\r\n            this.currentRotationAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running color animation */\r\n    stopCurrentColorAnimations() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentColorAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentColorAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentColorAnimationFrame);\r\n            this.currentColorAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops current demo and resets demo variables */\r\n    stopDemo() {\r\n        console.log(`%c ${this.constructor.name}: %c stopDemo`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        this.demoActive = false;\r\n        this.currentPresetIndex = 0;\r\n        this.stopAllNonColorAnimations();\r\n    }\r\n\r\n    /** Default callback after every animation that requires on-screen info update */\r\n    onAnimationFinished() {\r\n        setTimeout(() => updateInfo(), 50);\r\n    }\r\n\r\n    /**\r\n     * Smoothly transitions fractalApp.colorPalette from its current value\r\n     * to the provided newPalette over the specified duration (in milliseconds).\r\n     *\r\n     * @param {PALETTE} newPalette - The target palette as [r, g, b] (each in [0,1]).\r\n     * @param {number} [duration] - Duration of the transition in milliseconds.\r\n     * @param {Function} [coloringCallback] A method called at every animation step\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateColorPaletteTransition(newPalette, duration = 250, coloringCallback = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateColorPaletteTransition`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        if (comparePalettes(this.colorPalette, newPalette)) {\r\n            console.warn(`Identical palette found. Skipping.`);\r\n            return;\r\n        }\r\n        console.log(`Animating to ${newPalette}.`);\r\n\r\n        const startPalette = [...this.colorPalette];\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                this.colorPalette = [\r\n                    lerp(startPalette[0], newPalette[0], progress),\r\n                    lerp(startPalette[1], newPalette[1], progress),\r\n                    lerp(startPalette[2], newPalette[2], progress),\r\n                ];\r\n                this.draw();\r\n\r\n                if (coloringCallback) coloringCallback();\r\n\r\n                if (progress < 1) {\r\n                    this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentColorAnimations();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates fractalApp.colorPalette by cycling through the entire color space.\r\n     * The palette will continuously change hue from 0 to 360 degrees and starts from the current palette\r\n     *\r\n     * @param {number} [duration] - Duration (in milliseconds) for one full color cycle.\r\n     * @param {Function} [coloringCallback]\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateFullColorSpaceCycle(duration = 15000, coloringCallback = null) {\r\n        console.log(`%c ${this.constructor.name}: animateFullColorSpaceCycle`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        const currentRGB = this.colorPalette;\r\n        const hsl = rgbToHsl(currentRGB[0], currentRGB[1], currentRGB[2]);\r\n        const startHue = hsl[0]; // starting hue in [0, 1]\r\n        const fixedS = 1.0;\r\n        const fixedL = 0.6;\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const newHue = (startHue + progress) % 1;\r\n\r\n                this.colorPalette = hslToRgb(newHue, fixedS, fixedL);\r\n                this.draw();\r\n\r\n                if (coloringCallback) coloringCallback();\r\n\r\n                this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n            };\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates pan from current position to the new one\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanTo(targetPan, duration = 200, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentPanAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (compareComplex(this.pan, targetPan, 6)) {\r\n            console.log(`Already at the target pan. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n        console.log(`Panning to ${targetPan}.`);\r\n\r\n        const startPan = [...this.pan];\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const k = easeFunction(t);\r\n\r\n                const nx = lerp(startPan[0], targetPan[0], k);\r\n                const ny = lerp(startPan[1], targetPan[1], k);\r\n                this.setPan(nx, ny);\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentPanAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates pan by a delta (DD-stable). Unlike animatePanTo, this avoids computing\r\n     * targetPan = startPan + delta in a single float64 operation (which breaks in deep zoom).\r\n     *\r\n     * This method applies incremental DD pan updates based on animation progress.\r\n     *\r\n     * @param {COMPLEX} deltaPan\r\n     * @param [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise}\r\n     */\r\n    async animatePanBy(deltaPan, duration = 200, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanBy`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentPanAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (Math.abs(deltaPan[0]) < 1e-30 && Math.abs(deltaPan[1]) < 1e-30) {\r\n            console.log(`Zero delta pan. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        console.log(`Panning by ${deltaPan}.`);\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n            let prevK = 0;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n                const k = easeFunction(t);\r\n\r\n                const dk = k - prevK;\r\n                prevK = k;\r\n\r\n                if (dk !== 0) {\r\n                    this.addPan(deltaPan[0] * dk, deltaPan[1] * dk);\r\n                }\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentPanAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates zoom while keeping the fractal point under an anchor screen coordinate fixed.\r\n     *\r\n     * @param {number} targetZoom\r\n     * @param {number} [duration]\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @param {number|null} [anchorX] CSS px relative to canvas; defaults to canvas center\r\n     * @param {number|null} [anchorY] CSS px relative to canvas; defaults to canvas center\r\n     */\r\n    async animateZoomTo(targetZoom, duration = 500, easeFunction = EASE_TYPE.NONE, anchorX = null, anchorY = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentZoomAnimation();\r\n\r\n        if (this.zoom.toFixed(20) === targetZoom.toFixed(20)) {\r\n            console.log(`Already at the target zoom. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        // Default anchor = canvas center (CSS)\r\n        if (anchorX === null || anchorY === null) {\r\n            const [cx, cy] = this.getCanvasCssCenter();\r\n            anchorX = cx;\r\n            anchorY = cy;\r\n        }\r\n\r\n        const startZoom = this.zoom;\r\n        const ratio = targetZoom / startZoom;\r\n\r\n        // Compute anchor once. During zoom animation, rotation is constant, so view-vector stays valid.\r\n        const [vx, vy] = this.screenToViewVector(anchorX, anchorY);\r\n        const fxAnchor = vx * startZoom + this.pan[0];\r\n        const fyAnchor = vy * startZoom + this.pan[1];\r\n\r\n        // orbit boundary policy hook (safe no-op for non-perturbation renderers)\r\n        this.markOrbitDirty();\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                if (easeFunction !== EASE_TYPE.NONE) {\r\n                    const k = easeFunction(t);\r\n                    this.zoom = startZoom + (targetZoom - startZoom) * k;\r\n                } else {\r\n                    this.zoom = startZoom * Math.pow(ratio, t);\r\n                }\r\n\r\n                // Recompute pan from the fixed anchor point (stable in deep zoom)\r\n                this.setPanFromAnchor(fxAnchor, fyAnchor, vx, vy);\r\n\r\n                this.markOrbitDirty();\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentZoomAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates zoom from current value to target zoom without adjusting pan position.\r\n     * Unlike animateZoomTo, this method does not keep any anchor point fixed during zooming.\r\n     * The fractal will appear to zoom in/out from its current center position.\r\n     *\r\n     * @param {number} targetZoom - The target zoom level to animate to\r\n     * @param {number} [duration=500] - Duration of the animation in milliseconds\r\n     * @param {EASE_TYPE|Function} [easeFunction=EASE_TYPE.NONE] - Easing function to apply; EASE_TYPE.NONE uses exponential interpolation\r\n     * @returns {Promise<void>} Promise that resolves when the animation completes\r\n     */\r\n    async animateZoomToNoPan(targetZoom, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomToNoPan`, CONSOLE_GROUP_STYLE);\r\n\r\n        this.stopCurrentZoomAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (this.zoom.toFixed(12) === targetZoom.toFixed(12)) return;\r\n\r\n        const startZoom = this.zoom;\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                if (easeFunction !== EASE_TYPE.NONE) {\r\n                    const k = easeFunction(t);\r\n                    this.zoom = startZoom + (targetZoom - startZoom) * k;\r\n                } else {\r\n                    this.zoom = startZoom * Math.pow(targetZoom / startZoom, t);\r\n                }\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentZoomAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    async animateRotationTo(targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateRotationTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentRotationAnimation();\r\n\r\n        targetRotation = normalizeRotation(targetRotation);\r\n\r\n        if (this.rotation.toFixed(6) === targetRotation.toFixed(6)) {\r\n            console.log(`Already at the target rotation \"${targetRotation}\". Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n        console.log(`Rotating from ${this.rotation.toFixed(6)} to ${targetRotation.toFixed(6)}.`);\r\n\r\n        const startRotation = this.rotation;\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const k = easeFunction(t);\r\n\r\n                this.rotation = lerp(startRotation, targetRotation, k);\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentRotationAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentRotationAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentRotationAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates sequential pan and then zooms into the target location.\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param {number} targetZoom\r\n     * @param {number} panDuration in milliseconds\r\n     * @param {number} zoomDuration in milliseconds\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanThenZoomTo(targetPan, targetZoom, panDuration, zoomDuration, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanThenZoomTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await this.animatePanTo(targetPan, panDuration, easeFunction);\r\n        await this.animateZoomTo(targetZoom, zoomDuration, easeFunction);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates pan and zoom simultaneously.\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param {number} targetZoom\r\n     * @param {number} [duration] in milliseconds\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanAndZoomTo(targetPan, targetZoom, duration = 1000, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanAndZoomTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animatePanTo(targetPan, duration, easeFunction),\r\n            this.animateZoomToNoPan(targetZoom, duration, easeFunction),\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animateZoomRotationTo(targetZoom, targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomRotationTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animateZoomTo(targetZoom, duration, easeFunction),\r\n            this.animateRotationTo(targetRotation, duration, EASE_TYPE.CUBIC)\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animatePanZoomRotationTo(targetPan, targetZoom, targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanZoomRotationTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animatePanTo(targetPan, duration, easeFunction),\r\n            this.animateZoomToNoPan(targetZoom, duration, easeFunction),\r\n            this.animateRotationTo(targetRotation, duration, easeFunction)\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animateInfiniteRotation(direction, step = 0.001) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateInfiniteRotation`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentRotationAnimation();\r\n\r\n        const dir = direction >= 0 ? 1 : -1;\r\n\r\n        await new Promise(() => {\r\n            const rotationStep = () => {\r\n                this.rotation = normalizeRotation(this.rotation + dir * step + 2 * PI);\r\n                this.draw();\r\n                updateInfo(true);\r\n                this.currentRotationAnimationFrame = requestAnimationFrame(rotationStep);\r\n            };\r\n            this.currentRotationAnimationFrame = requestAnimationFrame(rotationStep);\r\n        });\r\n        console.groupEnd();\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}\r\n\r\nexport default FractalRenderer;","import {lerp} from \"../global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, JULIA_PALETTES} from \"../global/constants\";\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/julia.preview.frag';\r\nimport FractalRenderer from \"./fractalRenderer\";\r\n\r\n/**\r\n * Julia Set Preview Renderer (legacy)\r\n *\r\n * @author Radim Brnka\r\n * @description\r\n * @extends FractalRenderer\r\n * @since 1.9\r\n */\r\nexport class JuliaPreviewRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.MAX_ITER = 500;\r\n        this.extraIterations = 0;\r\n\r\n        this.DEFAULT_ZOOM = 2.5;\r\n\r\n        /** @type COMPLEX */\r\n        this.DEFAULT_C = [-0.246, 0.64235];\r\n\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n        this.pan = [...this.DEFAULT_PAN]; // Copy\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        /** @type COMPLEX */\r\n        this.c = [...this.DEFAULT_C];\r\n\r\n        /** @type {Array.<JULIA_PRESET>} */\r\n        this.PRESETS = [];\r\n\r\n        /** @type {Array.<DIVE>} */\r\n        this.DIVES = [];\r\n\r\n        this.currentPaletteIndex = 0;\r\n        this.innerStops = new Float32Array(JULIA_PALETTES[this.currentPaletteIndex].theme);\r\n\r\n        this.currentCAnimationFrame = null;\r\n        this.demoTime = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.toString();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        this.cLoc = this.gl.getUniformLocation(this.program, 'u_c');\r\n        this.innerStopsLoc = this.gl.getUniformLocation(this.program, 'u_innerStops');\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        const baseIters = Math.floor(3000 * Math.pow(2, -Math.log2(this.zoom)));\r\n        this.iterations = Math.min(2000, baseIters + this.extraIterations);\r\n\r\n        // Pass Julia constant `c`\r\n        this.gl.uniform2fv(this.cLoc, this.c);\r\n        this.gl.uniform3fv(this.innerStopsLoc, this.innerStops);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    reset() {\r\n        this.c = [...this.DEFAULT_C];\r\n        this.innerStops = new Float32Array(JULIA_PALETTES[0].theme);\r\n        this.currentPaletteIndex = 0;\r\n\r\n        super.reset();\r\n    }\r\n\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Returns id/title of the next color theme in the themes array.\r\n     * @return {string}\r\n     */\r\n    getNextColorThemeId() {\r\n        const nextTheme = JULIA_PALETTES[(this.currentPaletteIndex + 1) % JULIA_PALETTES.length];\r\n\r\n        return nextTheme.id || 'Random';\r\n    }\r\n\r\n    /**\r\n     * Smoothly transitions the inner color stops (used by the shader for inner coloring)\r\n     * from the current value to the provided toPalette over the specified duration.\r\n     * Also updates the colorPalette to match the theme (using the first stop, for example).\r\n     *\r\n     * @param {JULIA_PALETTE} toPalette - The target theme as an array of numbers (e.g., 15 numbers for 5 stops).\r\n     * @param {number} [duration=250] - Duration of the transition in milliseconds.\r\n     * @param {Function} [callback] - A callback invoked when the transition completes.\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateInnerStopsTransition(toPalette, duration = 250, callback = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateInnerStopsTransition`, `color: ${CONSOLE_GROUP_STYLE}`);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        // Save the starting stops as a plain array.\r\n        const startStops = Array.from(this.innerStops);\r\n\r\n        await new Promise(resolve => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                // Interpolate each component of the inner stops.\r\n                const interpolated = startStops.map((v, i) => lerp(v, toPalette.theme[i], progress));\r\n                this.innerStops = new Float32Array(interpolated);\r\n\r\n                let keyColor;\r\n\r\n                if (toPalette.keyColor) {\r\n                    keyColor = hexToRGB(toPalette.keyColor);\r\n                    if (keyColor) {\r\n                        this.colorPalette = [keyColor.r, keyColor.g, keyColor.b];\r\n                    }\r\n                }\r\n\r\n                if (!keyColor) {\r\n                    const stopIndex = 3;\r\n                    this.colorPalette = [\r\n                        toPalette.theme[stopIndex * 3] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 1] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 2] * 1.5\r\n                    ];\r\n                }\r\n\r\n                // Update the uniform for inner stops.\r\n                this.gl.useProgram(this.program);\r\n                if (this.innerStopsLoc) {\r\n                    this.gl.uniform3fv(this.innerStopsLoc, this.innerStops);\r\n                }\r\n\r\n                this.draw();\r\n\r\n                if (callback) callback();\r\n\r\n                if (progress < 1) {\r\n                    this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentColorAnimations();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    async animateColorPaletteTransition(duration = 250, coloringCallback = null) {\r\n        this.currentPaletteIndex = (this.currentPaletteIndex + 1) % JULIA_PALETTES.length;\r\n\r\n        await this.animateInnerStopsTransition(JULIA_PALETTES[this.currentPaletteIndex], duration, coloringCallback);\r\n    }\r\n\r\n    needsRebase() {\r\n        return false;\r\n    }\r\n\r\n    onProgramCreated() {\r\n\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}","/**\r\n * @module JuliaPreview\r\n * @author Radim Brnka\r\n * @description Manages the floating Julia set preview shown on middle-click in Mandelbrot mode.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE} from \"../global/constants\";\r\nimport {JuliaPreviewRenderer} from \"../renderers/juliaPreviewRenderer\";\r\n\r\n/** @type {HTMLCanvasElement} */\r\nlet floatingCanvas = null;\r\n\r\n/** @type {FractalRenderer} */\r\nlet previewRenderer = null;\r\n\r\n/** @type {boolean} */\r\nlet previewActive = false;\r\n\r\n/** Preview canvas size in pixels */\r\nconst PREVIEW_WIDTH = 250;\r\nconst PREVIEW_HEIGHT = 250;\r\n\r\n/** Offset from cursor position */\r\nconst CURSOR_OFFSET_X = 20;\r\nconst CURSOR_OFFSET_Y = 20;\r\n\r\n/**\r\n * Initializes the Julia preview system.\r\n * Should be called once during app initialization.\r\n */\r\nexport function initJuliaPreview() {\r\n    floatingCanvas = document.getElementById('floatingCanvas');\r\n    if (!floatingCanvas) {\r\n        console.error('floatingCanvas element not found!');\r\n        return;\r\n    }\r\n\r\n    // Set canvas dimensions (physical pixels for rendering)\r\n    floatingCanvas.width = PREVIEW_WIDTH * window.devicePixelRatio;\r\n    floatingCanvas.height = PREVIEW_HEIGHT * window.devicePixelRatio;\r\n\r\n    // Set CSS dimensions (display size)\r\n    floatingCanvas.style.width = `${PREVIEW_WIDTH}px`;\r\n    floatingCanvas.style.height = `${PREVIEW_HEIGHT}px`;\r\n}\r\n\r\n/**\r\n * Shows the Julia preview at the given screen position with the specified c parameter.\r\n * @param {number} screenX - Screen X coordinate (clientX)\r\n * @param {number} screenY - Screen Y coordinate (clientY)\r\n * @param {number} cx - Real part of Julia c parameter\r\n * @param {number} cy - Imaginary part of Julia c parameter\r\n */\r\nexport function showJuliaPreview(screenX, screenY, cx, cy) {\r\n    if (!floatingCanvas) {\r\n        initJuliaPreview();\r\n    }\r\n\r\n    // Create renderer on first show\r\n    if (!previewRenderer) {\r\n        previewRenderer = new JuliaPreviewRenderer(floatingCanvas);\r\n        // Use lower iteration count for responsiveness\r\n        previewRenderer.MAX_ITER = 500;\r\n        previewRenderer.extraIterations = 0;\r\n        console.log(`%c JuliaPreview: %c Created preview renderer`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    }\r\n\r\n    // Update c parameter\r\n    previewRenderer.c = [cx, cy];\r\n    previewRenderer.markOrbitDirty();\r\n\r\n    // Position the canvas near cursor\r\n    updatePreviewPosition(screenX, screenY);\r\n\r\n    // Show the canvas\r\n    floatingCanvas.style.display = 'block';\r\n    previewActive = true;\r\n\r\n    // Render the Julia set\r\n    previewRenderer.draw();\r\n}\r\n\r\n/**\r\n * Updates the Julia preview position and c parameter as the mouse moves.\r\n * @param {number} screenX - Screen X coordinate (clientX)\r\n * @param {number} screenY - Screen Y coordinate (clientY)\r\n * @param {number} cx - Real part of Julia c parameter\r\n * @param {number} cy - Imaginary part of Julia c parameter\r\n */\r\nexport function updateJuliaPreview(screenX, screenY, cx, cy) {\r\n    if (!previewActive || !previewRenderer) return;\r\n\r\n    // Update c parameter\r\n    previewRenderer.c = [cx, cy];\r\n    previewRenderer.markOrbitDirty();\r\n\r\n    // Update position\r\n    updatePreviewPosition(screenX, screenY);\r\n\r\n    // Re-render\r\n    previewRenderer.draw();\r\n}\r\n\r\n/**\r\n * Updates the floating canvas position relative to cursor.\r\n * Ensures the preview stays within viewport bounds.\r\n * @param {number} screenX - Screen X coordinate\r\n * @param {number} screenY - Screen Y coordinate\r\n */\r\nfunction updatePreviewPosition(screenX, screenY) {\r\n    if (!floatingCanvas) return;\r\n\r\n    const viewportWidth = window.innerWidth;\r\n    const viewportHeight = window.innerHeight;\r\n\r\n    // Default position: below and to the right of cursor\r\n    let left = screenX + CURSOR_OFFSET_X;\r\n    let top = screenY + CURSOR_OFFSET_Y;\r\n\r\n    // Flip to left side if would overflow right edge\r\n    if (left + PREVIEW_WIDTH > viewportWidth) {\r\n        left = screenX - PREVIEW_WIDTH - CURSOR_OFFSET_X;\r\n    }\r\n\r\n    // Flip to above cursor if would overflow bottom edge\r\n    if (top + PREVIEW_HEIGHT > viewportHeight) {\r\n        top = screenY - PREVIEW_HEIGHT - CURSOR_OFFSET_Y;\r\n    }\r\n\r\n    // Clamp to viewport bounds\r\n    left = Math.max(0, Math.min(left, viewportWidth - PREVIEW_WIDTH));\r\n    top = Math.max(0, Math.min(top, viewportHeight - PREVIEW_HEIGHT));\r\n\r\n    floatingCanvas.style.left = `${left}px`;\r\n    floatingCanvas.style.top = `${top}px`;\r\n}\r\n\r\n/**\r\n * Hides the Julia preview.\r\n */\r\nexport function hideJuliaPreview() {\r\n    if (!previewActive) return;\r\n\r\n    previewActive = false;\r\n\r\n    if (floatingCanvas) {\r\n        floatingCanvas.style.display = 'none';\r\n    }\r\n\r\n    console.log(`%c JuliaPreview: %c Preview hidden`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/**\r\n * Destroys the Julia preview renderer and cleans up resources.\r\n * Call this when switching away from Mandelbrot mode.\r\n */\r\nexport function destroyJuliaPreview() {\r\n    hideJuliaPreview();\r\n\r\n    if (previewRenderer) {\r\n        previewRenderer.destroy();\r\n        previewRenderer = null;\r\n        console.log(`%c JuliaPreview: %c Preview renderer destroyed`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    }\r\n}\r\n\r\n/**\r\n * Returns whether the preview is currently active.\r\n * @returns {boolean}\r\n */\r\nexport function isJuliaPreviewActive() {\r\n    return previewActive;\r\n}\r\n","/**\r\n * @module MouseEventHandlers\r\n * @author Radim Brnka\r\n * @description This module exports a function registerMouseEventHandlers that sets up all mouse events. It interacts directly with the fractalRenderer instance.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {expandComplexToString, normalizeRotation, updateURLParams} from '../global/utils.js';\r\nimport {isJuliaMode, resetAppState, updateInfo} from './ui.js';\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, EASE_TYPE, FRACTAL_TYPE} from \"../global/constants\";\r\nimport {hideJuliaPreview, initJuliaPreview, showJuliaPreview, updateJuliaPreview} from \"./juliaPreview\";\r\n\r\n/** How long should we wait before distinguish between double click and two single clicks. */\r\nconst DOUBLE_CLICK_THRESHOLD = 300;\r\n/** Tolerance of mouse movement before drag starts. */\r\nconst DRAG_THRESHOLD = 5;\r\nconst ZOOM_STEP = 0.05; // double-click zoom in/out\r\nconst ROTATION_SENSITIVITY = 0.01;\r\n\r\n// Wheel smoothing (reduces micro-jitter due to bursty wheel events)\r\nconst WHEEL_ZOOM_BASE = 1.1;\r\nconst WHEEL_DELTA_UNIT = 120;\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\n/** Global variable to track registration */\r\nlet mouseHandlersRegistered = false;\r\n\r\n// Stored references to event handler functions\r\nlet handleWheelEvent;\r\nlet handleMouseDownEvent;\r\nlet handleMouseMoveEvent;\r\nlet handleMouseUpEvent;\r\nlet handleMouseLeaveEvent;\r\n\r\nlet mouseDownX = 0, mouseDownY = 0;\r\nlet lastX = 0, lastY = 0;\r\nlet clickTimeout = null;\r\nlet wheelResetTimeout = null;\r\nlet isDragging = false;\r\nlet wasRotated = false;\r\n\r\n// Rotation\r\nlet isRightDragging = false;\r\nlet startX = 0;\r\n\r\n// Middle-click Julia preview\r\nlet isMiddleButtonHeld = false;\r\n\r\n// Cached rect (avoid layout thrash / inconsistencies during drag)\r\nlet dragRectLeft = 0;\r\nlet dragRectTop = 0;\r\nlet hasDragRect = false;\r\n\r\n// Wheel RAF aggregation\r\nlet wheelAccum = 0;\r\nlet wheelAnchorX = 0;\r\nlet wheelAnchorY = 0;\r\nlet wheelRAF = null;\r\n// Cached rect for wheel zoom (avoid sub-pixel jitter from repeated getBoundingClientRect calls)\r\nlet wheelRectLeft = 0;\r\nlet wheelRectTop = 0;\r\nlet hasWheelRect = false;\r\n\r\n/**\r\n * Mark orbit dirty if the current renderer supports perturbation caching.\r\n * IMPORTANT: must NOT trigger orbit rebuild immediately (renderers should defer).\r\n */\r\nfunction markOrbitDirtySafe() {\r\n    if (fractalApp && typeof fractalApp.markOrbitDirty === \"function\") {\r\n        fractalApp.markOrbitDirty();\r\n    } else if (fractalApp) {\r\n        // Fallback: do nothing; non-perturbation renderers won't need it.\r\n    }\r\n}\r\n\r\n/**\r\n * Initialization and registering of the event handlers.\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initMouseHandlers(app) {\r\n    fractalApp = app;\r\n    canvas = app.canvas;\r\n    canvas.addEventListener(\"contextmenu\", (e) => e.preventDefault());\r\n    initJuliaPreview();\r\n    registerMouseEventHandlers();\r\n}\r\n\r\n/** Registers mouse handlers. */\r\nexport function registerMouseEventHandlers() {\r\n    if (mouseHandlersRegistered) {\r\n        console.warn(`%c registerMouseEventHandlers: %c Mouse event handlers already registered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    handleWheelEvent = (event) => handleWheel(event);\r\n    handleMouseDownEvent = (event) => handleMouseDown(event);\r\n    handleMouseMoveEvent = (event) => handleMouseMove(event);\r\n    handleMouseUpEvent = (event) => handleMouseUp(event);\r\n    handleMouseLeaveEvent = () => handleMouseLeave();\r\n\r\n    canvas.addEventListener('wheel', handleWheelEvent, {passive: false});\r\n    canvas.addEventListener('mousedown', handleMouseDownEvent);\r\n    canvas.addEventListener('mousemove', handleMouseMoveEvent);\r\n    canvas.addEventListener('mouseup', handleMouseUpEvent);\r\n    canvas.addEventListener('mouseleave', handleMouseLeaveEvent);\r\n\r\n    mouseHandlersRegistered = true;\r\n    console.log(`%c registerMouseEventHandlers: %c Event handlers registered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/** Unregisters mouse handlers. */\r\nexport function unregisterMouseEventHandlers() {\r\n    if (!mouseHandlersRegistered) {\r\n        console.warn(`%c unregisterMouseEventHandlers: %c Event handlers are not registered so cannot be unregistered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    canvas.removeEventListener('wheel', handleWheelEvent, {passive: false});\r\n    canvas.removeEventListener('mousedown', handleMouseDownEvent);\r\n    canvas.removeEventListener('mousemove', handleMouseMoveEvent);\r\n    canvas.removeEventListener('mouseup', handleMouseUpEvent);\r\n    canvas.removeEventListener('mouseleave', handleMouseLeaveEvent);\r\n\r\n    mouseHandlersRegistered = false;\r\n    console.warn(`%c unregisterMouseEventHandlers: %c Event handlers unregistered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n// region > EVENT HANDLERS ---------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Apply accumulated wheel delta once per RAF.\r\n * This reduces \"bursty wheel\" micro-jitter and keeps anchor math consistent.\r\n */\r\nfunction flushWheelZoom() {\r\n    wheelRAF = null;\r\n\r\n    if (!fractalApp) return;\r\n    if (!Number.isFinite(fractalApp.zoom)) return;\r\n\r\n    // Use cached rect to avoid sub-pixel jitter from repeated getBoundingClientRect calls\r\n    const mouseX = wheelAnchorX - wheelRectLeft; // CSS px\r\n    const mouseY = wheelAnchorY - wheelRectTop;  // CSS px\r\n\r\n    // Apply accumulated delta\r\n    const zoomFactor = Math.pow(WHEEL_ZOOM_BASE, wheelAccum / WHEEL_DELTA_UNIT);\r\n    const targetZoom = fractalApp.zoom * zoomFactor;\r\n\r\n    // reset accumulator early (avoid re-entrance issues)\r\n    wheelAccum = 0;\r\n\r\n    if (targetZoom < fractalApp.MAX_ZOOM || targetZoom > fractalApp.MIN_ZOOM) return;\r\n\r\n    // Stable deep-zoom anchor math (no before/after subtraction)\r\n    // Keeps the fractal point under cursor fixed while changing zoom.\r\n    fractalApp.setZoomKeepingAnchor(targetZoom, mouseX, mouseY);\r\n\r\n    // orbit rebuild request for perturbation renderers (deferred by renderer logic)\r\n    markOrbitDirtySafe();\r\n\r\n    updateInfo(true);\r\n    fractalApp.draw();\r\n}\r\n\r\nfunction handleWheel(event) {\r\n    event.preventDefault();\r\n\r\n    // Cache rect on first wheel event of a gesture to avoid sub-pixel jitter\r\n    if (!hasWheelRect) {\r\n        const rect = fractalApp.canvas.getBoundingClientRect();\r\n        wheelRectLeft = rect.left;\r\n        wheelRectTop = rect.top;\r\n        hasWheelRect = true;\r\n    }\r\n\r\n    // Aggregate wheel delta and apply once per frame.\r\n    wheelAccum += event.deltaY;\r\n    wheelAnchorX = event.clientX;\r\n    wheelAnchorY = event.clientY;\r\n\r\n    if (!wheelRAF) {\r\n        wheelRAF = requestAnimationFrame(flushWheelZoom);\r\n    }\r\n\r\n    if (wheelResetTimeout) clearTimeout(wheelResetTimeout);\r\n    wheelResetTimeout = setTimeout(() => {\r\n        hasWheelRect = false; // Reset rect cache when gesture ends\r\n        resetAppState();\r\n    }, 150);\r\n\r\n    fractalApp.noteInteraction(160);\r\n}\r\n\r\nfunction handleMouseDown(event) {\r\n    if (event.button === 0) {\r\n        isDragging = false;\r\n        mouseDownX = event.clientX;\r\n        mouseDownY = event.clientY;\r\n        lastX = event.clientX;\r\n        lastY = event.clientY;\r\n\r\n        // Cache rect origin for stable relative coordinates during the drag.\r\n        // (Avoids layout thrash and tiny inconsistencies.)\r\n        const rect = canvas.getBoundingClientRect();\r\n        dragRectLeft = rect.left;\r\n        dragRectTop = rect.top;\r\n        hasDragRect = true;\r\n    } else if (event.button === 2) { // Right-click\r\n        startX = event.clientX;\r\n    } else if (event.button === 1) { // Middle click - Julia preview\r\n        event.preventDefault();\r\n\r\n        // Only show Julia preview when in Mandelbrot mode\r\n        if (!isJuliaMode()) {\r\n            isMiddleButtonHeld = true;\r\n\r\n            // Get fractal coordinates at cursor position\r\n            const rect = canvas.getBoundingClientRect();\r\n            const mouseX = event.clientX - rect.left;\r\n            const mouseY = event.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n            // Show Julia preview with c = cursor fractal position\r\n            showJuliaPreview(event.clientX, event.clientY, fx, fy);\r\n        }\r\n    }\r\n}\r\n\r\nfunction handleMouseMove(event) {\r\n    const dx = event.clientX - mouseDownX;\r\n    const dy = event.clientY - mouseDownY;\r\n\r\n    if (event.buttons === 1) {\r\n        if (!isDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isDragging = true;\r\n        }\r\n\r\n        if (isDragging) {\r\n            canvas.style.cursor = 'move';\r\n            if (clickTimeout) {\r\n                clearTimeout(clickTimeout);\r\n                clickTimeout = null;\r\n            }\r\n\r\n            // Use cached rect origin (fallback if not available).\r\n            let left = dragRectLeft;\r\n            let top = dragRectTop;\r\n            if (!hasDragRect) {\r\n                const rect = canvas.getBoundingClientRect();\r\n                left = rect.left;\r\n                top = rect.top;\r\n            }\r\n\r\n            // Stable deep-zoom pan delta:\r\n            // pan += zoom * (vLast - vNow)\r\n            const lastRelX = lastX - left;\r\n            const lastRelY = lastY - top;\r\n            const nowRelX = event.clientX - left;\r\n            const nowRelY = event.clientY - top;\r\n\r\n            const [vLastX, vLastY] = fractalApp.screenToViewVector(lastRelX, lastRelY);\r\n            const [vNowX,  vNowY ] = fractalApp.screenToViewVector(nowRelX, nowRelY);\r\n\r\n            if (Number.isFinite(fractalApp.zoom)) {\r\n                const deltaX = (vLastX - vNowX) * fractalApp.zoom;\r\n                const deltaY = (vLastY - vNowY) * fractalApp.zoom;\r\n\r\n                fractalApp.addPan(deltaX, deltaY);\r\n                // Mark orbit dirty (deferred rebuild)\r\n                markOrbitDirtySafe();\r\n\r\n                fractalApp.noteInteraction(160);\r\n            }\r\n\r\n            // Update last mouse coordinates.\r\n            lastX = event.clientX;\r\n            lastY = event.clientY;\r\n\r\n            fractalApp.draw();\r\n            updateInfo(true);\r\n        }\r\n    }\r\n\r\n    if (event.buttons === 2) {\r\n        if (!isRightDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isRightDragging = true;\r\n        }\r\n\r\n        if (isRightDragging) {\r\n            event.preventDefault();\r\n            const deltaX = event.clientX - startX;\r\n\r\n            fractalApp.rotation = normalizeRotation(fractalApp.rotation + deltaX * ROTATION_SENSITIVITY);\r\n            fractalApp.draw();\r\n\r\n            startX = event.clientX; // Update starting point for smooth rotation\r\n            wasRotated = true;\r\n            canvas.style.cursor = 'grabbing'; // Use a grabbing cursor for rotation\r\n            updateInfo();\r\n        }\r\n    }\r\n\r\n    // Middle button held - update Julia preview\r\n    if (event.buttons === 4 && isMiddleButtonHeld && !isJuliaMode()) {\r\n        const rect = canvas.getBoundingClientRect();\r\n        const mouseX = event.clientX - rect.left;\r\n        const mouseY = event.clientY - rect.top;\r\n        const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n        updateJuliaPreview(event.clientX, event.clientY, fx, fy);\r\n    }\r\n}\r\n\r\nfunction handleMouseUp(event) {\r\n    // Process only for left (0), middle (1), or right (2) mouse buttons.\r\n    if (![0, 1, 2].includes(event.button)) return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    if (event.button === 1) { // Middle-click - hide Julia preview\r\n        if (isMiddleButtonHeld) {\r\n            isMiddleButtonHeld = false;\r\n            hideJuliaPreview();\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (event.button === 0) { // Left click\r\n        // Release drag cache\r\n        hasDragRect = false;\r\n\r\n        if (!isDragging) {\r\n            const rect = canvas.getBoundingClientRect();\r\n            const mouseX = event.clientX - rect.left;\r\n            const mouseY = event.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n            // If there is already a pending click, then we have a double-click.\r\n            if (clickTimeout !== null) { // --- Double-click action ---\r\n                clearTimeout(clickTimeout);\r\n                clickTimeout = null;\r\n\r\n                const targetZoom = fractalApp.zoom * ZOOM_STEP;\r\n                if (targetZoom > fractalApp.MAX_ZOOM) {\r\n                    console.log(`%c handleMouseUp: %c Double Left Click: Centering on ${mouseX}x${mouseY} -> [${expandComplexToString([fx, fy])}] zoom ${fractalApp.zoom.toFixed(6)} -> ${targetZoom}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                    fractalApp.animatePanAndZoomTo([fx, fy], targetZoom, 1000, EASE_TYPE.QUINT).then(resetAppState);\r\n                } else {\r\n                    console.log(`%c handleMouseUp: %c Double Left Click: Over max zoom. Skipping`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                }\r\n            } else {\r\n                // Set a timeout for the single-click action.\r\n                clickTimeout = setTimeout(() => {\r\n                    console.log(`%c handleMouseUp: %c Single Left Click: Centering on ${mouseX}x${mouseY} -> ${expandComplexToString([fx, fy])}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                    // Centering action:\r\n                    fractalApp.animatePanTo([fx, fy], 500).then(() => {\r\n                        resetAppState();\r\n                        if (isJuliaMode()) {\r\n                            updateURLParams(FRACTAL_TYPE.JULIA, fx, fy, fractalApp.zoom, fractalApp.rotation, fractalApp.c[0], fractalApp.c[1]);\r\n                        } else {\r\n                            updateURLParams(FRACTAL_TYPE.MANDELBROT, fx, fy, fractalApp.zoom, fractalApp.rotation);\r\n                        }\r\n                    });\r\n\r\n                    navigator.clipboard.writeText(window.location.href).then(\r\n                        () => console.log(`%c handleMouseUp: %c Copied URL to clipboard!`, CONSOLE_MESSAGE_STYLE),\r\n                        (err) => console.error(`%c handleMouseUp: %c Not copied to clipboard! ${err}`, CONSOLE_MESSAGE_STYLE)\r\n                    );\r\n\r\n                    clickTimeout = null;\r\n                }, DOUBLE_CLICK_THRESHOLD);\r\n            }\r\n        } else {\r\n            resetAppState();\r\n            isDragging = false;\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n        }\r\n    }\r\n\r\n    if (event.button === 2) { // Right mouse button released\r\n        if (isRightDragging) {\r\n            isRightDragging = false;\r\n\r\n            if (DEBUG_MODE) console.log(`%c handleMouseUp: %c Single Right Click: Doing nothing.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n            if (wasRotated) resetAppState();\r\n            wasRotated = false;\r\n            canvas.style.cursor = 'crosshair';\r\n            return; // Prevent further processing if it was a drag\r\n        }\r\n\r\n        // Handle right-click double-click detection\r\n        const rect = canvas.getBoundingClientRect();\r\n        const mouseX = event.clientX - rect.left;\r\n        const mouseY = event.clientY - rect.top;\r\n        const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n        if (clickTimeout !== null) {\r\n            // Double-click detected\r\n            clearTimeout(clickTimeout);\r\n            clickTimeout = null;\r\n\r\n            const targetZoom = fractalApp.zoom / ZOOM_STEP;\r\n            if (targetZoom < fractalApp.MIN_ZOOM) {\r\n                console.log(`%c handleMouseUp: %c Double Right Click: Centering on ${mouseX}x${mouseY} -> [${expandComplexToString([fx, fy])}] zoom ${fractalApp.zoom.toFixed(6)} -> ${targetZoom}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                fractalApp.animatePanAndZoomTo([fx, fy], targetZoom, 1000, EASE_TYPE.QUINT).then(resetAppState);\r\n            } else {\r\n                console.log(`%c handleMouseUp: %c Double Right Click: Over min zoom. Skipping`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n            }\r\n        } else {\r\n            clickTimeout = setTimeout(() => { clickTimeout = null; }, DOUBLE_CLICK_THRESHOLD);\r\n        }\r\n\r\n        isRightDragging = false;\r\n    }\r\n\r\n    canvas.style.cursor = 'crosshair';\r\n}\r\n\r\nfunction handleMouseLeave() {\r\n    // Hide Julia preview if mouse leaves canvas while middle button is held\r\n    if (isMiddleButtonHeld) {\r\n        isMiddleButtonHeld = false;\r\n        hideJuliaPreview();\r\n    }\r\n}\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","/**\r\n * @module TouchEventHandlers\r\n * @author Radim Brnka\r\n * @description This module exports a function registerTouchEventHandlers that sets up all touch events. It interacts directly with the fractalRenderer instance.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {expandComplexToString, normalizeRotation, updateURLParams} from '../global/utils.js';\r\nimport {isJuliaMode, resetAppState, updateInfo} from './ui.js';\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, FRACTAL_TYPE} from \"../global/constants\";\r\n\r\n/** How long should we wait before distinguish between double tap and two single taps. */\r\nconst DOUBLE_TAP_THRESHOLD = 300;\r\n/** Tolerance of finger movements before drag starts with move gesture. */\r\nconst DRAG_THRESHOLD = 5;\r\nconst ZOOM_STEP = 0.05;\r\n/** Tolerance of finger movements before rotation starts with pinch gesture. */\r\nconst ROTATION_THRESHOLD = 0.05;\r\nconst ROTATION_SENSITIVITY = 1;\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\n/** Global variable to track registration */\r\nlet touchHandlersRegistered = false;\r\n\r\n// Stored references to event handler functions\r\nlet handleTouchStartEvent;\r\nlet handleTouchMoveEvent;\r\nlet handleTouchEndEvent;\r\n\r\nlet touchDownX = 0, touchDownY = 0;\r\nlet lastTouchX = 0, lastTouchY = 0;\r\nlet touchClickTimeout = null;\r\nlet isTouchDragging = false;\r\n\r\n// Cached rect (avoid layout thrash / inconsistencies during drag)\r\nlet dragRectLeft = 0;\r\nlet dragRectTop = 0;\r\nlet hasDragRect = false;\r\n\r\n// Pinch state variables\r\nlet isPinching = false;\r\nlet pinchStartDistance = null;\r\nlet pinchStartAngle = null;\r\n\r\n/**\r\n * Mark orbit dirty if the current renderer supports perturbation caching.\r\n * IMPORTANT: must NOT trigger orbit rebuild immediately (renderers should defer).\r\n */\r\nfunction markOrbitDirtySafe() {\r\n    if (fractalApp && typeof fractalApp.markOrbitDirty === \"function\") {\r\n        fractalApp.markOrbitDirty();\r\n    } else if (fractalApp) {\r\n        // Fallback: do nothing; non-perturbation renderers won't need it.\r\n    }\r\n}\r\n\r\n/**\r\n * Initialization and registering of the event handlers.\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initTouchHandlers(app) {\r\n    fractalApp = app;\r\n    canvas = app.canvas;\r\n    canvas.addEventListener('contextmenu', (e) => e.preventDefault());\r\n\r\n    registerTouchEventHandlers(app);\r\n}\r\n\r\n/** Registers touch handlers. */\r\nexport function registerTouchEventHandlers() {\r\n    if (touchHandlersRegistered) {\r\n        console.warn(`%c registerTouchEventHandlers: %c Event handlers already registered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    handleTouchStartEvent = (event) => handleTouchStart(event);\r\n    handleTouchMoveEvent = (event) => handleTouchMove(event);\r\n    handleTouchEndEvent = (event) => handleTouchEnd(event);\r\n\r\n    canvas.addEventListener('touchstart', handleTouchStartEvent, {passive: false});\r\n    canvas.addEventListener('touchmove', handleTouchMoveEvent, {passive: false});\r\n    canvas.addEventListener('touchend', handleTouchEndEvent, {passive: false});\r\n\r\n    touchHandlersRegistered = true;\r\n    console.log(`%c registerTouchEventHandlers: %c Touch event handlers registered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/** Unregisters touch handlers. */\r\nexport function unregisterTouchEventHandlers() {\r\n    if (!touchHandlersRegistered) {\r\n        console.warn(`%c unregisterTouchEventHandlers: %c Event handlers are not registered so cannot be unregistered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    canvas.removeEventListener('touchstart', handleTouchStartEvent, {passive: false});\r\n    canvas.removeEventListener('touchmove', handleTouchMoveEvent, {passive: false});\r\n    canvas.removeEventListener('touchend', handleTouchEndEvent, {passive: false});\r\n\r\n    touchHandlersRegistered = false;\r\n    console.warn(`%c unregisterTouchEventHandlers: %c Event handlers unregistered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n// region > EVENT HANDLERS ---------------------------------------------------------------------------------------------\r\n\r\nfunction handleTouchStart(event) {\r\n    if (!fractalApp) return;\r\n\r\n    if (event.touches.length === 1) {\r\n        event.preventDefault();\r\n\r\n        isTouchDragging = false;\r\n        isPinching = false;\r\n\r\n        pinchStartDistance = null;\r\n        pinchStartAngle = null;\r\n\r\n        const touch = event.touches[0];\r\n        touchDownX = touch.clientX;\r\n        touchDownY = touch.clientY;\r\n        lastTouchX = touch.clientX;\r\n        lastTouchY = touch.clientY;\r\n\r\n        // Cache rect origin for stable relative coordinates during the drag.\r\n        const rect = canvas.getBoundingClientRect();\r\n        dragRectLeft = rect.left;\r\n        dragRectTop = rect.top;\r\n        hasDragRect = true;\r\n\r\n        return;\r\n    }\r\n\r\n    if (event.touches.length === 2) {\r\n        event.preventDefault();\r\n\r\n        // Two-finger gesture: pinch zoom + rotation\r\n        isPinching = true;\r\n        isTouchDragging = false;\r\n\r\n        // Release drag cache (rect on-demand for pinch)\r\n        hasDragRect = false;\r\n\r\n        const touch0 = event.touches[0];\r\n        const touch1 = event.touches[1];\r\n\r\n        pinchStartDistance = Math.hypot(\r\n            touch0.clientX - touch1.clientX,\r\n            touch0.clientY - touch1.clientY\r\n        );\r\n\r\n        pinchStartAngle = Math.atan2(\r\n            touch1.clientY - touch0.clientY,\r\n            touch1.clientX - touch0.clientX\r\n        );\r\n\r\n        // Stop any pending single-tap click when pinch starts\r\n        if (touchClickTimeout) {\r\n            clearTimeout(touchClickTimeout);\r\n            touchClickTimeout = null;\r\n        }\r\n\r\n        fractalApp.noteInteraction(160);\r\n    }\r\n}\r\n\r\nfunction handleTouchMove(event) {\r\n    if (!fractalApp) return;\r\n\r\n    // Single touch drag (pan)\r\n    if (event.touches.length === 1 && !isPinching) {\r\n        event.preventDefault();\r\n\r\n        const touch = event.touches[0];\r\n        const dx = touch.clientX - touchDownX;\r\n        const dy = touch.clientY - touchDownY;\r\n\r\n        if (!isTouchDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isTouchDragging = true;\r\n            if (touchClickTimeout) {\r\n                clearTimeout(touchClickTimeout);\r\n                touchClickTimeout = null;\r\n            }\r\n        }\r\n\r\n        if (isTouchDragging) {\r\n            // Use cached rect origin (fallback if not available).\r\n            let left = dragRectLeft;\r\n            let top = dragRectTop;\r\n            if (!hasDragRect) {\r\n                const rect = canvas.getBoundingClientRect();\r\n                left = rect.left;\r\n                top = rect.top;\r\n            }\r\n\r\n            // Stable deep-zoom pan delta:\r\n            // pan += zoom * (vLast - vNow)\r\n            const lastRelX = lastTouchX - left;\r\n            const lastRelY = lastTouchY - top;\r\n            const nowRelX = touch.clientX - left;\r\n            const nowRelY = touch.clientY - top;\r\n\r\n            const [vLastX, vLastY] = fractalApp.screenToViewVector(lastRelX, lastRelY);\r\n            const [vNowX,  vNowY ] = fractalApp.screenToViewVector(nowRelX, nowRelY);\r\n\r\n            if (Number.isFinite(fractalApp.zoom)) {\r\n                const deltaX = (vLastX - vNowX) * fractalApp.zoom;\r\n                const deltaY = (vLastY - vNowY) * fractalApp.zoom;\r\n\r\n                fractalApp.addPan(deltaX, deltaY);\r\n                markOrbitDirtySafe();\r\n                fractalApp.noteInteraction(160);\r\n            }\r\n\r\n            lastTouchX = touch.clientX;\r\n            lastTouchY = touch.clientY;\r\n\r\n            fractalApp.draw();\r\n            updateInfo(true);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    // Two-finger pinch: zoom + rotation around midpoint\r\n    if (event.touches.length === 2) {\r\n        event.preventDefault();\r\n        isPinching = true;\r\n\r\n        const touch0 = event.touches[0];\r\n        const touch1 = event.touches[1];\r\n\r\n        const currentDistance = Math.hypot(\r\n            touch0.clientX - touch1.clientX,\r\n            touch0.clientY - touch1.clientY\r\n        );\r\n\r\n        const currentAngle = Math.atan2(\r\n            touch1.clientY - touch0.clientY,\r\n            touch1.clientX - touch0.clientX\r\n        );\r\n\r\n        // Midpoint in screen space\r\n        const centerClientX = (touch0.clientX + touch1.clientX) / 2;\r\n        const centerClientY = (touch0.clientY + touch1.clientY) / 2;\r\n\r\n        const rect = canvas.getBoundingClientRect();\r\n        const centerX = centerClientX - rect.left; // CSS px relative to canvas\r\n        const centerY = centerClientY - rect.top;\r\n\r\n        // Initialize baseline if missing (or if gesture restarted)\r\n        if (!pinchStartDistance || !pinchStartAngle) {\r\n            pinchStartDistance = currentDistance;\r\n            pinchStartAngle = currentAngle;\r\n            return;\r\n        }\r\n\r\n        // Zoom:\r\n        // If distance increases -> zoom in (smaller zoom value).\r\n        // So scale zoom proportionally: zoom *= (startDistance / currentDistance)\r\n        let targetZoom = fractalApp.zoom;\r\n        if (currentDistance > 0) {\r\n            const zoomFactor = pinchStartDistance / currentDistance;\r\n            targetZoom = fractalApp.zoom * zoomFactor;\r\n        }\r\n\r\n        // Clamp (same semantics as your mouse/wheel handlers)\r\n        if (targetZoom < fractalApp.MAX_ZOOM) targetZoom = fractalApp.MAX_ZOOM;\r\n        if (targetZoom > fractalApp.MIN_ZOOM) targetZoom = fractalApp.MIN_ZOOM;\r\n\r\n        // Apply stable anchor zoom at midpoint (deep-zoom safe)\r\n        fractalApp.setZoomKeepingAnchor(targetZoom, centerX, centerY);\r\n\r\n        // Rotation (incremental, like mouse right-drag)\r\n        const angleDifference = currentAngle - pinchStartAngle;\r\n        if (Math.abs(angleDifference) > ROTATION_THRESHOLD) {\r\n            fractalApp.rotation = normalizeRotation(fractalApp.rotation + angleDifference * ROTATION_SENSITIVITY);\r\n        }\r\n\r\n        pinchStartDistance = currentDistance;\r\n        pinchStartAngle = currentAngle;\r\n\r\n        markOrbitDirtySafe();\r\n        fractalApp.noteInteraction(160);\r\n\r\n        fractalApp.draw();\r\n        updateInfo();\r\n    }\r\n}\r\n\r\nfunction handleTouchEnd(event) {\r\n    if (!fractalApp) return;\r\n\r\n    // Reset pinch baseline when leaving 2-finger gesture.\r\n    if (event.touches.length < 2) {\r\n        pinchStartDistance = null;\r\n        pinchStartAngle = null;\r\n    }\r\n\r\n    // When all touches end, decide if it was tap/double-tap or drag/pinch end.\r\n    if (event.touches.length === 0) {\r\n        // End of a pinch gesture: just settle.\r\n        if (isPinching) {\r\n            isPinching = false;\r\n            resetAppState();\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n\r\n            return;\r\n        }\r\n\r\n        // Release drag cache\r\n        hasDragRect = false;\r\n\r\n        if (!isTouchDragging) {\r\n            const touch = event.changedTouches[0];\r\n\r\n            const rect = canvas.getBoundingClientRect();\r\n            const touchX = touch.clientX - rect.left;\r\n            const touchY = touch.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(touchX, touchY);\r\n\r\n            if (touchClickTimeout !== null) {\r\n                clearTimeout(touchClickTimeout);\r\n                touchClickTimeout = null;\r\n\r\n                console.log(`%c handleTouchEnd: %c Double Tap: Centering on ${touchX}x${touchY} which is fractal coords [${expandComplexToString([fx, fy])}]`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                const targetZoom = fractalApp.zoom * ZOOM_STEP;\r\n                if (targetZoom > fractalApp.MAX_ZOOM) {\r\n                    fractalApp.animatePanAndZoomTo([fx, fy], targetZoom).then(resetAppState);\r\n                }\r\n            } else {\r\n                touchClickTimeout = setTimeout(() => {\r\n                    console.log(`%c handleTouchEnd: %c Single Tap Click: Centering on ${touchX}x${touchY} which is fractal coords ${expandComplexToString([fx, fy])}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                    // Centering action:\r\n                    fractalApp.animatePanTo([fx, fy], 400).then(() => {\r\n                        resetAppState();\r\n                        if (isJuliaMode()) {\r\n                            updateURLParams(FRACTAL_TYPE.JULIA, fx, fy, fractalApp.zoom, fractalApp.rotation, fractalApp.c[0], fractalApp.c[1]);\r\n                        } else {\r\n                            updateURLParams(FRACTAL_TYPE.MANDELBROT, fx, fy, fractalApp.zoom, fractalApp.rotation);\r\n                            }\r\n                    });\r\n\r\n                    touchClickTimeout = null;\r\n                }, DOUBLE_TAP_THRESHOLD);\r\n            }\r\n        } else {\r\n            resetAppState();\r\n            isTouchDragging = false;\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n        }\r\n\r\n        isTouchDragging = false;\r\n    }\r\n}\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","/**\r\n * @module ScreenshotController\r\n * @author Radim Brnka\r\n * @description Screenshot capturing logic.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\nimport {APP_NAME, CONSOLE_GROUP_STYLE, SCREENSHOT_JPEG_COMPRESSION_QUALITY} from \"../global/constants\";\r\nimport {expandComplexToString} from \"../global/utils\";\r\nimport {isJuliaMode} from \"./ui\";\r\n\r\n/**\r\n * Generates filename based on current timestamp\r\n * @return {string}\r\n */\r\nfunction getFilename() {\r\n    const now = new Date();\r\n    const pad = (n) => String(n).padStart(2, '0');\r\n    return `fractal-${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}_${pad(now.getHours())}-${pad(now.getMinutes())}-${pad(now.getSeconds())}.jpg`;\r\n}\r\n\r\n/**\r\n * Returns watermark text that fits current fractal type and its properties.\r\n * @param {FractalRenderer} fractalApp\r\n * @return {string}\r\n */\r\nfunction getWatermarkText(fractalApp) {\r\n    const fractalType = isJuliaMode() ? 'Julia' : 'Mandelbrot';\r\n\r\n    return `Created by ${APP_NAME} (${fractalType}: ` +\r\n        `p=${expandComplexToString(fractalApp.pan.slice(), 6)}, zoom=${fractalApp.zoom.toExponential(2)}` +\r\n        `${(fractalApp instanceof JuliaRenderer) ? `, c=${expandComplexToString(fractalApp.c)})` : `)`}`;\r\n}\r\n\r\n/**\r\n * Draws rectangle with rounded borders\r\n * @param {CanvasRenderingContext2D} ctx\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} width\r\n * @param {number} height\r\n * @param {number} radius\r\n */\r\nfunction drawRoundRect(ctx, x, y, width, height, radius) {\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + radius, y);\r\n    ctx.lineTo(x + width - radius, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n    ctx.lineTo(x + width, y + height - radius);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n    ctx.lineTo(x + radius, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n    ctx.lineTo(x, y + radius);\r\n    ctx.quadraticCurveTo(x, y, x + radius, y);\r\n    ctx.closePath();\r\n}\r\n\r\n/**\r\n * Generates screenshot of the canvas, adds watermark and emulates link click to download the file.\r\n * @param {HTMLCanvasElement} canvas\r\n * @param {FractalRenderer} fractalApp\r\n * @param {string} accentColor\r\n */\r\nexport function takeScreenshot(canvas, fractalApp, accentColor) {\r\n    console.groupCollapsed(`%c takeScreenshot`, CONSOLE_GROUP_STYLE);\r\n\r\n    // Ensure the fractal is fully rendered before taking a screenshot\r\n    fractalApp.draw();\r\n\r\n    // Create an offscreen canvas for watermarking\r\n    const offscreenCanvas = document.createElement('canvas');\r\n    offscreenCanvas.width = canvas.width;\r\n    offscreenCanvas.height = canvas.height;\r\n    const ctx = offscreenCanvas.getContext('2d');\r\n\r\n    if (!ctx) {\r\n        console.error('Unable to get 2D context for the canvas.');\r\n        return;\r\n    }\r\n\r\n    // Copy the fractal canvas content to the offscreen canvas\r\n    ctx.drawImage(canvas, 0, 0);\r\n\r\n    // Define the watermark text and style\r\n    let watermarkText = getWatermarkText(fractalApp);\r\n    const fontSize = 12;\r\n    const padding = 6;\r\n    const borderWidth = 1;\r\n\r\n    ctx.font = `${fontSize}px sans-serif`;\r\n    ctx.textAlign = 'center';\r\n    ctx.textBaseline = 'middle';\r\n\r\n    // Measure the text width and calculate the rectangle size\r\n    const textWidth = ctx.measureText(watermarkText).width;\r\n    const rectWidth = textWidth + padding * 2 + borderWidth * 2;\r\n    const rectHeight = fontSize + padding * 2 + borderWidth * 2;\r\n\r\n    // Position the rectangle in the bottom-right corner\r\n    const x = offscreenCanvas.width - rectWidth - padding;\r\n    const y = offscreenCanvas.height - rectHeight - padding;\r\n\r\n    // Draw the semi-transparent black background\r\n    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n    drawRoundRect(ctx, x, y, rectWidth, rectHeight, 8);  // 10 is the corner radius, adjust as needed\r\n    ctx.fill();\r\n\r\n    // Draw the border\r\n    // ctx.strokeStyle = accentColor;\r\n    // ctx.lineWidth = borderWidth;\r\n    // drawRoundRect(ctx, x, y, rectWidth, rectHeight, 8);\r\n    // ctx.stroke();\r\n\r\n    // Draw the text centered within the rectangle\r\n    const textX = x + rectWidth / 2;\r\n    const textY = y + rectHeight / 2 + 1;\r\n    ctx.fillStyle = accentColor;\r\n    ctx.fillText(watermarkText, textX, textY);\r\n\r\n    // Create a temporary link for downloading the image\r\n    const link = document.createElement('a');\r\n\r\n    // Set the download attributes\r\n    link.setAttribute('download', getFilename());\r\n    link.setAttribute('href', offscreenCanvas.toDataURL(\"image/jpeg\", SCREENSHOT_JPEG_COMPRESSION_QUALITY));\r\n    link.click();\r\n\r\n    console.log('Screenshot successfully taken.');\r\n    console.groupEnd();\r\n}","/**\r\n * @module HotKeyController\r\n * @author Radim Brnka\r\n * @description Keyboard shortcuts controller attached to the UI\r\n * @link https://www.freecodecamp.org/news/javascript-keycode-list-keypress-event-key-codes/\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {\r\n    captureScreenshot,\r\n    isAnimationActive,\r\n    isJuliaMode,\r\n    randomizeColors,\r\n    reset,\r\n    resetAppState,\r\n    startJuliaDive,\r\n    switchFractalMode,\r\n    switchFractalTypeWithPersistence,\r\n    toggleCenterLines,\r\n    toggleDebugMode,\r\n    toggleDemo,\r\n    toggleHeader,\r\n    travelToPreset,\r\n    updateColorTheme,\r\n} from \"./ui\";\r\nimport {\r\n    CONSOLE_GROUP_STYLE,\r\n    CONSOLE_MESSAGE_STYLE,\r\n    DEBUG_LEVEL,\r\n    DEBUG_MODE,\r\n    DEFAULT_MANDELBROT_THEME_COLOR,\r\n    FF_PERSISTENT_FRACTAL_SWITCHING,\r\n    FRACTAL_TYPE,\r\n    JULIA_PALETTES,\r\n    log,\r\n    ROTATION_DIRECTION\r\n} from \"../global/constants\";\r\n\r\n//region CONSTANTS > ---------------------------------------------------------------------------------------------------\r\n/**\r\n * Keys not allowed to work in animation mode\r\n * @type {string[]}\r\n */\r\nconst ANIMATION_KEYS_BLACKLIST = [\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\", \"Space\", \"KeyQ\", \"KeyW\"];\r\n\r\n/**\r\n * Pan movement animation duration\r\n * @type {number}\r\n */\r\nconst PAN_SPEED = 50;\r\n\r\n/**\r\n * Pan step size per keystroke\r\n * @type {number}\r\n */\r\nconst PAN_STEP = .1;\r\n\r\n/**\r\n * Smooth (Shift) pan step size per keystroke\r\n * @type {number}\r\n */\r\nconst PAN_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Normal rotation animation step size\r\n * @type {number}\r\n */\r\nconst ROTATION_ANIMATION_STEP = .1;\r\n\r\n/**\r\n * Smooth rotation animation step size\r\n * @type {number}\r\n */\r\nconst ROTATION_ANIMATION_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Zoom step per keystroke\r\n * @type {number}\r\n */\r\nconst ZOOM_ANIMATION_STEP = .1;\r\n\r\n/**\r\n * Smooth (Shift) zoom step per keystroke\r\n * @type {number}\r\n */\r\nconst ZOOM_ANIMATION_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Smooth stepping: step size\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_STEP = .0005;\r\n\r\n/**\r\n * Super smooth stepping multiplier (SHIFT)\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_SMOOTH_MULTIPLIER = .1;\r\n\r\n/**\r\n * Smooth stepping: animation duration\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_SPEED = 10;\r\n//endregion ------------------------------------------------------------------------------------------------------------\r\n\r\nlet rotationActive = false;\r\nlet initialized = false;\r\nlet fractalApp;\r\n\r\n/**\r\n * Keydown event handler\r\n * @param {KeyboardEvent} event\r\n * @return {Promise<void>}\r\n */\r\nasync function onKeyDown(event) {\r\n\r\n    // Do not steal hotkeys from user input fields (search boxes, sliders, etc.)\r\n    const target = /** @type {HTMLElement|null} */ (event.target);\r\n    const tag = target?.tagName?.toLowerCase();\r\n    const isTypingTarget =\r\n        !!target &&\r\n        (\r\n            tag === 'input' ||\r\n            tag === 'textarea' ||\r\n            tag === 'select' ||\r\n            target.isContentEditable\r\n        );\r\n\r\n    if (isTypingTarget) return;\r\n\r\n    if (DEBUG_MODE) console.log(`%c onKeyDown: %c Pressed key/code ${event.shiftKey ? 'Shift + ' : ''}${event.ctrlKey ? 'CTRL + ' : ''}${event.altKey ? 'ALT + ' : ''}${event.code}/${event.key}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    let handled = false;\r\n\r\n    const rotationSpeed = event.shiftKey ? ROTATION_ANIMATION_SMOOTH_STEP : ROTATION_ANIMATION_STEP;\r\n    let rotationDirection = ROTATION_DIRECTION.CW;\r\n\r\n    let deltaPanX = 0;\r\n    let deltaPanY = 0;\r\n    let deltaCx = 0;\r\n    let deltaCy = 0;\r\n\r\n    // Treat MAC Option button as Alt\r\n    const altKey = event.altKey || event.code === 'Alt';\r\n\r\n    if (isAnimationActive() && ANIMATION_KEYS_BLACKLIST.includes(event.code)) {\r\n        event.preventDefault();\r\n        return;\r\n    }\r\n    switch (event.code) {\r\n        // TODO add shift/non-shift to slow down or speed up the rotation instead of stop.\r\n        case 'KeyQ': // Rotation counter-clockwise\r\n            rotationDirection = ROTATION_DIRECTION.CCW;\r\n        case 'KeyW': // Rotation clockwise\r\n            if (rotationActive) {\r\n                fractalApp.stopCurrentRotationAnimation();\r\n                rotationActive = false;\r\n            } else {\r\n                rotationActive = true;\r\n                await fractalApp.animateInfiniteRotation(rotationDirection, rotationSpeed);\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyE': // Debug lines\r\n            toggleCenterLines();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyR': // Reset\r\n            if (event.shiftKey) await reset();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyL': // DEBUG BAR toggle\r\n            toggleDebugMode();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyZ': // Switch between fractals with constant p/c\r\n            if (!FF_PERSISTENT_FRACTAL_SWITCHING) break;\r\n\r\n            await switchFractalTypeWithPersistence(isJuliaMode() ? FRACTAL_TYPE.MANDELBROT : FRACTAL_TYPE.JULIA);\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyT': // Random colors\r\n            if (altKey) {\r\n                if (isJuliaMode()) {\r\n                    await fractalApp.animateInnerStopsTransition(\r\n                        JULIA_PALETTES[0],\r\n                        250,\r\n                        updateColorTheme);\r\n                } else {\r\n                    await fractalApp.animateColorPaletteTransition(\r\n                        DEFAULT_MANDELBROT_THEME_COLOR,\r\n                        250,\r\n                        updateColorTheme);\r\n                }\r\n            } else if (event.shiftKey) {\r\n                if (fractalApp.currentColorAnimationFrame) {\r\n                    fractalApp.stopCurrentColorAnimations();\r\n                    break;\r\n                }\r\n                await fractalApp.animateFullColorSpaceCycle(isJuliaMode() ? 10000 : 15000, updateColorTheme);\r\n            } else {\r\n                await randomizeColors();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyA': // Forced resize\r\n            fractalApp.resizeCanvas();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyS': // Screenshot\r\n            if (event.shiftKey) captureScreenshot();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyD': // Start/stop demo\r\n            await toggleDemo();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyM': // Riemann Mode\r\n            if (DEBUG_MODE === DEBUG_LEVEL.FULL) await switchFractalMode(FRACTAL_TYPE.RIEMANN);\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyN':\r\n            if (DEBUG_MODE) {\r\n                log('Analytic Extension toggled.');\r\n                fractalApp.useAnalyticExtension = !fractalApp.useAnalyticExtension;\r\n                fractalApp.draw();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowLeft\":\r\n            deltaPanX = altKey ? 0 : -(event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCx = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : 1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowRight\":\r\n            deltaPanX = altKey ? 0 : (event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCx = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? -JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : -1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowDown\":\r\n            deltaPanY = altKey ? 0 : -(event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCy = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? -JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : -1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowUp\":\r\n            deltaPanY = altKey ? 0 : (event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCy = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : 1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"Space\":\r\n            const increment = event.shiftKey ? ZOOM_ANIMATION_SMOOTH_STEP : ZOOM_ANIMATION_STEP;\r\n            const zoomFactor = (event.ctrlKey || altKey) ? (1 + increment) : (1 - increment);\r\n\r\n            let targetZoom = fractalApp.zoom * zoomFactor; // TODO\r\n\r\n            if (targetZoom >= fractalApp.MAX_ZOOM && targetZoom <= fractalApp.MIN_ZOOM) {\r\n                await fractalApp.animateZoomTo(targetZoom, 20);\r\n                resetAppState();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case \"Enter\":\r\n            toggleHeader();\r\n            handled = true;\r\n            break;\r\n\r\n        default: // Case nums and others:\r\n            const match = event.code.match(/^(Digit|Numpad)(\\d)$/);\r\n            if (match) {\r\n                const index = parseInt(match[2], 0); // match[2] contains the digit pressed\r\n                if (event.shiftKey && isJuliaMode()) {\r\n                    await startJuliaDive(fractalApp.DIVES, index);\r\n                } else {\r\n                    await travelToPreset(fractalApp.PRESETS, index);\r\n                }\r\n                handled = true;\r\n            }\r\n            break;\r\n    }\r\n\r\n    // Handling pan changes\r\n    if (deltaPanX || deltaPanY) {\r\n        let r = fractalApp.rotation;\r\n\r\n        // Reflect the zoom factor for consistent pan speed at different zoom levels\r\n        const effectiveDeltaX = (deltaPanX * fractalApp.zoom) * Math.cos(r) - (deltaPanY * fractalApp.zoom) * Math.sin(r);\r\n        const effectiveDeltaY = (deltaPanX * fractalApp.zoom) * Math.sin(r) + (deltaPanY * fractalApp.zoom) * Math.cos(r);\r\n\r\n        await fractalApp.animatePanBy([effectiveDeltaX, effectiveDeltaY], PAN_SPEED);\r\n        fractalApp.noteInteraction(160);\r\n\r\n        resetAppState();\r\n    }\r\n\r\n    // Handling C changes\r\n    if ((deltaCx || deltaCy) && isJuliaMode()) {\r\n        const effectiveDeltaCx = deltaCx * fractalApp.zoom;\r\n        const effectiveDeltaCy = deltaCy * fractalApp.zoom;\r\n\r\n        await fractalApp.animateToC([fractalApp.c[0] + effectiveDeltaCx, fractalApp.c[1] + effectiveDeltaCy], JULIA_HOTKEY_C_SPEED);\r\n        resetAppState();\r\n    }\r\n\r\n    if (handled) {\r\n        event.preventDefault();\r\n    }\r\n}\r\n\r\n/**\r\n * Initializes the keyboard event listener\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initHotKeys(app) {\r\n    if (initialized) {\r\n        console.warn(`%c initHotKeys: %c Redundant initialization skipped!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = app;\r\n    document.addEventListener(\"keydown\", onKeyDown);\r\n    initialized = true;\r\n\r\n    log('Initialized.', 'initHotKeys');\r\n}\r\n\r\n/** Destructor. Removes event listeners and cleans up */\r\nexport function destroyHotKeys() {\r\n    if (!initialized) {\r\n        console.warn(`%c destroyHotKeys: %c Nothing to destroy!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = null;\r\n    initialized = false;\r\n\r\n    document.removeEventListener(\"keydown\", onKeyDown);\r\n\r\n    console.log(`%c destroyHotKeys: %c Destroyed.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}","import FractalRenderer from \"./fractalRenderer\";\r\nimport {asyncDelay, compareComplex, ddSubDD, hsbToRgb, normalizeRotation, splitFloat} from \"../global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, EASE_TYPE, log, PI} from \"../global/constants\";\r\nimport presetsData from '../data/mandelbrot.json' with {type: 'json'};\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/mandelbrot.frag';\r\n\r\n/**\r\n * MandelbrotRenderer (Rebased Perturbation)\r\n *\r\n * @author Radim Brnka\r\n * @description This module defines a MandelbrotRenderer class that inherits from fractalRenderer, implements the shader fragment code for the Mandelbrot set fractal and sets preset zoom-ins.\r\n * @extends FractalRenderer\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nclass MandelbrotRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.DEFAULT_PAN = [-0.5, 0];\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]); // sync DD + array\r\n\r\n        // Reference state with DD precision\r\n        this.refPan = [...this.DEFAULT_PAN];\r\n        this.refPanDD = {\r\n            x: { hi: this.DEFAULT_PAN[0], lo: 0 },\r\n            y: { hi: this.DEFAULT_PAN[1], lo: 0 }\r\n        };\r\n        this.orbitDirty = true;\r\n\r\n        /** IMPORTANT: MAX_ITER must remain constant after shader compilation + orbit buffer allocation. */\r\n        this.MAX_ITER = 2000;\r\n\r\n        // Reference search parameters (for perturbation rebasing)\r\n        this.REF_SEARCH_GRID = 7;\r\n        this.REF_SEARCH_RADIUS = 0.50;\r\n\r\n        // Hysteresis state for rebasing\r\n        this.rebaseArmed = true;\r\n\r\n        // WebGL resources\r\n        this.orbitTex = null;\r\n        this.orbitData = null;\r\n        this.floatTexExt = null;\r\n\r\n        /** Mandelbrot-specific presets */\r\n        this.PRESETS = presetsData.presets;\r\n\r\n        this.init();\r\n    }\r\n\r\n    markOrbitDirty = () => this.orbitDirty = true;\r\n\r\n    /**\r\n     * Called by FractalRenderer.initGLProgram() after program creation + common uniform cache.\r\n     * Creates float texture, allocates orbit buffer, and binds texture unit.\r\n     */\r\n    onProgramCreated() {\r\n        this.floatTexExt = this.gl.getExtension(\"OES_texture_float\");\r\n        if (!this.floatTexExt) {\r\n            console.error('Missing OES_texture_float. Perturbation orbit texture upload requires it.');\r\n            return;\r\n        }\r\n\r\n        this.orbitTex = this.gl.createTexture();\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n\r\n        this.orbitData = new Float32Array(this.MAX_ITER * 4);\r\n\r\n        // Shader expects orbit sampler in unit 0\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n\r\n        this.orbitDirty = true;\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.replace('__MAX_ITER__', this.MAX_ITER).toString();\r\n    }\r\n\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        // delta pan hi/lo (viewPan - refPan, computed on JS side for precision)\r\n        this.deltaPanHLoc = this.gl.getUniformLocation(this.program, 'u_delta_pan_h');\r\n        this.deltaPanLLoc = this.gl.getUniformLocation(this.program, 'u_delta_pan_l');\r\n\r\n        // zoom hi/lo\r\n        this.zoomHLoc = this.gl.getUniformLocation(this.program, 'u_zoom_h');\r\n        this.zoomLLoc = this.gl.getUniformLocation(this.program, 'u_zoom_l');\r\n\r\n        // orbit texture uniforms\r\n        this.orbitTexLoc = this.gl.getUniformLocation(this.program, 'u_orbitTex');\r\n        this.orbitWLoc = this.gl.getUniformLocation(this.program, 'u_orbitW');\r\n    }\r\n\r\n    /** Reference picking + orbit build */\r\n    escapeItersDouble(cx, cy, iters) {\r\n        let zx = 0.0, zy = 0.0;\r\n        for (let i = 0; i < iters; i++) {\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2;\r\n            zy = zy2;\r\n            if (zx * zx + zy * zy > 4.0) return i;\r\n        }\r\n        return iters;\r\n    }\r\n\r\n    /**\r\n     * Choose a good refPan near view center:\r\n     * - sample a grid around view center (radius scales with zoom)\r\n     * - pick the point with the highest escape iteration (prefer inside / late escape)\r\n     * - prefer keeping the current reference to avoid jitter unless a significantly better one is found\r\n     * @param {boolean} useViewCenter - If true, skip grid search and use view center directly (for stability during interaction)\r\n     */\r\n    pickReferenceNearViewCenter(useViewCenter = false) {\r\n        // During interaction, use view center directly to prevent jitter from grid search\r\n        // Copy DD components to preserve deep zoom precision\r\n        if (useViewCenter) {\r\n            this.refPan[0] = this.pan[0];\r\n            this.refPan[1] = this.pan[1];\r\n            this.refPanDD.x.hi = this.panDD.x.hi;\r\n            this.refPanDD.x.lo = this.panDD.x.lo;\r\n            this.refPanDD.y.hi = this.panDD.y.hi;\r\n            this.refPanDD.y.lo = this.panDD.y.lo;\r\n            return;\r\n        }\r\n\r\n        const grid = this.REF_SEARCH_GRID;\r\n        const half = (grid - 1) / 2;\r\n        const step = (2.0 * this.REF_SEARCH_RADIUS) / (grid - 1);\r\n\r\n        const base = this.zoom; // scale offsets by current zoom\r\n\r\n        const probeIters = Math.min(this.MAX_ITER, Math.max(200, Math.floor(this.iterations)));\r\n\r\n        // Evaluate current reference point's score (if we have one within reasonable distance)\r\n        let currentRefScore = -1;\r\n        const currentRefDist = Math.hypot(this.refPan[0] - this.pan[0], this.refPan[1] - this.pan[1]);\r\n        const maxRefDist = base * this.REF_SEARCH_RADIUS * 2.5; // Allow some margin beyond search radius\r\n\r\n        if (currentRefDist < maxRefDist) {\r\n            currentRefScore = this.escapeItersDouble(this.refPan[0], this.refPan[1], probeIters);\r\n        }\r\n\r\n        // Start with view center as fallback\r\n        let bestCx = this.pan[0];\r\n        let bestCy = this.pan[1];\r\n        let bestScore = this.escapeItersDouble(this.pan[0], this.pan[1], probeIters);\r\n\r\n        for (let j = 0; j < grid; j++) {\r\n            for (let i = 0; i < grid; i++) {\r\n                const ox = (i - half) * step;\r\n                const oy = (j - half) * step;\r\n                const cx = this.pan[0] + ox * base;\r\n                const cy = this.pan[1] + oy * base;\r\n\r\n                const score = this.escapeItersDouble(cx, cy, probeIters);\r\n                if (score > bestScore) {\r\n                    bestScore = score;\r\n                    bestCx = cx;\r\n                    bestCy = cy;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Stability: only switch reference if the new one is significantly better.\r\n        // This prevents jitter from small score differences between frames.\r\n        // Require at least 10% improvement or 50 iterations better to switch.\r\n        const improvementThreshold = Math.max(currentRefScore * 0.10, 50);\r\n        const shouldSwitch = currentRefScore < 0 || (bestScore - currentRefScore) > improvementThreshold;\r\n\r\n        if (shouldSwitch) {\r\n            this.refPan[0] = bestCx;\r\n            this.refPan[1] = bestCy;\r\n            // New reference point from grid search - no DD precision accumulated yet\r\n            this.refPanDD.x.hi = bestCx;\r\n            this.refPanDD.x.lo = 0;\r\n            this.refPanDD.y.hi = bestCy;\r\n            this.refPanDD.y.lo = 0;\r\n        }\r\n        // else: keep current refPan for stability\r\n\r\n        this.bestScore = bestScore;\r\n        this.probeIters = probeIters;\r\n    }\r\n\r\n    computeReferenceOrbit() {\r\n        if (!this.orbitData || !this.orbitTex) return;\r\n\r\n        const cx = this.refPan[0];\r\n        const cy = this.refPan[1];\r\n\r\n        let zx = 0.0, zy = 0.0;\r\n\r\n        for (let n = 0; n < this.MAX_ITER; n++) {\r\n            const sx = splitFloat(zx);\r\n            const sy = splitFloat(zy);\r\n\r\n            const idx = n * 4;\r\n            this.orbitData[idx] = sx.high;\r\n            this.orbitData[idx + 1] = sx.low;\r\n            this.orbitData[idx + 2] = sy.high;\r\n            this.orbitData[idx + 3] = sy.low;\r\n\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2;\r\n            zy = zy2;\r\n\r\n            if (zx * zx + zy * zy > 4.0) {\r\n                // Fill remainder with last value (keeps texture defined)\r\n                const fx = splitFloat(zx);\r\n                const fy = splitFloat(zy);\r\n                for (let k = n + 1; k < this.MAX_ITER; k++) {\r\n                    const j = k * 4;\r\n                    this.orbitData[j] = fx.high;\r\n                    this.orbitData[j + 1] = fx.low;\r\n                    this.orbitData[j + 2] = fy.high;\r\n                    this.orbitData[j + 3] = fy.low;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        // Upload 1D orbit texture: width=MAX_ITER, height=1\r\n        this.gl.texImage2D(\r\n            this.gl.TEXTURE_2D,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.MAX_ITER,\r\n            1,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.gl.FLOAT,\r\n            this.orbitData\r\n        );\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Iteration strategy avoids exploding to infinity at tiny zooms\r\n        // TODO Tune! main point is: clamp to MAX_ITER.\r\n        const safe = Math.max(this.zoom, 1e-300);\r\n        const baseIters = Math.floor(300 + 120 * Math.log10(this.DEFAULT_ZOOM / safe));\r\n        this.iterations = Math.max(50, Math.min(this.MAX_ITER, baseIters + this.extraIterations));\r\n\r\n        const mustRebaseNow = this.needsRebase();\r\n        const canRebaseNow = !this.interactionActive || mustRebaseNow;\r\n\r\n        if (this.orbitDirty && canRebaseNow) {\r\n            this.pickReferenceNearViewCenter();\r\n            this.computeReferenceOrbit();\r\n            this.orbitDirty = false;\r\n        }\r\n\r\n        // Compute deltaPan = panDD - refPanDD on JS side (float64) for precision\r\n        // This avoids float32 precision loss when the shader subtracts viewPan - refPan\r\n        const deltaPanX = ddSubDD(this.panDD.x, this.refPanDD.x);\r\n        const deltaPanY = ddSubDD(this.panDD.y, this.refPanDD.y);\r\n\r\n        // Upload deltaPan hi/lo\r\n        if (this.deltaPanHLoc) this.gl.uniform2f(this.deltaPanHLoc, deltaPanX.hi, deltaPanY.hi);\r\n        if (this.deltaPanLLoc) this.gl.uniform2f(this.deltaPanLLoc, deltaPanX.lo, deltaPanY.lo);\r\n\r\n        // Upload zoom hi/lo\r\n        const z = splitFloat(this.zoom);\r\n        if (this.zoomHLoc) this.gl.uniform1f(this.zoomHLoc, z.high);\r\n        if (this.zoomLLoc) this.gl.uniform1f(this.zoomLLoc, z.low);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    needsRebase() {\r\n        const dx = this.pan[0] - this.refPan[0];\r\n        const dy = this.pan[1] - this.refPan[1];\r\n\r\n        // Rebase threshold is proportional to zoom (view scale).\r\n        // 0.75 is consistent with the Julia policy.\r\n        return Math.hypot(dx, dy) > this.zoom * 0.75;\r\n    }\r\n\r\n    // region > ANIMATION METHODS\r\n\r\n    async animateColorPaletteTransition(newPalette, duration = 250, coloringCallback = null) {\r\n        const clamp = (x, a, b) => Math.max(a, Math.min(b, x));\r\n\r\n        // Robustly normalize whatever hsbToRgb returns:\r\n        // - [r,g,b] or {r,g,b}\r\n        // - either in 0..1 or 0..255\r\n        const normalizeRgb = (c) => {\r\n            let r, g, b;\r\n            if (Array.isArray(c)) [r, g, b] = c;\r\n            else ({r, g, b} = c);\r\n\r\n            // If it looks like 0..255, normalize.\r\n            if (r > 1 || g > 1 || b > 1) {\r\n                r /= 255;\r\n                g /= 255;\r\n                b /= 255;\r\n            }\r\n            return [r, g, b];\r\n        };\r\n\r\n        // Generate a vivid hue in HSV, but output as a MULTIPLIER palette:\r\n        // values intentionally > 1 to keep results bright after multiplication.\r\n        const randomBrightMultiplierPalette = () => {\r\n            const hue = Math.random();\r\n            const sat = 0.85 + Math.random() * 0.15; // vivid\r\n            const val = 0.90 + Math.random() * 0.10; // bright\r\n\r\n            let [r, g, b] = normalizeRgb(hsbToRgb(hue, sat, val));\r\n\r\n            // Avoid palettes that are effectively gray multipliers (kills vividness)\r\n            const maxCh = Math.max(r, g, b);\r\n            const minCh = Math.min(r, g, b);\r\n            const chroma = maxCh - minCh;\r\n            if (chroma < 0.25) {\r\n                // force a more saturated hue by nudging channels\r\n                r = clamp(r * 1.15, 0, 1);\r\n                g = clamp(g * 1.15, 0, 1);\r\n                b = clamp(b * 1.15, 0, 1);\r\n            }\r\n\r\n            // Convert 0..1 RGB into a \"gain\" (multiplier) palette.\r\n            // Base gain keeps everything bright; color gain adds hue tint.\r\n            const baseGain = 1.20 + Math.random() * 0.50; // 1.20..1.70\r\n            const colorGain = 0.90 + Math.random() * 1.10; // 0.90..2.00\r\n\r\n            // Lift darker channels so no channel is near-zero multiplier (avoids dim output).\r\n            const lift = 0.25;\r\n\r\n            return [\r\n                baseGain + (lift + r * (1 - lift)) * colorGain,\r\n                baseGain + (lift + g * (1 - lift)) * colorGain,\r\n                baseGain + (lift + b * (1 - lift)) * colorGain,\r\n            ];\r\n        };\r\n\r\n        newPalette ||= randomBrightMultiplierPalette();\r\n        await super.animateColorPaletteTransition(newPalette, duration, coloringCallback);\r\n    }\r\n\r\n    /**\r\n     * Animates travel to a preset. It first zooms out to the default zoom, then rotates, then animates pan and zoom-in.\r\n     * If any of the final params is the same as the target, it won't animate it.\r\n     *\r\n     * @param {MANDELBROT_PRESET} preset An instance-specific object to define exact spot in the fractal\r\n     * @param {number} [zoomOutDuration] in ms\r\n     * @param {number} [zoomInDuration] in ms\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateTravelToPreset(preset, zoomOutDuration = 1000, zoomInDuration = 3500) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateTravelToPreset`, CONSOLE_GROUP_STYLE);\r\n        log(`Traveling to preset: ${JSON.stringify(preset)}`);\r\n\r\n        const targetRotation = preset.rotation || 0;\r\n\r\n        if (preset.zoom.toFixed(24) === this.zoom.toFixed(24)) {\r\n            await this.animatePanTo(preset.pan, zoomOutDuration);\r\n        } else if (compareComplex(preset.pan, this.pan)) {\r\n            // If only zoom is changed, adjust zoom-in\r\n            // TODO zoom-out could be proportionally fast to the zoom depth. If zoomed in too much, the speed is too fast and the image does not render\r\n            await this.animateZoomTo(preset.zoom, zoomOutDuration);\r\n        } else {\r\n            // Otherwise zoom-out\r\n            await this.animateZoomTo(this.DEFAULT_ZOOM, zoomOutDuration);\r\n        }\r\n\r\n        await Promise.all([\r\n            this.animatePanThenZoomTo(preset.pan, preset.zoom, 1000, zoomInDuration * (preset.speed ?? 1)),\r\n            this.animateRotationTo(targetRotation, 1000, EASE_TYPE.QUINT),\r\n        ]);\r\n\r\n        this.currentPresetIndex = preset.id || 0;\r\n\r\n        console.log(`Travel complete.`);\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animate travel to a preset with random rotation. This method waits for three stages:\r\n     *   1. Zoom-out to default zoom with rotation.\r\n     *   2. Pan transition.\r\n     *   3. Zoom-in with rotation.\r\n     *\r\n     * @param {MANDELBROT_PRESET} preset The target preset object with properties: pan, c, zoom, rotation.\r\n     * @param {number} zoomOutDuration Duration (ms) for the zoom-out stage.\r\n     * @param {number} panDuration Duration (ms) for the pan stage.\r\n     * @param {number} zoomInDuration Duration (ms) for the zoom-in stage.\r\n     */\r\n    async animateTravelToPresetWithRandomRotation(preset, zoomOutDuration, panDuration, zoomInDuration) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateTravelToPresetWithRandomRotation`, CONSOLE_GROUP_STYLE);\r\n\r\n        // Random rotation during zoom-out for dynamic effect\r\n        const zoomOutRotation = this.rotation + (Math.random() * PI * 2 - PI);\r\n        const presetRotation = normalizeRotation(preset.rotation ?? this.DEFAULT_ROTATION);\r\n\r\n        // Add 1-2 full cinematic rotations during zoom-in, ending at preset.rotation\r\n        const extraSpins = (Math.random() > 0.5 ? 1 : -1) * (PI * 2 + Math.random() * PI * 2);\r\n        const cinematicFinalRotation = presetRotation + extraSpins;\r\n\r\n        if (this.rotation !== this.DEFAULT_ROTATION) {\r\n            await this.animateZoomRotationTo(this.DEFAULT_ZOOM, zoomOutRotation, zoomOutDuration);\r\n        }\r\n\r\n        await this.animatePanTo(preset.pan, panDuration, EASE_TYPE.CUBIC);\r\n        await this.animateZoomRotationTo(preset.zoom, cinematicFinalRotation, zoomInDuration * (preset.speed ?? 1));\r\n\r\n        this.currentPresetIndex = preset.id || 0;\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates infinite demo loop of traveling to the presets\r\n     * @param {boolean} random Determines whether presets are looped in order from 1-9 or ordered randomly\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDemo(random = true) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateDemo`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        if (!this.PRESETS.length) {\r\n            console.warn('No presets defined for Mandelbrot mode ');\r\n            return;\r\n        }\r\n\r\n        this.demoActive = true;\r\n\r\n        const getNextPresetIndex = (random) => {\r\n            if (random) {\r\n                let index;\r\n                do {\r\n                    index = Math.floor(Math.random() * this.PRESETS.length);\r\n                } while (index === this.currentPresetIndex || index === 0);\r\n                return index;\r\n            } else {\r\n                // Sequential: increment index, but if it wraps to 0, skip to 1.\r\n                const nextIdx = (this.currentPresetIndex + 1) % this.PRESETS.length;\r\n                return nextIdx === 0 ? 1 : nextIdx;\r\n            }\r\n        };\r\n\r\n        // Continue cycling through presets while demo is active.\r\n        while (this.demoActive) {\r\n            this.currentPresetIndex = getNextPresetIndex(random);\r\n            const currentPreset = this.PRESETS[this.currentPresetIndex];\r\n            console.log(`Animating to preset ${this.currentPresetIndex}`);\r\n\r\n            await this.animateTravelToPresetWithRandomRotation(currentPreset, 2000, 1000, 5000);\r\n            await asyncDelay(3500);\r\n        }\r\n\r\n        console.log(`Demo interrupted.`);\r\n        console.groupEnd();\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}\r\n\r\nexport default MandelbrotRenderer","import FractalRenderer from \"./fractalRenderer\";\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/riemann.frag';\r\n\r\nclass RiemannRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.termCount = 100;\r\n\r\n        this.useAnalyticExtension = true;\r\n\r\n        this.init();\r\n    }\r\n\r\n    updateUniforms() {\r\n        this.termCountLoc = this.gl.getUniformLocation(this.program, 'u_termCount');\r\n        this.useAnalyticExtensionLoc = this.gl.getUniformLocation(this.program, 'u_useAnalyticExtension');\r\n\r\n        super.updateUniforms();\r\n    }\r\n\r\n    draw() {\r\n        this.gl.uniform1i(this.termCountLoc, this.termCount);\r\n        this.gl.uniform1i(this.useAnalyticExtensionLoc, this.useAnalyticExtension ? 1 : 0);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw;\r\n\r\n    }\r\n\r\n    onProgramCreated() {\r\n\r\n    }\r\n}\r\n\r\nexport default RiemannRenderer;","/**\r\n * @module JuliaSlidersController\r\n * @author Radim Brnka\r\n * @description Controller of Julia slider elements directly interacting with the c-value of Julia fractal.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE} from \"../global/constants\";\r\nimport {isJuliaMode, resetPresetAndDiveButtonStates, updateInfo} from \"./ui\";\r\nimport {clearURLParams} from \"../global/utils\";\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\n\r\n/**\r\n * Throttle limit in milliseconds\r\n * @type {number}\r\n */\r\nconst SLIDER_UPDATE_THROTTLE_LIMIT = 10;\r\n\r\nlet sliderContainer;\r\nlet realSlider;\r\nlet imagSlider;\r\nlet realSliderValue;\r\nlet imagSliderValue;\r\nlet lastSliderUpdate = 0; // Tracks the last time the sliders were updated\r\n\r\nlet fractalApp;\r\n\r\n/**\r\n * Initializes the elements and their event listeners\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initJuliaSliders(app) {\r\n    if (!(app instanceof JuliaRenderer)) {\r\n        console.error(`%c initJuliaSliders: %c Can only attach to JuliaRenderer, not ${app}!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = app;\r\n\r\n    realSlider = document.getElementById('realSlider');\r\n    realSliderValue = document.getElementById('realSliderValue');\r\n    imagSlider = document.getElementById('imagSlider');\r\n    imagSliderValue = document.getElementById('imagSliderValue');\r\n\r\n    realSlider.addEventListener('input', onRealSliderChange);\r\n    imagSlider.addEventListener('input', onImagSliderChange);\r\n\r\n    sliderContainer = document.getElementById('sliders');\r\n    sliderContainer.style.display = 'flex';\r\n\r\n    console.log(`%c initJuliaSliders: %c Initialized.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\nfunction onSliderChangeFinished() {\r\n    fractalApp.draw();\r\n    updateInfo();\r\n    clearURLParams();\r\n    resetPresetAndDiveButtonStates();\r\n    fractalApp.demoTime = 0;\r\n}\r\n\r\nconst onRealSliderChange = () => {\r\n    fractalApp.c[0] = parseFloat(realSlider.value);\r\n    // Increased to 4 decimals to match the new step\r\n    realSliderValue.textContent = fractalApp.c[0].toFixed(4);\r\n    onSliderChangeFinished();\r\n};\r\n\r\nconst onImagSliderChange = () => {\r\n    fractalApp.c[1] = parseFloat(imagSlider.value);\r\n    // Using 4 decimals and template literals for cleaner code\r\n    imagSliderValue.textContent = `${fractalApp.c[1].toFixed(4)}i`;\r\n    onSliderChangeFinished();\r\n};\r\n\r\n// region > External methods ------------------------------------------------------------------------------------------\r\n/** Destructor. Removes listeners and hides elements. */\r\nexport function destroyJuliaSliders() {\r\n    if (realSlider && imagSlider && sliderContainer) {\r\n        realSlider.removeEventListener('input', onRealSliderChange);\r\n        imagSlider.removeEventListener('input', onImagSliderChange);\r\n\r\n        sliderContainer.style.display = 'none';\r\n\r\n        console.log(`%c destroyJuliaSliders: %c Destroyed.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    } else {\r\n        console.warn(`%c destroyJuliaSliders: %c Called on not initialized state!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    }\r\n}\r\n\r\n/** Resets sliders */\r\nexport function resetJuliaSliders() {\r\n    if (!isJuliaMode()) {\r\n        console.warn(`%c resetJuliaSliders: %c Not in Julia mode!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    realSlider.value = parseFloat(fractalApp.c[0].toFixed(2));\r\n    imagSlider.value = parseFloat(fractalApp.c[1].toFixed(2));\r\n    realSliderValue.innerText = realSlider.value;\r\n    imagSliderValue.innerText = imagSlider.value + 'i';\r\n    fractalApp.demoTime = 0;\r\n}\r\n\r\n/** Updates the real/imaginary sliders appropriately */\r\nexport function updateJuliaSliders() {\r\n    const now = performance.now();\r\n    const timeSinceLastUpdate = now - lastSliderUpdate;\r\n\r\n    if (timeSinceLastUpdate < SLIDER_UPDATE_THROTTLE_LIMIT) {\r\n        return; // Skip update if called too soon\r\n    }\r\n\r\n    // Update the last update time\r\n    lastSliderUpdate = now;\r\n    realSliderValue.innerText = fractalApp.c[0].toFixed(4);\r\n    imagSliderValue.innerText = fractalApp.c[1].toFixed(4) + 'i';\r\n    realSlider.value = parseFloat(fractalApp.c[0].toFixed(4));\r\n    imagSlider.value = parseFloat(fractalApp.c[1].toFixed(4));\r\n}\r\n\r\n/** Disable slider controls */\r\nexport const disableJuliaSliders = () => {\r\n    imagSlider.disabled = realSlider.disabled = true;\r\n    realSlider.classList.add('thumbDisabled');\r\n    imagSlider.classList.add('thumbDisabled');\r\n};\r\n\r\n/** Enable slider controls */\r\nexport const enableJuliaSliders = () => {\r\n    imagSlider.disabled = realSlider.disabled = false;\r\n    realSlider.classList.remove('thumbDisabled');\r\n    imagSlider.classList.remove('thumbDisabled');\r\n};\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","import {ddValue, isTouchDevice} from \"../global/utils\";\r\nimport {log, LOG_LEVEL} from \"../global/constants\";\r\nimport {getFractalMode, isJuliaMode} from \"./ui\";\r\n\r\n/**\r\n * Debug Panel\r\n *\r\n * @author Radim Brnka\r\n * @description Provides an on-screen debugging panel for monitoring real-time application performance,\r\n * GPU capabilities, and rendering diagnostics related to WebGL fractal rendering.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nexport class DebugPanel {\r\n\r\n    panelSelector = 'debugInfo';\r\n\r\n    constructor(canvas, fractalApp) {\r\n        this.canvas = canvas;\r\n        this.fractalApp = fractalApp;\r\n        this.gl = fractalApp?.gl;\r\n\r\n        this.debugInfo = document.getElementById(this.panelSelector);\r\n        if (!this.debugInfo) {\r\n            console.warn(`DebugPanel: #${this.panelSelector} element not found.`);\r\n            return;\r\n        }\r\n\r\n        if (isTouchDevice()) {\r\n            let lastTap = 0;\r\n            this.debugInfo.addEventListener(\"pointerdown\", (e) => {\r\n                const now = Date.now();\r\n                if (now - lastTap < 300) { // Double tap detected\r\n                    this.toggle();\r\n                }\r\n                lastTap = now;\r\n                e.preventDefault();\r\n            });\r\n        }\r\n\r\n        this.debugInfo.addEventListener(\"auxclick\", (event) => {\r\n            if (event.button === 1) {\r\n                console.group('> DEBUG PANEL DUMP');\r\n                log(this.debugInfo.innerText, this.constructor.name, LOG_LEVEL.DEBUG);\r\n                console.groupEnd();\r\n\r\n                let dump = this.debugInfo.innerText.substring(this.debugInfo.innerText.indexOf('FRAG'));\r\n\r\n                navigator.clipboard.writeText(dump).then(function () {\r\n                    console.log('Debug dump copied to clipboard!');\r\n                }, function (err) {\r\n                    console.error('Debug dump not copied to clipboard! ' + err.toString());\r\n                });\r\n            }\r\n        });\r\n\r\n        // ---- Extensions / GPU info (cached) ----\r\n        this.extTimer =\r\n            this.gl?.getExtension(\"EXT_disjoint_timer_query\") ||\r\n            this.gl?.getExtension(\"EXT_disjoint_timer_query_webgl2\") ||\r\n            null;\r\n\r\n        // Renderer info (optional, blocked in some browsers unless allowed)\r\n        this.extRendererInfo =\r\n            this.gl?.getExtension(\"WEBGL_debug_renderer_info\") || null;\r\n\r\n        this.gpu = {\r\n            vendor: \"unknown\",\r\n            renderer: \"unknown\",\r\n            unmaskedVendor: null,\r\n            unmaskedRenderer: null,\r\n            webglVersion: \"unknown\",\r\n            shadingLanguageVersion: \"unknown\",\r\n            maxTextureSize: null,\r\n            maxVaryings: null,\r\n            maxFragUniforms: null,\r\n            maxVertUniforms: null,\r\n            maxViewportDims: null,\r\n        };\r\n\r\n        this._initGpuInfo();\r\n\r\n        // ---- Persistent perf state ----\r\n        this.perf = {\r\n            // rAF timing\r\n            lastRafTs: performance.now(),\r\n            fps: 0,\r\n            frameMs: 0,\r\n            frameMsSmoothed: NaN,\r\n\r\n            // CPU timing of this panel update itself (not your fractal draw)\r\n            panelCpuMs: 0,\r\n            panelCpuMsSmoothed: NaN,\r\n\r\n            // GPU timing via timer query (requires beginGpuTimer/endGpuTimer around draw)\r\n            gpuSupported: !!this.extTimer,\r\n            gpuMs: NaN,\r\n            gpuMsSmoothed: NaN,\r\n            gpuDisjoint: false,\r\n\r\n            // Timer query bookkeeping\r\n            queryInFlight: null,\r\n            pendingQueries: [],\r\n        };\r\n\r\n        // Toggle visibility on creation\r\n        this.toggle();\r\n\r\n        // Bind-safe update loop\r\n        requestAnimationFrame(this.update);\r\n    }\r\n\r\n    setRenderer(renderer) {\r\n        this.fractalApp = renderer || null;\r\n        this.gl = renderer?.gl || null;\r\n\r\n        // refresh cached precision safely\r\n        this.precisionInfo = null;\r\n        const gl = this.gl;\r\n        if (gl && typeof gl.getShaderPrecisionFormat === \"function\") {\r\n            const hp = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n            this.precisionInfo = hp\r\n                ? {precision: hp.precision, rangeMin: hp.rangeMin, rangeMax: hp.rangeMax}\r\n                : null;\r\n        }\r\n    }\r\n\r\n    _initGpuInfo() {\r\n        const gl = this.gl;\r\n        if (!gl) return;\r\n\r\n        try {\r\n            this.gpu.webglVersion = gl.getParameter(gl.VERSION) || \"unknown\";\r\n            this.gpu.shadingLanguageVersion =\r\n                gl.getParameter(gl.SHADING_LANGUAGE_VERSION) || \"unknown\";\r\n            this.gpu.vendor = gl.getParameter(gl.VENDOR) || \"unknown\";\r\n            this.gpu.renderer = gl.getParameter(gl.RENDERER) || \"unknown\";\r\n\r\n            this.gpu.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n            this.gpu.maxVaryings = gl.getParameter(gl.MAX_VARYING_VECTORS);\r\n            this.gpu.maxFragUniforms = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\r\n            this.gpu.maxVertUniforms = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n            this.gpu.maxViewportDims = gl.getParameter(gl.MAX_VIEWPORT_DIMS);\r\n\r\n            if (this.extRendererInfo) {\r\n                const v = gl.getParameter(\r\n                    this.extRendererInfo.UNMASKED_VENDOR_WEBGL\r\n                );\r\n                const r = gl.getParameter(\r\n                    this.extRendererInfo.UNMASKED_RENDERER_WEBGL\r\n                );\r\n                this.gpu.unmaskedVendor = v || null;\r\n                this.gpu.unmaskedRenderer = r || null;\r\n            }\r\n        } catch (e) {\r\n            // Some browsers throw on blocked params; keep defaults\r\n            console.warn(\"DebugPanel: GPU info query failed:\", e);\r\n        }\r\n    }\r\n\r\n    // ---- GPU timer query helpers ----\r\n    beginGpuTimer() {\r\n        if (!this.extTimer || !this.gl) return;\r\n        if (this.perf.queryInFlight) return; // keep it simple: one in flight\r\n\r\n        // EXT_disjoint_timer_query is async; begin/end must bracket the draw call\r\n        const q = this.extTimer.createQueryEXT();\r\n        this.extTimer.beginQueryEXT(this.extTimer.TIME_ELAPSED_EXT, q);\r\n        this.perf.queryInFlight = q;\r\n    }\r\n\r\n    endGpuTimer() {\r\n        if (!this.extTimer || !this.gl) return;\r\n        if (!this.perf.queryInFlight) return;\r\n\r\n        this.extTimer.endQueryEXT(this.extTimer.TIME_ELAPSED_EXT);\r\n        this.perf.pendingQueries.push(this.perf.queryInFlight);\r\n        this.perf.queryInFlight = null;\r\n    }\r\n\r\n    pollGpuTimers() {\r\n        if (!this.extTimer || !this.gl) return;\r\n\r\n        // disjoint means the result is unreliable (clock reset / driver event)\r\n        const disjoint = this.gl.getParameter(this.extTimer.GPU_DISJOINT_EXT);\r\n        this.perf.gpuDisjoint = !!disjoint;\r\n\r\n        if (this.perf.pendingQueries.length === 0) return;\r\n\r\n        // Read the oldest query only (avoid stalls)\r\n        const q = this.perf.pendingQueries[0];\r\n        const available = this.extTimer.getQueryObjectEXT(\r\n            q,\r\n            this.extTimer.QUERY_RESULT_AVAILABLE_EXT\r\n        );\r\n        if (!available) return;\r\n\r\n        const ns = this.extTimer.getQueryObjectEXT(q, this.extTimer.QUERY_RESULT_EXT);\r\n        this.extTimer.deleteQueryEXT(q);\r\n        this.perf.pendingQueries.shift();\r\n\r\n        if (!this.perf.gpuDisjoint) {\r\n            const ms = ns / 1e6;\r\n            this.perf.gpuMs = ms;\r\n            this.perf.gpuMsSmoothed = this.smooth(this.perf.gpuMsSmoothed, ms, 0.15);\r\n        } else {\r\n            this.perf.gpuMs = NaN;\r\n            // keep previous smoothed value; disjoint is a transient condition\r\n        }\r\n    }\r\n\r\n    smooth(prev, next, alpha) {\r\n        if (!Number.isFinite(next)) return prev;\r\n        if (!Number.isFinite(prev)) return next;\r\n        return prev + (next - prev) * alpha;\r\n    }\r\n\r\n    update = (ts) => {\r\n        if (!this.debugInfo || !this.fractalApp) return;\r\n\r\n        const t0 = performance.now();\r\n\r\n        // Poll GPU timers first (results arrive later)\r\n        this.pollGpuTimers();\r\n\r\n        // rAF timing / FPS\r\n        const dt = ts - this.perf.lastRafTs;\r\n        this.perf.lastRafTs = ts;\r\n        this.perf.frameMs = dt;\r\n        this.perf.frameMsSmoothed = this.smooth(this.perf.frameMsSmoothed, dt, 0.1);\r\n        this.perf.fps = dt > 0 ? 1000 / dt : 0;\r\n\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n\r\n        const gl = this.gl;\r\n        if (!gl || typeof gl.getShaderPrecisionFormat !== \"function\") return;\r\n\r\n\r\n        const hp = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n\r\n        const hpInfo = {precision: hp.precision, rangeMin: hp.rangeMin, rangeMax: hp.rangeMax};\r\n\r\n        const viewPanX = ddValue(this.fractalApp.panDD.x);\r\n        const viewPanY = ddValue(this.fractalApp.panDD.y);\r\n        const cx = isJuliaMode() ? this.fractalApp.c[0] : 0;\r\n        const cy = isJuliaMode() ? this.fractalApp.c[1] : 0;\r\n\r\n        const refPanX = this.fractalApp.pan[0];\r\n        const refPanY = this.fractalApp.pan[1];\r\n\r\n        const zoom = this.fractalApp.zoom;\r\n        const safeZoom = Math.max(zoom, 1e-300);\r\n\r\n        // Scale diagnostics\r\n        const pxPerUnit = this.canvas.width / safeZoom;\r\n        const unitPerPx = safeZoom / this.canvas.width;\r\n\r\n        // Precision stress heuristics\r\n        const absPan = Math.hypot(viewPanX, viewPanY);\r\n        const panOverZoom = absPan / safeZoom;\r\n        const mantissaUsedApprox = Math.log2(Math.max(panOverZoom, 1e-300));\r\n\r\n        // Perturbation drift\r\n        const driftAbs = Math.hypot(viewPanX - refPanX, viewPanY - refPanY);\r\n        const driftViewUnits = driftAbs / safeZoom;\r\n\r\n        const orbitStatus = this.fractalApp.orbitDirty ? \"DIRTY\" : \"cached\";\r\n        const zoomBucket = Math.floor(-Math.log10(safeZoom));\r\n\r\n        // ---------- Coloring helpers ----------\r\n        const esc = (s) =>\r\n            String(s)\r\n                .replaceAll(\"&\", \"&amp;\")\r\n                .replaceAll(\"<\", \"&lt;\")\r\n                .replaceAll(\">\", \"&gt;\");\r\n\r\n        const levelClass = (level) => {\r\n            if (level === \"bad\") return \"dbg-bad\";\r\n            if (level === \"warn\") return \"dbg-warn\";\r\n            return \"dbg-ok\";\r\n        };\r\n\r\n        // ---------- Precision health model ----------\r\n        let score = 100;\r\n\r\n        let panLevel = \"ok\";\r\n        if (mantissaUsedApprox > 44) {\r\n            panLevel = \"bad\";\r\n            score -= 40;\r\n        } else if (mantissaUsedApprox > 34) {\r\n            panLevel = \"warn\";\r\n            score -= 20;\r\n        } else if (mantissaUsedApprox > 28) {\r\n            panLevel = \"warn\";\r\n            score -= 10;\r\n        }\r\n\r\n        let driftLevel = \"ok\";\r\n        if (driftViewUnits > 1.0) {\r\n            driftLevel = \"bad\";\r\n            score -= 25;\r\n        } else if (driftViewUnits > 0.5) {\r\n            driftLevel = \"warn\";\r\n            score -= 12;\r\n        } else if (driftViewUnits > 0.25) {\r\n            driftLevel = \"warn\";\r\n            score -= 6;\r\n        }\r\n\r\n        let scaleLevel = \"ok\";\r\n        if (pxPerUnit < 0.75) {\r\n            scaleLevel = \"warn\";\r\n            score -= 10;\r\n        }\r\n        if (pxPerUnit < 0.25) {\r\n            scaleLevel = \"bad\";\r\n            score -= 20;\r\n        }\r\n\r\n        score = Math.max(0, Math.min(100, Math.round(score)));\r\n\r\n        let healthLevel = \"ok\";\r\n        if (score < 70) healthLevel = \"warn\";\r\n        if (score < 45) healthLevel = \"bad\";\r\n\r\n        const worst =\r\n            healthLevel === \"bad\" || healthLevel === \"warn\"\r\n                ? ` (pan:${panLevel}, drift:${driftLevel}, scale:${scaleLevel})`\r\n                : \"\";\r\n\r\n        // ---------- Performance / bottleneck heuristics ----------\r\n        // Typical: if GPU_ms_smooth is close to frame budget, you're GPU-bound.\r\n        const frameBudgetMs = 1000 / 60; // 16.67ms\r\n        const gpuSmooth = this.perf.gpuMsSmoothed;\r\n        const gpuLevel =\r\n            !Number.isFinite(gpuSmooth) ? \"ok\"\r\n                : gpuSmooth > 22 ? \"bad\"\r\n                    : gpuSmooth > 14 ? \"warn\"\r\n                        : \"ok\";\r\n\r\n        const fpsLevel =\r\n            this.perf.fps < 30 ? \"bad\"\r\n                : this.perf.fps < 50 ? \"warn\"\r\n                    : \"ok\";\r\n\r\n        // panel CPU time (debug UI overhead)\r\n        const panelCpuMs = performance.now() - t0;\r\n        this.perf.panelCpuMs = panelCpuMs;\r\n        this.perf.panelCpuMsSmoothed = this.smooth(this.perf.panelCpuMsSmoothed, panelCpuMs, 0.2);\r\n\r\n        const gpuHint =\r\n            this.perf.gpuSupported\r\n                ? (Number.isFinite(gpuSmooth)\r\n                    ? (gpuSmooth > frameBudgetMs ? \"Likely GPU-bound\" : \"GPU OK\")\r\n                    : \"GPU timer available (wrap draw with begin/end)\")\r\n                : \"No GPU timer support\";\r\n\r\n        // ---------- Output ----------\r\n        const gpuVendor =\r\n            this.gpu.unmaskedVendor || this.gpu.vendor || \"unknown\";\r\n        const gpuRenderer =\r\n            this.gpu.unmaskedRenderer || this.gpu.renderer || \"unknown\";\r\n\r\n        this.debugInfo.innerHTML = `\r\n            <span class=\"dbg-title\" id=\"copyDebugInfo\">DEBUG PANEL</span><span class=\"dbg-dim\"> ('L' to toggle, draggable, middle-click to log)</span>|<br/>\r\n            <span class=\"dbg-dim\"></span><br/>\r\n            <span class=\"dbg-title\">FRAG highp</span>: precision=${esc(hpInfo.precision)} range=[${esc(hpInfo.rangeMin)}, ${esc(hpInfo.rangeMax)}]<br/>\r\n            <span class=\"dbg-title\">mode:</span> <span class=\"dbg-dim\">${getFractalMode()}</span> <span class=\"dbg-title\">css</span>=${esc(rect.width.toFixed(1))}x${esc(rect.height.toFixed(1))} <span class=\"dbg-dim\">dpr=${esc(dpr)}<span class=\"dbg-title\"> \r\n            buf</span>=${esc(this.canvas.width)}x${esc(this.canvas.height)}<br/>\r\n            <br/>\r\n            <span class=\"dbg-title\">viewPan</span>=[${esc(viewPanX.toFixed(24))}, ${esc(viewPanY.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">refPan</span>     =[${esc(refPanX.toFixed(24))}, ${esc(refPanY.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">c</span>=[${esc(cx.toFixed(24))}, ${esc(cy.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">zoom</span>=${esc(zoom.toFixed(20))}<br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Scale </span><br/>\r\n            zoomExp=[${esc(zoom.toExponential(1))}]  <span class=\"dbg-dim\">zoomBucket=1e-${esc(zoomBucket)}</span><br/>\r\n            px/unit=<span class=\"${levelClass(scaleLevel)}\">${esc(pxPerUnit.toExponential(3))}</span><br/>\r\n            unit/px=<span class=\"${levelClass(scaleLevel)}\">${esc(unitPerPx.toExponential(3))}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Precision Stress (heuristics) </span><br/>\r\n            <span class=\"dbg-title\">iters</span>=${esc(this.fractalApp.iterations.toFixed(0))} (MAX_ITER=${esc(this.fractalApp.MAX_ITER)})<br/>\r\n            Precision health:<span class=\"dbg-badge ${levelClass(healthLevel)}\">${score}/100</span><span class=\"dbg-dim\">${esc(worst)}</span><br/>\r\n            |pan|=${esc(absPan.toExponential(3))}<br/>\r\n            |pan|/zoom=<span class=\"${levelClass(panLevel)}\">${esc(panOverZoom.toExponential(3))}</span><br/>\r\n            log2(|pan|/zoom)<span class=\"${levelClass(panLevel)}\">${esc(mantissaUsedApprox.toFixed(1))}</span> <span class=\"dbg-dim\">(larger  cancellation risk )</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Perturbation </span><br/>\r\n            ref drift (abs)=${esc(driftAbs.toExponential(3))}<br/>\r\n            ref drift/zoom=<span class=\"${levelClass(driftLevel)}\">${esc(driftViewUnits.toFixed(3))}</span> <span class=\"dbg-dim\">view-units</span><br/>\r\n            refPick=${esc(this.fractalApp ? (this.fractalApp.bestScore + \"/\" + this.fractalApp.probeIters) : \"cached\")}<br/>\r\n            orbit=<span class=\"${this.fractalApp.orbitDirty ? \"dbg-warn\" : \"dbg-ok\"}\">${esc(orbitStatus)}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Performance </span><br/>\r\n            FPS=<span class=\"${levelClass(fpsLevel)}\">${esc(this.perf.fps.toFixed(1))}</span> <span class=\"dbg-dim\">(frame ${esc(this.perf.frameMsSmoothed?.toFixed?.(2) ?? \"n/a\")} ms)</span><br/>\r\n            debugUI=<span class=\"dbg-dim\">${esc(this.perf.panelCpuMsSmoothed?.toFixed?.(2) ?? \"n/a\")} ms</span><br/>\r\n            gpuTimer=${esc(this.perf.gpuSupported ? \"yes\" : \"no\")}<br/>\r\n            gpuMs=<span class=\"${levelClass(gpuLevel)}\">${esc(Number.isFinite(gpuSmooth) ? gpuSmooth.toFixed(2) : \"n/a\")}</span> <span class=\"dbg-dim\">${esc(this.perf.gpuDisjoint ? \"(disjoint)\" : \"\")}</span><br/>\r\n            hint=<span class=\"dbg-dim\">${esc(gpuHint)}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Renderer </span><br/>\r\n            Vendor: ${esc(gpuVendor)}<br/>\r\n            GPU: ${esc(gpuRenderer)}<br/>\r\n            <span class=\"dbg-dim\">${esc(this.gpu.webglVersion)} on ${navigator?.userAgentData?.platform || navigator?.platform}</span><br/>\r\n            `;\r\n\r\n        requestAnimationFrame(this.update);\r\n    };\r\n\r\n    /** Toggle the visibility of the debug panel. */\r\n    toggle = () => {\r\n        if (!this.debugInfo) return; // Safety check\r\n        this.debugInfo.style.display = this.debugInfo.style.display === 'block' ? 'none' : 'block';\r\n    }\r\n}\r\n","import {\r\n    clearURLParams,\r\n    ddValue,\r\n    destroyArrayOfButtons,\r\n    getAnimationDuration,\r\n    getFractalName,\r\n    hsbToRgb,\r\n    isMobileDevice,\r\n    isTouchDevice,\r\n    normalizeRotation,\r\n    updateURLParams\r\n} from '../global/utils.js';\r\nimport {initMouseHandlers, registerMouseEventHandlers, unregisterMouseEventHandlers} from \"./mouseEventHandlers\";\r\nimport {initTouchHandlers, registerTouchEventHandlers, unregisterTouchEventHandlers} from \"./touchEventHandlers\";\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\nimport {takeScreenshot} from \"./screenshotController\";\r\nimport {\r\n    CONSOLE_GROUP_STYLE,\r\n    CONSOLE_MESSAGE_STYLE,\r\n    DEBUG_LEVEL,\r\n    DEBUG_MODE,\r\n    DEFAULT_ACCENT_COLOR,\r\n    DEFAULT_BG_COLOR,\r\n    DEFAULT_JULIA_THEME_COLOR,\r\n    DEFAULT_MANDELBROT_THEME_COLOR,\r\n    FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED,\r\n    FF_TRAVEL_TO_PRESET_WITH_ROTATION,\r\n    FF_USER_INPUT_ALLOWED,\r\n    FRACTAL_TYPE,\r\n    log,\r\n    PI,\r\n    RANDOMIZE_COLOR_BUTTON_DEFAULT_TITLE\r\n} from \"../global/constants\";\r\nimport {destroyHotKeys, initHotKeys} from \"./hotkeyController\";\r\nimport MandelbrotRenderer from \"../renderers/mandelbrotRenderer\";\r\nimport RiemannRenderer from \"../renderers/riemannRenderer\";\r\nimport {\r\n    destroyJuliaSliders,\r\n    disableJuliaSliders,\r\n    enableJuliaSliders,\r\n    initJuliaSliders,\r\n    resetJuliaSliders,\r\n    updateJuliaSliders\r\n} from \"./juliaSlidersController\";\r\nimport {DebugPanel} from \"./debugPanel\";\r\n\r\n/**\r\n * @module UI\r\n * @author Radim Brnka\r\n * @description Contains code to manage the UI (header interactions, buttons, infoText update, etc.).\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\nlet fractalMode = FRACTAL_TYPE.MANDELBROT;\r\n\r\nconst DEMO_BUTTON_DEFAULT_TEXT = 'Demo';\r\nconst DEMO_BUTTON_STOP_TEXT = 'Stop';\r\n\r\nlet accentColor = DEFAULT_ACCENT_COLOR;\r\nlet midColor = DEFAULT_BG_COLOR; // TODO use?\r\nlet bgColor = DEFAULT_BG_COLOR;\r\n\r\nlet headerMinimizeTimeout = null;\r\nlet uiInitialized = false;\r\n/** @type {boolean} */\r\nlet headerVisible = true;\r\n\r\nlet animationActive = false;\r\nlet activeJuliaDiveIndex = -1;\r\nlet activePresetIndex = 0;\r\nlet resizeTimeout;\r\n\r\n// HTML elements\r\nlet header;\r\nlet logo; // H1\r\nlet mandelbrotSwitch;\r\nlet juliaSwitch;\r\nlet persistSwitch;\r\nlet resetButton;\r\nlet randomizeColorsButton;\r\nlet screenshotButton;\r\nlet demoButton;\r\nlet presetButtons = [];\r\nlet diveButtons = [];\r\nlet allButtons = [];\r\nlet infoLabel;\r\nlet infoText;\r\nexport let debugPanel;\r\n\r\nlet lastInfoUpdate = 0; // Tracks the last time the sliders were updated\r\nconst infoUpdateThrottleLimit = 100; // Throttle limit in milliseconds\r\n\r\nlet pendingInfoTimer = null;\r\nlet pendingInfoForce = false;\r\n\r\n\r\nexport const getFractalMode = () => getFractalName(fractalMode);\r\n\r\n/**\r\n * Switches among fractal modes\r\n * @param {FRACTAL_TYPE} mode\r\n * @param {PRESET} [preset] If present, it's set as the default state through travelToPreset\r\n */\r\nexport async function switchFractalMode(mode, preset = null) {\r\n    console.groupCollapsed(`%c switchFractalMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (mode === fractalMode) {\r\n        console.warn(`Switching to the same mode? Why?`);\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    exitAnimationMode();\r\n\r\n    fractalApp.destroy();\r\n\r\n    switch (mode) {\r\n        case FRACTAL_TYPE.MANDELBROT:\r\n            enableMandelbrotMode();\r\n            break;\r\n\r\n        case FRACTAL_TYPE.JULIA:\r\n            enableJuliaMode();\r\n            break;\r\n\r\n        case FRACTAL_TYPE.RIEMANN:\r\n            enableRiemannMode();\r\n            break;\r\n\r\n        default:\r\n            console.error(`Unknown fractal mode \"${mode}\"!`);\r\n            console.groupEnd();\r\n            return;\r\n    }\r\n\r\n    // Detach debug panel from old renderer BEFORE destroy\r\n    debugPanel?.setRenderer?.(null);\r\n\r\n    // Attach debug panel to new renderer AFTER init/constructor\r\n    debugPanel?.setRenderer?.(fractalApp);\r\n\r\n    // Register control events\r\n    if (isTouchDevice()) {\r\n        unregisterTouchEventHandlers();\r\n        initTouchHandlers(fractalApp);\r\n    } else {\r\n        destroyHotKeys();\r\n        initHotKeys(fractalApp);\r\n\r\n        unregisterMouseEventHandlers();\r\n        initMouseHandlers(fractalApp);\r\n    }\r\n\r\n    fractalApp.reset();\r\n\r\n    if (preset) {\r\n        resetPresetAndDiveButtonStates();\r\n        initAnimationMode();\r\n\r\n        console.log(`Preset found, setting: ${JSON.stringify(preset)}`)\r\n        if (isJuliaMode()) {\r\n            await fractalApp.animateTravelToPreset({\r\n                pan: [0, 0], c: preset.c, zoom: preset.zoom, rotation: 0\r\n            }, 1000);\r\n        } else {\r\n            await fractalApp.animateTravelToPreset({\r\n                pan: preset.pan, zoom: preset.zoom, rotation: 0\r\n            }, 500, 1000);\r\n        }\r\n\r\n        exitAnimationMode();\r\n        updateURLParams(fractalMode, fractalApp.pan[0], fractalApp.pan[1], fractalApp.zoom, fractalApp.rotation, fractalApp.c ? fractalApp.c[0] : null, fractalApp.c ? fractalApp.c[1] : null);\r\n    }\r\n\r\n    console.log(`Switched to ${mode === FRACTAL_TYPE.MANDELBROT ? 'Mandelbrot' : 'Julia'}`);\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Switches among fractal modes but keeps the c/pan settings so the fractals match each other.\r\n * @param {FRACTAL_TYPE} targetType\r\n * @return {Promise<void>}\r\n */\r\nexport async function switchFractalTypeWithPersistence(targetType) {\r\n    console.groupCollapsed(`%c switchFractalTypeWithPersistence`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (targetType === fractalMode) {\r\n        console.warn(`Switching to the same fractal? Why?`);\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    if (targetType === FRACTAL_TYPE.MANDELBROT) {\r\n        const targetZoom = Math.max(fractalApp.MAX_ZOOM, fractalApp.zoom * 0.1);\r\n\r\n        await switchFractalMode(FRACTAL_TYPE.MANDELBROT, {\r\n            pan: fractalApp.c.slice(), zoom: targetZoom, rotation: 0\r\n        });\r\n    } else {\r\n        await switchFractalMode(FRACTAL_TYPE.JULIA, {\r\n            pan: [0, 0], c: fractalApp.pan.slice(), zoom: 1.5, rotation: 0\r\n        });\r\n    }\r\n    console.groupEnd();\r\n}\r\n\r\nexport const isJuliaMode = () => fractalMode === FRACTAL_TYPE.JULIA;\r\n\r\n/**\r\n * Implemented in a way it's not needed to be called at the first render. Everything should be pre-initialized\r\n * for Mandelbrot mode.\r\n */\r\nexport function enableMandelbrotMode() {\r\n    juliaSwitch.classList.remove('active');\r\n    mandelbrotSwitch.classList.add('active');\r\n\r\n    destroyArrayOfButtons(diveButtons);\r\n    const diveBlock = document.getElementById('dives');\r\n    diveBlock.style.display = 'none';\r\n\r\n    destroyJuliaSliders();\r\n\r\n    fractalApp = new MandelbrotRenderer(canvas);\r\n    fractalMode = FRACTAL_TYPE.MANDELBROT;\r\n\r\n    // Remove each button from the DOM and reinitialize\r\n    destroyArrayOfButtons(presetButtons);\r\n    if (activePresetIndex !== 0) resetActivePresetIndex();\r\n    initPresetButtonEvents();\r\n\r\n    updateColorTheme(DEFAULT_MANDELBROT_THEME_COLOR);\r\n\r\n    updateRecolorButtonTitle();\r\n\r\n    window.location.hash = ''; // Update URL hash\r\n}\r\n\r\nexport function enableJuliaMode() {\r\n    fractalApp = new JuliaRenderer(canvas);\r\n    fractalMode = FRACTAL_TYPE.JULIA;\r\n\r\n    juliaSwitch.classList.add('active');\r\n    mandelbrotSwitch.classList.remove('active');\r\n\r\n    // Remove each button from the DOM and reinitialize\r\n    destroyArrayOfButtons(presetButtons);\r\n    initPresetButtonEvents();\r\n\r\n    initJuliaSliders(fractalApp);\r\n    updateJuliaSliders();\r\n\r\n    destroyArrayOfButtons(diveButtons);\r\n    initDiveButtons();\r\n\r\n    if (activePresetIndex !== 0) resetActivePresetIndex();\r\n\r\n    updateColorTheme(DEFAULT_JULIA_THEME_COLOR);\r\n    // Darker backgrounds for Julia as it renders on white\r\n    header.style.background = 'rgba(20, 20, 20, 0.8)';\r\n    infoLabel.style.background = 'rgba(20, 20, 20, 0.8)';\r\n\r\n    updateRecolorButtonTitle();\r\n\r\n    window.location.hash = '#julia'; // Update URL hash\r\n}\r\n\r\nexport function enableRiemannMode() {\r\n    fractalApp = new RiemannRenderer(canvas);\r\n    fractalApp.useAnalyticExtension = false;\r\n    fractalMode = FRACTAL_TYPE.RIEMANN;\r\n\r\n    destroyArrayOfButtons(presetButtons);\r\n\r\n    window.location.hash = '#zeta'; // Update URL hash\r\n}\r\n\r\nexport function updateRecolorButtonTitle() {\r\n    if (isJuliaMode()) {\r\n        let nextTheme = fractalApp.getNextColorThemeId();\r\n        if (nextTheme) randomizeColorsButton.title = 'Next theme: \"' + nextTheme + '\" (T)';\r\n    } else {\r\n        randomizeColorsButton.title = RANDOMIZE_COLOR_BUTTON_DEFAULT_TITLE;\r\n    }\r\n}\r\n\r\n/**\r\n * Updates color scheme\r\n * @param {PALETTE} [palette] defaults to the fractal palette\r\n */\r\nexport function updateColorTheme(palette) {\r\n    palette ||= [...fractalApp.colorPalette];\r\n\r\n    const adjustChannel = (value, brightnessFactor = 1.9) => Math.min(255, Math.floor(value * 255 * brightnessFactor));\r\n\r\n    accentColor = `rgba(${adjustChannel(palette[0])}, ${adjustChannel(palette[1])}, ${adjustChannel(palette[2])}, 1)`;\r\n    midColor = `rgba(${adjustChannel(palette[0], .5)}, ${adjustChannel(palette[1], .5)}, ${adjustChannel(palette[2], .5)}, 0.2)`;\r\n    bgColor = `rgba(${Math.floor(palette[0] * 200)}, ${Math.floor(palette[1] * 200)}, ${Math.floor(palette[2] * 200)}, 0.1)`; // Slightly dimmed for borders\r\n\r\n    let root = document.querySelector(':root');\r\n    root.style.setProperty('--bg-color', bgColor);\r\n    root.style.setProperty('--mid-color', midColor);\r\n    root.style.setProperty('--accent-color', accentColor);\r\n}\r\n\r\n/** Resets buttons, active presets and URL */\r\nexport function resetAppState() {\r\n    resetPresetAndDiveButtonStates();\r\n    resetActivePresetIndex();\r\n    clearURLParams();\r\n}\r\n\r\n/**\r\n * Updates the bottom info bar\r\n * @param force\r\n */\r\nexport function updateInfo(force = false) {\r\n    const now = performance.now();\r\n    const timeSinceLastUpdate = now - lastInfoUpdate;\r\n\r\n    // Coalescing throttle: If called too soon, schedule exactly one deferred update instead of dropping updates entirely.\r\n    if (!force && timeSinceLastUpdate < infoUpdateThrottleLimit) {\r\n        pendingInfoForce = pendingInfoForce || force;\r\n\r\n        if (!pendingInfoTimer) {\r\n            const delay = Math.max(infoUpdateThrottleLimit - timeSinceLastUpdate, 0);\r\n\r\n            pendingInfoTimer = setTimeout(() => {\r\n                pendingInfoTimer = null;\r\n\r\n                const pendingForce = pendingInfoForce;\r\n                pendingInfoForce = false;\r\n\r\n                updateInfo(pendingForce || true);\r\n            }, delay);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    lastInfoUpdate = now;\r\n\r\n    if (!canvas || !fractalApp) {\r\n        return;\r\n    }\r\n\r\n    let text = (animationActive ? ` [AUTO] ` : ``);\r\n\r\n    const panX = ddValue(fractalApp.panDD.x) ?? 0;\r\n    const panY = ddValue(fractalApp.panDD.y) ?? 0;\r\n\r\n    text += `p: [${panX.toFixed(8)}, ${panY.toFixed(8)}i]  `;\r\n\r\n    if (fractalMode === FRACTAL_TYPE.JULIA) {\r\n        const cx = fractalApp.c[0] ?? 0;\r\n        const cy = fractalApp.c[1] ?? 0;\r\n\r\n        text += `c: [${cx.toFixed(4)}, ${cy.toFixed(4)}i]  `;\r\n    }\r\n\r\n    const currentZoom = fractalApp.zoom ?? 0;\r\n    const currentRotation = (fractalApp.rotation * 180 / PI) % 360;\r\n    const normalizedRotation = currentRotation < 0 ? currentRotation + 360 : currentRotation;\r\n    text += `r: ${normalizedRotation.toFixed(0)}  zoom:&nbsp;${currentZoom.toExponential(0)}`;\r\n\r\n    if (animationActive) {\r\n        if (!infoText.classList.contains('animationActive')) infoText.classList.add('animationActive');\r\n    } else {\r\n        if (infoText.classList.contains('animationActive')) infoText.classList.remove('animationActive');\r\n    }\r\n\r\n    if (FF_USER_INPUT_ALLOWED) {\r\n        if (document.activeElement !== infoText) {\r\n            if (infoText.innerHTML !== text) infoText.innerHTML = text;\r\n        }\r\n    } else {\r\n        if (infoText.innerHTML !== text) infoText.innerHTML = text;\r\n    }\r\n}\r\n\r\n/** @returns {boolean} */\r\nexport const isAnimationActive = () => animationActive;\r\n\r\n/** Enables controls, resets demo button */\r\nfunction exitAnimationMode() {\r\n    console.groupCollapsed(`%c exitAnimationMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (!animationActive) {\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    animationActive = false;\r\n    infoText.classList.remove('animation');\r\n\r\n    fractalApp.stopAllNonColorAnimations();\r\n\r\n    demoButton.innerText = DEMO_BUTTON_DEFAULT_TEXT;\r\n    demoButton.classList.remove('active');\r\n\r\n    if (isTouchDevice()) {\r\n        registerTouchEventHandlers();\r\n    } else {\r\n        registerMouseEventHandlers();\r\n    }\r\n\r\n    if (isJuliaMode()) {\r\n        enableJuliaSliders();\r\n    }\r\n\r\n    setTimeout(() => {\r\n        updateInfo();\r\n    }, 150);\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/** Disables controls, activates demo button */\r\nfunction initAnimationMode() {\r\n    console.groupCollapsed(`%c initAnimationMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    animationActive = true;\r\n    infoText.classList.add('animation');\r\n\r\n    // resetPresetAndDiveButtons();\r\n    demoButton.innerText = DEMO_BUTTON_STOP_TEXT;\r\n    demoButton.classList.add('active');\r\n\r\n    // Unregister control events\r\n    if (isTouchDevice()) {\r\n        unregisterTouchEventHandlers();\r\n    } else {\r\n        unregisterMouseEventHandlers();\r\n    }\r\n\r\n    if (isJuliaMode()) {\r\n        disableJuliaSliders();\r\n    }\r\n\r\n    clearURLParams();\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Turns demo on/off and/or stops current animation\r\n * @return {Promise<void>}\r\n */\r\nexport async function toggleDemo() {\r\n    console.groupCollapsed(`%c toggleDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        resetPresetAndDiveButtonStates();\r\n        activeJuliaDiveIndex = -1;\r\n        fractalApp.stopDemo();\r\n        exitAnimationMode();\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    initAnimationMode();\r\n\r\n    switch (fractalMode) {\r\n        // @formatter:off\r\n        case FRACTAL_TYPE.MANDELBROT: await startMandelbrotDemo(); break;\r\n\r\n        case FRACTAL_TYPE.JULIA: await startJuliaDemo(); break;\r\n\r\n        default:\r\n            console.warn(`No demo defined for mode ${fractalMode}`);\r\n            exitAnimationMode();\r\n            break;\r\n        // @formatter:on\r\n    }\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/** Starts the Mandelbrot demo */\r\nasync function startMandelbrotDemo() {\r\n    console.groupCollapsed(`%c startMandelbrotDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    await fractalApp.animateDemo();\r\n\r\n    console.log(\"Demo ended\");\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Starts the Julia dive infinite animation\r\n * @param {Array<DIVE>} dives\r\n * @param {number} index Index of the dive\r\n * @return {Promise<void>}\r\n */\r\nexport async function startJuliaDive(dives, index) {\r\n    if (animationActive && index === activeJuliaDiveIndex) {\r\n        console.log(`%c startJuliaDive: %c Dive ${index} already in progress. Skipping.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    if (animationActive) {\r\n        exitAnimationMode();\r\n    }\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    activeJuliaDiveIndex = index;\r\n    diveButtons[index].classList.add('active');\r\n\r\n    const dive = dives[index];\r\n\r\n    // Validate configuration:\r\n    if (dive.cxDirection < 0 && dive.endC[0] >= dive.startC[0]) {\r\n        console.error(\"For negative cxDirection, endC[0] must be lower than startC[0].\");\r\n        return;\r\n    } else if (dive.cxDirection > 0 && dive.endC[0] <= dive.startC[0]) {\r\n        console.error(\"For positive cxDirection, endC[0] must be higher than startC[0].\");\r\n        return;\r\n    }\r\n    if (dive.cyDirection < 0 && dive.endC[1] >= dive.startC[1]) {\r\n        console.error(\"For negative cyDirection, endC[1] must be lower than startC[1].\");\r\n        return;\r\n    } else if (dive.cyDirection > 0 && dive.endC[1] <= dive.startC[1]) {\r\n        console.error(\"For positive cyDirection, endC[1] must be higher than startC[1].\");\r\n        return;\r\n    }\r\n\r\n    initAnimationMode();\r\n\r\n    //if (DEBUG_MODE) dive.step *= 10;\r\n\r\n    // Transition to the initial preset first.\r\n    const duration = getAnimationDuration(500, fractalApp, {c: dive.startC, pan: dive.pan, zoom: dive.zoom},\r\n        {pan: 0.5, zoom: 2, c: 1});\r\n    console.log(duration);\r\n\r\n    // Phase 1: Set initial state\r\n    // await fractalApp.animateTravelToPreset({\r\n    //     pan: dive.pan, c: dive.startC.slice(), // copy initial c\r\n    //     zoom: dive.zoom, rotation: dive.rotation\r\n    // }, 1500, EASE_TYPE.QUINT);\r\n    // Alternatively:\r\n    await fractalApp.animateToZoomAndC(fractalApp.DEFAULT_ZOOM, dive.startC, 1500);\r\n\r\n    // Phase 2: Enter dive mode\r\n    await Promise.all([\r\n        fractalApp.animateDive(dive),\r\n        fractalApp.animatePanZoomRotationTo(dive.pan, dive.zoom, dive.rotation, 1500)\r\n    ]);\r\n}\r\n\r\n/** Starts the Julia demo */\r\nasync function startJuliaDemo() {\r\n    console.groupCollapsed(`%c startJuliaDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        console.log(`Animation already in progress. Stopping.`);\r\n        exitAnimationMode();\r\n    }\r\n\r\n    initAnimationMode();\r\n\r\n    resetPresetAndDiveButtonStates();\r\n\r\n    // Initialize or continue the demo?\r\n    if (fractalApp.demoTime === 0) {\r\n        await fractalApp.animateTravelToPreset({\r\n            pan: fractalApp.DEFAULT_PAN, c: [-0.25, 0.7], // For smooth c transition\r\n            zoom: fractalApp.DEFAULT_ZOOM, rotation: fractalApp.DEFAULT_ROTATION\r\n        }, 1000);\r\n    }\r\n\r\n    await fractalApp.animateDemo();\r\n\r\n    exitAnimationMode();\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Travels to preset at given index\r\n * @param {Array<PRESET>} presets\r\n * @param {number} index Preset array index\r\n * @return {Promise<void>}\r\n */\r\nexport async function travelToPreset(presets, index) {\r\n    if (animationActive) {\r\n        console.log(`%c travelToPreset: %c Travel to preset ${index} requested, active animation in progress, interrupting...`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        exitAnimationMode();\r\n    }\r\n\r\n    if (index === activePresetIndex) {\r\n        console.log(`%c travelToPreset: %c Already on preset ${index}, skipping.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    console.log(`%c travelToPreset: %c Executing travel to preset ${index}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    initAnimationMode();\r\n\r\n    presetButtons[index].classList.add('active');\r\n\r\n    if (isJuliaMode()) {\r\n        fractalApp.demoTime = 0;\r\n        await fractalApp.animateTravelToPreset(presets[index], 1500);\r\n    } else {\r\n        if (FF_TRAVEL_TO_PRESET_WITH_ROTATION) {\r\n            await fractalApp.animateTravelToPresetWithRandomRotation(presets[index], 2000, 500, 1500);\r\n        } else {\r\n            await fractalApp.animateTravelToPreset(presets[index]);\r\n        }\r\n    }\r\n    activePresetIndex = index;\r\n\r\n    exitAnimationMode();\r\n    updateURLParams(fractalMode, fractalApp.pan[0], fractalApp.pan[1], fractalApp.zoom, fractalApp.rotation, fractalApp.c ? fractalApp.c[0] : null, fractalApp.c ? fractalApp.c[1] : null);\r\n}\r\n\r\n/** Inits debug bar with various information permanently shown on the screen */\r\nexport function toggleDebugMode() {\r\n    if (debugPanel) {\r\n        debugPanel.toggle();\r\n    } else {\r\n        debugPanel = new DebugPanel(canvas, fractalApp, accentColor);\r\n        toggleCenterLines();\r\n    }\r\n}\r\n\r\n/** Toggles x/y axes */\r\nexport function toggleCenterLines() {\r\n    const verticalLine = document.getElementById('verticalLine');\r\n    const horizontalLine = document.getElementById('horizontalLine');\r\n\r\n    if (verticalLine.style.display === 'block' && horizontalLine.style.display === 'block') {\r\n        verticalLine.style.display = 'none';\r\n        horizontalLine.style.display = 'none';\r\n    } else {\r\n        verticalLine.style.display = 'block';\r\n        horizontalLine.style.display = 'block';\r\n    }\r\n}\r\n\r\nexport function resetPresetAndDiveButtonStates() {\r\n    if (DEBUG_MODE) console.log(`%c resetPresetAndDiveButtonStates: %c Button states reset.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    presetButtons.concat(diveButtons).forEach(b => b.classList.remove('active'));\r\n}\r\n\r\n/**\r\n * This needs to happen on any fractal change\r\n */\r\nexport function resetActivePresetIndex() {\r\n    activePresetIndex = -1;\r\n}\r\n\r\nexport async function randomizeColors() {\r\n    if (isJuliaMode()) {\r\n        await fractalApp.animateColorPaletteTransition(250, updateColorTheme);\r\n        updateRecolorButtonTitle();\r\n    } else {\r\n        // Generate a bright random color palette\r\n        // Generate colors with better separation and higher brightness\r\n        const hue = Math.random(); // Hue determines the \"base color\" (red, green, blue, etc.)\r\n        const saturation = Math.random() * 0.5 + 0.5; // Ensure higher saturation (more vivid colors)\r\n        const brightness = Math.random() * 0.5 + 0.5; // Ensure higher brightness\r\n\r\n        // Convert HSB/HSV to RGB\r\n        const newPalette = hsbToRgb(hue, saturation, brightness);\r\n\r\n        await fractalApp.animateColorPaletteTransition(newPalette, 250, () => {\r\n            updateColorTheme(newPalette);\r\n        }); // Update app colors\r\n    }\r\n}\r\n\r\nexport function captureScreenshot() {\r\n    takeScreenshot(canvas, fractalApp, accentColor);\r\n}\r\n\r\n/**\r\n * Shows/hides/toggles header.\r\n * @param {boolean|null} show Show header? If null, then toggles current state\r\n */\r\nexport function toggleHeader(show = null) {\r\n    let header = document.getElementById('headerContainer');\r\n\r\n    if (show === null) show = !headerVisible;\r\n\r\n    if (show) {\r\n        header.classList.remove('minimized');\r\n    } else {\r\n        header.classList.add('minimized');\r\n    }\r\n\r\n    headerVisible = show;\r\n}\r\n\r\nexport async function reset() {\r\n    console.groupCollapsed(`%c reset`, CONSOLE_GROUP_STYLE);\r\n\r\n    updateColorTheme(isJuliaMode() ? DEFAULT_JULIA_THEME_COLOR : DEFAULT_MANDELBROT_THEME_COLOR);\r\n\r\n    exitAnimationMode();\r\n\r\n    fractalApp.reset();\r\n    if (isJuliaMode()) {\r\n        resetJuliaSliders();\r\n    }\r\n    resetAppState();\r\n    updateRecolorButtonTitle();\r\n    presetButtons[0].classList.add('active');\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n// region > INITIALIZERS -----------------------------------------------------------------------------------------------\r\n\r\nfunction initHeaderEvents() {\r\n\r\n    logo.addEventListener('pointerenter', () => {\r\n        if (headerMinimizeTimeout) {\r\n            clearTimeout(headerMinimizeTimeout);\r\n            headerMinimizeTimeout = null;\r\n        }\r\n        toggleHeader(true);\r\n    });\r\n\r\n    if (DEBUG_MODE > DEBUG_LEVEL.NONE) {\r\n        logo.addEventListener('click', () => {\r\n            toggleHeader();\r\n        });\r\n    }\r\n\r\n    header.addEventListener('pointerleave', async () => {\r\n        // Only minimize if it hasn't been toggled manually\r\n        if (headerVisible && !DEBUG_MODE) {\r\n            headerMinimizeTimeout = setTimeout(() => {\r\n                toggleHeader(false);\r\n                headerMinimizeTimeout = null;\r\n            }, 3000);\r\n        }\r\n    });\r\n\r\n    // When user clicks/taps outside of the header\r\n    canvas.addEventListener('pointerdown', () => {\r\n        if (DEBUG_MODE) return;\r\n        toggleHeader(false);\r\n    });\r\n\r\n    log('Initialized.', 'initHeaderEvents');\r\n}\r\n\r\nfunction initControlButtonEvents() {\r\n    resetButton.addEventListener('click', async () => {\r\n        await reset();\r\n    });\r\n\r\n    randomizeColorsButton.addEventListener('click', randomizeColors);\r\n\r\n    demoButton.addEventListener('click', toggleDemo);\r\n\r\n    screenshotButton.addEventListener('click', captureScreenshot);\r\n\r\n    log('Initialized.', 'initControlButtonEvents');\r\n}\r\n\r\nfunction initPresetButtonEvents() {\r\n    const presetBlock = document.getElementById('presets');\r\n    // presetBlock.innerHTML = 'Presets: ';\r\n    //\r\n    presetButtons = [];\r\n\r\n    const presets = [...fractalApp.PRESETS];\r\n    presets.forEach((preset, index) => {\r\n        const btn = document.createElement('button');\r\n        btn.id = 'preset' + (index);\r\n        btn.className = 'preset';\r\n        btn.title = (preset.title || ('Preset ' + index)) + (index < 10 ? ` (Num ${index})` : ` (${index})`); // TODO keep the ID in the title\r\n        btn.textContent = (preset.title || index).toString();\r\n        btn.addEventListener('click', async () => {\r\n            await travelToPreset(presets, index);\r\n        });\r\n\r\n        presetBlock.appendChild(btn);\r\n        presetButtons.push(btn);\r\n        presetButtons[0].classList.add('active');\r\n    });\r\n\r\n    log('Initialized.', 'initPresetButtonEvents');\r\n}\r\n\r\n/**\r\n * Inits behavior common for all buttons\r\n */\r\nfunction initCommonButtonEvents() {\r\n    allButtons = diveButtons.concat(presetButtons);\r\n    allButtons.push(resetButton, randomizeColorsButton, screenshotButton, demoButton);\r\n\r\n    allButtons.forEach((btn) => {\r\n        btn.addEventListener('mouseleave', () => {\r\n            btn.blur();\r\n        });\r\n\r\n        btn.addEventListener('mouseup', () => {\r\n            btn.blur();\r\n        });\r\n    });\r\n\r\n    log('Initialized.', 'initCommonButtonEvents');\r\n}\r\n\r\nfunction initDiveButtons() {\r\n    if (isJuliaMode()) {\r\n        const diveBlock = document.getElementById('dives');\r\n        //diveBlock.innerHTML = 'Dives: ';\r\n\r\n        diveButtons = [];\r\n\r\n        const dives = [...fractalApp.DIVES];\r\n        dives.forEach((dive, index) => {\r\n            const btn = document.createElement('button');\r\n            btn.id = 'dive' + (index);\r\n            btn.className = 'dive';\r\n            btn.title = (dive.title || ('Preset ' + index)) + ` (Shift+${index})`;\r\n            btn.textContent = dive.title || (index).toString();\r\n            btn.addEventListener('click', async () => {\r\n                await startJuliaDive(dives, index);\r\n            });\r\n\r\n            diveBlock.appendChild(btn);\r\n            diveButtons.push(btn);\r\n        });\r\n\r\n        diveBlock.style.display = 'inline-flex';\r\n    }\r\n\r\n    log('Initialized.', 'initDiveButtons');\r\n}\r\n\r\nfunction initFractalSwitchButtons() {\r\n    mandelbrotSwitch.addEventListener('click', async (e) => {\r\n        if (e.ctrlKey) {\r\n            console.log('mandelbrotSwitch clicked (with persistence).');\r\n            await switchFractalTypeWithPersistence(FRACTAL_TYPE.MANDELBROT);\r\n        } else {\r\n            console.log('mandelbrotSwitch clicked.');\r\n            await switchFractalMode(FRACTAL_TYPE.MANDELBROT);\r\n        }\r\n    });\r\n\r\n    juliaSwitch.addEventListener('click', async (e) => {\r\n        if (e.ctrlKey) {\r\n            console.log('juliaSwitch clicked (with persistence).');\r\n            await switchFractalTypeWithPersistence(FRACTAL_TYPE.JULIA);\r\n        } else {\r\n            await switchFractalMode(FRACTAL_TYPE.JULIA);\r\n        }\r\n    });\r\n\r\n    if (FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED) {\r\n        persistSwitch.addEventListener('click', async (e) => {\r\n            console.log('persistSwitch clicked.');\r\n            if (isJuliaMode()) {\r\n                await switchFractalTypeWithPersistence(FRACTAL_TYPE.MANDELBROT)\r\n            } else {\r\n                await switchFractalTypeWithPersistence(FRACTAL_TYPE.JULIA);\r\n            }\r\n        });\r\n\r\n        persistSwitch.style.display = 'inline-flex';\r\n    }\r\n\r\n    log('Initialized.', 'initFractalSwitchButtons');\r\n}\r\n\r\nfunction initWindowEvents() {\r\n    // Resize canvas on window resize\r\n    window.addEventListener('resize', () => {\r\n        clearTimeout(resizeTimeout);\r\n        resizeTimeout = setTimeout(() => {\r\n            fractalApp.resizeCanvas(); // Adjust canvas dimensions\r\n        }, 200); // Adjust delay as needed\r\n    });\r\n\r\n    // Initialize draggable elements (debug info)\r\n    const dragElements = document.querySelectorAll(\".draggable\");\r\n\r\n    const move = (event, element) => {\r\n        let leftValue = parseInt(window.getComputedStyle(element).left);\r\n        let topValue = parseInt(window.getComputedStyle(element).top);\r\n        element.style.left = `${leftValue + event.movementX}px`;\r\n        element.style.top = `${topValue + event.movementY}px`;\r\n    }\r\n\r\n    dragElements.forEach((element) => {\r\n        element.addEventListener(\"mousedown\", () => {\r\n            const onMove = (event) => move(event, element);\r\n\r\n            document.addEventListener(\"mousemove\", onMove);\r\n            document.addEventListener(\"mouseup\", () => {\r\n                document.removeEventListener(\"mousemove\", onMove);\r\n            }, {once: true});\r\n        });\r\n    });\r\n\r\n    log('Initialized.', 'initWindowEvents');\r\n}\r\n\r\n/**\r\n * Parses a string of the form:\r\n *   p = [<panX>, <panY>i] c = [<cX>, <cY>i] zoom = <zoom> r = <rotation>\r\n * and returns an object with the parsed numbers.\r\n * If a part is invalid or missing, an error message is returned.\r\n *\r\n * @param {string} input The input string.\r\n * @returns {PRESET|Object}\r\n */\r\nexport function parseUserInput(input) {\r\n\r\n    // https://regex101.com/\r\n    const panRegex = /\\s*p\\s*=\\s*[\\[\\(]?\\s*(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*[\\]\\)]?/i;\r\n    const cRegex = /\\s*c\\s*=\\s*[\\[\\(]?\\s*(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*[\\]\\)]?/i;\r\n    const zoomRegex = /\\s*zoom\\s*=\\s*([\\d.]+)/i;\r\n    const rotationRegex = /\\s*r\\s*=\\s*([\\d.]+)/i;\r\n\r\n    let errors = [];\r\n\r\n    // Validate and extract pan.\r\n    const panMatch = input.match(panRegex);\r\n    if (!panMatch) {\r\n        errors.push(`Pan coordinates (p) are missing or invalid.`);\r\n    }\r\n    // Validate and extract Julia c in Julia mode\r\n    const cMatch = input.match(cRegex);\r\n    if (!cMatch && isJuliaMode()) {\r\n        errors.push(`Julia constant (c) is missing or invalid.`);\r\n    }\r\n    // Validate and extract zoom.\r\n    const zoomMatch = input.match(zoomRegex);\r\n    if (!zoomMatch) {\r\n        errors.push(`Zoom (zoom) value is missing or invalid.`);\r\n    }\r\n    // Validate and extract rotation.\r\n    const rotationMatch = input.match(rotationRegex);\r\n    if (!rotationMatch) {\r\n        errors.push(`Rotation (r) value is missing or invalid.`);\r\n    }\r\n\r\n    // If any errors, return error object.\r\n    if (errors.length > 0) {\r\n        return {error: errors.join(\" \")};\r\n    }\r\n\r\n    // Otherwise, parse values.\r\n    const panX = parseFloat(panMatch[1]);\r\n    const panY = parseFloat(panMatch[2]);\r\n    const z = parseFloat(zoomMatch[1]);\r\n    const r = normalizeRotation(parseFloat(rotationMatch[1]) * Math.PI / 180);\r\n\r\n    // Optionally check for isNaN here too.\r\n    // if ([panX, panY, cX, cY, z, r].some(v => isNaN(v))) {\r\n    //     return { error: \"One or more numeric values could not be parsed.\" };\r\n    // }\r\n\r\n    if (isJuliaMode()) {\r\n        const cX = parseFloat(cMatch[1]);\r\n        const cY = parseFloat(cMatch[2]);\r\n\r\n        return {pan: [panX, panY], c: [cX, cY], zoom: z, rotation: r};\r\n    } else {\r\n        return {pan: [panX, panY], zoom: z, rotation: r};\r\n    }\r\n\r\n}\r\n\r\nfunction initInfoText() {\r\n    if (!FF_USER_INPUT_ALLOWED) {\r\n\r\n        infoText.addEventListener('mouseenter', () => {\r\n            infoText.innerHTML = 'Click to copy fractal state to clipboard.';\r\n        });\r\n\r\n        infoText.addEventListener('mouseleave', () => {\r\n            updateInfo();\r\n        });\r\n\r\n        infoText.addEventListener('click', () => {\r\n            let text = `\"pan\": [${fractalApp.pan}], \"rotation\": ${normalizeRotation(fractalApp.rotation)}, \"zoom\": ${fractalApp.zoom}`\r\n                + (isJuliaMode() ? `, \"c\": [${fractalApp.c}]}` : `}`);\r\n\r\n            navigator.clipboard.writeText(text).then(function () {\r\n                infoText.innerHTML = 'Copied to clipboard!';\r\n            }, function (err) {\r\n                console.error('Not copied to clipboard! ' + err.toString());\r\n            });\r\n        });\r\n    } else {\r\n        infoText.setAttribute(\"contenteditable\", true);\r\n        infoText.style.cursor = 'auto';\r\n        infoText.removeAttribute(\"readonly\");\r\n\r\n        infoText.addEventListener('focus', () => {\r\n            infoLabel.style.zoom = '200%';\r\n        })\r\n\r\n        infoText.addEventListener('blur', () => {\r\n            infoLabel.style.zoom = '120%';\r\n        })\r\n\r\n        infoText.addEventListener(\"keydown\", function (e) {\r\n            e.stopPropagation();\r\n\r\n            if (e.key === \"Enter\") {\r\n                e.preventDefault(); // Prevent a newline\r\n\r\n                //const regex = /\\s*p\\s*=\\s*\\[(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*\\]\\s*?\\s*r\\s*=\\s*(-?[\\d.]+)\\s*?\\s*?\\s*zoom\\s*=\\s*(-?[\\d.]+)/;\r\n                /* for C capture the same as for P\r\n                    Allowed complex notations:\r\n                    p = [ -0.500000000000, 0.000000000000i]  r = 0  zoom = 3.000000\r\n                    p = [-0.500000000000 + 2i]  r = 0  zoom = 3.000000\r\n                    p = [ 0.500000000000, 0.000000000000]  r = 0  zoom = 3.000000\r\n                    p = [0.500000000000 + 0.000000000000]  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 + 0.000000000001)  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 - 0.000000000001)  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 - 0.000000000001i)  r = 0  zoom = -3.000000 (No match)\r\n                 */\r\n\r\n                const result = parseUserInput(infoText.innerHTML);\r\n                if (result.error) {\r\n                    infoLabel.style.color = '#f00';\r\n                    alert(result.error);\r\n                } else {\r\n                    infoLabel.style.color = '#fff';\r\n                    fractalApp.animateTravelToPreset(result);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction bindHTMLElements() {\r\n    // Element binding\r\n    mandelbrotSwitch = document.getElementById('mandelbrotSwitch');\r\n    juliaSwitch = document.getElementById('juliaSwitch');\r\n    persistSwitch = document.getElementById('persistSwitch');\r\n    header = document.getElementById('headerContainer');\r\n    logo = document.getElementById('logo');\r\n    infoLabel = document.getElementById('infoLabel');\r\n    infoText = document.getElementById('infoText');\r\n    resetButton = document.getElementById('reset');\r\n    randomizeColorsButton = document.getElementById('randomize');\r\n    screenshotButton = document.getElementById('screenshot');\r\n    demoButton = document.getElementById('demo');\r\n}\r\n\r\n/**\r\n * Initializes the UI and registers UI event handlers\r\n * @param fractalRenderer\r\n */\r\nexport async function initUI(fractalRenderer) {\r\n    if (uiInitialized) {\r\n        console.warn(\"UI already initialized!\");\r\n        return;\r\n    }\r\n\r\n    fractalApp = fractalRenderer;\r\n    canvas = fractalApp.canvas;\r\n\r\n    bindHTMLElements();\r\n\r\n    if (fractalRenderer instanceof JuliaRenderer) {\r\n        fractalMode = FRACTAL_TYPE.JULIA;\r\n        juliaSwitch.classList.add('active');\r\n        mandelbrotSwitch.classList.remove('active');\r\n\r\n        initJuliaSliders(fractalApp);\r\n        updateJuliaSliders();\r\n        initDiveButtons();\r\n\r\n        updateColorTheme(DEFAULT_JULIA_THEME_COLOR);\r\n        // Darker backgrounds for Julia as it renders on white\r\n        header.style.background = 'rgba(20, 20, 20, 0.8)';\r\n        infoLabel.style.background = 'rgba(20, 20, 20, 0.8)';\r\n\r\n        window.location.hash = '#julia'; // Update URL hash\r\n    }\r\n    initPresetButtonEvents();\r\n    initWindowEvents();\r\n    initHeaderEvents();\r\n    initControlButtonEvents();\r\n    initInfoText();\r\n    initFractalSwitchButtons();\r\n    initCommonButtonEvents(); // After all dynamic buttons are set\r\n\r\n    // Register control events\r\n    if (isTouchDevice()) {\r\n        initTouchHandlers(fractalApp);\r\n    } else {\r\n        initHotKeys(fractalApp);\r\n        initMouseHandlers(fractalApp);\r\n    }\r\n\r\n    updateRecolorButtonTitle();\r\n\r\n    if (DEBUG_MODE === DEBUG_LEVEL.FULL && !isMobileDevice()) {\r\n        toggleDebugMode();\r\n    }\r\n\r\n    uiInitialized = true;\r\n}\r\n\r\n// endregion------------------------------------------------------------------------------------------------------------","import {updateInfo} from \"../ui/ui\";\r\nimport FractalRenderer from \"./fractalRenderer\";\r\nimport {compareComplex, ddSubDD, degToRad, hexToRGB, lerp, normalizeRotation, splitFloat,} from \"../global/utils\";\r\nimport \"../global/types\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, EASE_TYPE, JULIA_PALETTES,} from \"../global/constants\";\r\nimport {updateJuliaSliders} from \"../ui/juliaSlidersController\";\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/julia.frag';\r\nimport data from '../data/julia.json' with {type: 'json'};\r\n\r\n/**\r\n * JuliaRenderer (Rebased Perturbation)\r\n *\r\n * @author Radim Brnka\r\n * @description This module defines a JuliaRenderer class that inherits from fractalRenderer, implements the shader fragment code for the Julia set fractal, and sets preset zoom-ins.\r\n * Reference orbit is for current c and a chosen z0_ref (near the view center).\r\n * For each pixel:\r\n *   z0 = pan + zoom * rotated(st)\r\n *   dz0 = z0 - z0_ref\r\n *   dz_{n+1} = 2*zref*dz + dz^2 (NO +dc each step for Julia!)\r\n * @extends FractalRenderer\r\n * @see MandelbrotRenderer\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nexport class JuliaRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.LEGACY_JULIA_RENDER = false;\r\n\r\n        this.DEFAULT_ZOOM = data.presets[0].zoom;\r\n        this.MAX_ZOOM = 1e-17;\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n\r\n        this.DEFAULT_ROTATION = data.presets[0].rotation;\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n\r\n        // TODO Use less detailed initial set for less performant devices\r\n        /** @type COMPLEX */\r\n        this.DEFAULT_C = [data.presets[0].c[0], data.presets[0].c[1]];\r\n        /** @type COMPLEX */\r\n        this.c = [...this.DEFAULT_C];\r\n\r\n        // IMPORTANT: use setPan (syncs DD + array)  keep this.pan canonical (TODO remove pan completely at some point)\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]);\r\n\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        // --- Perturbation state with DD precision ---\r\n        this.refZ0 = [0, 0];\r\n        this.refZ0DD = {\r\n            x: { hi: 0, lo: 0 },\r\n            y: { hi: 0, lo: 0 }\r\n        };\r\n        this.refPan = [...this.DEFAULT_PAN];\r\n        this.refPanDD = {\r\n            x: { hi: this.DEFAULT_PAN[0], lo: 0 },\r\n            y: { hi: this.DEFAULT_PAN[1], lo: 0 }\r\n        };\r\n        this.orbitDirty = true;\r\n\r\n        this._prevPan0 = NaN;\r\n        this._prevPan1 = NaN;\r\n        this._prevZoom = NaN;\r\n        this._prevC0 = NaN;\r\n        this._prevC1 = NaN;\r\n\r\n        this.MAX_ITER = 2000;\r\n        this.REF_SEARCH_GRID = 7;\r\n        this.REF_SEARCH_RADIUS = 0.50;\r\n\r\n        this.orbitTex = null;\r\n        this.orbitData = null;\r\n        this.floatTexExt = null;\r\n\r\n        this.rebaseArmed = true;\r\n\r\n        /** @type {Array.<JULIA_PRESET>} */\r\n        this.PRESETS = data.presets.map(p => ({\r\n            ...p,\r\n            rotation: degToRad(p.rotation || 0)\r\n        }));\r\n\r\n        /** @type {Array.<DIVE>} */\r\n        this.DIVES = data.dives.map(d => ({\r\n            ...d,\r\n            rotation: degToRad(d.rotation || 0)\r\n        }));\r\n\r\n        this.currentPaletteIndex = 0;\r\n        this.innerStops = new Float32Array(JULIA_PALETTES[this.currentPaletteIndex].theme);\r\n\r\n        this.currentCAnimationFrame = null;\r\n        this.demoTime = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    markOrbitDirty = () => this.orbitDirty = true;\r\n\r\n    onProgramCreated() {\r\n        this.floatTexExt = this.gl.getExtension(\"OES_texture_float\");\r\n        if (!this.floatTexExt) {\r\n            console.error(\"Missing OES_texture_float. Julia deep zoom perturbation requires it.\");\r\n            return;\r\n        }\r\n\r\n        this.orbitTex = this.gl.createTexture();\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n\r\n        this.orbitData = new Float32Array(this.MAX_ITER * 4);\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n\r\n        this.orbitDirty = true;\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.replace('__MAX_ITER__', this.MAX_ITER).toString();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        this.cLoc = this.gl.getUniformLocation(this.program, \"u_c\");\r\n        this.innerStopsLoc = this.gl.getUniformLocation(this.program, \"u_innerStops\");\r\n\r\n        // delta z0 (pan - refZ0) computed on JS side for float64 precision\r\n        this.deltaZ0HLoc = this.gl.getUniformLocation(this.program, \"u_delta_z0_h\");\r\n        this.deltaZ0LLoc = this.gl.getUniformLocation(this.program, \"u_delta_z0_l\");\r\n        this.zoomHLoc = this.gl.getUniformLocation(this.program, \"u_zoom_h\");\r\n        this.zoomLLoc = this.gl.getUniformLocation(this.program, \"u_zoom_l\");\r\n\r\n        this.orbitTexLoc = this.gl.getUniformLocation(this.program, \"u_orbitTex\");\r\n        this.orbitWLoc = this.gl.getUniformLocation(this.program, \"u_orbitW\");\r\n    }\r\n\r\n    // --- Reference orbit building ---\r\n\r\n    escapeItersJulia(zx0, zy0, iters) {\r\n        let zx = zx0, zy = zy0;\r\n        const cx = this.c[0], cy = this.c[1];\r\n        for (let i = 0; i < iters; i++) {\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2; zy = zy2;\r\n            if (zx * zx + zy * zy > 4.0) return i;\r\n        }\r\n        return iters;\r\n    }\r\n\r\n    /**\r\n     * Choose a good refZ0 near view center:\r\n     * - sample a grid around view center (radius scales with zoom)\r\n     * - pick the point with the highest escape iteration (prefer inside / late escape)\r\n     * - prefer keeping the current reference to avoid jitter unless a significantly better one is found\r\n     * @param {boolean} useViewCenter - If true, skip grid search and use view center directly (for stability during interaction)\r\n     */\r\n    pickReferenceNearViewCenter(useViewCenter = false) {\r\n        // During interaction, use view center directly to prevent jitter from grid search\r\n        // Copy DD components to preserve deep zoom precision\r\n        if (useViewCenter) {\r\n            this.refZ0[0] = this.pan[0];\r\n            this.refZ0[1] = this.pan[1];\r\n            this.refZ0DD.x.hi = this.panDD.x.hi;\r\n            this.refZ0DD.x.lo = this.panDD.x.lo;\r\n            this.refZ0DD.y.hi = this.panDD.y.hi;\r\n            this.refZ0DD.y.lo = this.panDD.y.lo;\r\n            // Keep refPan in sync for needsRebase() to work correctly\r\n            this.refPan[0] = this.pan[0];\r\n            this.refPan[1] = this.pan[1];\r\n            this.refPanDD.x.hi = this.panDD.x.hi;\r\n            this.refPanDD.x.lo = this.panDD.x.lo;\r\n            this.refPanDD.y.hi = this.panDD.y.hi;\r\n            this.refPanDD.y.lo = this.panDD.y.lo;\r\n            return;\r\n        }\r\n\r\n        const grid = this.REF_SEARCH_GRID;\r\n        const half = (grid - 1) / 2;\r\n        const step = (2.0 * this.REF_SEARCH_RADIUS) / (grid - 1);\r\n\r\n        const base = this.zoom;\r\n        const probeIters = Math.min(this.MAX_ITER, Math.max(200, Math.floor(this.iterations)));\r\n\r\n        // Evaluate current reference point's score (if we have one within reasonable distance)\r\n        let currentRefScore = -1;\r\n        const currentRefDist = Math.hypot(this.refZ0[0] - this.pan[0], this.refZ0[1] - this.pan[1]);\r\n        const maxRefDist = base * this.REF_SEARCH_RADIUS * 2.5; // Allow some margin beyond search radius\r\n\r\n        if (currentRefDist < maxRefDist) {\r\n            currentRefScore = this.escapeItersJulia(this.refZ0[0], this.refZ0[1], probeIters);\r\n        }\r\n\r\n        // Start with view center as fallback\r\n        let bestX = this.pan[0];\r\n        let bestY = this.pan[1];\r\n        let bestScore = this.escapeItersJulia(this.pan[0], this.pan[1], probeIters);\r\n\r\n        for (let j = 0; j < grid; j++) {\r\n            for (let i = 0; i < grid; i++) {\r\n                const ox = (i - half) * step;\r\n                const oy = (j - half) * step;\r\n\r\n                const zx0 = this.pan[0] + ox * base;\r\n                const zy0 = this.pan[1] + oy * base;\r\n\r\n                const score = this.escapeItersJulia(zx0, zy0, probeIters);\r\n                if (score > bestScore) {\r\n                    bestScore = score;\r\n                    bestX = zx0;\r\n                    bestY = zy0;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Stability: only switch reference if the new one is significantly better.\r\n        // This prevents jitter from small score differences between frames.\r\n        // Require at least 10% improvement or 50 iterations better to switch.\r\n        const improvementThreshold = Math.max(currentRefScore * 0.10, 50);\r\n        const shouldSwitch = currentRefScore < 0 || (bestScore - currentRefScore) > improvementThreshold;\r\n\r\n        if (shouldSwitch) {\r\n            this.refZ0[0] = bestX;\r\n            this.refZ0[1] = bestY;\r\n            // New reference point from grid search - no DD precision accumulated yet\r\n            this.refZ0DD.x.hi = bestX;\r\n            this.refZ0DD.x.lo = 0;\r\n            this.refZ0DD.y.hi = bestY;\r\n            this.refZ0DD.y.lo = 0;\r\n            // Keep refPan in sync for needsRebase() to work correctly\r\n            this.refPan[0] = bestX;\r\n            this.refPan[1] = bestY;\r\n            this.refPanDD.x.hi = bestX;\r\n            this.refPanDD.x.lo = 0;\r\n            this.refPanDD.y.hi = bestY;\r\n            this.refPanDD.y.lo = 0;\r\n        }\r\n        // else: keep current refZ0 for stability\r\n    }\r\n\r\n    computeReferenceOrbit() {\r\n        if (!this.orbitData || !this.orbitTex) return;\r\n\r\n        const cx = this.c[0];\r\n        const cy = this.c[1];\r\n\r\n        let zx = this.refZ0[0];\r\n        let zy = this.refZ0[1];\r\n\r\n        for (let n = 0; n < this.MAX_ITER; n++) {\r\n            const sx = splitFloat(zx);\r\n            const sy = splitFloat(zy);\r\n\r\n            const idx = n * 4;\r\n            this.orbitData[idx] = sx.high;\r\n            this.orbitData[idx + 1] = sx.low;\r\n            this.orbitData[idx + 2] = sy.high;\r\n            this.orbitData[idx + 3] = sy.low;\r\n\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2; zy = zy2;\r\n\r\n            if (zx * zx + zy * zy > 4.0) {\r\n                const fx = splitFloat(zx);\r\n                const fy = splitFloat(zy);\r\n                for (let k = n + 1; k < this.MAX_ITER; k++) {\r\n                    const j = k * 4;\r\n                    this.orbitData[j] = fx.high;\r\n                    this.orbitData[j + 1] = fx.low;\r\n                    this.orbitData[j + 2] = fy.high;\r\n                    this.orbitData[j + 3] = fy.low;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texImage2D(\r\n            this.gl.TEXTURE_2D,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.MAX_ITER,\r\n            1,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.gl.FLOAT,\r\n            this.orbitData\r\n        );\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n    }\r\n\r\n    /**\r\n     * Julia \"needsRebase\": keep reference initial condition close to view center.\r\n     * Same intent as Mandelbrot, but for z0 reference.\r\n     */\r\n    needsRebase() {\r\n        const REBASE_ON = 1.75;\r\n        const REBASE_OFF = 0.90;\r\n\r\n        if (this.rebaseArmed === undefined) this.rebaseArmed = true;\r\n\r\n        if (!this.refPan) return true;\r\n        if (!Number.isFinite(this.zoom)) return false;\r\n\r\n        const z = Math.max(this.zoom, 1e-300);\r\n\r\n        const dx = this.pan[0] - this.refPan[0];\r\n        const dy = this.pan[1] - this.refPan[1];\r\n        const deltaView = Math.hypot(dx, dy) / z;\r\n\r\n        if (!this.rebaseArmed && deltaView < REBASE_OFF) {\r\n            this.rebaseArmed = true;\r\n            return false;\r\n        }\r\n\r\n        if (this.rebaseArmed && deltaView > REBASE_ON) {\r\n            this.rebaseArmed = false;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Iteration strategy avoids exploding to infinity at tiny zooms\r\n        const safe = Math.max(this.zoom, 1e-300);\r\n        const baseIters = Math.floor(200 + 50 * Math.log10(this.DEFAULT_ZOOM / safe));\r\n        this.iterations = Math.max(50, Math.min(this.MAX_ITER, baseIters + this.extraIterations));\r\n\r\n        // Detect view changes -> mark orbit dirty (use tolerant checks to avoid noise)\r\n        const panMoved =\r\n            Number.isFinite(this._prevPan0) && Number.isFinite(this._prevPan1)\r\n                ? (Math.abs(this.pan[0] - this._prevPan0) + Math.abs(this.pan[1] - this._prevPan1)) > (this.zoom * 1e-6)\r\n                : true;\r\n\r\n        const zoomChanged =\r\n            Number.isFinite(this._prevZoom)\r\n                ? Math.abs(this.zoom - this._prevZoom) > (this.zoom * 1e-8)\r\n                : true;\r\n\r\n        const cChanged =\r\n            Number.isFinite(this._prevC0) && Number.isFinite(this._prevC1)\r\n                ? (Math.abs(this.c[0] - this._prevC0) + Math.abs(this.c[1] - this._prevC1)) > 0.0\r\n                : true;\r\n\r\n        if (panMoved || zoomChanged || cChanged) {\r\n            this.orbitDirty = true;\r\n            this._prevPan0 = this.pan[0];\r\n            this._prevPan1 = this.pan[1];\r\n            this._prevZoom = this.zoom;\r\n            this._prevC0 = this.c[0];\r\n            this._prevC1 = this.c[1];\r\n        }\r\n\r\n        // Rebase policy (same intent as Mandelbrot):\r\n        // - avoid rebuilding orbit every frame during interaction (prevents swim/jitter)\r\n        // - but if c changes, we must rebuild for correctness\r\n        const mustRebaseNow = cChanged || this.needsRebase();\r\n        const canRebaseNow = !this.interactionActive || mustRebaseNow;\r\n\r\n        if (this.orbitDirty && canRebaseNow) {\r\n            // During interaction, use view center directly to prevent jitter\r\n            this.pickReferenceNearViewCenter(this.interactionActive);\r\n            this.computeReferenceOrbit();\r\n            this.orbitDirty = false;\r\n        }\r\n\r\n        // Compute deltaZ0 = panDD - refZ0DD on JS side (float64) for precision\r\n        // This avoids float32 precision loss when the shader subtracts pan - refZ0\r\n        const deltaZ0X = ddSubDD(this.panDD.x, this.refZ0DD.x);\r\n        const deltaZ0Y = ddSubDD(this.panDD.y, this.refZ0DD.y);\r\n\r\n        // Upload deltaZ0 hi/lo\r\n        if (this.deltaZ0HLoc) this.gl.uniform2f(this.deltaZ0HLoc, deltaZ0X.hi, deltaZ0Y.hi);\r\n        if (this.deltaZ0LLoc) this.gl.uniform2f(this.deltaZ0LLoc, deltaZ0X.lo, deltaZ0Y.lo);\r\n\r\n        // Upload zoom hi/lo\r\n        const z = splitFloat(this.zoom);\r\n        if (this.zoomHLoc) this.gl.uniform1f(this.zoomHLoc, z.high);\r\n        if (this.zoomLLoc) this.gl.uniform1f(this.zoomLLoc, z.low);\r\n\r\n        if (this.cLoc) this.gl.uniform2fv(this.cLoc, this.c);\r\n        if (this.innerStopsLoc) this.gl.uniform3fv(this.innerStopsLoc, this.innerStops);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    reset() {\r\n        this.c = [...this.DEFAULT_C];\r\n        this.innerStops = new Float32Array(JULIA_PALETTES[0].theme);\r\n        this.currentPaletteIndex = 0;\r\n\r\n        this.orbitDirty = true;\r\n        this._prevPan0 = NaN;\r\n        this._prevPan1 = NaN;\r\n        this._prevZoom = NaN;\r\n        this._prevC0 = NaN;\r\n        this._prevC1 = NaN;\r\n\r\n        super.reset();\r\n    }\r\n\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /** Stops currently running pan animation */\r\n    stopCurrentCAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentCAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentCAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentCAnimationFrame);\r\n            this.currentCAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    stopAllNonColorAnimations() {\r\n        this.stopCurrentCAnimation();\r\n\r\n        super.stopAllNonColorAnimations();\r\n    }\r\n\r\n    /**\r\n     * Returns id/title of the next color theme in the themes array.\r\n     * @return {string}\r\n     */\r\n    getNextColorThemeId() {\r\n        const nextTheme = JULIA_PALETTES[(this.currentPaletteIndex + 1) % JULIA_PALETTES.length];\r\n\r\n        return nextTheme.id || 'Random';\r\n    }\r\n\r\n    /**\r\n     * Smoothly transitions the inner color stops (used by the shader for inner coloring)\r\n     * from the current value to the provided toPalette over the specified duration.\r\n     * Also updates the colorPalette to match the theme (using the first stop, for example).\r\n     *\r\n     * @param {JULIA_PALETTE} toPalette - The target theme as an array of numbers (e.g., 15 numbers for 5 stops).\r\n     * @param {number} [duration=250] - Duration of the transition in milliseconds.\r\n     * @param {Function} [callback] - A callback invoked when the transition completes.\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateInnerStopsTransition(toPalette, duration = 250, callback = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateInnerStopsTransition`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        // Save the starting stops as a plain array.\r\n        const startStops = Array.from(this.innerStops);\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                // Interpolate each component of the inner stops.\r\n                const interpolated = startStops.map((v, i) => lerp(v, toPalette.theme[i], progress));\r\n                this.innerStops = new Float32Array(interpolated);\r\n\r\n                let keyColor;\r\n\r\n                if (toPalette.keyColor) {\r\n                    keyColor = hexToRGB(toPalette.keyColor);\r\n                    if (keyColor) this.colorPalette = [keyColor.r, keyColor.g, keyColor.b];\r\n                }\r\n\r\n                if (!keyColor) {\r\n                    const stopIndex = 3;\r\n                    this.colorPalette = [\r\n                        toPalette.theme[stopIndex * 3] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 1] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 2] * 1.5\r\n                    ];\r\n                }\r\n\r\n                this.draw();\r\n\r\n                if (callback) callback();\r\n\r\n                if (progress < 1) {\r\n                    this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentColorAnimations();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    async animateColorPaletteTransition(duration = 250, coloringCallback = null) {\r\n        this.currentPaletteIndex = (this.currentPaletteIndex + 1) % JULIA_PALETTES.length;\r\n\r\n        await this.animateInnerStopsTransition(JULIA_PALETTES[this.currentPaletteIndex], duration, coloringCallback);\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    async animateFullColorSpaceCycle(duration = 15000, coloringCallback = null) {\r\n        await new Promise(() => {\r\n            this.animateColorPaletteTransition(duration, coloringCallback);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates Julia from current C to target C\r\n     *\r\n     * @param {COMPLEX} [targetC] Defaults to default C\r\n     * @param {number} [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateToC(targetC = [...this.DEFAULT_C], duration = 500, easeFunction = EASE_TYPE.QUINT) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateToC`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        if (compareComplex(this.c, targetC)) {\r\n            console.log(`Already at the target c. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        console.log(`Animating c from ${this.c} to ${targetC}.`);\r\n\r\n        const startC = [...this.c];\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                // Interpolate `c` smoothly\r\n                const easedProgress = easeFunction(progress);\r\n                this.c[0] = lerp(startC[0], targetC[0], easedProgress);\r\n                this.c[1] = lerp(startC[1], targetC[1], easedProgress);\r\n\r\n                // c changes require orbit rebuild for correctness (but keep same gating in draw()).\r\n                this.markOrbitDirty();\r\n\r\n                this.draw();\r\n\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                if (progress < 1) {\r\n                    this.currentCAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentCAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates Julia from current C and zoom to target C and zoom\r\n     *\r\n     * @param {number} [targetZoom] Target zoom\r\n     * @param {COMPLEX} [targetC] Defaults to default C\r\n     * @param {number} [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateToZoomAndC(targetZoom, targetC = [...this.DEFAULT_C], duration = 500, easeFunction = EASE_TYPE.QUINT) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateToZoomAndC`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        await Promise.all([\r\n            this.animateZoomTo(targetZoom, duration, easeFunction),\r\n            this.animateToC(targetC, duration, easeFunction)\r\n        ]);\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates travel to a preset.\r\n     * @param {JULIA_PRESET} preset\r\n     * @param {number} [duration] in ms\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateTravelToPreset(preset, duration = 500) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateTravelToPreset`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        // Phase 1: Setting default params.\r\n        await this.animatePanAndZoomTo(this.DEFAULT_PAN, this.DEFAULT_ZOOM, 1000);\r\n\r\n        // Phase 2: Animating to preset.\r\n        await Promise.all([\r\n            this.animateZoomTo(preset.zoom, duration, EASE_TYPE.QUINT),\r\n            this.animateToC(preset.c, duration),\r\n            this.animateRotationTo(preset.rotation, duration, EASE_TYPE.QUINT),\r\n            this.animatePanTo(preset.pan, duration, EASE_TYPE.QUINT)\r\n        ]);\r\n\r\n        this.currentPresetIndex = preset.id || 0;\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Infinite animation of the dive (c-param interpolations)\r\n     * @param {DIVE} dive\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDive(dive) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateDive`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        console.log(`Diving to ${dive}.`);\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            // Ensure phases are defined\r\n            dive.phases ||= [1, 2, 3, 4];\r\n            let phase = dive.phases[0];\r\n\r\n            const diveStep = () => {\r\n                const step = dive.step;\r\n                // Phase 1: Animate cx (real part) toward endC[0]\r\n                if (phase === 1) {\r\n                    this.c[0] += dive.cxDirection * step;\r\n                    if ((dive.cxDirection < 0 && this.c[0] <= dive.endC[0]) || (dive.cxDirection > 0 && this.c[0] >= dive.endC[0])) {\r\n                        this.c[0] = dive.endC[0];\r\n                        phase = 2;\r\n                    }\r\n                }\r\n                // Phase 2: Animate cy (imaginary part) toward endC[1]\r\n                else if (phase === 2) {\r\n                    this.c[1] += dive.cyDirection * step;\r\n                    if ((dive.cyDirection < 0 && this.c[1] <= dive.endC[1]) || (dive.cyDirection > 0 && this.c[1] >= dive.endC[1])) {\r\n                        this.c[1] = dive.endC[1];\r\n                        phase = 3;\r\n                    }\r\n                }\r\n                // Phase 3: Animate cx back toward startC[0]\r\n                else if (phase === 3) {\r\n                    this.c[0] -= dive.cxDirection * step;\r\n                    if ((dive.cxDirection < 0 && this.c[0] >= dive.startC[0]) || (dive.cxDirection > 0 && this.c[0] <= dive.startC[0])) {\r\n                        this.c[0] = dive.startC[0];\r\n                        phase = 4;\r\n                    }\r\n                }\r\n                // Phase 4: Animate cy back toward startC[1]\r\n                else if (phase === 4) {\r\n                    this.c[1] -= dive.cyDirection * step;\r\n                    if ((dive.cyDirection < 0 && this.c[1] >= dive.startC[1]) || (dive.cyDirection > 0 && this.c[1] <= dive.startC[1])) {\r\n                        this.c[1] = dive.startC[1];\r\n                        phase = 1; // Loop back to start phase.\r\n                    }\r\n                }\r\n\r\n                this.markOrbitDirty();\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                this.currentCAnimationFrame = requestAnimationFrame(diveStep);\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(diveStep);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates infinite demo loop with oscillating c between predefined values\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDemo() {\r\n        console.log(`%c ${this.constructor.name}: animateDemo`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        this.demoActive = true; // Not used in Julia but the demo is active\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            const step = () => {\r\n                this.c = [\r\n                    ((Math.sin(this.demoTime) + 1) / 2) * 1.5 - 1,   // Oscillates between -1 and 0.5\r\n                    ((Math.cos(this.demoTime) + 1) / 2) * 1.4 - 0.7  // Oscillates between -0.7 and 0.7\r\n                ];\r\n                this.rotation = normalizeRotation(this.rotation - 0.001);\r\n                this.demoTime += 0.0005; // Speed\r\n\r\n                this.markOrbitDirty();\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                this.currentCAnimationFrame = requestAnimationFrame(step);\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}","/**\r\n * @module Main\r\n * @author Radim Brnka\r\n * @description The entry point that imports modules, creates the fractal renderer instance (passing the canvas ID), initializes the UI and the fractal.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport './css/style.css';\r\nimport './css/debugPanel.css';\r\nimport {JuliaRenderer} from \"./renderers/juliaRenderer\";\r\nimport MandelbrotRenderer from \"./renderers/mandelbrotRenderer\";\r\nimport RiemannRenderer from \"./renderers/riemannRenderer\";\r\nimport {initUI, resetActivePresetIndex, resetPresetAndDiveButtonStates, updateInfo} from \"./ui/ui\";\r\nimport {asyncDelay, clearURLParams, loadFractalParamsFromURL} from \"./global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_LEVEL, DEBUG_MODE, FRACTAL_TYPE} from \"./global/constants\";\r\n\r\n/**\r\n * Initializes the canvas, reads URL params and triggers respective fractal rendering\r\n */\r\nasync function initFractalApp() {\r\n    if (DEBUG_MODE > DEBUG_LEVEL.VERBOSE) console.warn(' --- FULL DEBUG MODE ACTIVE! ---');\r\n    console.groupCollapsed(`%c initFractalApp`, CONSOLE_GROUP_STYLE);\r\n\r\n    const canvas = document.getElementById('fractalCanvas');\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n\r\n    const params = loadFractalParamsFromURL();\r\n    console.log(`URL Params found:  ${JSON.stringify(params)}`);\r\n\r\n    // Do we have all the params needed for initial travel?\r\n    const validMandelbrotTravelPreset = params.px != null && params.py != null && params.zoom != null && params.r != null;\r\n    const validJuliaTravelPreset = validMandelbrotTravelPreset && params.cx != null && params.cy != null;\r\n    const preset = {\r\n        pan: [params.px, params.py],\r\n        zoom: params.zoom,\r\n        c: [params.cx, params.cy],\r\n        rotation: params.r\r\n    };\r\n\r\n    const onDefault = () => {\r\n        console.log(`Default fractal settings used.`);\r\n        fractalApp.resizeCanvas();\r\n        clearURLParams();\r\n    }\r\n\r\n    let fractalApp;\r\n\r\n    switch (params.mode) {\r\n        /************\r\n         * JULIA SET\r\n         ************/\r\n        case FRACTAL_TYPE.JULIA:\r\n            console.log(`Constructing Julia.`);\r\n            fractalApp = new JuliaRenderer(canvas);\r\n            break;\r\n\r\n        /****************\r\n         * MANDELBROT SET\r\n         ****************/\r\n        case FRACTAL_TYPE.MANDELBROT:\r\n            console.log(`Constructing Mandelbrot.`);\r\n            fractalApp = new MandelbrotRenderer(canvas);\r\n            break;\r\n\r\n        /****************\r\n         * RIEMANN ZETA\r\n         ****************/\r\n        case FRACTAL_TYPE.RIEMANN:\r\n            console.log(`Constructing Riemann Zeta.`);\r\n            fractalApp = new RiemannRenderer(canvas);\r\n            break;\r\n\r\n        default:\r\n            console.error('Unknown fractal mode: ' + params.mode);\r\n            break;\r\n    }\r\n\r\n    await asyncDelay(100); // Wait a moment for things to stabilize\r\n    await initUI(fractalApp); // TODO consider initializing after travel\r\n\r\n    if (validJuliaTravelPreset) {\r\n        console.log(`Traveling to URL params.`);\r\n        await fractalApp.animateTravelToPreset(preset, 1000);\r\n    } else if (validMandelbrotTravelPreset) {\r\n        console.log(`Traveling to URL params.`);\r\n        await fractalApp.animateTravelToPreset(preset, 100, 1000);\r\n    } else {\r\n        onDefault();\r\n    }\r\n\r\n    await asyncDelay(100); // Wait a moment for things to stabilize\r\n\r\n    await new Promise(resolve => {\r\n        document.getElementById('headerContainer').classList.add('ready');\r\n        document.getElementById('infoLabel').classList.add('ready');\r\n        resolve();\r\n    });\r\n\r\n    // If URL contains a preset, reset buttons\r\n    if (validMandelbrotTravelPreset || validJuliaTravelPreset) {\r\n        resetPresetAndDiveButtonStates();\r\n        resetActivePresetIndex();\r\n    }\r\n\r\n    console.groupEnd();\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n        if (DEBUG_MODE) console.log('%c DOMContentLoaded: %c Initializing fractal.', CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        await initFractalApp();\r\n        console.log('%c DOMContentLoaded: %c Fractal init complete.', CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        await asyncDelay(2000); // Wait a moment for things to stabilize\r\n        updateInfo();\r\n    }, {\r\n        once: true\r\n    }\r\n);"],"names":["DEBUG_LEVEL","DEBUG_MODE","LOG_LEVEL","log","message","scope","arguments","length","undefined","concat","FRACTAL_TYPE","MANDELBROT","JULIA","RIEMANN","EASE_TYPE","NONE","x","QUAD","time","CUBIC","Math","pow","QUINT","ROTATION_DIRECTION","DEFAULT_ACCENT_COLOR","DEFAULT_BG_COLOR","JULIA_PALETTES","id","keyColor","theme","DEFAULT_MANDELBROT_THEME_COLOR","DEFAULT_JULIA_THEME_COLOR","hex","normalize","rgb","hexToRGB","r","g","b","hexToRGBArray","PI","e","t","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_slicedToArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_nonIterableRest","toString","slice","constructor","name","test","urlParamsSet","updateURLParams","mode","px","py","zoom","rotation","cx","cy","formatNumber","Number","toPrecision","params","toFixed","some","el","encodedParams","btoa","JSON","stringify","hashPath","window","history","pushState","loadFractalParamsFromURL","hash","URL","location","href","_hash$slice$split2","split","queryString","URLSearchParams","get","decodedParams","parse","atob","parseFloat","clearURLParams","newUrl","origin","isTouchDevice","navigator","maxTouchPoints","msMaxTouchPoints","isMobileDevice","toMatchItem","userAgent","match","expandComplexToString","precision","withI","invalidValues","NaN","isNumber","isFinite","expanded","trimmedReal","trimmedImag","SPLIT_FLOAT_METHOD","splitFloat","high","fround","low","splitFloatED","K","temp","splitFloatVD","ddMake","hi","lo","twoSum","s","bb","err","quickTwoSum","ddAdd","dd","ddSet","ddValue","ddSubDD","ddAddDD","compareComplex","c1","c2","comparePalettes","p1","p2","hsbToRgb","h","bl","floor","q","hslToRgb","hue2rgb","rgbToHsl","max","min","toLowerCase","replace","map","char","join","parseInt","substring","lerp","start","end","degToRad","degrees","normalizeRotation","twoPi","getAnimationDuration","seed","current","target","weights","compositeDistance","_loop","hasOwnProperty","key","currVal","targVal","diff","abs","hypot","apply","round","asyncDelay","_x","_asyncDelay","_callee","timeout","_context","setTimeout","_next","_throw","destroyArrayOfButtons","buttons","forEach","btn","parentNode","removeChild","_asyncToGenerator","_defineProperties","_toPropertyKey","_typeof","toPrimitive","String","_toPrimitive","FractalRenderer","canvas","_classCallCheck","this","gl","getContext","antialias","alpha","depth","stencil","preserveDrawingBuffer","powerPreference","MAX_ITER","DEFAULT_ROTATION","DEFAULT_ZOOM","DEFAULT_PAN","DEFAULT_PALETTE","MAX_ZOOM","MIN_ZOOM","PRESETS","pan","panDD","currentPanAnimationFrame","currentZoomAnimationFrame","currentRotationAnimationFrame","currentColorAnimationFrame","demoActive","currentPresetIndex","interactionActive","interactionTimer","iterations","extraIterations","bestScore","probeIters","colorPalette","vertexShaderSource","onWebGLContextLost","addEventListener","alert","dx","dy","fxAnchor","fyAnchor","vx","vy","setPan","targetZoom","anchorX","anchorY","_this$screenToViewVec2","screenToViewVector","deltaZoom","addPan","_this","settleMs","clearTimeout","markOrbitDirty","draw","updateInfo","event","preventDefault","init","stopAllNonColorAnimations","stopCurrentColorAnimations","removeEventListener","program","deleteProgram","vertexShader","deleteShader","fragmentShader","preset","index","generatePresetIDs","initGLProgram","useProgram","oldRect","getBoundingClientRect","width","height","_this$screenToFractal2","screenToFractal","centerFx","centerFy","dpr","devicePixelRatio","viewport","resolutionLoc","uniform2f","_this$screenToViewVec4","setPanFromAnchor","Error","source","type","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","VERTEX_SHADER","createFragmentShaderSource","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","positions","Float32Array","bufferData","STATIC_DRAW","positionLoc","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","updateUniforms","onProgramCreated","panLoc","getUniformLocation","zoomLoc","iterLoc","colorLoc","rotationLoc","uniform2fv","uniform1f","uniform3fv","clearColor","clear","COLOR_BUFFER_BIT","debugPanel","beginGpuTimer","drawArrays","TRIANGLE_STRIP","endGpuTimer","resizeCanvas","screenX","screenY","rect","stX","stY","cosR","cos","sinR","sin","rotatedY","stopCurrentPanAnimation","stopCurrentZoomAnimation","stopCurrentRotationAnimation","cancelAnimationFrame","_animateColorPaletteTransition","newPalette","duration","coloringCallback","startPalette","_this2","_args","startTime","step","timestamp","progress","requestAnimationFrame","_animateFullColorSpaceCycle","_callee2","currentRGB","hsl","startHue","_this3","_args2","_context2","newHue","_animatePanTo","_callee3","targetPan","easeFunction","startPan","_this4","_args3","_context3","k","nx","ny","onAnimationFinished","_x2","_animatePanBy","_callee4","deltaPan","_this5","_args4","_context4","prevK","dk","_x3","_animateZoomTo","_callee5","_this$getCanvasCssCen","_this$getCanvasCssCen2","startZoom","ratio","_this$screenToViewVec5","_this$screenToViewVec6","_this6","_args5","_context5","getCanvasCssCenter","_x4","_animateZoomToNoPan","_callee6","_this7","_args6","_context6","_x5","_animateRotationTo","_callee7","targetRotation","startRotation","_this8","_args7","_context7","_x6","_animatePanThenZoomTo","_callee8","panDuration","zoomDuration","_args8","_context8","animatePanTo","animateZoomTo","_x7","_x8","_x9","_x0","_animatePanAndZoomTo","_callee9","_args9","_context9","all","animateZoomToNoPan","_x1","_x10","_animateZoomRotationTo","_callee0","_args0","_context0","animateRotationTo","_x11","_x12","_animatePanZoomRotationTo","_callee1","_args1","_context1","_x13","_x14","_x15","_animateInfiniteRotation","_callee10","direction","dir","_this9","_args10","_context10","rotationStep","_x16","_callSuper","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","Boolean","valueOf","_superPropGet","_get","_superPropBase","getOwnPropertyDescriptor","_setPrototypeOf","JuliaPreviewRenderer","_FractalRenderer","DEFAULT_C","DIVES","currentPaletteIndex","innerStops","currentCAnimationFrame","demoTime","_inherits","cLoc","innerStopsLoc","baseIters","log2","_animateInnerStopsTransition","toPalette","callback","startStops","interpolated","stopIndex","animateInnerStopsTransition","floatingCanvas","previewRenderer","previewActive","PREVIEW_WIDTH","PREVIEW_HEIGHT","initJuliaPreview","document","getElementById","style","updatePreviewPosition","viewportWidth","innerWidth","viewportHeight","innerHeight","left","top","hideJuliaPreview","display","fractalApp","handleWheelEvent","handleMouseDownEvent","handleMouseMoveEvent","handleMouseUpEvent","handleMouseLeaveEvent","DOUBLE_CLICK_THRESHOLD","ZOOM_STEP","mouseHandlersRegistered","mouseDownX","mouseDownY","lastX","lastY","clickTimeout","wheelResetTimeout","isDragging","wasRotated","isRightDragging","startX","isMiddleButtonHeld","dragRectLeft","dragRectTop","hasDragRect","wheelAccum","wheelAnchorX","wheelAnchorY","wheelRAF","wheelRectLeft","wheelRectTop","hasWheelRect","markOrbitDirtySafe","initMouseHandlers","app","registerMouseEventHandlers","deltaY","clientX","clientY","flushWheelZoom","resetAppState","noteInteraction","handleWheel","button","isJuliaMode","mouseX","mouseY","_fractalApp$screenToF2","fx","fy","handleMouseDown","cursor","lastRelX","lastRelY","nowRelX","nowRelY","_fractalApp$screenToV2","vLastX","vLastY","_fractalApp$screenToV4","vNowX","vNowY","deltaX","_fractalApp$screenToF4","handleMouseMove","includes","stopPropagation","_fractalApp$screenToF6","animatePanAndZoomTo","clipboard","writeText","_fractalApp$screenToF8","handleMouseUp","passive","unregisterMouseEventHandlers","zoomFactor","setZoomKeepingAnchor","handleTouchStartEvent","handleTouchMoveEvent","handleTouchEndEvent","touchHandlersRegistered","touchDownX","touchDownY","lastTouchX","lastTouchY","touchClickTimeout","isTouchDragging","isPinching","pinchStartDistance","pinchStartAngle","initTouchHandlers","registerTouchEventHandlers","touches","touch","touch0","touch1","atan2","handleTouchStart","currentDistance","currentAngle","centerClientX","centerClientY","centerX","centerY","angleDifference","handleTouchMove","changedTouches","touchX","touchY","handleTouchEnd","unregisterTouchEventHandlers","takeScreenshot","accentColor","offscreenCanvas","createElement","ctx","drawImage","watermarkText","fractalType","toExponential","JuliaRenderer","getWatermarkText","font","textAlign","textBaseline","rectWidth","measureText","padding","borderWidth","fontSize","fillStyle","radius","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","drawRoundRect","fill","textX","textY","rectHeight","fillText","now","pad","link","setAttribute","Date","padStart","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","toDataURL","click","ANIMATION_KEYS_BLACKLIST","PAN_STEP","PAN_SMOOTH_STEP","JULIA_HOTKEY_C_STEP","JULIA_HOTKEY_C_SMOOTH_MULTIPLIER","rotationActive","initialized","onKeyDown","_onKeyDown","_target$tagName","tag","handled","rotationSpeed","rotationDirection","deltaPanX","deltaPanY","deltaCx","deltaCy","altKey","increment","effectiveDeltaX","effectiveDeltaY","effectiveDeltaCx","effectiveDeltaCy","_t","tagName","isContentEditable","shiftKey","code","isAnimationActive","animateInfiniteRotation","toggleCenterLines","reset","toggleDebugMode","switchFractalTypeWithPersistence","updateColorTheme","animateColorPaletteTransition","animateFullColorSpaceCycle","randomizeColors","captureScreenshot","toggleDemo","switchFractalMode","useAnalyticExtension","ctrlKey","toggleHeader","startJuliaDive","travelToPreset","animatePanBy","animateToC","initHotKeys","destroyHotKeys","MandelbrotRenderer","orbitDirty","refPan","refPanDD","REF_SEARCH_GRID","REF_SEARCH_RADIUS","rebaseArmed","orbitTex","orbitData","floatTexExt","presetsData","getExtension","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","orbitTexLoc","uniform1i","orbitWLoc","deltaPanHLoc","deltaPanLLoc","zoomHLoc","zoomLLoc","iters","zx","zy","zy2","grid","half","base","currentRefScore","escapeItersDouble","bestCx","bestCy","j","ox","oy","score","improvementThreshold","sx","sy","idx","texImage2D","RGBA","safe","log10","mustRebaseNow","needsRebase","canRebaseNow","pickReferenceNearViewCenter","computeReferenceOrbit","z","clamp","normalizeRgb","randomBrightMultiplierPalette","_c","hue","random","sat","val","_normalizeRgb2","baseGain","colorGain","lift","_animateTravelToPreset","_preset$speed","zoomOutDuration","zoomInDuration","animatePanThenZoomTo","speed","_animateTravelToPresetWithRandomRotation","_preset$rotation","_preset$speed2","zoomOutRotation","presetRotation","extraSpins","cinematicFinalRotation","animateZoomRotationTo","_animateDemo","getNextPresetIndex","currentPreset","nextIdx","animateTravelToPresetWithRandomRotation","RiemannRenderer","termCount","termCountLoc","useAnalyticExtensionLoc","sliderContainer","realSlider","imagSlider","realSliderValue","imagSliderValue","lastSliderUpdate","initJuliaSliders","onRealSliderChange","onImagSliderChange","onSliderChangeFinished","resetPresetAndDiveButtonStates","textContent","resetJuliaSliders","innerText","updateJuliaSliders","performance","DebugPanel","_this$gl","_this$gl2","_this$gl3","_defineProperty","ts","_this$perf$frameMsSmo","_this$perf$frameMsSmo2","_this$perf$frameMsSmo3","_this$perf$panelCpuMs","_this$perf$panelCpuMs2","_this$perf$panelCpuMs3","_navigator","_navigator2","debugInfo","t0","pollGpuTimers","dt","perf","lastRafTs","frameMs","frameMsSmoothed","smooth","fps","getShaderPrecisionFormat","hp","HIGH_FLOAT","hpInfo","rangeMin","rangeMax","viewPanX","viewPanY","refPanX","refPanY","safeZoom","pxPerUnit","unitPerPx","absPan","panOverZoom","mantissaUsedApprox","driftAbs","driftViewUnits","orbitStatus","zoomBucket","esc","replaceAll","levelClass","level","panLevel","driftLevel","scaleLevel","healthLevel","worst","gpuSmooth","gpuMsSmoothed","gpuLevel","fpsLevel","panelCpuMs","panelCpuMsSmoothed","gpuHint","gpuSupported","gpuVendor","gpu","unmaskedVendor","vendor","gpuRenderer","unmaskedRenderer","renderer","innerHTML","getFractalMode","gpuDisjoint","webglVersion","userAgentData","platform","update","panelSelector","lastTap","toggle","dump","indexOf","extTimer","extRendererInfo","shadingLanguageVersion","maxTextureSize","maxVaryings","maxFragUniforms","maxVertUniforms","maxViewportDims","_initGpuInfo","gpuMs","queryInFlight","pendingQueries","precisionInfo","getParameter","VERSION","SHADING_LANGUAGE_VERSION","VENDOR","RENDERER","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","createQueryEXT","beginQueryEXT","TIME_ELAPSED_EXT","endQueryEXT","disjoint","GPU_DISJOINT_EXT","getQueryObjectEXT","QUERY_RESULT_AVAILABLE_EXT","ns","QUERY_RESULT_EXT","deleteQueryEXT","shift","ms","prev","resizeTimeout","header","logo","mandelbrotSwitch","juliaSwitch","persistSwitch","resetButton","randomizeColorsButton","screenshotButton","demoButton","infoLabel","infoText","fractalMode","midColor","bgColor","headerMinimizeTimeout","uiInitialized","headerVisible","animationActive","activeJuliaDiveIndex","activePresetIndex","presetButtons","diveButtons","allButtons","lastInfoUpdate","infoUpdateThrottleLimit","pendingInfoTimer","pendingInfoForce","keys","find","_switchFractalMode","_debugPanel","_debugPanel$setRender","_debugPanel2","_debugPanel2$setRende","exitAnimationMode","destroy","enableMandelbrotMode","enableJuliaMode","enableRiemannMode","setRenderer","initAnimationMode","animateTravelToPreset","_switchFractalTypeWithPersistence","targetType","classList","remove","add","resetActivePresetIndex","initPresetButtonEvents","updateRecolorButtonTitle","initDiveButtons","background","nextTheme","getNextColorThemeId","title","palette","adjustChannel","brightnessFactor","root","querySelector","setProperty","_ddValue","_ddValue2","_fractalApp$zoom","force","timeSinceLastUpdate","delay","pendingForce","text","panX","panY","_fractalApp$c$","_fractalApp$c$2","currentZoom","currentRotation","contains","disabled","_toggleDemo","_t2","stopDemo","startMandelbrotDemo","startJuliaDemo","_startMandelbrotDemo","animateDemo","_startJuliaDive","dives","dive","cxDirection","endC","startC","cyDirection","animateToZoomAndC","animateDive","animatePanZoomRotationTo","_startJuliaDemo","_callee11","_context11","_travelToPreset","_callee12","presets","_context12","verticalLine","horizontalLine","_randomizeColors","_callee13","saturation","brightness","_context13","show","_reset","_callee14","_context14","initHeaderEvents","initControlButtonEvents","presetBlock","className","appendChild","initCommonButtonEvents","blur","diveBlock","initFractalSwitchButtons","_ref5","_ref6","_ref7","initWindowEvents","dragElements","querySelectorAll","element","onMove","leftValue","getComputedStyle","topValue","movementX","movementY","move","once","initInfoText","bindHTMLElements","initUI","_initUI","_callee15","fractalRenderer","_context15","ownKeys","getOwnPropertySymbols","filter","_objectSpread","getOwnPropertyDescriptors","defineProperties","LEGACY_JULIA_RENDER","data","refZ0","refZ0DD","_prevPan0","_prevPan1","_prevZoom","_prevC0","_prevC1","deltaZ0HLoc","deltaZ0LLoc","zx0","zy0","escapeItersJulia","bestX","bestY","deltaView","panMoved","zoomChanged","cChanged","deltaZ0X","deltaZ0Y","stopCurrentCAnimation","_animateToC","targetC","easedProgress","_animateToZoomAndC","_animateDive","phases","phase","diveStep","initFractalApp","_initFractalApp","validMandelbrotTravelPreset","validJuliaTravelPreset","onDefault"],"ignoreList":[],"sourceRoot":""}