{"version":3,"file":"js/bundle.js","mappings":"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","sources":["webpack://fractal-traveler/./src/global/constants.js","webpack://fractal-traveler/./src/global/utils.js","webpack://fractal-traveler/./src/renderers/renderer.js","webpack://fractal-traveler/./src/renderers/fractalRenderer.js","webpack://fractal-traveler/./src/renderers/juliaPreviewRenderer.js","webpack://fractal-traveler/./src/ui/juliaPreview.js","webpack://fractal-traveler/./src/ui/mouseEventHandlers.js","webpack://fractal-traveler/./src/ui/touchEventHandlers.js","webpack://fractal-traveler/./src/ui/screenshotController.js","webpack://fractal-traveler/./src/ui/hotkeyController.js","webpack://fractal-traveler/./src/renderers/mandelbrotRenderer.js","webpack://fractal-traveler/./src/renderers/riemannRenderer.js","webpack://fractal-traveler/./src/ui/juliaSlidersController.js","webpack://fractal-traveler/./src/ui/debugPanel.js","webpack://fractal-traveler/./src/ui/ui.js","webpack://fractal-traveler/./src/renderers/juliaRenderer.js","webpack://fractal-traveler/./src/main.js"],"sourcesContent":["/**\r\n * @module Constants\r\n * @author Radim Brnka\r\n * @description Global constants used across the app.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {easeInOut, easeInOutCubic, easeInOutQuint, hexToRGBArray} from \"./utils\";\r\n// region > DEBUG CONSTANTS ////////////////////////////////////////////////////////////////////////////////////////////\r\n/**\r\n * DEBUG_LEVEL\r\n * @enum {number}\r\n */\r\nexport const DEBUG_LEVEL = {\r\n    NONE: 0,\r\n    VERBOSE: 1, /** Logs only */\r\n    FULL: 2\r\n}\r\n\r\n/**\r\n * DEBUG MODE. Set to false for prod deployment!\r\n * @type {DEBUG_LEVEL}\r\n */\r\nexport const DEBUG_MODE = DEBUG_LEVEL.FULL;\r\n\r\n/**\r\n *\r\n * @type {{LOG: string, INFO: string, WARN: string, ERROR: string}}\r\n */\r\nexport const LOG_LEVEL = {\r\n    LOG: 'log',\r\n    DEBUG: 'debug',\r\n    WARN: 'warn',\r\n    ERROR: 'error'\r\n}\r\n\r\n/**\r\n * Logs a message with an optional scope and severity level.\r\n * @param {string} message - The message to log.\r\n * @param {string} [scope=''] - The scope/context of the message.\r\n * @param {string} [severity=LOG_LEVEL.LOG] - The severity level from LOG_LEVEL.\r\n */\r\nexport const log = (message, scope = '', severity = LOG_LEVEL.LOG) => {\r\n    const formattedScope = scope ? `[${scope}]` : '';\r\n\r\n    console[severity](\r\n        `%c${formattedScope}%c ${message}`,\r\n        CONSOLE_GROUP_STYLE,\r\n        CONSOLE_MESSAGE_STYLE\r\n    );\r\n}\r\n// endregion\r\n// region > FEATURE FLAGS\r\n/** Allows switching between fractal while keeping the params to allow Mandelbrot and Julia to match each other */\r\nexport const FF_PERSISTENT_FRACTAL_SWITCHING = true;\r\n\r\n/**\r\n * Feature flag controlling the display of the persistent fractal switching button in the UI.\r\n * When enabled, users can see a button to toggle between fractal types while maintaining\r\n * the current parameters for seamless transitions between Mandelbrot and Julia sets.\r\n *\r\n * @type {boolean}\r\n * @since 1.9\r\n */\r\nexport const FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED = true;\r\n\r\n/**\r\n * Enables bottom bar for user input for custom coords\r\n */\r\nexport const FF_USER_INPUT_ALLOWED = false;\r\n\r\n// endregion ///////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n/**\r\n * Application name\r\n * @type {string}\r\n */\r\nexport const APP_NAME = 'Synaptory Fractal Traveler';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Enum of fractal types\r\n * @enum {number}\r\n */\r\nexport const FRACTAL_TYPE = {\r\n    MANDELBROT: 0,\r\n    JULIA: 1,\r\n    RIEMANN: 2\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Ease in-out transition types matching functions in the Utils module\r\n * @enum {Function}\r\n */\r\nexport const EASE_TYPE = {\r\n    /** No easing (identity function) */\r\n    NONE: (x) => x,\r\n    /** Slow at the end */\r\n    QUAD: easeInOut,\r\n    /** Slower at the end */\r\n    CUBIC: easeInOutCubic,\r\n    /** Slowest at the end */\r\n    QUINT: easeInOutQuint\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Rotation directions\r\n * @enum {number}\r\n */\r\nexport const ROTATION_DIRECTION = {\r\n    /** Counter-clockwise */\r\n    CCW: -1,\r\n    /** Clockwise */\r\n    CW: 1\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Default main GUI color\r\n * @type {string}\r\n */\r\nexport const DEFAULT_ACCENT_COLOR = '#B4FF6A';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Default secondary (background) GUI color\r\n * @type {string}\r\n */\r\nexport const DEFAULT_BG_COLOR = 'rgba(24, 48, 13, 0.2)';\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/***\r\n * Default color for console group labels\r\n * @type {string}\r\n */\r\nconst DEFAULT_CONSOLE_GROUP_COLOR = DEFAULT_ACCENT_COLOR;\r\n\r\nconst DEFAULT_CONSOLE_MESSAGE_COLOR = '#fff';\r\n\r\nexport const CONSOLE_GROUP_STYLE = `color: ${DEFAULT_CONSOLE_GROUP_COLOR}`;\r\n\r\nexport const CONSOLE_MESSAGE_STYLE = `color: ${DEFAULT_CONSOLE_MESSAGE_COLOR}`;\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Default Julia-specific palette.\r\n * @type {JULIA_PALETTE}\r\n */\r\nexport const DEFAULT_JULIA_PALETTE = {\r\n    id: \"Default\",\r\n    keyColor: \"#fefe66\",\r\n    theme: [\r\n        0.0, 0.0, 0.0,\r\n        1.0, 0.647, 0.0,\r\n        0.0, 0.0, 0.0,\r\n        1.2, 1.2, 1.0,\r\n        0.1, 0.1, 0.1\r\n    ]\r\n};\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/** Default color used based on the initial Mandelbrot coloring. It's an accent color / 1.9 brightness factor that\r\n * is hardcoded in the updateColorTheme method.\r\n * @type {PALETTE}\r\n */\r\nexport const DEFAULT_MANDELBROT_THEME_COLOR = [95 / 255, 134 / 255, 56 / 255];\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/** Default color used based on the initial Julia coloring. It's accent color / 1.9 brightness factor that\r\n * is hardcoded in the updateColorTheme method.\r\n * @type {PALETTE}\r\n */\r\nexport const DEFAULT_JULIA_THEME_COLOR = hexToRGBArray(DEFAULT_JULIA_PALETTE.keyColor);\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * This is to allow switching between two precisions as the embedded PI constant is too accurate, which is not needed\r\n * in many cases (rotations etc.)\r\n * @type {boolean}\r\n * @default true\r\n */\r\nconst USE_PRECISE_PI = true;\r\n/**\r\n * PI\r\n * @type {number|number}\r\n */\r\nexport const PI = USE_PRECISE_PI ? Math.PI : 3.1415926535;\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Rotation constants for easy deg/rad conversion\r\n * @enum {number} radians\r\n */\r\nexport const DEG = {\r\n    _30: 30 * (PI / 180),\r\n    _90: 90 * (PI / 180),\r\n    _120: 120 * (PI / 180),\r\n    _150: 150 * (PI / 180),\r\n}\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n/**\r\n * Defines the compression quality for JPEG screenshots (0-1) in %\r\n * @type {number}\r\n */\r\nexport const SCREENSHOT_JPEG_COMPRESSION_QUALITY = 0.95;","/**\r\n * @module Utils\r\n * @author Radim Brnka\r\n * @description Contains helper functions for working with URL parameters, colors, etc.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, FRACTAL_TYPE, PI} from \"./constants\";\r\n\r\nlet urlParamsSet = false;\r\n\r\n/**\r\n * Updates browser URL with params of the selected point and zoom in the fractal\r\n * @param {FRACTAL_TYPE} mode\r\n * @param {number} px panX\r\n * @param {number} py panY\r\n * @param {number|null} cx Julia only\r\n * @param {number|null} cy Julia only\r\n * @param {number} zoom\r\n * @param {number} rotation\r\n */\r\nexport function updateURLParams(mode, px, py, zoom, rotation, cx = null, cy = null) {\r\n    const formatNumber = (value) => {\r\n        if (value == null) return null;\r\n        // 1517 digits is where JS double precision is meaningfully preserved.\r\n        // toPrecision also uses scientific notation for very small values (deep zoom).\r\n        return Number(value).toPrecision(17);\r\n    };\r\n\r\n    const params = {\r\n        mode: mode != null ? mode.toFixed(0) : FRACTAL_TYPE.MANDELBROT,\r\n        px: formatNumber(px),\r\n        py: formatNumber(py),\r\n        zoom: formatNumber(zoom),\r\n        r: rotation != null ? Number(rotation).toPrecision(17) : 0,\r\n        cx: formatNumber(cx),\r\n        cy: formatNumber(cy),\r\n    };\r\n\r\n    if (DEBUG_MODE) console.log(`%c updateURLParams: %c Setting URL: ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    if ([px, py, zoom, rotation].some(el => el == null)) {\r\n        console.error(`%c updateURLParams: %c Fractal params incomplete, can't generate URL! ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    if (mode === FRACTAL_TYPE.JULIA && [cx, cy].some(el => el == null)) {\r\n        console.error(`%c updateURLParams: %c Julia params incomplete, can't generate URL! ${JSON.stringify(params)}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    // Convert to Base64 for compact representation\r\n    const encodedParams = btoa(JSON.stringify(params));\r\n\r\n    // Update the URL with a single \"params\" field\r\n    const hashPath = mode === FRACTAL_TYPE.JULIA ? '#julia' : '#';\r\n    window.history.pushState({}, '', `${hashPath}?view=${encodedParams}`);\r\n\r\n    urlParamsSet = true;\r\n}\r\n\r\n/**\r\n * Fetches and recalculates coords and zoom from URL and sets them to the fractalApp instance\r\n * @return {URL_PRESET}\r\n */\r\nexport function loadFractalParamsFromURL() {\r\n    if (DEBUG_MODE) console.groupCollapsed(`%c loadFractalParamsFromURL`, CONSOLE_GROUP_STYLE);\r\n\r\n    const url = new URL(window.location.href);\r\n    const hash = url.hash; // Get the hash part of the URL (e.g., #julia?view=...)\r\n\r\n    if (!hash) {\r\n        if (DEBUG_MODE) console.log(`No hash found in the URL, return default mode.`);\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: FRACTAL_TYPE.MANDELBROT}; // Return default if no hash is present\r\n    }\r\n\r\n    // Split the hash to separate the mode and parameters\r\n    const [mode, queryString] = hash.slice(1).split('?'); // Remove the '#' and split by '?'\r\n\r\n    if (!queryString) {\r\n        if (DEBUG_MODE) console.log(`No query string is found in the URL, returning mode only.`);\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT};\r\n    }\r\n\r\n    // Parse the query parameters\r\n    const hashParams = new URLSearchParams(queryString);\r\n    const encodedParams = hashParams.get('view');\r\n\r\n    try {\r\n        // Decode the Base64 string and parse the JSON object\r\n        const decodedParams = JSON.parse(atob(encodedParams));\r\n        if (DEBUG_MODE) console.log(`Decoded params: ${JSON.stringify(decodedParams)}`);\r\n        urlParamsSet = true;\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        // Return the parsed parameters\r\n        return {\r\n            mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT,\r\n            px: decodedParams.px != null ? parseFloat(decodedParams.px) : null,\r\n            py: decodedParams.py != null ? parseFloat(decodedParams.py) : null,\r\n            zoom: decodedParams.zoom != null ? parseFloat(decodedParams.zoom) : null,\r\n            r: decodedParams.r != null ? parseFloat(decodedParams.r) : 0, // Rotation is not necessary to be defined\r\n            cx: decodedParams.cx != null ? parseFloat(decodedParams.cx) : null,\r\n            cy: decodedParams.cy != null ? parseFloat(decodedParams.cy) : null,\r\n        };\r\n    } catch (e) {\r\n        console.error(`%c loadFractalParamsFromURL: %c Error decoding URL parameters: ${e}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        urlParamsSet = true;\r\n        if (DEBUG_MODE) console.groupEnd();\r\n        return {mode: mode === 'julia' ? FRACTAL_TYPE.JULIA : FRACTAL_TYPE.MANDELBROT}; // Return only the mode if no query string is found\r\n    }\r\n}\r\n\r\n/** Clears browser URL, usually when it stops correspond with the position/zoom in the fractal */\r\nexport function clearURLParams() {\r\n    if (!urlParamsSet) return;\r\n\r\n    if (DEBUG_MODE) console.log(`%c clearURLParams: %c Clearing URL params.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    const hash = window.location.hash.split('?')[0]; // Keep only the hash part, discard any query parameters\r\n    const newUrl = `${window.location.origin}/${hash}`;\r\n    window.history.pushState({}, '', newUrl);\r\n    urlParamsSet = false;\r\n}\r\n\r\n/**\r\n * Detects touch device\r\n * @returns {boolean}\r\n */\r\nexport const isTouchDevice = () => 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\r\n\r\n/**\r\n * Detects mobile device\r\n * @returns {boolean} if the user device is mobile\r\n */\r\nexport function isMobileDevice() {\r\n    const toMatch = [/Android/i, /webOS/i, /iPhone/i, /iPad/i, /iPod/i, /BlackBerry/i, /Windows Phone/i];\r\n\r\n    return toMatch.some((toMatchItem) => {\r\n        return navigator.userAgent.match(toMatchItem);\r\n    });\r\n}\r\n\r\n/**\r\n * Generates string in [x, yi] format from the given complex number. Trailing zeroes are trimmed.\r\n * @param {COMPLEX} c\r\n * @param {number} precision Decimal point precision\r\n * @param {boolean} [withI] Append \"i\" to the imaginary member? Ignored if zero.\r\n * @return {string} [x, yi]|[x, 0]|[?, ?]\r\n */\r\nexport function expandComplexToString(c, precision = 6, withI = true) {\r\n    if (DEBUG_MODE) console.groupCollapsed(`%c expandComplexToString`, CONSOLE_GROUP_STYLE);\r\n\r\n    const invalidValues = [NaN, undefined, null, ''];\r\n    const isNumber = (value) => typeof value === 'number' && isFinite(value);\r\n\r\n    let expanded = `[`;\r\n\r\n    if (invalidValues.some(value => value === c[0]) || invalidValues.some(value => value === c[1]) || !isNumber(c[0]) || !isNumber(c[1])) {\r\n        expanded += `?, ?]`;\r\n        console.warn(`%c expandComplexToString: %c Invalid complex number: ${c}`, CONSOLE_GROUP_STYLE);\r\n        console.groupEnd();\r\n        return expanded;\r\n    } else {\r\n        const trimmedReal = parseFloat(c[0].toFixed(precision)).toString();\r\n        const trimmedImag = parseFloat(c[1].toFixed(precision)).toString();\r\n        expanded += `${trimmedReal}, ${trimmedImag}`;\r\n    }\r\n\r\n    if (DEBUG_MODE) console.groupEnd();\r\n    return expanded + ((withI && c[1] !== 0) ? 'i]' : ']');\r\n}\r\n\r\n// region > Double helpers ---------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @enum\r\n * @type {{VELTKAMP_DEKKER: string, GPU_EMULATED_DOUBLE: string}}\r\n */\r\nexport const SPLIT_FLOAT_METHOD = {\r\n    VELTKAMP_DEKKER: 'vd', // Default\r\n    GPU_EMULATED_DOUBLE: 'ed',\r\n}\r\n\r\n/**\r\n * Splits a 64-bit floating point number into two 32-bit parts\r\n * @param {number} value A standard JavaScript 64-bit number.\r\n * @param value\r\n * @param method\r\n * @returns {{high: number, low: number}}\r\n */\r\nexport const splitFloat = (value, method = SPLIT_FLOAT_METHOD.VELTKAMP_DEKKER) =>\r\n    (method === SPLIT_FLOAT_METHOD.GPU_EMULATED_DOUBLE) ? splitFloatED(value) : splitFloatVD(value);\r\n\r\n/**\r\n * Veltkamp-Dekker splitting constant: 2^27 + 1 = 134217729\r\n * Pre-computed to avoid Math.pow() on every splitFloat call (called 4000+ times per orbit rebuild).\r\n * This is a common splitting point for 53-bit mantissa (JS number).\r\n */\r\nconst VELTKAMP_DEKKER_K = 134217729;\r\n\r\n/**\r\n * The Veltkamp-Dekker Split: This implementation is the classic Veltkamp-Dekker algorithm. It is designed to split\r\n * a 64-bit double into two \"half-precision\" doubles so that their product can be calculated without losing precision.\r\n * @param {number} value A standard JavaScript 64-bit number.\r\n * @returns {{high: number, low: number}}\r\n */\r\nfunction splitFloatVD(value) {\r\n    const temp = value * VELTKAMP_DEKKER_K;\r\n    const high = temp - (temp - value);\r\n    const low = value - high;\r\n\r\n    return {high, low};\r\n}\r\n\r\n/**\r\n * GPU Emulated Double. This is the standard approach for rendering high-precision or astronomical visualizations).\r\n * @param value\r\n * @returns {{high: number, low: number}}\r\n */\r\nfunction splitFloatED(value) {\r\n    // Force the high part to be *exactly* what will be stored in GPU float32.\r\n    const high = Math.fround(value);\r\n    // Residual in double, then quantize to float32 as well (matches GPU storage).\r\n    const low = Math.fround(value - high);\r\n\r\n    return {high, low};\r\n}\r\n\r\n/**\r\n * Creates a double-double precision number object with high and low parts.\r\n * Used for extended precision arithmetic beyond standard 64-bit floating point.\r\n *\r\n * @param {number} [hi=0] - The high-order (primary) part of the number.\r\n * @param {number} [lo=0] - The low-order (error correction) part of the number.\r\n * @returns {{hi: number, lo: number}} A double-double precision number object.\r\n */\r\nexport function ddMake(hi = 0, lo = 0) {\r\n    return {hi, lo};\r\n}\r\n\r\n/**\r\n * Computes the error-free sum of two floating-point numbers using Knuth's two-sum algorithm.\r\n * Returns both the sum and the rounding error, enabling extended precision arithmetic.\r\n *\r\n * @param {number} a - The first number to sum.\r\n * @param {number} b - The second number to sum.\r\n * @returns {{s: number, err: number}} An object containing the sum (s) and the rounding error (err).\r\n */\r\nexport function twoSum(a, b) {\r\n    const s = a + b;\r\n    const bb = s - a;\r\n    const err = (a - (s - bb)) + (b - bb);\r\n    return {s, err};\r\n}\r\n\r\n/**\r\n * Computes the error-free sum of two floating-point numbers where |a| >= |b|.\r\n * This is a faster variant of twoSum that assumes the first argument has greater magnitude.\r\n *\r\n * @param {number} a - The larger magnitude number (must satisfy |a| >= |b|).\r\n * @param {number} b - The smaller magnitude number to add.\r\n * @returns {{s: number, err: number}} An object containing the sum (s) and the rounding error (err).\r\n */\r\nexport function quickTwoSum(a, b) {\r\n    const s = a + b;\r\n    const err = b - (s - a);\r\n    return {s, err};\r\n}\r\n\r\n/**\r\n * Adds a standard floating-point number to a double-double precision number.\r\n * This function mutates the input double-double object and maintains extended precision.\r\n *\r\n * @param {{hi: number, lo: number}} dd - The double-double number to modify (mutated in place).\r\n * @param {number} n - The standard floating-point number to add.\r\n * @returns {{hi: number, lo: number}} The mutated double-double object with the sum.\r\n */\r\nexport function ddAdd(dd, n) {\r\n    const t = twoSum(dd.hi, n);\r\n    const lo = dd.lo + t.err;\r\n    const r = quickTwoSum(t.s, lo);\r\n    dd.hi = r.s;\r\n    dd.lo = r.err;\r\n    return dd;\r\n}\r\n\r\n/**\r\n * Sets the value of a double-double precision object from a standard number.\r\n * This effectively resets the high-precision value to a single 64-bit float,\r\n * clearing any existing low-precision error bits.\r\n *\r\n * @param {{hi: number, lo: number}} dd - The double-double object to modify.\r\n * @param {number} n - The number to assign to the high part.\r\n * @returns {{hi: number, lo: number}} The mutated double-double object.\r\n */\r\nexport function ddSet(dd, n) {\r\n    dd.hi = n;\r\n    dd.lo = 0;\r\n    return dd;\r\n}\r\n\r\n/**\r\n * Returns the standard 64-bit floating-point approximation of a double-double number.\r\n * This combines the high and low parts to reconstruct the full precision value.\r\n *\r\n * @param {{hi: number, lo: number}} dd The double-double number object with high and low precision parts.\r\n * @returns {number} The combined floating-point value.\r\n */\r\nexport function ddValue(dd) {\r\n    return dd.hi + dd.lo;\r\n}\r\n\r\n/**\r\n * Adds two double-double precision numbers and returns a new DD result.\r\n * Uses the Knuth two-sum algorithm for error-free addition.\r\n *\r\n * @param {{hi: number, lo: number}} a - First double-double number.\r\n * @param {{hi: number, lo: number}} b - Second double-double number.\r\n * @returns {{hi: number, lo: number}} The sum as a new double-double number.\r\n */\r\nexport function ddAddDD(a, b) {\r\n    const t = twoSum(a.hi, b.hi);\r\n    const lo = a.lo + b.lo + t.err;\r\n    const r = quickTwoSum(t.s, lo);\r\n    return {hi: r.s, lo: r.err};\r\n}\r\n\r\n/**\r\n * Subtracts two double-double precision numbers (a - b) and returns a new DD result.\r\n *\r\n * @param {{hi: number, lo: number}} a - The minuend (number to subtract from).\r\n * @param {{hi: number, lo: number}} b - The subtrahend (number to subtract).\r\n * @returns {{hi: number, lo: number}} The difference (a - b) as a new double-double number.\r\n */\r\nexport function ddSubDD(a, b) {\r\n    return ddAddDD(a, {hi: -b.hi, lo: -b.lo});\r\n}\r\n\r\n// endregion---------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Compares two complex numbers / arrays of two numbers with given precision\r\n * @param {COMPLEX} c1\r\n * @param {COMPLEX}c2\r\n * @param {number} [precision]\r\n * @return {boolean} true if numbers are equal, false if not\r\n */\r\nexport function compareComplex(c1, c2, precision = 12) {\r\n    return c1[0].toFixed(precision) === c2[0].toFixed(precision) && c1[1].toFixed(precision) === c2[1].toFixed(precision);\r\n}\r\n\r\n/**\r\n * Compares two palettes / arrays of three numbers with given precision (transitively uses the compareComplex)\r\n * @param {PALETTE} p1\r\n * @param {PALETTE} p2\r\n * @param {number} [precision]\r\n * @return {boolean} true if palettes are equal, false if not\r\n */\r\nexport function comparePalettes(p1, p2, precision = 6) {\r\n    return p1[0].toFixed(precision) === p2[0].toFixed(precision) &&\r\n        p1[1].toFixed(precision) === p2[1].toFixed(precision) &&\r\n        p1[2].toFixed(precision) === p2[2].toFixed(precision);\r\n}\r\n\r\n/**\r\n * HSB to RGB conversion helper function\r\n * @param h Hue\r\n * @param s Saturation\r\n * @param b Brightness\r\n * @returns {PALETTE} rgb\r\n */\r\nexport function hsbToRgb(h, s, b) {\r\n    const i = Math.floor(h * 6);\r\n    const f = h * 6 - i;\r\n    const p = b * (1 - s);\r\n    const q = b * (1 - f * s);\r\n    const t = b * (1 - (1 - f) * s);\r\n\r\n    let r, g, bl;\r\n    // @formatter:off\r\n    switch (i % 6) {\r\n        case 0: r = b; g = t; bl = p; break;\r\n        case 1: r = q; g = b; bl = p; break;\r\n        case 2: r = p; g = b; bl = t; break;\r\n        case 3: r = p; g = q; bl = b; break;\r\n        case 4: r = t; g = p; bl = b; break;\r\n        case 5: r = b; g = p; bl = q; break;\r\n    }\r\n    // @formatter:on\r\n    return [r, g, bl];\r\n}\r\n\r\n/**\r\n * Convert HSL (h in [0,1], s in [0,1], l in [0,1]) to RGB (each channel in [0,1])\r\n * @param {number} h Hue\r\n * @param {number} s Saturation\r\n * @param {number} l Lightness\r\n * @return {PALETTE} [r, g ,b]\r\n */\r\nexport function hslToRgb(h, s, l) {\r\n    let r, g, b;\r\n    if (s === 0) {\r\n        r = g = b = l; // achromatic\r\n    } else {\r\n        const hue2rgb = (p, q, t) => {\r\n            if (t < 0) t += 1;\r\n            if (t > 1) t -= 1;\r\n            if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n            if (t < 1 / 2) return q;\r\n            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n            return p;\r\n        };\r\n        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n        const p = 2 * l - q;\r\n        r = hue2rgb(p, q, h + 1 / 3);\r\n        g = hue2rgb(p, q, h);\r\n        b = hue2rgb(p, q, h - 1 / 3);\r\n    }\r\n    return [r, g, b];\r\n}\r\n\r\n/**\r\n * Converts RGB (each in [0,1]) to HSL (h in [0,1], s in [0,1], l in [0,1])\r\n * @param {number} r Red\r\n * @param {number} g Green\r\n * @param {number} b Blue\r\n * @return {Array<number, number, number>} [h, s, l]\r\n */\r\nexport function rgbToHsl(r, g, b) {\r\n    let max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n    let h, s, l = (max + min) / 2;\r\n    if (max === min) {\r\n        h = s = 0; // achromatic\r\n    } else {\r\n        let d = max - min;\r\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n        if (max === r) {\r\n            h = (g - b) / d + (g < b ? 6 : 0);\r\n        } else if (max === g) {\r\n            h = (b - r) / d + 2;\r\n        } else {\r\n            h = (r - g) / d + 4;\r\n        }\r\n        h /= 6;\r\n    }\r\n    return [h, s, l];\r\n}\r\n\r\n/**\r\n * Converts HTML hex color notation to rgb object\r\n * @param {string} hex HTML hex color\r\n * @param {number} [normalize] interval to normalize onto\r\n * @return {{r: number, g: number, b: number}|null}\r\n */\r\nexport function hexToRGB(hex, normalize = 255) {\r\n    // Ensure it's a string and remove any leading #\r\n    hex = hex.toLowerCase().replace(/^#/, \"\");\r\n\r\n    // Convert shorthand \"#abc\"  \"aabbcc\"\r\n    if (hex.length === 3) {\r\n        hex = hex.split(\"\").map(char => char + char).join(\"\");\r\n    }\r\n\r\n    // Validate format\r\n    if (!/^([\\da-f]{6})$/i.test(hex)) {\r\n        return null;\r\n    }\r\n\r\n    // Convert HEX to RGB (0-255)\r\n    const r = parseInt(hex.substring(0, 2), 16);\r\n    const g = parseInt(hex.substring(2, 4), 16);\r\n    const b = parseInt(hex.substring(4, 6), 16);\r\n\r\n    // Normalize to 0-1 range\r\n    return {\r\n        r: r / normalize,\r\n        g: g / normalize,\r\n        b: b / normalize\r\n    };\r\n}\r\n\r\n/**\r\n * Converts HTML hex color notation to rgb array\r\n * @param {string} hex HTML hex color\r\n * @param {number} [normalize] interval to normalize onto\r\n * @return {number[]|null} [r, g, b]\r\n */\r\nexport function hexToRGBArray(hex, normalize = 255) {\r\n    const rgb = hexToRGB(hex, normalize);\r\n    return [rgb.r, rgb.g, rgb.b];\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing. This function accelerates in the first half (using 2*t) and decelerates in\r\n * the second half.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOut(time) {\r\n    return time < 0.5 ? 2 * time * time : -1 + (4 - 2 * time) * time;\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing. The cubic version tends to have a smoother acceleration at the beginning and\r\n * a gentler deceleration at the end, to start more gradually and then slow down more smoothly toward the end.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOutCubic(time) {\r\n    return time < 0.5\r\n        ? 4 * time * time * time\r\n        : 1 - Math.pow(-2 * time + 2, 3) / 2;\r\n}\r\n\r\n/**\r\n * Helper function for ease-in-out timing using a quintic curve.\r\n * This function starts gradually, accelerates, then decelerates more gently near the end.\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number} The eased value.\r\n */\r\nexport function easeInOutQuint(time) {\r\n    return time < 0.5\r\n        ? 16 * Math.pow(time, 5)\r\n        : 1 - Math.pow(-2 * time + 2, 5) / 2;\r\n}\r\n\r\n/**\r\n * Helper function for linear interpolation\r\n * @param {number} start\r\n * @param {number} end\r\n * @param {number} time A value between 0 and 1 representing the progress.\r\n * @return {number}\r\n */\r\nexport function lerp(start, end, time) {\r\n    return start + (end - start) * time;\r\n}\r\n\r\n/**\r\n * Converts degrees from JSON to Radians for GLSL uniforms\r\n * @param {number} degrees\r\n * @returns {number} radians\r\n */\r\nexport function degToRad(degrees) {\r\n    return degrees * (PI / 180);\r\n}\r\n\r\n/**\r\n * Normalizes rotation into into [0, 2*PI] interval\r\n * @param {number} rotation in rad\r\n * @return {number} rotation in rad\r\n */\r\nexport function normalizeRotation(rotation) {\r\n    const twoPi = 2 * PI;\r\n    return (rotation % twoPi + twoPi) % twoPi;\r\n}\r\n\r\n/**\r\n * Computes a duration based on the travel distance between current and target parameters. Iterates over each property\r\n * in target (assuming current and target have the same structure)\r\n * @param {number} seed - A scaling factor to adjust the overall duration.\r\n * @param {object} current - An object with current values\r\n * @param {object} target - An object with target values\r\n * @param {object} [weights] - Optional weights\r\n * @returns {number} The computed duration.\r\n */\r\nexport function getAnimationDuration(seed, current, target, weights = {}) {\r\n    let compositeDistance = 0;\r\n    for (const key in target) {\r\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\r\n            const w = weights[key] !== undefined ? weights[key] : 1.0;\r\n            const currVal = current[key];\r\n            const targVal = target[key];\r\n            let diff = 0;\r\n\r\n            // If the property is a number, use absolute difference.\r\n            if (typeof targVal === 'number' && typeof currVal === 'number') {\r\n                diff = Math.abs(targVal - currVal);\r\n            }\r\n            // If the property is an array, compute the Euclidean distance between the two arrays.\r\n            else if (Array.isArray(targVal) && Array.isArray(currVal)) {\r\n                // Assume both arrays have the same length.\r\n                diff = Math.hypot(...targVal.map((v, i) => v - (currVal[i] || 0)));\r\n            }\r\n\r\n            compositeDistance += w * diff;\r\n        }\r\n    }\r\n    return Math.round(seed * compositeDistance);\r\n}\r\n\r\n/**\r\n * Helper function that returns a Promise that resolves after timeout.\r\n * @param {number} timeout in ms\r\n * @return {Promise<unknown>}\r\n */\r\nexport async function asyncDelay(timeout) {\r\n    return new Promise(resolve => setTimeout(resolve, timeout));\r\n}\r\n\r\n/**\r\n * Calculates the change in pan based on the movement delta, the canvas rectangle, current zoom, and rotation.\r\n *\r\n * @param {number} currentX The current X coordinate (clientX or touch.clientX).\r\n * @param {number} currentY The current Y coordinate.\r\n * @param {number} lastX The previous X coordinate.\r\n * @param {number} lastY The previous Y coordinate.\r\n * @param {DOMRect} rect The canvas bounding rectangle.\r\n * @param {number} rotation The current rotation (in radians).\r\n * @param {number} zoom The current zoom factor.\r\n * @returns {Array<number>} An array [deltaPanX, deltaPanY] that should be added to the current pan.\r\n */\r\nexport function calculatePanDelta(currentX, currentY, lastX, lastY, rect, rotation, zoom) {\r\n    const moveX = currentX - lastX;\r\n    const moveY = currentY - lastY;\r\n\r\n    const ref = Math.min(rect.width, rect.height);\r\n\r\n    // Apply inverse rotation to the movement, so it aligns with fractal pan direction.\r\n    const cosR = Math.cos(-rotation);\r\n    const sinR = Math.sin(-rotation);\r\n    const rotatedMoveX = cosR * moveX - sinR * moveY;\r\n    const rotatedMoveY = sinR * moveX + cosR * moveY;\r\n\r\n    // Scale movement relative to canvas size and zoom.\r\n    const deltaPanX = -(rotatedMoveX / ref) * zoom;\r\n    const deltaPanY = +(rotatedMoveY / ref) * zoom;\r\n\r\n    return [deltaPanX, deltaPanY];\r\n}\r\n\r\n/**\r\n * Removes array of buttons from the scene and clears it.\r\n * @param {Array<HTMLButtonElement>} buttons\r\n */\r\nexport function destroyArrayOfButtons(buttons) {\r\n    if (Array.isArray(buttons)) {\r\n        buttons.forEach(btn => {\r\n            if (btn.parentNode) {\r\n                btn.parentNode.removeChild(btn);\r\n            }\r\n        });\r\n        buttons.length = 0;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the name of the fractal mode.\r\n * @param {number} type\r\n */\r\nexport function getFractalName(type) {\r\n    return Object.keys(FRACTAL_TYPE).find(key => FRACTAL_TYPE[key] === type) || \"UNKNOWN\";\r\n}","import {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE} from \"../global/constants\";\r\n\r\n/**\r\n * Abstract base class for WebGL-based renderers.\r\n * Provides common WebGL context initialization and management functionality.\r\n * \r\n * @abstract\r\n */\r\nclass Renderer {\r\n    /**\r\n     * Creates a new Renderer instance and initializes the WebGL context.\r\n     *\r\n     * @param {HTMLCanvasElement} canvas - The canvas element to render to.\r\n     */\r\n    constructor(canvas) {\r\n        this.canvas = canvas;\r\n\r\n        this.gl = this.canvas.getContext(\"webgl\", {\r\n            antialias: false,\r\n            alpha: false,\r\n            depth: false,\r\n            stencil: false,\r\n            preserveDrawingBuffer: false,\r\n            powerPreference: \"high-performance\",\r\n        });\r\n\r\n        if (!this.gl) {\r\n            alert('WebGL is not supported by your browser or crashed.');\r\n            return;\r\n        }\r\n\r\n        this.onWebGLContextLost = this.onWebGLContextLost.bind(this);\r\n        this.canvas.addEventListener('webglcontextlost', this.onWebGLContextLost);\r\n    }\r\n\r\n    /**\r\n     * Handles WebGL context lost events and attempts to recover the context.\r\n     *\r\n     * @param {WebGLContextEvent} event - The context lost event.\r\n     */\r\n    onWebGLContextLost(event) {\r\n        event.preventDefault();\r\n        console.error(\r\n            `%c ${this.constructor.name}: onWebGLContextLost %c WebGL context lost. Attempting to recover...`,\r\n            CONSOLE_GROUP_STYLE,\r\n            CONSOLE_MESSAGE_STYLE\r\n        );\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * Initializes the renderer. Must be implemented by subclasses.\r\n     *\r\n     * @abstract\r\n     * @throws {Error} Always throws an error if not implemented.\r\n     */\r\n    init() {\r\n        throw new Error('Not implemented');\r\n    }\r\n\r\n    /**\r\n     * Performs the rendering operation. Must be implemented by subclasses.\r\n     *\r\n     * @abstract\r\n     * @throws {Error} Always throws an error if not implemented.\r\n     */\r\n    draw() {\r\n        throw new Error('Not implemented');\r\n    }\r\n\r\n    /**\r\n     * Resets the renderer to its initial state. Must be implemented by subclasses.\r\n     *\r\n     * @abstract\r\n     * @throws {Error} Always throws an error if not implemented.\r\n     */\r\n    reset() {\r\n        throw new Error('Not implemented');\r\n    }\r\n\r\n    /**\r\n     * Cleans up renderer resources and releases references.\r\n     */\r\n    destroy() {\r\n        this.gl = null;\r\n        this.canvas = null;\r\n    }\r\n}\r\n\r\nexport default Renderer;","import {debugPanel, updateInfo} from \"../ui/ui\";\r\nimport {\r\n    compareComplex,\r\n    comparePalettes,\r\n    ddAdd,\r\n    ddMake,\r\n    ddSet,\r\n    ddValue,\r\n    hslToRgb,\r\n    lerp,\r\n    normalizeRotation,\r\n    rgbToHsl\r\n} from \"../global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, EASE_TYPE, log, PI} from \"../global/constants\";\r\nimport vertexFragmentShaderRaw from '../shaders/vertexShaderInit.vert';\r\nimport Renderer from \"./renderer\";\r\n\r\n/**\r\n * FractalRenderer\r\n *\r\n * @author Radim Brnka (c) 2025-2026\r\n * @description This module defines a fractalRenderer abstract class that encapsulates the WebGL code, including shader compilation, drawing, reset, and screenToFractal conversion. It also includes common animation methods.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n * @abstract\r\n */\r\nclass FractalRenderer extends Renderer {\r\n\r\n    /**\r\n     * @param {HTMLCanvasElement} canvas\r\n     */\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        // Defaults:\r\n        this.MAX_ITER = 2000;\r\n\r\n        this.DEFAULT_ROTATION = 0;\r\n        this.DEFAULT_ZOOM = 3.0;\r\n        /** @type {COMPLEX} */\r\n        this.DEFAULT_PAN = [0, 0];\r\n        this.DEFAULT_PALETTE = [1.0, 1.0, 1.0];\r\n        this.MAX_ZOOM = 1e-80;\r\n        this.MIN_ZOOM = 40;\r\n\r\n        /**\r\n         * Interesting points / details / zooms / views\r\n         * @type {Array.<PRESET>}\r\n         */\r\n        this.PRESETS = [];\r\n\r\n        /** @type {number} */\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n\r\n        /** @type {COMPLEX} */\r\n        this.pan = [...this.DEFAULT_PAN];\r\n\r\n        /** DD accumulator mirrors into this.pan */\r\n        this.panDD = {\r\n            x: ddMake(this.pan[0], 0),\r\n            y: ddMake(this.pan[1], 0),\r\n        };\r\n\r\n        /**\r\n         * Rotation in rad\r\n         * @type {number}\r\n         */\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n\r\n        this.currentPanAnimationFrame = null;\r\n        this.currentZoomAnimationFrame = null;\r\n        this.currentRotationAnimationFrame = null;\r\n        this.currentColorAnimationFrame = null;\r\n\r\n        this.demoActive = false;\r\n        this.currentPresetIndex = 0;\r\n\r\n        this.interactionActive = false;\r\n        this.interactionTimer = null;\r\n\r\n        /** @type {number} */\r\n        this.iterations = 0;\r\n        this.extraIterations = 0;\r\n\r\n        this.bestScore = NaN;\r\n        this.probeIters = NaN;\r\n\r\n\r\n        /** @type PALETTE */\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        // Uniform dirty tracking - only upload uniforms when values change\r\n        this._uniformCache = {\r\n            resW: -1,\r\n            resH: -1,\r\n            pan0: NaN,\r\n            pan1: NaN,\r\n            zoom: NaN,\r\n            rotation: NaN,\r\n            iterations: NaN,\r\n            color0: NaN,\r\n            color1: NaN,\r\n            color2: NaN,\r\n        };\r\n\r\n        /** Vertex shader */\r\n        this.vertexShaderSource = vertexFragmentShaderRaw;\r\n    }\r\n\r\n    /**\r\n     * Hook for perturbation renderers to request orbit rebuild.\r\n     * No-op by default.\r\n     */\r\n    markOrbitDirty() {}\r\n\r\n    /**\r\n     * Invalidates the uniform cache, forcing all uniforms to be re-uploaded on next draw().\r\n     * Called after GL program creation/recreation.\r\n     */\r\n    invalidateUniformCache() {\r\n        this._uniformCache.resW = -1;\r\n        this._uniformCache.resH = -1;\r\n        this._uniformCache.pan0 = NaN;\r\n        this._uniformCache.pan1 = NaN;\r\n        this._uniformCache.zoom = NaN;\r\n        this._uniformCache.rotation = NaN;\r\n        this._uniformCache.iterations = NaN;\r\n        this._uniformCache.color0 = NaN;\r\n        this._uniformCache.color1 = NaN;\r\n        this._uniformCache.color2 = NaN;\r\n    }\r\n\r\n    // --------- Pan API (use these; they keep DD + array in sync) ---------\r\n\r\n    /** @returns {number[]} the canonical array */\r\n    getPan() {\r\n        return [this.pan[0], this.pan[1]];\r\n    }\r\n\r\n    /**\r\n     * Sets the pan values for the object.\r\n     *\r\n     * @param {number} x - The horizontal pan value.\r\n     * @param {number} y - The vertical pan value.\r\n     * @return {void}\r\n     */\r\n    setPan(x, y) {\r\n        ddSet(this.panDD.x, x);\r\n        ddSet(this.panDD.y, y);\r\n        this.pan[0] = ddValue(this.panDD.x);\r\n        this.pan[1] = ddValue(this.panDD.y);\r\n    }\r\n\r\n    /**\r\n     * Adjusts the pan values by adding the specified deltas to the current pan values.\r\n     *\r\n     * @param {number} dx - The change in the x-direction to be added to the pan.\r\n     * @param {number} dy - The change in the y-direction to be added to the pan.\r\n     * @return {void}\r\n     */\r\n    addPan(dx, dy) {\r\n        ddAdd(this.panDD.x, dx);\r\n        ddAdd(this.panDD.y, dy);\r\n        this.pan[0] = ddValue(this.panDD.x);\r\n        this.pan[1] = ddValue(this.panDD.y);\r\n    }\r\n\r\n    /**\r\n     * Set pan so that fractal point (fxAnchor,fyAnchor) remains under a screen point\r\n     * whose view vector is (vx,vy).\r\n     */\r\n    setPanFromAnchor(fxAnchor, fyAnchor, vx, vy) {\r\n        const px = fxAnchor - vx * this.zoom;\r\n        const py = fyAnchor - vy * this.zoom;\r\n        this.setPan(px, py);\r\n    }\r\n\r\n    /**\r\n     * Sets zoom while keeping the fractal point under a given screen anchor fixed.\r\n     * Uses DD-preserving arithmetic to avoid precision loss at deep zoom.\r\n     *\r\n     * @param {number} targetZoom\r\n     * @param {number} anchorX CSS px relative to canvas\r\n     * @param {number} anchorY CSS px relative to canvas\r\n     */\r\n    setZoomKeepingAnchor(targetZoom, anchorX, anchorY) {\r\n        // View vector (rotated + aspect corrected) is stable because it does not include pan/zoom.\r\n        const [vx, vy] = this.screenToViewVector(anchorX, anchorY);\r\n\r\n        // To keep fractal point under cursor fixed:\r\n        // Old: fractalPt = pan + v * oldZoom\r\n        // New: fractalPt = newPan + v * newZoom\r\n        // Therefore: newPan = pan + v * (oldZoom - newZoom)\r\n        // Using addPan preserves DD precision (unlike setPan which resets lo=0)\r\n        const deltaZoom = this.zoom - targetZoom;\r\n        this.addPan(vx * deltaZoom, vy * deltaZoom);\r\n\r\n        this.zoom = targetZoom;\r\n    }\r\n\r\n    /**\r\n     * Marks the app as \"in interaction\" (drag/wheel/key-pan) and schedules a settle phase.\r\n     * Perturbation renderers can use this to defer expensive orbit rebuilds until the user stops moving.\r\n     *\r\n     * @param {number} settleMs\r\n     */\r\n    noteInteraction(settleMs = 160) {\r\n        this.interactionActive = true;\r\n\r\n        if (this.interactionTimer) {\r\n            clearTimeout(this.interactionTimer);\r\n            this.interactionTimer = null;\r\n        }\r\n\r\n        this.interactionTimer = setTimeout(() => {\r\n            this.interactionActive = false;\r\n\r\n            // Request a clean rebuild at rest for perturbation renderers (safe no-op otherwise)\r\n            this.markOrbitDirty();\r\n\r\n            // One clean redraw at settle time (prevents swim and removes lingering error)\r\n            this.draw();\r\n            updateInfo(true);\r\n        }, settleMs);\r\n    }\r\n\r\n    /** Destructor */\r\n    destroy() {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: %c destroy`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        // Cancel any ongoing animations.\r\n        this.stopAllNonColorAnimations();\r\n        this.stopCurrentColorAnimations();\r\n\r\n        // Remove event listeners from the canvas.\r\n        if (this.canvas) {\r\n            this.canvas.removeEventListener('webglcontextlost', this.onWebGLContextLost);\r\n        }\r\n\r\n        // Free WebGL resources.\r\n        if (this.program) {\r\n            this.gl.deleteProgram(this.program);\r\n            this.program = null;\r\n        }\r\n        if (this.vertexShader) {\r\n            this.gl.deleteShader(this.vertexShader);\r\n            this.vertexShader = null;\r\n        }\r\n        if (this.fragmentShader) {\r\n            this.gl.deleteShader(this.fragmentShader);\r\n            this.fragmentShader = null;\r\n        }\r\n\r\n        if (this.interactionTimer) {\r\n            clearTimeout(this.interactionTimer);\r\n            this.interactionTimer = null;\r\n        }\r\n\r\n        super.destroy();\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    //region > CONTROL METHODS -----------------------------------------------------------------------------------------\r\n\r\n    generatePresetIDs() {\r\n        this.PRESETS.forEach((preset, index) => {\r\n            preset.id = index;\r\n        });\r\n    }\r\n\r\n    init() {\r\n        this.generatePresetIDs();\r\n        this.initGLProgram();\r\n        this.draw();\r\n    }\r\n\r\n    resizeCanvas() {\r\n        log(`resizeCanvas`, this.constructor.name);\r\n\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Keep the center fixed\r\n        const oldRect = this.canvas.getBoundingClientRect();\r\n        const cx = oldRect.width / 2;\r\n        const cy = oldRect.height / 2;\r\n\r\n        const [centerFx, centerFy] = this.screenToFractal(cx, cy);\r\n\r\n        const dpr = window.devicePixelRatio || 1;\r\n        this.canvas.width = Math.floor(oldRect.width * dpr);\r\n        this.canvas.height = Math.floor(oldRect.height * dpr);\r\n\r\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n        if (this.resolutionLoc) this.gl.uniform2f(this.resolutionLoc, this.canvas.width, this.canvas.height);\r\n\r\n        const [vx, vy] = this.screenToViewVector(cx, cy);\r\n        this.setPanFromAnchor(centerFx, centerFy, vx, vy);\r\n\r\n        // After resizing, request a clean rebuild for perturbation renderers (safe no-op otherwise)\r\n        this.markOrbitDirty();\r\n        this.draw();\r\n    }\r\n\r\n\r\n    /**\r\n     * Defines the shader code for rendering the fractal shape\r\n     *\r\n     * @abstract\r\n     * @returns {string}\r\n     */\r\n    createFragmentShaderSource() {\r\n        throw new Error('The draw method must be implemented in child classes');\r\n    }\r\n\r\n    /**\r\n     * Compiles shader code\r\n     * @param {string} source\r\n     * @param {GLenum} type\r\n     * @return {WebGLShader|null}\r\n     */\r\n    compileShader(source, type) {\r\n        if (DEBUG_MODE) {\r\n            console.groupCollapsed(`%c ${this.constructor.name}: %c compileShader`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n            console.log(`Shader GLenum type: ${type}\\nShader code: ${source}`);\r\n        }\r\n\r\n        const shader = this.gl.createShader(type);\r\n        this.gl.shaderSource(shader, source);\r\n        this.gl.compileShader(shader);\r\n\r\n        if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\r\n            console.error(this.gl.getShaderInfoLog(shader));\r\n            this.gl.deleteShader(shader);\r\n            if (DEBUG_MODE) console.groupEnd();\r\n            return null;\r\n        }\r\n        if (DEBUG_MODE) console.groupEnd();\r\n\r\n        return shader;\r\n    }\r\n\r\n    /**\r\n     * Initializes WebGL program, shaders, quad, and uniform caches.\r\n     */\r\n    initGLProgram() {\r\n        if (DEBUG_MODE) console.groupCollapsed(`%c ${this.constructor.name}:%c initGLProgram`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.program) this.gl.deleteProgram(this.program);\r\n        if (this.fragmentShader) this.gl.deleteShader(this.fragmentShader);\r\n\r\n        if (!this.vertexShader) {\r\n            this.vertexShader = this.compileShader(this.vertexShaderSource, this.gl.VERTEX_SHADER);\r\n        }\r\n        this.fragmentShader = this.compileShader(this.createFragmentShaderSource(), this.gl.FRAGMENT_SHADER);\r\n\r\n        this.program = this.gl.createProgram();\r\n        this.gl.attachShader(this.program, this.vertexShader);\r\n        this.gl.attachShader(this.program, this.fragmentShader);\r\n        this.gl.linkProgram(this.program);\r\n\r\n        if (!this.gl.getProgramParameter(this.program, this.gl.LINK_STATUS)) {\r\n            console.error(this.gl.getProgramInfoLog(this.program));\r\n        }\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Full-screen quad\r\n        const positionBuffer = this.gl.createBuffer();\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, positionBuffer);\r\n        const positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, positions, this.gl.STATIC_DRAW);\r\n        const positionLoc = this.gl.getAttribLocation(this.program, \"a_position\");\r\n        this.gl.enableVertexAttribArray(positionLoc);\r\n        this.gl.vertexAttribPointer(positionLoc, 2, this.gl.FLOAT, false, 0, 0);\r\n\r\n        this.updateUniforms();\r\n        this.invalidateUniformCache();\r\n\r\n        if (typeof this.onProgramCreated === \"function\") {\r\n            this.onProgramCreated();\r\n        }\r\n\r\n        if (DEBUG_MODE) console.groupEnd();\r\n    }\r\n\r\n    /** @abstract */\r\n    onProgramCreated() {\r\n        throw new Error(\"The onProgramCreated method must be implemented in child classes\");\r\n    }\r\n\r\n    /**\r\n     * kept for compatibility; perturbation renderers may ignore\r\n     * @abstract\r\n     */\r\n    needsRebase() {\r\n        throw new Error(\"The needsRebase method must be implemented in child classes\");\r\n    }\r\n\r\n    /**\r\n     * Cache common uniforms used by all renderers\r\n     */\r\n    updateUniforms() {\r\n        this.gl.useProgram(this.program);\r\n        this.panLoc = this.gl.getUniformLocation(this.program, \"u_pan\");\r\n        this.zoomLoc = this.gl.getUniformLocation(this.program, \"u_zoom\");\r\n        this.iterLoc = this.gl.getUniformLocation(this.program, \"u_iterations\");\r\n        this.colorLoc = this.gl.getUniformLocation(this.program, \"u_colorPalette\");\r\n        this.rotationLoc = this.gl.getUniformLocation(this.program, \"u_rotation\");\r\n        this.resolutionLoc = this.gl.getUniformLocation(this.program, \"u_resolution\");\r\n    }\r\n\r\n    /**\r\n     * Draws the fractal and sets basic uniforms.\r\n     * Subclasses can override draw() but must call super.draw() for viewport+common uniforms+draw call.\r\n     * Uses dirty checking to avoid redundant uniform uploads.\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        const w = this.canvas.width;\r\n        const h = this.canvas.height;\r\n        const uc = this._uniformCache;\r\n\r\n        this.gl.viewport(0, 0, w, h);\r\n\r\n        // Only upload uniforms that have changed\r\n        if (this.resolutionLoc && (uc.resW !== w || uc.resH !== h)) {\r\n            this.gl.uniform2f(this.resolutionLoc, w, h);\r\n            uc.resW = w;\r\n            uc.resH = h;\r\n        }\r\n\r\n        if (this.panLoc && (uc.pan0 !== this.pan[0] || uc.pan1 !== this.pan[1])) {\r\n            this.gl.uniform2fv(this.panLoc, this.pan);\r\n            uc.pan0 = this.pan[0];\r\n            uc.pan1 = this.pan[1];\r\n        }\r\n\r\n        if (this.zoomLoc && uc.zoom !== this.zoom) {\r\n            this.gl.uniform1f(this.zoomLoc, this.zoom);\r\n            uc.zoom = this.zoom;\r\n        }\r\n\r\n        if (this.rotationLoc && uc.rotation !== this.rotation) {\r\n            this.gl.uniform1f(this.rotationLoc, this.rotation);\r\n            uc.rotation = this.rotation;\r\n        }\r\n\r\n        if (this.iterLoc && uc.iterations !== this.iterations) {\r\n            this.gl.uniform1f(this.iterLoc, this.iterations);\r\n            uc.iterations = this.iterations;\r\n        }\r\n\r\n        if (this.colorLoc && (uc.color0 !== this.colorPalette[0] ||\r\n                              uc.color1 !== this.colorPalette[1] ||\r\n                              uc.color2 !== this.colorPalette[2])) {\r\n            this.gl.uniform3fv(this.colorLoc, this.colorPalette);\r\n            uc.color0 = this.colorPalette[0];\r\n            uc.color1 = this.colorPalette[1];\r\n            uc.color2 = this.colorPalette[2];\r\n        }\r\n\r\n        this.gl.clearColor(0, 0, 0, 1);\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n        debugPanel?.beginGpuTimer();\r\n        this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n        debugPanel?.endGpuTimer();\r\n    }\r\n\r\n    /**\r\n     * Resets the fractal to its initial state (default pan, zoom, palette, rotation, etc.), resizes and redraws.\r\n     */\r\n    reset() {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: reset`, CONSOLE_GROUP_STYLE);\r\n\r\n        this.stopAllNonColorAnimations();\r\n        this.stopCurrentColorAnimations();\r\n\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]);\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n        this.extraIterations = 0;\r\n        this.currentPresetIndex = 0;\r\n\r\n        this.resizeCanvas();\r\n\r\n        this.markOrbitDirty();\r\n        this.draw();\r\n\r\n        console.groupEnd();\r\n        updateInfo();\r\n    }\r\n\r\n    /**\r\n     * Screen point -> fractal coordinates (float64 JS side; fine for UI)\r\n     * @param {number} screenX\r\n     * @param {number} screenY\r\n     * @returns {COMPLEX}\r\n     */\r\n    screenToFractal(screenX, screenY) {\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        const w = rect.width * dpr;\r\n        const h = rect.height * dpr;\r\n\r\n        const bufferX = screenX * dpr;\r\n        const bufferY = screenY * dpr;\r\n\r\n        const normX = bufferX / w;\r\n        const normY = bufferY / h;\r\n\r\n        let stX = normX - 0.5;\r\n        let stY = (1 - normY) - 0.5;\r\n\r\n        const aspect = w / h;\r\n        stX *= aspect;\r\n\r\n        const cosR = Math.cos(this.rotation);\r\n        const sinR = Math.sin(this.rotation);\r\n        const rotatedX = cosR * stX - sinR * stY;\r\n        const rotatedY = sinR * stX + cosR * stY;\r\n\r\n        return [rotatedX * this.zoom + this.pan[0], rotatedY * this.zoom + this.pan[1]];\r\n    }\r\n\r\n    /**\r\n     * Convert a screen point to the rotated, aspect-corrected \"view vector\" (no pan/zoom applied).\r\n     * This is exactly what your shader calls `rotated`.\r\n     *\r\n     * @param {number} screenX CSS pixels relative to canvas (like your handlers use)\r\n     * @param {number} screenY CSS pixels relative to canvas\r\n     * @returns {number[]} view-space rotated vector\r\n     */\r\n    screenToViewVector(screenX, screenY) {\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        const w = rect.width * dpr;\r\n        const h = rect.height * dpr;\r\n\r\n        const bufferX = screenX * dpr;\r\n        const bufferY = screenY * dpr;\r\n\r\n        const normX = bufferX / w;\r\n        const normY = bufferY / h;\r\n\r\n        let stX = normX - 0.5;\r\n        let stY = (1 - normY) - 0.5;\r\n\r\n        const aspect = w / h;\r\n        stX *= aspect;\r\n\r\n        const cosR = Math.cos(this.rotation);\r\n        const sinR = Math.sin(this.rotation);\r\n\r\n        return [cosR * stX - sinR * stY, sinR * stX + cosR * stY];\r\n    }\r\n\r\n    /**\r\n     * Compute CSS-space center of the canvas (for default anchored zoom).\r\n     * @returns {number[]}\r\n     */\r\n    getCanvasCssCenter() {\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        return [rect.width / 2, rect.height / 2];\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /** Stops all currently running animations that are not a color transition */\r\n    stopAllNonColorAnimations() {\r\n        console.log(`%c ${this.constructor.name}: %c stopAllNonColorAnimations`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        this.stopCurrentPanAnimation();\r\n        this.stopCurrentZoomAnimation();\r\n        this.stopCurrentRotationAnimation();\r\n    }\r\n\r\n    /** Stops currently running pan animation */\r\n    stopCurrentPanAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentPanAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentPanAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentPanAnimationFrame);\r\n            this.currentPanAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running zoom animation */\r\n    stopCurrentZoomAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentZoomAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentZoomAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentZoomAnimationFrame);\r\n            this.currentZoomAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running rotation animation */\r\n    stopCurrentRotationAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentRotationAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentRotationAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentRotationAnimationFrame);\r\n            this.currentRotationAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops currently running color animation */\r\n    stopCurrentColorAnimations() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentColorAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentColorAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentColorAnimationFrame);\r\n            this.currentColorAnimationFrame = null;\r\n        }\r\n    }\r\n\r\n    /** Stops current demo and resets demo variables */\r\n    stopDemo() {\r\n        console.log(`%c ${this.constructor.name}: %c stopDemo`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        this.demoActive = false;\r\n        this.currentPresetIndex = 0;\r\n        this.stopAllNonColorAnimations();\r\n    }\r\n\r\n    /** Default callback after every animation that requires on-screen info update */\r\n    onAnimationFinished() {\r\n        setTimeout(() => updateInfo(), 50);\r\n    }\r\n\r\n    /**\r\n     * Smoothly transitions fractalApp.colorPalette from its current value\r\n     * to the provided newPalette over the specified duration (in milliseconds).\r\n     *\r\n     * @param {PALETTE} newPalette - The target palette as [r, g, b] (each in [0,1]).\r\n     * @param {number} [duration] - Duration of the transition in milliseconds.\r\n     * @param {Function} [coloringCallback] A method called at every animation step\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateColorPaletteTransition(newPalette, duration = 250, coloringCallback = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateColorPaletteTransition`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        if (comparePalettes(this.colorPalette, newPalette)) {\r\n            console.warn(`Identical palette found. Skipping.`);\r\n            return;\r\n        }\r\n        console.log(`Animating to ${newPalette}.`);\r\n\r\n        const startPalette = [...this.colorPalette];\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                this.colorPalette = [\r\n                    lerp(startPalette[0], newPalette[0], progress),\r\n                    lerp(startPalette[1], newPalette[1], progress),\r\n                    lerp(startPalette[2], newPalette[2], progress),\r\n                ];\r\n                this.draw();\r\n\r\n                if (coloringCallback) coloringCallback();\r\n\r\n                if (progress < 1) {\r\n                    this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentColorAnimations();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates fractalApp.colorPalette by cycling through the entire color space.\r\n     * The palette will continuously change hue from 0 to 360 degrees and starts from the current palette\r\n     *\r\n     * @param {number} [duration] - Duration (in milliseconds) for one full color cycle.\r\n     * @param {Function} [coloringCallback]\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateFullColorSpaceCycle(duration = 15000, coloringCallback = null) {\r\n        console.log(`%c ${this.constructor.name}: animateFullColorSpaceCycle`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        const currentRGB = this.colorPalette;\r\n        const hsl = rgbToHsl(currentRGB[0], currentRGB[1], currentRGB[2]);\r\n        const startHue = hsl[0]; // starting hue in [0, 1]\r\n        const fixedS = 1.0;\r\n        const fixedL = 0.6;\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const newHue = (startHue + progress) % 1;\r\n\r\n                this.colorPalette = hslToRgb(newHue, fixedS, fixedL);\r\n                this.draw();\r\n\r\n                if (coloringCallback) coloringCallback();\r\n\r\n                this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n            };\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates pan from current position to the new one\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanTo(targetPan, duration = 200, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentPanAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (compareComplex(this.pan, targetPan, 6)) {\r\n            console.log(`Already at the target pan. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n        console.log(`Panning to ${targetPan}.`);\r\n\r\n        const startPan = [...this.pan];\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const k = easeFunction(t);\r\n\r\n                const nx = lerp(startPan[0], targetPan[0], k);\r\n                const ny = lerp(startPan[1], targetPan[1], k);\r\n                this.setPan(nx, ny);\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentPanAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates pan by a delta (DD-stable). Unlike animatePanTo, this avoids computing\r\n     * targetPan = startPan + delta in a single float64 operation (which breaks in deep zoom).\r\n     *\r\n     * This method applies incremental DD pan updates based on animation progress.\r\n     *\r\n     * @param {COMPLEX} deltaPan\r\n     * @param [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise}\r\n     */\r\n    async animatePanBy(deltaPan, duration = 200, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanBy`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentPanAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (Math.abs(deltaPan[0]) < 1e-30 && Math.abs(deltaPan[1]) < 1e-30) {\r\n            console.log(`Zero delta pan. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        console.log(`Panning by ${deltaPan}.`);\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n            let prevK = 0;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n                const k = easeFunction(t);\r\n\r\n                const dk = k - prevK;\r\n                prevK = k;\r\n\r\n                if (dk !== 0) {\r\n                    this.addPan(deltaPan[0] * dk, deltaPan[1] * dk);\r\n                }\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentPanAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentPanAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates zoom while keeping the fractal point under an anchor screen coordinate fixed.\r\n     *\r\n     * @param {number} targetZoom\r\n     * @param {number} [duration]\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @param {number|null} [anchorX] CSS px relative to canvas; defaults to canvas center\r\n     * @param {number|null} [anchorY] CSS px relative to canvas; defaults to canvas center\r\n     */\r\n    async animateZoomTo(targetZoom, duration = 500, easeFunction = EASE_TYPE.NONE, anchorX = null, anchorY = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentZoomAnimation();\r\n\r\n        if (this.zoom.toFixed(20) === targetZoom.toFixed(20)) {\r\n            console.log(`Already at the target zoom. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        // Default anchor = canvas center (CSS)\r\n        if (anchorX === null || anchorY === null) {\r\n            const [cx, cy] = this.getCanvasCssCenter();\r\n            anchorX = cx;\r\n            anchorY = cy;\r\n        }\r\n\r\n        const startZoom = this.zoom;\r\n        const ratio = targetZoom / startZoom;\r\n\r\n        // Compute anchor once. During zoom animation, rotation is constant, so view-vector stays valid.\r\n        const [vx, vy] = this.screenToViewVector(anchorX, anchorY);\r\n        const fxAnchor = vx * startZoom + this.pan[0];\r\n        const fyAnchor = vy * startZoom + this.pan[1];\r\n\r\n        // orbit boundary policy hook (safe no-op for non-perturbation renderers)\r\n        this.markOrbitDirty();\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                if (easeFunction !== EASE_TYPE.NONE) {\r\n                    const k = easeFunction(t);\r\n                    this.zoom = startZoom + (targetZoom - startZoom) * k;\r\n                } else {\r\n                    this.zoom = startZoom * Math.pow(ratio, t);\r\n                }\r\n\r\n                // Recompute pan from the fixed anchor point (stable in deep zoom)\r\n                this.setPanFromAnchor(fxAnchor, fyAnchor, vx, vy);\r\n\r\n                this.markOrbitDirty();\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentZoomAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates zoom from current value to target zoom without adjusting pan position.\r\n     * Unlike animateZoomTo, this method does not keep any anchor point fixed during zooming.\r\n     * The fractal will appear to zoom in/out from its current center position.\r\n     *\r\n     * @param {number} targetZoom - The target zoom level to animate to\r\n     * @param {number} [duration=500] - Duration of the animation in milliseconds\r\n     * @param {EASE_TYPE|Function} [easeFunction=EASE_TYPE.NONE] - Easing function to apply; EASE_TYPE.NONE uses exponential interpolation\r\n     * @returns {Promise<void>} Promise that resolves when the animation completes\r\n     */\r\n    async animateZoomToNoPan(targetZoom, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomToNoPan`, CONSOLE_GROUP_STYLE);\r\n\r\n        this.stopCurrentZoomAnimation();\r\n\r\n        this.markOrbitDirty();\r\n\r\n        if (this.zoom.toFixed(20) === targetZoom.toFixed(20)) {\r\n            console.log(`Already at the target zoom. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        const startZoom = this.zoom;\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                if (easeFunction !== EASE_TYPE.NONE) {\r\n                    const k = easeFunction(t);\r\n                    this.zoom = startZoom + (targetZoom - startZoom) * k;\r\n                } else {\r\n                    this.zoom = startZoom * Math.pow(targetZoom / startZoom, t);\r\n                }\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n                    this.stopCurrentZoomAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentZoomAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    async animateRotationTo(targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateRotationTo`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentRotationAnimation();\r\n\r\n        targetRotation = normalizeRotation(targetRotation);\r\n\r\n        if (this.rotation.toFixed(6) === targetRotation.toFixed(6)) {\r\n            console.log(`Already at the target rotation \"${targetRotation}\". Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n        console.log(`Rotating from ${this.rotation.toFixed(6)} to ${targetRotation.toFixed(6)}.`);\r\n\r\n        const startRotation = this.rotation;\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const t = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                const k = easeFunction(t);\r\n\r\n                this.rotation = lerp(startRotation, targetRotation, k);\r\n                this.draw();\r\n                updateInfo(true);\r\n\r\n                if (t < 1) {\r\n                    this.currentRotationAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentRotationAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentRotationAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates sequential pan and then zooms into the target location.\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param {number} targetZoom\r\n     * @param {number} panDuration in milliseconds\r\n     * @param {number} zoomDuration in milliseconds\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanThenZoomTo(targetPan, targetZoom, panDuration, zoomDuration, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanThenZoomTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await this.animatePanTo(targetPan, panDuration, easeFunction);\r\n        await this.animateZoomTo(targetZoom, zoomDuration, easeFunction);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates pan and zoom simultaneously.\r\n     *\r\n     * @param {COMPLEX} targetPan\r\n     * @param {number} targetZoom\r\n     * @param {number} [duration] in milliseconds\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animatePanAndZoomTo(targetPan, targetZoom, duration = 1000, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanAndZoomTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animatePanTo(targetPan, duration, easeFunction),\r\n            this.animateZoomToNoPan(targetZoom, duration, easeFunction),\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animateZoomRotationTo(targetZoom, targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateZoomRotationTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animateZoomTo(targetZoom, duration, easeFunction),\r\n            this.animateRotationTo(targetRotation, duration, EASE_TYPE.CUBIC)\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animatePanZoomRotationTo(targetPan, targetZoom, targetRotation, duration = 500, easeFunction = EASE_TYPE.NONE) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animatePanZoomRotationTo`, CONSOLE_GROUP_STYLE);\r\n\r\n        await Promise.all([\r\n            this.animatePanTo(targetPan, duration, easeFunction),\r\n            this.animateZoomToNoPan(targetZoom, duration, easeFunction),\r\n            this.animateRotationTo(targetRotation, duration, easeFunction)\r\n        ]);\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    async animateInfiniteRotation(direction, step = 0.001) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateInfiniteRotation`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentRotationAnimation();\r\n\r\n        const dir = direction >= 0 ? 1 : -1;\r\n\r\n        await new Promise(() => {\r\n            const rotationStep = () => {\r\n                this.rotation = normalizeRotation(this.rotation + dir * step + 2 * PI);\r\n                this.draw();\r\n                updateInfo(true);\r\n                this.currentRotationAnimationFrame = requestAnimationFrame(rotationStep);\r\n            };\r\n            this.currentRotationAnimationFrame = requestAnimationFrame(rotationStep);\r\n        });\r\n        console.groupEnd();\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}\r\n\r\nexport default FractalRenderer;","/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/julia.preview.frag';\r\nimport FractalRenderer from \"./fractalRenderer\";\r\nimport data from '../data/julia.json' with {type: 'json'};\r\nimport {DEFAULT_JULIA_PALETTE} from \"../global/constants\";\r\n\r\n/**\r\n * Julia Set Preview Renderer (legacy)\r\n *\r\n * @author Radim Brnka\r\n * @description Simplified renderer for Julia preview in Mandelbrot mode\r\n * @extends FractalRenderer\r\n * @since 1.9\r\n */\r\nexport class JuliaPreviewRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.MAX_ITER = 500;\r\n        this.extraIterations = 0;\r\n\r\n        this.DEFAULT_ZOOM = 2.5;\r\n\r\n        /** @type COMPLEX */\r\n        this.DEFAULT_C = [-0.246, 0.64235];\r\n\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n        this.pan = [...this.DEFAULT_PAN]; // Copy\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n        this.DEFAULT_PALETTE = data.palettes[0].theme || DEFAULT_JULIA_PALETTE.theme;\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        /** @type COMPLEX */\r\n        this.c = [...this.DEFAULT_C];\r\n\r\n        /** @type {Array.<JULIA_PRESET>} */\r\n        this.PRESETS = [];\r\n\r\n        /** @type {Array.<DIVE>} */\r\n        this.DIVES = [];\r\n\r\n        this.innerStops = new Float32Array(this.DEFAULT_PALETTE);\r\n\r\n        this.currentCAnimationFrame = null;\r\n        this.demoTime = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.replace('__MAX_ITER__', this.MAX_ITER).toString();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        this.cLoc = this.gl.getUniformLocation(this.program, 'u_c');\r\n        this.innerStopsLoc = this.gl.getUniformLocation(this.program, 'u_innerStops');\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        const baseIters = Math.floor(3000 * Math.pow(2, -Math.log2(this.zoom)));\r\n        this.iterations = Math.min(2000, baseIters + this.extraIterations);\r\n\r\n        // Pass Julia constant `c`\r\n        this.gl.uniform2fv(this.cLoc, this.c);\r\n        this.gl.uniform3fv(this.innerStopsLoc, this.innerStops);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    reset() {\r\n        this.c = [...this.DEFAULT_C];\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n        this.innerStops = new Float32Array(this.colorPalette);\r\n        this.extraIterations = 0;\r\n\r\n        this.draw();\r\n    }\r\n\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Updates the palette and redraws.\r\n     * @param {number[]|Float32Array} newPalette - The inner stops array (15 floats for 5 RGB colors)\r\n     * @param {number} [duration] - Ignored for preview (instant transition)\r\n     * @param {Function} [coloringCallback] - Callback after palette change\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateColorPaletteTransition(newPalette, duration = 250, coloringCallback = null) {\r\n        if (!newPalette) return Promise.resolve();\r\n\r\n        // Update inner stops from the provided palette\r\n        this.innerStops = new Float32Array(newPalette);\r\n\r\n        // Derive colorPalette from stop index 3 (brightest color typically)\r\n        const stopIndex = 3;\r\n        this.colorPalette = [\r\n            newPalette[stopIndex * 3] * 1.5,\r\n            newPalette[stopIndex * 3 + 1] * 1.5,\r\n            newPalette[stopIndex * 3 + 2] * 1.5\r\n        ];\r\n\r\n        // Redraw with new palette\r\n        this.draw();\r\n\r\n        if (coloringCallback) coloringCallback();\r\n\r\n        return Promise.resolve();\r\n    }\r\n\r\n    needsRebase() {\r\n        return false;\r\n    }\r\n\r\n    onProgramCreated() {\r\n\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}","/**\r\n * @module JuliaPreview\r\n * @author Radim Brnka\r\n * @description Manages the floating Julia set preview shown on middle-click in Mandelbrot mode.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE} from \"../global/constants\";\r\nimport {JuliaPreviewRenderer} from \"../renderers/juliaPreviewRenderer\";\r\n\r\n/** @type {HTMLCanvasElement} */\r\nlet floatingCanvas = null;\r\n\r\n/** @type {JuliaPreviewRenderer} */\r\nlet previewRenderer = null;\r\n\r\n/** @type {boolean} */\r\nlet previewActive = false;\r\n\r\n/** @type {Float32Array|null} */\r\nlet pendingInnerStops = null;\r\n\r\n/** Preview canvas size in pixels */\r\nconst PREVIEW_WIDTH = 250;\r\nconst PREVIEW_HEIGHT = 200;\r\n\r\n/** Offset from cursor position */\r\nconst CURSOR_OFFSET_X = 20;\r\nconst CURSOR_OFFSET_Y = 20;\r\n\r\n/**\r\n * Initializes the Julia preview system.\r\n * Should be called once during app initialization.\r\n */\r\nexport function initJuliaPreview() {\r\n    floatingCanvas = document.getElementById('floatingCanvas');\r\n    if (!floatingCanvas) {\r\n        console.error('floatingCanvas element not found!');\r\n        return;\r\n    }\r\n\r\n    // Set canvas dimensions (physical pixels for rendering)\r\n    floatingCanvas.width = PREVIEW_WIDTH * window.devicePixelRatio;\r\n    floatingCanvas.height = PREVIEW_HEIGHT * window.devicePixelRatio;\r\n\r\n    // Set CSS dimensions (display size)\r\n    floatingCanvas.style.width = `${PREVIEW_WIDTH}px`;\r\n    floatingCanvas.style.height = `${PREVIEW_HEIGHT}px`;\r\n}\r\n\r\n/**\r\n * Shows the Julia preview at the given screen position with the specified c parameter.\r\n * @param {number} screenX - Screen X coordinate (clientX)\r\n * @param {number} screenY - Screen Y coordinate (clientY)\r\n * @param {number} cx - Real part of Julia c parameter\r\n * @param {number} cy - Imaginary part of Julia c parameter\r\n */\r\nexport function showJuliaPreview(screenX, screenY, cx, cy) {\r\n    if (!floatingCanvas) {\r\n        initJuliaPreview();\r\n    }\r\n\r\n    // Create renderer on first show\r\n    if (!previewRenderer) {\r\n        previewRenderer = new JuliaPreviewRenderer(floatingCanvas);\r\n        // Use lower iteration count for responsiveness\r\n        previewRenderer.MAX_ITER = 500;\r\n        previewRenderer.extraIterations = 0;\r\n        console.log(`%c JuliaPreview: %c Created preview renderer`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        // Apply any pending palette that was set before renderer was created\r\n        if (pendingInnerStops) {\r\n            previewRenderer.innerStops = pendingInnerStops;\r\n            pendingInnerStops = null;\r\n        }\r\n    }\r\n\r\n    // Update c parameter\r\n    previewRenderer.c = [cx, cy];\r\n    previewRenderer.markOrbitDirty();\r\n\r\n    // Position the canvas near cursor\r\n    updatePreviewPosition(screenX, screenY);\r\n\r\n    // Show the canvas\r\n    floatingCanvas.style.display = 'block';\r\n    previewActive = true;\r\n\r\n    // Render the Julia set\r\n    previewRenderer.draw();\r\n}\r\n\r\n/**\r\n * Updates the Julia preview position and c parameter as the mouse moves.\r\n * @param {number} screenX - Screen X coordinate (clientX)\r\n * @param {number} screenY - Screen Y coordinate (clientY)\r\n * @param {number} cx - Real part of Julia c parameter\r\n * @param {number} cy - Imaginary part of Julia c parameter\r\n */\r\nexport function updateJuliaPreview(screenX, screenY, cx, cy) {\r\n    if (!previewActive || !previewRenderer) return;\r\n\r\n    // Update c parameter\r\n    previewRenderer.c = [cx, cy];\r\n    previewRenderer.markOrbitDirty();\r\n\r\n    // Update position\r\n    updatePreviewPosition(screenX, screenY);\r\n\r\n    // Re-render\r\n    previewRenderer.draw();\r\n}\r\n\r\n/**\r\n * Updates the floating canvas position relative to cursor.\r\n * Ensures the preview stays within viewport bounds.\r\n * @param {number} screenX - Screen X coordinate\r\n * @param {number} screenY - Screen Y coordinate\r\n */\r\nfunction updatePreviewPosition(screenX, screenY) {\r\n    if (!floatingCanvas) return;\r\n\r\n    const viewportWidth = window.innerWidth;\r\n    const viewportHeight = window.innerHeight;\r\n\r\n    // Default position: below and to the right of cursor\r\n    let left = screenX + CURSOR_OFFSET_X;\r\n    let top = screenY + CURSOR_OFFSET_Y;\r\n\r\n    // Flip to left side if would overflow right edge\r\n    if (left + PREVIEW_WIDTH > viewportWidth) {\r\n        left = screenX - PREVIEW_WIDTH - CURSOR_OFFSET_X;\r\n    }\r\n\r\n    // Flip to above cursor if would overflow bottom edge\r\n    if (top + PREVIEW_HEIGHT > viewportHeight) {\r\n        top = screenY - PREVIEW_HEIGHT - CURSOR_OFFSET_Y;\r\n    }\r\n\r\n    // Clamp to viewport bounds\r\n    left = Math.max(0, Math.min(left, viewportWidth - PREVIEW_WIDTH));\r\n    top = Math.max(0, Math.min(top, viewportHeight - PREVIEW_HEIGHT));\r\n\r\n    floatingCanvas.style.left = `${left}px`;\r\n    floatingCanvas.style.top = `${top}px`;\r\n}\r\n\r\n/**\r\n * Hides the Julia preview.\r\n */\r\nexport function hideJuliaPreview() {\r\n    if (!previewActive) return;\r\n\r\n    previewActive = false;\r\n\r\n    if (floatingCanvas) {\r\n        floatingCanvas.style.display = 'none';\r\n    }\r\n\r\n    console.log(`%c JuliaPreview: %c Preview hidden`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/**\r\n * Recolors the Julia preview with a new palette.\r\n * @param {number[]} palette - RGB palette [r, g, b] in range [0,1]\r\n */\r\nexport function recolorJuliaPreview(palette) {\r\n    if (!palette || palette.length < 3) return;\r\n\r\n    // Convert 3-float RGB palette to 15-float inner stops for Julia shader\r\n    // Pattern matches Cosmos palette: black -> color -> black -> bright -> dark\r\n    const innerStops = new Float32Array([\r\n        0, 0, 0,                                              // stop 0: black\r\n        palette[0], palette[1], palette[2],                   // stop 1: the color\r\n        0, 0, 0,                                              // stop 2: black (keeps dark background)\r\n        palette[0] * 1.2, palette[1] * 1.2, palette[2] * 1.2, // stop 3: brighter highlight\r\n        0.1, 0.1, 0.1                                         // stop 4: dark version\r\n    ]);\r\n\r\n    if (previewRenderer) {\r\n        // Renderer exists - update immediately\r\n        previewRenderer.animateColorPaletteTransition(innerStops).then();\r\n    } else {\r\n        // Store for later when renderer is created\r\n        pendingInnerStops = innerStops;\r\n    }\r\n}\r\n\r\n/**\r\n * Resets the Julia preview renderer to default state.\r\n */\r\nexport function resetJuliaPreview() {\r\n    if (!previewRenderer) {\r\n        console.warn(`%c JuliaPreview: %c Cannot reset - renderer not initialized`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    previewRenderer.reset();\r\n}\r\n\r\n/**\r\n * Destroys the Julia preview renderer and cleans up resources.\r\n * Call this when switching away from Mandelbrot mode.\r\n */\r\nexport function destroyJuliaPreview() {\r\n    hideJuliaPreview();\r\n\r\n    if (previewRenderer) {\r\n        previewRenderer.destroy();\r\n        previewRenderer = null;\r\n        console.log(`%c JuliaPreview: %c Preview renderer destroyed`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    }\r\n}\r\n\r\n/**\r\n * Returns whether the preview is currently active.\r\n * @returns {boolean}\r\n */\r\nexport function isJuliaPreviewActive() {\r\n    return previewActive;\r\n}\r\n","/**\r\n * @module MouseEventHandlers\r\n * @author Radim Brnka\r\n * @description This module exports a function registerMouseEventHandlers that sets up all mouse events. It interacts directly with the fractalRenderer instance.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {expandComplexToString, normalizeRotation, updateURLParams} from '../global/utils.js';\r\nimport {isJuliaMode, resetAppState, updateInfo} from './ui.js';\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_MODE, EASE_TYPE, FRACTAL_TYPE} from \"../global/constants\";\r\nimport {hideJuliaPreview, initJuliaPreview, showJuliaPreview, updateJuliaPreview} from \"./juliaPreview\";\r\n\r\n/** How long should we wait before distinguish between double click and two single clicks. */\r\nconst DOUBLE_CLICK_THRESHOLD = 300;\r\n/** Tolerance of mouse movement before drag starts. */\r\nconst DRAG_THRESHOLD = 5;\r\nconst ZOOM_STEP = 0.05; // double-click zoom in/out\r\nconst ROTATION_SENSITIVITY = 0.01;\r\n\r\n// Wheel smoothing (reduces micro-jitter due to bursty wheel events)\r\nconst WHEEL_ZOOM_BASE = 1.1;\r\nconst WHEEL_DELTA_UNIT = 120;\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\n/** Global variable to track registration */\r\nlet mouseHandlersRegistered = false;\r\n\r\n// Stored references to event handler functions\r\nlet handleWheelEvent;\r\nlet handleMouseDownEvent;\r\nlet handleMouseMoveEvent;\r\nlet handleMouseUpEvent;\r\nlet handleMouseLeaveEvent;\r\n\r\nlet mouseDownX = 0, mouseDownY = 0;\r\nlet lastX = 0, lastY = 0;\r\nlet clickTimeout = null;\r\nlet wheelResetTimeout = null;\r\nlet isDragging = false;\r\nlet wasRotated = false;\r\n\r\n// Rotation\r\nlet isRightDragging = false;\r\nlet startX = 0;\r\n\r\n// Middle-click Julia preview\r\nlet isMiddleButtonHeld = false;\r\n\r\n// Cached rect (avoid layout thrash / inconsistencies during drag)\r\nlet dragRectLeft = 0;\r\nlet dragRectTop = 0;\r\nlet hasDragRect = false;\r\n\r\n// Wheel RAF aggregation\r\nlet wheelAccum = 0;\r\nlet wheelAnchorX = 0;\r\nlet wheelAnchorY = 0;\r\nlet wheelRAF = null;\r\n// Cached rect for wheel zoom (avoid sub-pixel jitter from repeated getBoundingClientRect calls)\r\nlet wheelRectLeft = 0;\r\nlet wheelRectTop = 0;\r\nlet hasWheelRect = false;\r\n\r\n/**\r\n * Mark orbit dirty if the current renderer supports perturbation caching.\r\n * IMPORTANT: must NOT trigger orbit rebuild immediately (renderers should defer).\r\n */\r\nfunction markOrbitDirtySafe() {\r\n    if (fractalApp && typeof fractalApp.markOrbitDirty === \"function\") {\r\n        fractalApp.markOrbitDirty();\r\n    } else if (fractalApp) {\r\n        // Fallback: do nothing; non-perturbation renderers won't need it.\r\n    }\r\n}\r\n\r\n/**\r\n * Initialization and registering of the event handlers.\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initMouseHandlers(app) {\r\n    fractalApp = app;\r\n    canvas = app.canvas;\r\n    canvas.addEventListener(\"contextmenu\", (e) => e.preventDefault());\r\n    initJuliaPreview();\r\n    registerMouseEventHandlers();\r\n}\r\n\r\n/** Registers mouse handlers. */\r\nexport function registerMouseEventHandlers() {\r\n    if (mouseHandlersRegistered) {\r\n        console.warn(`%c registerMouseEventHandlers: %c Mouse event handlers already registered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    handleWheelEvent = (event) => handleWheel(event);\r\n    handleMouseDownEvent = (event) => handleMouseDown(event);\r\n    handleMouseMoveEvent = (event) => handleMouseMove(event);\r\n    handleMouseUpEvent = (event) => handleMouseUp(event);\r\n    handleMouseLeaveEvent = () => handleMouseLeave();\r\n\r\n    canvas.addEventListener('wheel', handleWheelEvent, {passive: false});\r\n    canvas.addEventListener('mousedown', handleMouseDownEvent);\r\n    canvas.addEventListener('mousemove', handleMouseMoveEvent);\r\n    canvas.addEventListener('mouseup', handleMouseUpEvent);\r\n    canvas.addEventListener('mouseleave', handleMouseLeaveEvent);\r\n\r\n    mouseHandlersRegistered = true;\r\n    console.log(`%c registerMouseEventHandlers: %c Event handlers registered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/** Unregisters mouse handlers. */\r\nexport function unregisterMouseEventHandlers() {\r\n    if (!mouseHandlersRegistered) {\r\n        console.warn(`%c unregisterMouseEventHandlers: %c Event handlers are not registered so cannot be unregistered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    canvas.removeEventListener('wheel', handleWheelEvent, {passive: false});\r\n    canvas.removeEventListener('mousedown', handleMouseDownEvent);\r\n    canvas.removeEventListener('mousemove', handleMouseMoveEvent);\r\n    canvas.removeEventListener('mouseup', handleMouseUpEvent);\r\n    canvas.removeEventListener('mouseleave', handleMouseLeaveEvent);\r\n\r\n    mouseHandlersRegistered = false;\r\n    console.warn(`%c unregisterMouseEventHandlers: %c Event handlers unregistered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n// region > EVENT HANDLERS ---------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Apply accumulated wheel delta once per RAF.\r\n * This reduces \"bursty wheel\" micro-jitter and keeps anchor math consistent.\r\n */\r\nfunction flushWheelZoom() {\r\n    wheelRAF = null;\r\n\r\n    if (!fractalApp) return;\r\n    if (!Number.isFinite(fractalApp.zoom)) return;\r\n\r\n    // Use cached rect to avoid sub-pixel jitter from repeated getBoundingClientRect calls\r\n    const mouseX = wheelAnchorX - wheelRectLeft; // CSS px\r\n    const mouseY = wheelAnchorY - wheelRectTop;  // CSS px\r\n\r\n    // Apply accumulated delta\r\n    const zoomFactor = Math.pow(WHEEL_ZOOM_BASE, wheelAccum / WHEEL_DELTA_UNIT);\r\n    const targetZoom = fractalApp.zoom * zoomFactor;\r\n\r\n    // reset accumulator early (avoid re-entrance issues)\r\n    wheelAccum = 0;\r\n\r\n    if (targetZoom < fractalApp.MAX_ZOOM || targetZoom > fractalApp.MIN_ZOOM) return;\r\n\r\n    // Stable deep-zoom anchor math (no before/after subtraction)\r\n    // Keeps the fractal point under cursor fixed while changing zoom.\r\n    fractalApp.setZoomKeepingAnchor(targetZoom, mouseX, mouseY);\r\n\r\n    // orbit rebuild request for perturbation renderers (deferred by renderer logic)\r\n    markOrbitDirtySafe();\r\n\r\n    updateInfo(true);\r\n    fractalApp.draw();\r\n}\r\n\r\nfunction handleWheel(event) {\r\n    event.preventDefault();\r\n\r\n    // Cache rect on first wheel event of a gesture to avoid sub-pixel jitter\r\n    if (!hasWheelRect) {\r\n        const rect = fractalApp.canvas.getBoundingClientRect();\r\n        wheelRectLeft = rect.left;\r\n        wheelRectTop = rect.top;\r\n        hasWheelRect = true;\r\n    }\r\n\r\n    // Aggregate wheel delta and apply once per frame.\r\n    wheelAccum += event.deltaY;\r\n    wheelAnchorX = event.clientX;\r\n    wheelAnchorY = event.clientY;\r\n\r\n    if (!wheelRAF) {\r\n        wheelRAF = requestAnimationFrame(flushWheelZoom);\r\n    }\r\n\r\n    if (wheelResetTimeout) clearTimeout(wheelResetTimeout);\r\n    wheelResetTimeout = setTimeout(() => {\r\n        hasWheelRect = false; // Reset rect cache when gesture ends\r\n        resetAppState();\r\n    }, 150);\r\n\r\n    fractalApp.noteInteraction(160);\r\n}\r\n\r\nfunction handleMouseDown(event) {\r\n    if (event.button === 0) {\r\n        isDragging = false;\r\n        mouseDownX = event.clientX;\r\n        mouseDownY = event.clientY;\r\n        lastX = event.clientX;\r\n        lastY = event.clientY;\r\n\r\n        // Cache rect origin for stable relative coordinates during the drag.\r\n        // (Avoids layout thrash and tiny inconsistencies.)\r\n        const rect = canvas.getBoundingClientRect();\r\n        dragRectLeft = rect.left;\r\n        dragRectTop = rect.top;\r\n        hasDragRect = true;\r\n    } else if (event.button === 2) { // Right-click\r\n        startX = event.clientX;\r\n    } else if (event.button === 1) { // Middle click - Julia preview\r\n        event.preventDefault();\r\n\r\n        // Only show Julia preview when in Mandelbrot mode\r\n        if (!isJuliaMode()) {\r\n            isMiddleButtonHeld = true;\r\n\r\n            // Get fractal coordinates at cursor position\r\n            const rect = canvas.getBoundingClientRect();\r\n            const mouseX = event.clientX - rect.left;\r\n            const mouseY = event.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n            // Show Julia preview with c = cursor fractal position\r\n            showJuliaPreview(event.clientX, event.clientY, fx, fy);\r\n        }\r\n    }\r\n}\r\n\r\nfunction handleMouseMove(event) {\r\n    const dx = event.clientX - mouseDownX;\r\n    const dy = event.clientY - mouseDownY;\r\n\r\n    if (event.buttons === 1) {\r\n        if (!isDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isDragging = true;\r\n        }\r\n\r\n        if (isDragging) {\r\n            canvas.style.cursor = 'move';\r\n            if (clickTimeout) {\r\n                clearTimeout(clickTimeout);\r\n                clickTimeout = null;\r\n            }\r\n\r\n            // Use cached rect origin (fallback if not available).\r\n            let left = dragRectLeft;\r\n            let top = dragRectTop;\r\n            if (!hasDragRect) {\r\n                const rect = canvas.getBoundingClientRect();\r\n                left = rect.left;\r\n                top = rect.top;\r\n            }\r\n\r\n            // Stable deep-zoom pan delta:\r\n            // pan += zoom * (vLast - vNow)\r\n            const lastRelX = lastX - left;\r\n            const lastRelY = lastY - top;\r\n            const nowRelX = event.clientX - left;\r\n            const nowRelY = event.clientY - top;\r\n\r\n            const [vLastX, vLastY] = fractalApp.screenToViewVector(lastRelX, lastRelY);\r\n            const [vNowX,  vNowY ] = fractalApp.screenToViewVector(nowRelX, nowRelY);\r\n\r\n            if (Number.isFinite(fractalApp.zoom)) {\r\n                const deltaX = (vLastX - vNowX) * fractalApp.zoom;\r\n                const deltaY = (vLastY - vNowY) * fractalApp.zoom;\r\n\r\n                fractalApp.addPan(deltaX, deltaY);\r\n                // Mark orbit dirty (deferred rebuild)\r\n                markOrbitDirtySafe();\r\n\r\n                fractalApp.noteInteraction(160);\r\n            }\r\n\r\n            // Update last mouse coordinates.\r\n            lastX = event.clientX;\r\n            lastY = event.clientY;\r\n\r\n            fractalApp.draw();\r\n            updateInfo(true);\r\n        }\r\n    }\r\n\r\n    if (event.buttons === 2) {\r\n        if (!isRightDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isRightDragging = true;\r\n        }\r\n\r\n        if (isRightDragging) {\r\n            event.preventDefault();\r\n            const deltaX = event.clientX - startX;\r\n\r\n            fractalApp.rotation = normalizeRotation(fractalApp.rotation + deltaX * ROTATION_SENSITIVITY);\r\n            fractalApp.draw();\r\n\r\n            startX = event.clientX; // Update starting point for smooth rotation\r\n            wasRotated = true;\r\n            canvas.style.cursor = 'grabbing'; // Use a grabbing cursor for rotation\r\n            updateInfo();\r\n        }\r\n    }\r\n\r\n    // Middle button held - update Julia preview\r\n    if (event.buttons === 4 && isMiddleButtonHeld && !isJuliaMode()) {\r\n        const rect = canvas.getBoundingClientRect();\r\n        const mouseX = event.clientX - rect.left;\r\n        const mouseY = event.clientY - rect.top;\r\n        const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n        updateJuliaPreview(event.clientX, event.clientY, fx, fy);\r\n    }\r\n}\r\n\r\nfunction handleMouseUp(event) {\r\n    // Process only for left (0), middle (1), or right (2) mouse buttons.\r\n    if (![0, 1, 2].includes(event.button)) return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    if (event.button === 1) { // Middle-click - hide Julia preview\r\n        if (isMiddleButtonHeld) {\r\n            isMiddleButtonHeld = false;\r\n            hideJuliaPreview();\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (event.button === 0) { // Left click\r\n        // Release drag cache\r\n        hasDragRect = false;\r\n\r\n        if (!isDragging) {\r\n            const rect = canvas.getBoundingClientRect();\r\n            const mouseX = event.clientX - rect.left;\r\n            const mouseY = event.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n            // If there is already a pending click, then we have a double-click.\r\n            if (clickTimeout !== null) { // --- Double-click action ---\r\n                clearTimeout(clickTimeout);\r\n                clickTimeout = null;\r\n\r\n                const targetZoom = fractalApp.zoom * ZOOM_STEP;\r\n                if (targetZoom > fractalApp.MAX_ZOOM) {\r\n                    console.log(`%c handleMouseUp: %c Double Left Click: Centering on ${mouseX}x${mouseY} -> [${expandComplexToString([fx, fy])}] zoom ${fractalApp.zoom.toFixed(6)} -> ${targetZoom}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                    fractalApp.animatePanAndZoomTo([fx, fy], targetZoom, 1000, EASE_TYPE.QUINT).then(resetAppState);\r\n                } else {\r\n                    console.log(`%c handleMouseUp: %c Double Left Click: Over max zoom. Skipping`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                }\r\n            } else {\r\n                // Set a timeout for the single-click action.\r\n                clickTimeout = setTimeout(() => {\r\n                    console.log(`%c handleMouseUp: %c Single Left Click: Centering on ${mouseX}x${mouseY} -> ${expandComplexToString([fx, fy])}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                    // Centering action:\r\n                    fractalApp.animatePanTo([fx, fy], 500).then(() => {\r\n                        resetAppState();\r\n                        if (isJuliaMode()) {\r\n                            updateURLParams(FRACTAL_TYPE.JULIA, fx, fy, fractalApp.zoom, fractalApp.rotation, fractalApp.c[0], fractalApp.c[1]);\r\n                        } else {\r\n                            updateURLParams(FRACTAL_TYPE.MANDELBROT, fx, fy, fractalApp.zoom, fractalApp.rotation);\r\n                        }\r\n                    });\r\n\r\n                    navigator.clipboard.writeText(window.location.href).then(\r\n                        () => console.log(`%c handleMouseUp: %c Copied URL to clipboard!`, CONSOLE_MESSAGE_STYLE),\r\n                        (err) => console.error(`%c handleMouseUp: %c Not copied to clipboard! ${err}`, CONSOLE_MESSAGE_STYLE)\r\n                    );\r\n\r\n                    clickTimeout = null;\r\n                }, DOUBLE_CLICK_THRESHOLD);\r\n            }\r\n        } else {\r\n            resetAppState();\r\n            isDragging = false;\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n        }\r\n    }\r\n\r\n    if (event.button === 2) { // Right mouse button released\r\n        if (isRightDragging) {\r\n            isRightDragging = false;\r\n\r\n            if (DEBUG_MODE) console.log(`%c handleMouseUp: %c Single Right Click: Doing nothing.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n            if (wasRotated) resetAppState();\r\n            wasRotated = false;\r\n            canvas.style.cursor = 'crosshair';\r\n            return; // Prevent further processing if it was a drag\r\n        }\r\n\r\n        // Handle right-click double-click detection\r\n        const rect = canvas.getBoundingClientRect();\r\n        const mouseX = event.clientX - rect.left;\r\n        const mouseY = event.clientY - rect.top;\r\n        const [fx, fy] = fractalApp.screenToFractal(mouseX, mouseY);\r\n\r\n        if (clickTimeout !== null) {\r\n            // Double-click detected\r\n            clearTimeout(clickTimeout);\r\n            clickTimeout = null;\r\n\r\n            const targetZoom = fractalApp.zoom / ZOOM_STEP;\r\n            if (targetZoom < fractalApp.MIN_ZOOM) {\r\n                console.log(`%c handleMouseUp: %c Double Right Click: Centering on ${mouseX}x${mouseY} -> [${expandComplexToString([fx, fy])}] zoom ${fractalApp.zoom.toFixed(6)} -> ${targetZoom}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n                fractalApp.animatePanAndZoomTo([fx, fy], targetZoom, 1000, EASE_TYPE.QUINT).then(resetAppState);\r\n            } else {\r\n                console.log(`%c handleMouseUp: %c Double Right Click: Over min zoom. Skipping`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n            }\r\n        } else {\r\n            clickTimeout = setTimeout(() => { clickTimeout = null; }, DOUBLE_CLICK_THRESHOLD);\r\n        }\r\n\r\n        isRightDragging = false;\r\n    }\r\n\r\n    canvas.style.cursor = 'crosshair';\r\n}\r\n\r\nfunction handleMouseLeave() {\r\n    // Hide Julia preview if mouse leaves canvas while middle button is held\r\n    if (isMiddleButtonHeld) {\r\n        isMiddleButtonHeld = false;\r\n        hideJuliaPreview();\r\n    }\r\n}\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","/**\r\n * @module TouchEventHandlers\r\n * @author Radim Brnka\r\n * @description This module exports a function registerTouchEventHandlers that sets up all touch events. It interacts directly with the fractalRenderer instance.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {expandComplexToString, normalizeRotation, updateURLParams} from '../global/utils.js';\r\nimport {isJuliaMode, resetAppState, updateInfo} from './ui.js';\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, FRACTAL_TYPE} from \"../global/constants\";\r\n\r\n/** How long should we wait before distinguish between double tap and two single taps. */\r\nconst DOUBLE_TAP_THRESHOLD = 300;\r\n/** Tolerance of finger movements before drag starts with move gesture. */\r\nconst DRAG_THRESHOLD = 5;\r\nconst ZOOM_STEP = 0.05;\r\n/** Tolerance of finger movements before rotation starts with pinch gesture. */\r\nconst ROTATION_THRESHOLD = 0.05;\r\nconst ROTATION_SENSITIVITY = 1;\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\n/** Global variable to track registration */\r\nlet touchHandlersRegistered = false;\r\n\r\n// Stored references to event handler functions\r\nlet handleTouchStartEvent;\r\nlet handleTouchMoveEvent;\r\nlet handleTouchEndEvent;\r\n\r\nlet touchDownX = 0, touchDownY = 0;\r\nlet lastTouchX = 0, lastTouchY = 0;\r\nlet touchClickTimeout = null;\r\nlet isTouchDragging = false;\r\n\r\n// Cached rect (avoid layout thrash / inconsistencies during drag)\r\nlet dragRectLeft = 0;\r\nlet dragRectTop = 0;\r\nlet hasDragRect = false;\r\n\r\n// Pinch state variables\r\nlet isPinching = false;\r\nlet pinchStartDistance = null;\r\nlet pinchStartAngle = null;\r\n\r\n/**\r\n * Mark orbit dirty if the current renderer supports perturbation caching.\r\n * IMPORTANT: must NOT trigger orbit rebuild immediately (renderers should defer).\r\n */\r\nfunction markOrbitDirtySafe() {\r\n    if (fractalApp && typeof fractalApp.markOrbitDirty === \"function\") {\r\n        fractalApp.markOrbitDirty();\r\n    } else if (fractalApp) {\r\n        // Fallback: do nothing; non-perturbation renderers won't need it.\r\n    }\r\n}\r\n\r\n/**\r\n * Initialization and registering of the event handlers.\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initTouchHandlers(app) {\r\n    if (!app || !app.canvas) {\r\n        console.warn(`%c initTouchHandlers: %c App or canvas not provided.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = app;\r\n    canvas = app.canvas;\r\n    canvas.addEventListener('contextmenu', (e) => e.preventDefault());\r\n\r\n    registerTouchEventHandlers();\r\n}\r\n\r\n/** Registers touch handlers. */\r\nexport function registerTouchEventHandlers() {\r\n    if (!canvas) {\r\n        console.warn(`%c registerTouchEventHandlers: %c Canvas not initialized. Call initTouchHandlers first.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    if (touchHandlersRegistered) {\r\n        console.warn(`%c registerTouchEventHandlers: %c Event handlers already registered!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    handleTouchStartEvent = (event) => handleTouchStart(event);\r\n    handleTouchMoveEvent = (event) => handleTouchMove(event);\r\n    handleTouchEndEvent = (event) => handleTouchEnd(event);\r\n\r\n    canvas.addEventListener('touchstart', handleTouchStartEvent, {passive: false});\r\n    canvas.addEventListener('touchmove', handleTouchMoveEvent, {passive: false});\r\n    canvas.addEventListener('touchend', handleTouchEndEvent, {passive: false});\r\n\r\n    touchHandlersRegistered = true;\r\n    console.log(`%c registerTouchEventHandlers: %c Touch event handlers registered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n/** Unregisters touch handlers. */\r\nexport function unregisterTouchEventHandlers() {\r\n    if (!canvas || !touchHandlersRegistered) {\r\n        return;\r\n    }\r\n\r\n    canvas.removeEventListener('touchstart', handleTouchStartEvent, {passive: false});\r\n    canvas.removeEventListener('touchmove', handleTouchMoveEvent, {passive: false});\r\n    canvas.removeEventListener('touchend', handleTouchEndEvent, {passive: false});\r\n\r\n    touchHandlersRegistered = false;\r\n    console.warn(`%c unregisterTouchEventHandlers: %c Event handlers unregistered`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\n// region > EVENT HANDLERS ---------------------------------------------------------------------------------------------\r\n\r\nfunction handleTouchStart(event) {\r\n    if (!fractalApp) return;\r\n\r\n    if (event.touches.length === 1) {\r\n        event.preventDefault();\r\n\r\n        isTouchDragging = false;\r\n        isPinching = false;\r\n\r\n        pinchStartDistance = null;\r\n        pinchStartAngle = null;\r\n\r\n        const touch = event.touches[0];\r\n        touchDownX = touch.clientX;\r\n        touchDownY = touch.clientY;\r\n        lastTouchX = touch.clientX;\r\n        lastTouchY = touch.clientY;\r\n\r\n        // Cache rect origin for stable relative coordinates during the drag.\r\n        const rect = canvas.getBoundingClientRect();\r\n        dragRectLeft = rect.left;\r\n        dragRectTop = rect.top;\r\n        hasDragRect = true;\r\n\r\n        return;\r\n    }\r\n\r\n    if (event.touches.length === 2) {\r\n        event.preventDefault();\r\n\r\n        // Two-finger gesture: pinch zoom + rotation\r\n        isPinching = true;\r\n        isTouchDragging = false;\r\n\r\n        // Release drag cache (rect on-demand for pinch)\r\n        hasDragRect = false;\r\n\r\n        const touch0 = event.touches[0];\r\n        const touch1 = event.touches[1];\r\n\r\n        pinchStartDistance = Math.hypot(\r\n            touch0.clientX - touch1.clientX,\r\n            touch0.clientY - touch1.clientY\r\n        );\r\n\r\n        pinchStartAngle = Math.atan2(\r\n            touch1.clientY - touch0.clientY,\r\n            touch1.clientX - touch0.clientX\r\n        );\r\n\r\n        // Stop any pending single-tap click when pinch starts\r\n        if (touchClickTimeout) {\r\n            clearTimeout(touchClickTimeout);\r\n            touchClickTimeout = null;\r\n        }\r\n\r\n        fractalApp.noteInteraction(160);\r\n    }\r\n}\r\n\r\nfunction handleTouchMove(event) {\r\n    if (!fractalApp) return;\r\n\r\n    // Single touch drag (pan)\r\n    if (event.touches.length === 1 && !isPinching) {\r\n        event.preventDefault();\r\n\r\n        const touch = event.touches[0];\r\n        const dx = touch.clientX - touchDownX;\r\n        const dy = touch.clientY - touchDownY;\r\n\r\n        if (!isTouchDragging && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)) {\r\n            isTouchDragging = true;\r\n            if (touchClickTimeout) {\r\n                clearTimeout(touchClickTimeout);\r\n                touchClickTimeout = null;\r\n            }\r\n        }\r\n\r\n        if (isTouchDragging) {\r\n            // Use cached rect origin (fallback if not available).\r\n            let left = dragRectLeft;\r\n            let top = dragRectTop;\r\n            if (!hasDragRect) {\r\n                const rect = canvas.getBoundingClientRect();\r\n                left = rect.left;\r\n                top = rect.top;\r\n            }\r\n\r\n            // Stable deep-zoom pan delta:\r\n            // pan += zoom * (vLast - vNow)\r\n            const lastRelX = lastTouchX - left;\r\n            const lastRelY = lastTouchY - top;\r\n            const nowRelX = touch.clientX - left;\r\n            const nowRelY = touch.clientY - top;\r\n\r\n            const [vLastX, vLastY] = fractalApp.screenToViewVector(lastRelX, lastRelY);\r\n            const [vNowX,  vNowY ] = fractalApp.screenToViewVector(nowRelX, nowRelY);\r\n\r\n            if (Number.isFinite(fractalApp.zoom)) {\r\n                const deltaX = (vLastX - vNowX) * fractalApp.zoom;\r\n                const deltaY = (vLastY - vNowY) * fractalApp.zoom;\r\n\r\n                fractalApp.addPan(deltaX, deltaY);\r\n                markOrbitDirtySafe();\r\n                fractalApp.noteInteraction(160);\r\n            }\r\n\r\n            lastTouchX = touch.clientX;\r\n            lastTouchY = touch.clientY;\r\n\r\n            fractalApp.draw();\r\n            updateInfo(true);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    // Two-finger pinch: zoom + rotation around midpoint\r\n    if (event.touches.length === 2) {\r\n        event.preventDefault();\r\n        isPinching = true;\r\n\r\n        const touch0 = event.touches[0];\r\n        const touch1 = event.touches[1];\r\n\r\n        const currentDistance = Math.hypot(\r\n            touch0.clientX - touch1.clientX,\r\n            touch0.clientY - touch1.clientY\r\n        );\r\n\r\n        const currentAngle = Math.atan2(\r\n            touch1.clientY - touch0.clientY,\r\n            touch1.clientX - touch0.clientX\r\n        );\r\n\r\n        // Midpoint in screen space\r\n        const centerClientX = (touch0.clientX + touch1.clientX) / 2;\r\n        const centerClientY = (touch0.clientY + touch1.clientY) / 2;\r\n\r\n        const rect = canvas.getBoundingClientRect();\r\n        const centerX = centerClientX - rect.left; // CSS px relative to canvas\r\n        const centerY = centerClientY - rect.top;\r\n\r\n        // Initialize baseline if missing (or if gesture restarted)\r\n        if (!pinchStartDistance || !pinchStartAngle) {\r\n            pinchStartDistance = currentDistance;\r\n            pinchStartAngle = currentAngle;\r\n            return;\r\n        }\r\n\r\n        // Zoom:\r\n        // If distance increases -> zoom in (smaller zoom value).\r\n        // So scale zoom proportionally: zoom *= (startDistance / currentDistance)\r\n        let targetZoom = fractalApp.zoom;\r\n        if (currentDistance > 0) {\r\n            const zoomFactor = pinchStartDistance / currentDistance;\r\n            targetZoom = fractalApp.zoom * zoomFactor;\r\n        }\r\n\r\n        // Clamp (same semantics as your mouse/wheel handlers)\r\n        if (targetZoom < fractalApp.MAX_ZOOM) targetZoom = fractalApp.MAX_ZOOM;\r\n        if (targetZoom > fractalApp.MIN_ZOOM) targetZoom = fractalApp.MIN_ZOOM;\r\n\r\n        // Apply stable anchor zoom at midpoint (deep-zoom safe)\r\n        fractalApp.setZoomKeepingAnchor(targetZoom, centerX, centerY);\r\n\r\n        // Rotation (incremental, like mouse right-drag)\r\n        const angleDifference = currentAngle - pinchStartAngle;\r\n        if (Math.abs(angleDifference) > ROTATION_THRESHOLD) {\r\n            fractalApp.rotation = normalizeRotation(fractalApp.rotation + angleDifference * ROTATION_SENSITIVITY);\r\n        }\r\n\r\n        pinchStartDistance = currentDistance;\r\n        pinchStartAngle = currentAngle;\r\n\r\n        markOrbitDirtySafe();\r\n        fractalApp.noteInteraction(160);\r\n\r\n        fractalApp.draw();\r\n        updateInfo();\r\n    }\r\n}\r\n\r\nfunction handleTouchEnd(event) {\r\n    if (!fractalApp) return;\r\n\r\n    // Reset pinch baseline when leaving 2-finger gesture.\r\n    if (event.touches.length < 2) {\r\n        pinchStartDistance = null;\r\n        pinchStartAngle = null;\r\n    }\r\n\r\n    // When all touches end, decide if it was tap/double-tap or drag/pinch end.\r\n    if (event.touches.length === 0) {\r\n        // End of a pinch gesture: just settle.\r\n        if (isPinching) {\r\n            isPinching = false;\r\n            resetAppState();\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n\r\n            return;\r\n        }\r\n\r\n        // Release drag cache\r\n        hasDragRect = false;\r\n\r\n        if (!isTouchDragging) {\r\n            const touch = event.changedTouches[0];\r\n\r\n            const rect = canvas.getBoundingClientRect();\r\n            const touchX = touch.clientX - rect.left;\r\n            const touchY = touch.clientY - rect.top;\r\n            const [fx, fy] = fractalApp.screenToFractal(touchX, touchY);\r\n\r\n            if (touchClickTimeout !== null) {\r\n                clearTimeout(touchClickTimeout);\r\n                touchClickTimeout = null;\r\n\r\n                console.log(`%c handleTouchEnd: %c Double Tap: Centering on ${touchX}x${touchY} which is fractal coords [${expandComplexToString([fx, fy])}]`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                const targetZoom = fractalApp.zoom * ZOOM_STEP;\r\n                if (targetZoom > fractalApp.MAX_ZOOM) {\r\n                    fractalApp.animatePanAndZoomTo([fx, fy], targetZoom).then(resetAppState);\r\n                }\r\n            } else {\r\n                touchClickTimeout = setTimeout(() => {\r\n                    console.log(`%c handleTouchEnd: %c Single Tap Click: Centering on ${touchX}x${touchY} which is fractal coords ${expandComplexToString([fx, fy])}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n                    // Centering action:\r\n                    fractalApp.animatePanTo([fx, fy], 400).then(() => {\r\n                        resetAppState();\r\n                        if (isJuliaMode()) {\r\n                            updateURLParams(FRACTAL_TYPE.JULIA, fx, fy, fractalApp.zoom, fractalApp.rotation, fractalApp.c[0], fractalApp.c[1]);\r\n                        } else {\r\n                            updateURLParams(FRACTAL_TYPE.MANDELBROT, fx, fy, fractalApp.zoom, fractalApp.rotation);\r\n                            }\r\n                    });\r\n\r\n                    touchClickTimeout = null;\r\n                }, DOUBLE_TAP_THRESHOLD);\r\n            }\r\n        } else {\r\n            resetAppState();\r\n            isTouchDragging = false;\r\n\r\n            // Final settle rebuild request (renderer decides when to rebuild)\r\n            markOrbitDirtySafe();\r\n            fractalApp.draw();\r\n        }\r\n\r\n        isTouchDragging = false;\r\n    }\r\n}\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","/**\r\n * @module ScreenshotController\r\n * @author Radim Brnka\r\n * @description Screenshot capturing logic.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\nimport {APP_NAME, CONSOLE_GROUP_STYLE, SCREENSHOT_JPEG_COMPRESSION_QUALITY} from \"../global/constants\";\r\nimport {expandComplexToString} from \"../global/utils\";\r\nimport {isJuliaMode} from \"./ui\";\r\n\r\n/**\r\n * Generates filename based on current timestamp\r\n * @return {string}\r\n */\r\nfunction getFilename() {\r\n    const now = new Date();\r\n    const pad = (n) => String(n).padStart(2, '0');\r\n    return `fractal-${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}_${pad(now.getHours())}-${pad(now.getMinutes())}-${pad(now.getSeconds())}.jpg`;\r\n}\r\n\r\n/**\r\n * Returns watermark text that fits current fractal type and its properties.\r\n * @param {FractalRenderer} fractalApp\r\n * @return {string}\r\n */\r\nfunction getWatermarkText(fractalApp) {\r\n    const fractalType = isJuliaMode() ? 'Julia' : 'Mandelbrot';\r\n\r\n    return `Created by ${APP_NAME} (${fractalType}: ` +\r\n        `p=${expandComplexToString(fractalApp.pan.slice(), 6)}, zoom=${fractalApp.zoom.toExponential(2)}` +\r\n        `${(fractalApp instanceof JuliaRenderer) ? `, c=${expandComplexToString(fractalApp.c)})` : `)`}`;\r\n}\r\n\r\n/**\r\n * Draws rectangle with rounded borders\r\n * @param {CanvasRenderingContext2D} ctx\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} width\r\n * @param {number} height\r\n * @param {number} radius\r\n */\r\nfunction drawRoundRect(ctx, x, y, width, height, radius) {\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + radius, y);\r\n    ctx.lineTo(x + width - radius, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n    ctx.lineTo(x + width, y + height - radius);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n    ctx.lineTo(x + radius, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n    ctx.lineTo(x, y + radius);\r\n    ctx.quadraticCurveTo(x, y, x + radius, y);\r\n    ctx.closePath();\r\n}\r\n\r\n/**\r\n * Generates screenshot of the canvas, adds watermark and emulates link click to download the file.\r\n * @param {HTMLCanvasElement} canvas\r\n * @param {FractalRenderer} fractalApp\r\n * @param {string} accentColor\r\n */\r\nexport function takeScreenshot(canvas, fractalApp, accentColor) {\r\n    console.groupCollapsed(`%c takeScreenshot`, CONSOLE_GROUP_STYLE);\r\n\r\n    // Ensure the fractal is fully rendered before taking a screenshot\r\n    fractalApp.draw();\r\n\r\n    // Create an offscreen canvas for watermarking\r\n    const offscreenCanvas = document.createElement('canvas');\r\n    offscreenCanvas.width = canvas.width;\r\n    offscreenCanvas.height = canvas.height;\r\n    const ctx = offscreenCanvas.getContext('2d');\r\n\r\n    if (!ctx) {\r\n        console.error('Unable to get 2D context for the canvas.');\r\n        return;\r\n    }\r\n\r\n    // Copy the fractal canvas content to the offscreen canvas\r\n    ctx.drawImage(canvas, 0, 0);\r\n\r\n    // Define the watermark text and style\r\n    let watermarkText = getWatermarkText(fractalApp);\r\n    const fontSize = 12;\r\n    const padding = 6;\r\n    const borderWidth = 1;\r\n\r\n    ctx.font = `${fontSize}px sans-serif`;\r\n    ctx.textAlign = 'center';\r\n    ctx.textBaseline = 'middle';\r\n\r\n    // Measure the text width and calculate the rectangle size\r\n    const textWidth = ctx.measureText(watermarkText).width;\r\n    const rectWidth = textWidth + padding * 2 + borderWidth * 2;\r\n    const rectHeight = fontSize + padding * 2 + borderWidth * 2;\r\n\r\n    // Position the rectangle in the bottom-right corner\r\n    const x = offscreenCanvas.width - rectWidth - padding;\r\n    const y = offscreenCanvas.height - rectHeight - padding;\r\n\r\n    // Draw the semi-transparent black background\r\n    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n    drawRoundRect(ctx, x, y, rectWidth, rectHeight, 8);  // 10 is the corner radius, adjust as needed\r\n    ctx.fill();\r\n\r\n    // Draw the border\r\n    // ctx.strokeStyle = accentColor;\r\n    // ctx.lineWidth = borderWidth;\r\n    // drawRoundRect(ctx, x, y, rectWidth, rectHeight, 8);\r\n    // ctx.stroke();\r\n\r\n    // Draw the text centered within the rectangle\r\n    const textX = x + rectWidth / 2;\r\n    const textY = y + rectHeight / 2 + 1;\r\n    ctx.fillStyle = accentColor;\r\n    ctx.fillText(watermarkText, textX, textY);\r\n\r\n    // Create a temporary link for downloading the image\r\n    const link = document.createElement('a');\r\n\r\n    // Set the download attributes\r\n    link.setAttribute('download', getFilename());\r\n    link.setAttribute('href', offscreenCanvas.toDataURL(\"image/jpeg\", SCREENSHOT_JPEG_COMPRESSION_QUALITY));\r\n    link.click();\r\n\r\n    console.log('Screenshot successfully taken.');\r\n    console.groupEnd();\r\n}","/**\r\n * @module HotKeyController\r\n * @author Radim Brnka\r\n * @description Keyboard shortcuts controller attached to the UI\r\n * @link https://www.freecodecamp.org/news/javascript-keycode-list-keypress-event-key-codes/\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {\r\n    captureScreenshot,\r\n    isAnimationActive,\r\n    isJuliaMode,\r\n    randomizeColors,\r\n    reset,\r\n    resetAppState,\r\n    startJuliaDive,\r\n    switchFractalMode,\r\n    switchFractalTypeWithPersistence,\r\n    toggleCenterLines,\r\n    toggleDebugMode,\r\n    toggleDemo,\r\n    toggleHeader,\r\n    travelToPreset,\r\n    updateColorTheme,\r\n    updatePaletteDropdownState,\r\n} from \"./ui\";\r\nimport {\r\n    CONSOLE_GROUP_STYLE,\r\n    CONSOLE_MESSAGE_STYLE,\r\n    DEBUG_LEVEL,\r\n    DEBUG_MODE,\r\n    DEFAULT_MANDELBROT_THEME_COLOR,\r\n    FF_PERSISTENT_FRACTAL_SWITCHING,\r\n    FRACTAL_TYPE,\r\n    log,\r\n    ROTATION_DIRECTION\r\n} from \"../global/constants\";\r\n\r\n//region CONSTANTS > ---------------------------------------------------------------------------------------------------\r\n/**\r\n * Keys not allowed to work in animation mode\r\n * @type {string[]}\r\n */\r\nconst ANIMATION_KEYS_BLACKLIST = [\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\", \"Space\", \"KeyQ\", \"KeyW\"];\r\n\r\n/**\r\n * Pan movement animation duration\r\n * @type {number}\r\n */\r\nconst PAN_SPEED = 50;\r\n\r\n/**\r\n * Pan step size per keystroke\r\n * @type {number}\r\n */\r\nconst PAN_STEP = .1;\r\n\r\n/**\r\n * Smooth (Shift) pan step size per keystroke\r\n * @type {number}\r\n */\r\nconst PAN_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Normal rotation animation step size\r\n * @type {number}\r\n */\r\nconst ROTATION_ANIMATION_STEP = .1;\r\n\r\n/**\r\n * Smooth rotation animation step size\r\n * @type {number}\r\n */\r\nconst ROTATION_ANIMATION_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Zoom step per keystroke\r\n * @type {number}\r\n */\r\nconst ZOOM_ANIMATION_STEP = .1;\r\n\r\n/**\r\n * Smooth (Shift) zoom step per keystroke\r\n * @type {number}\r\n */\r\nconst ZOOM_ANIMATION_SMOOTH_STEP = .01;\r\n\r\n/**\r\n * Smooth stepping: step size\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_STEP = .0005;\r\n\r\n/**\r\n * Super smooth stepping multiplier (SHIFT)\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_SMOOTH_MULTIPLIER = .1;\r\n\r\n/**\r\n * Smooth stepping: animation duration\r\n * @type {number}\r\n */\r\nconst JULIA_HOTKEY_C_SPEED = 10;\r\n//endregion ------------------------------------------------------------------------------------------------------------\r\n\r\nlet rotationActive = false;\r\nlet initialized = false;\r\nlet fractalApp;\r\n\r\n/**\r\n * Keydown event handler\r\n * @param {KeyboardEvent} event\r\n * @return {Promise<void>}\r\n */\r\nasync function onKeyDown(event) {\r\n\r\n    // Do not steal hotkeys from user input fields (search boxes, sliders, etc.)\r\n    const target = /** @type {HTMLElement|null} */ (event.target);\r\n    const tag = target?.tagName?.toLowerCase();\r\n    const isTypingTarget =\r\n        !!target &&\r\n        (\r\n            tag === 'input' ||\r\n            tag === 'textarea' ||\r\n            tag === 'select' ||\r\n            target.isContentEditable\r\n        );\r\n\r\n    if (isTypingTarget) return;\r\n\r\n    if (DEBUG_MODE) console.log(`%c onKeyDown: %c Pressed key/code ${event.shiftKey ? 'Shift + ' : ''}${event.ctrlKey ? 'CTRL + ' : ''}${event.altKey ? 'ALT + ' : ''}${event.code}/${event.key}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    let handled = false;\r\n\r\n    const rotationSpeed = event.shiftKey ? ROTATION_ANIMATION_SMOOTH_STEP : ROTATION_ANIMATION_STEP;\r\n    let rotationDirection = ROTATION_DIRECTION.CW;\r\n\r\n    let deltaPanX = 0;\r\n    let deltaPanY = 0;\r\n    let deltaCx = 0;\r\n    let deltaCy = 0;\r\n\r\n    // Treat MAC Option button as Alt\r\n    const altKey = event.altKey || event.code === 'Alt';\r\n\r\n    if (isAnimationActive() && ANIMATION_KEYS_BLACKLIST.includes(event.code)) {\r\n        event.preventDefault();\r\n        return;\r\n    }\r\n    switch (event.code) {\r\n        // TODO add shift/non-shift to slow down or speed up the rotation instead of stop.\r\n        case 'KeyQ': // Rotation counter-clockwise\r\n            rotationDirection = ROTATION_DIRECTION.CCW;\r\n        case 'KeyW': // Rotation clockwise\r\n            if (rotationActive) {\r\n                fractalApp.stopCurrentRotationAnimation();\r\n                rotationActive = false;\r\n            } else {\r\n                rotationActive = true;\r\n                await fractalApp.animateInfiniteRotation(rotationDirection, rotationSpeed);\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyE': // Debug lines\r\n            toggleCenterLines();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyR': // Reset\r\n            if (event.shiftKey) await reset();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyL': // DEBUG BAR toggle\r\n            toggleDebugMode();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyZ': // Switch between fractals with constant p/c\r\n            if (!FF_PERSISTENT_FRACTAL_SWITCHING) break;\r\n\r\n            await switchFractalTypeWithPersistence(isJuliaMode() ? FRACTAL_TYPE.MANDELBROT : FRACTAL_TYPE.JULIA);\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyT': // Random colors / cycle palettes\r\n            if (altKey) {\r\n                // Alt+T: Reset to first palette\r\n                if (isJuliaMode() && fractalApp.PALETTES?.length > 0) {\r\n                    await fractalApp.applyPaletteByIndex(0, 250, updateColorTheme);\r\n                    updatePaletteDropdownState();\r\n                } else {\r\n                    await fractalApp.animateColorPaletteTransition(\r\n                        DEFAULT_MANDELBROT_THEME_COLOR,\r\n                        250,\r\n                        updateColorTheme);\r\n                }\r\n            } else if (event.shiftKey) {\r\n                // Shift+T: Cycle through color space\r\n                if (fractalApp.currentColorAnimationFrame) {\r\n                    fractalApp.stopCurrentColorAnimations();\r\n                    break;\r\n                }\r\n                await fractalApp.animateFullColorSpaceCycle(isJuliaMode() ? 10000 : 15000, updateColorTheme);\r\n            } else {\r\n                // T: Randomize / cycle palettes\r\n                await randomizeColors();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyA': // Forced resize\r\n            fractalApp.resizeCanvas();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyS': // Screenshot\r\n            if (event.shiftKey) captureScreenshot();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyD': // Start/stop demo\r\n            await toggleDemo();\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyM': // Riemann Mode\r\n            if (DEBUG_MODE === DEBUG_LEVEL.FULL) await switchFractalMode(FRACTAL_TYPE.RIEMANN);\r\n            handled = true;\r\n            break;\r\n\r\n        case 'KeyN':\r\n            if (DEBUG_MODE) {\r\n                log('Analytic Extension toggled.');\r\n                fractalApp.useAnalyticExtension = !fractalApp.useAnalyticExtension;\r\n                fractalApp.draw();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowLeft\":\r\n            deltaPanX = altKey ? 0 : -(event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCx = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : 1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowRight\":\r\n            deltaPanX = altKey ? 0 : (event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCx = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? -JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : -1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowDown\":\r\n            deltaPanY = altKey ? 0 : -(event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCy = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? -JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : -1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"ArrowUp\":\r\n            deltaPanY = altKey ? 0 : (event.shiftKey ? PAN_SMOOTH_STEP : PAN_STEP);\r\n            deltaCy = altKey ? (JULIA_HOTKEY_C_STEP * (event.shiftKey ? JULIA_HOTKEY_C_SMOOTH_MULTIPLIER : 1)) : 0;\r\n            handled = true;\r\n            break;\r\n\r\n        case \"Space\":\r\n            const increment = event.shiftKey ? ZOOM_ANIMATION_SMOOTH_STEP : ZOOM_ANIMATION_STEP;\r\n            const zoomFactor = (event.ctrlKey || altKey) ? (1 + increment) : (1 - increment);\r\n\r\n            let targetZoom = fractalApp.zoom * zoomFactor;\r\n\r\n            if (targetZoom >= fractalApp.MAX_ZOOM && targetZoom <= fractalApp.MIN_ZOOM) {\r\n                // Use animateZoomToNoPan to preserve DD pan precision at deep zooms\r\n                await fractalApp.animateZoomToNoPan(targetZoom, 20);\r\n                resetAppState();\r\n            }\r\n            handled = true;\r\n            break;\r\n\r\n        case \"Enter\":\r\n            toggleHeader();\r\n            handled = true;\r\n            break;\r\n\r\n        default: // Case nums and others:\r\n            const match = event.code.match(/^(Digit|Numpad)(\\d)$/);\r\n            if (match) {\r\n                const index = parseInt(match[2], 0); // match[2] contains the digit pressed\r\n                if (event.shiftKey && isJuliaMode()) {\r\n                    await startJuliaDive(fractalApp.DIVES, index);\r\n                } else {\r\n                    await travelToPreset(fractalApp.PRESETS, index);\r\n                }\r\n                handled = true;\r\n            }\r\n            break;\r\n    }\r\n\r\n    // Handling pan changes\r\n    if (deltaPanX || deltaPanY) {\r\n        let r = fractalApp.rotation;\r\n\r\n        // Reflect the zoom factor for consistent pan speed at different zoom levels\r\n        const effectiveDeltaX = (deltaPanX * fractalApp.zoom) * Math.cos(r) - (deltaPanY * fractalApp.zoom) * Math.sin(r);\r\n        const effectiveDeltaY = (deltaPanX * fractalApp.zoom) * Math.sin(r) + (deltaPanY * fractalApp.zoom) * Math.cos(r);\r\n\r\n        await fractalApp.animatePanBy([effectiveDeltaX, effectiveDeltaY], PAN_SPEED);\r\n        fractalApp.noteInteraction(160);\r\n\r\n        resetAppState();\r\n    }\r\n\r\n    // Handling C changes\r\n    if ((deltaCx || deltaCy) && isJuliaMode()) {\r\n        const effectiveDeltaCx = deltaCx * fractalApp.zoom;\r\n        const effectiveDeltaCy = deltaCy * fractalApp.zoom;\r\n\r\n        await fractalApp.animateToC([fractalApp.c[0] + effectiveDeltaCx, fractalApp.c[1] + effectiveDeltaCy], JULIA_HOTKEY_C_SPEED);\r\n        resetAppState();\r\n    }\r\n\r\n    if (handled) {\r\n        event.preventDefault();\r\n    }\r\n}\r\n\r\n/**\r\n * Initializes the keyboard event listener\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initHotKeys(app) {\r\n    if (initialized) {\r\n        console.warn(`%c initHotKeys: %c Redundant initialization skipped!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = app;\r\n    document.addEventListener(\"keydown\", onKeyDown);\r\n    initialized = true;\r\n\r\n    log('Initialized.', 'initHotKeys');\r\n}\r\n\r\n/** Destructor. Removes event listeners and cleans up */\r\nexport function destroyHotKeys() {\r\n    if (!initialized) {\r\n        console.warn(`%c destroyHotKeys: %c Nothing to destroy!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = null;\r\n    initialized = false;\r\n\r\n    document.removeEventListener(\"keydown\", onKeyDown);\r\n\r\n    console.log(`%c destroyHotKeys: %c Destroyed.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}","import FractalRenderer from \"./fractalRenderer\";\r\nimport {asyncDelay, compareComplex, ddSubDD, hsbToRgb, normalizeRotation, splitFloat} from \"../global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, EASE_TYPE, log, PI} from \"../global/constants\";\r\nimport presetsData from '../data/mandelbrot.json' with {type: 'json'};\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/mandelbrot.frag';\r\n\r\n/**\r\n * MandelbrotRenderer (Rebased Perturbation)\r\n *\r\n * @author Radim Brnka\r\n * @description This module defines a MandelbrotRenderer class that inherits from fractalRenderer, implements the shader fragment code for the Mandelbrot set fractal and sets preset zoom-ins.\r\n * @extends FractalRenderer\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nclass MandelbrotRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.DEFAULT_PAN = [-0.5, 0];\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]); // sync DD + array\r\n\r\n        // Reference state with DD precision\r\n        this.refPan = [...this.DEFAULT_PAN];\r\n        this.refPanDD = {\r\n            x: { hi: this.DEFAULT_PAN[0], lo: 0 },\r\n            y: { hi: this.DEFAULT_PAN[1], lo: 0 }\r\n        };\r\n        this.orbitDirty = true;\r\n\r\n        /** IMPORTANT: MAX_ITER must remain constant after shader compilation + orbit buffer allocation. */\r\n        this.MAX_ITER = 5000;\r\n\r\n        // Reference search parameters (for perturbation rebasing)\r\n        this.REF_SEARCH_GRID = 7;\r\n        this.REF_SEARCH_RADIUS = 0.50;\r\n\r\n        // Hysteresis state for rebasing\r\n        this.rebaseArmed = true;\r\n\r\n        // WebGL resources\r\n        this.orbitTex = null;\r\n        this.orbitData = null;\r\n        this.floatTexExt = null;\r\n\r\n        /** Mandelbrot-specific presets */\r\n        this.PRESETS = presetsData.presets;\r\n\r\n        /**\r\n         * @type {Array.<PALETTE>}\r\n         * @description Palettes loaded from JSON (empty = random only)\r\n         */\r\n        this.PALETTES = presetsData.palettes || [];\r\n        this.currentPaletteIndex = -1; // -1 means \"random\"\r\n\r\n        this.init();\r\n    }\r\n\r\n    markOrbitDirty = () => this.orbitDirty = true;\r\n\r\n    /**\r\n     * Called by FractalRenderer.initGLProgram() after program creation + common uniform cache.\r\n     * Creates float texture, allocates orbit buffer, and binds texture unit.\r\n     */\r\n    onProgramCreated() {\r\n        this.floatTexExt = this.gl.getExtension(\"OES_texture_float\");\r\n        if (!this.floatTexExt) {\r\n            console.error('Missing OES_texture_float. Perturbation orbit texture upload requires it.');\r\n            return;\r\n        }\r\n\r\n        this.orbitTex = this.gl.createTexture();\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n\r\n        this.orbitData = new Float32Array(this.MAX_ITER * 4);\r\n\r\n        // Shader expects orbit sampler in unit 0\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n\r\n        this.orbitDirty = true;\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.replace('__MAX_ITER__', this.MAX_ITER).toString();\r\n    }\r\n\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        // delta pan hi/lo (viewPan - refPan, computed on JS side for precision)\r\n        this.deltaPanHLoc = this.gl.getUniformLocation(this.program, 'u_delta_pan_h');\r\n        this.deltaPanLLoc = this.gl.getUniformLocation(this.program, 'u_delta_pan_l');\r\n\r\n        // zoom hi/lo\r\n        this.zoomHLoc = this.gl.getUniformLocation(this.program, 'u_zoom_h');\r\n        this.zoomLLoc = this.gl.getUniformLocation(this.program, 'u_zoom_l');\r\n\r\n        // orbit texture uniforms\r\n        this.orbitTexLoc = this.gl.getUniformLocation(this.program, 'u_orbitTex');\r\n        this.orbitWLoc = this.gl.getUniformLocation(this.program, 'u_orbitW');\r\n    }\r\n\r\n    /** Reference picking + orbit build */\r\n    escapeItersDouble(cx, cy, iters) {\r\n        let zx = 0.0, zy = 0.0;\r\n        for (let i = 0; i < iters; i++) {\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2;\r\n            zy = zy2;\r\n            if (zx * zx + zy * zy > 4.0) return i;\r\n        }\r\n        return iters;\r\n    }\r\n\r\n    /**\r\n     * Choose a good refPan near view center:\r\n     * - sample a grid around view center (radius scales with zoom)\r\n     * - pick the point with the highest escape iteration (prefer inside / late escape)\r\n     * - prefer keeping the current reference to avoid jitter unless a significantly better one is found\r\n     * @param {boolean} useViewCenter - If true, skip grid search and use view center directly (for stability during interaction)\r\n     */\r\n    pickReferenceNearViewCenter(useViewCenter = false) {\r\n        // During interaction, use view center directly to prevent jitter from grid search\r\n        // Copy DD components to preserve deep zoom precision\r\n        if (useViewCenter) {\r\n            this.refPan[0] = this.pan[0];\r\n            this.refPan[1] = this.pan[1];\r\n            this.refPanDD.x.hi = this.panDD.x.hi;\r\n            this.refPanDD.x.lo = this.panDD.x.lo;\r\n            this.refPanDD.y.hi = this.panDD.y.hi;\r\n            this.refPanDD.y.lo = this.panDD.y.lo;\r\n            return;\r\n        }\r\n\r\n        const grid = this.REF_SEARCH_GRID;\r\n        const half = (grid - 1) / 2;\r\n        const step = (2.0 * this.REF_SEARCH_RADIUS) / (grid - 1);\r\n\r\n        const base = this.zoom; // scale offsets by current zoom\r\n\r\n        const probeIters = Math.min(this.MAX_ITER, Math.max(200, Math.floor(this.iterations)));\r\n\r\n        // Evaluate current reference point's score (if we have one within reasonable distance)\r\n        let currentRefScore = -1;\r\n        const currentRefDist = Math.hypot(this.refPan[0] - this.pan[0], this.refPan[1] - this.pan[1]);\r\n        const maxRefDist = base * this.REF_SEARCH_RADIUS * 2.5; // Allow some margin beyond search radius\r\n\r\n        if (currentRefDist < maxRefDist) {\r\n            currentRefScore = this.escapeItersDouble(this.refPan[0], this.refPan[1], probeIters);\r\n        }\r\n\r\n        // Start with view center as fallback\r\n        let bestCx = this.pan[0];\r\n        let bestCy = this.pan[1];\r\n        let bestScore = this.escapeItersDouble(this.pan[0], this.pan[1], probeIters);\r\n\r\n        for (let j = 0; j < grid; j++) {\r\n            for (let i = 0; i < grid; i++) {\r\n                const ox = (i - half) * step;\r\n                const oy = (j - half) * step;\r\n                const cx = this.pan[0] + ox * base;\r\n                const cy = this.pan[1] + oy * base;\r\n\r\n                const score = this.escapeItersDouble(cx, cy, probeIters);\r\n                if (score > bestScore) {\r\n                    bestScore = score;\r\n                    bestCx = cx;\r\n                    bestCy = cy;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Stability: only switch reference if the new one is significantly better.\r\n        // This prevents jitter from small score differences between frames.\r\n        // Require at least 10% improvement or 50 iterations better to switch.\r\n        const improvementThreshold = Math.max(currentRefScore * 0.10, 50);\r\n        const shouldSwitch = currentRefScore < 0 || (bestScore - currentRefScore) > improvementThreshold;\r\n\r\n        if (shouldSwitch) {\r\n            this.refPan[0] = bestCx;\r\n            this.refPan[1] = bestCy;\r\n            // New reference point from grid search - no DD precision accumulated yet\r\n            this.refPanDD.x.hi = bestCx;\r\n            this.refPanDD.x.lo = 0;\r\n            this.refPanDD.y.hi = bestCy;\r\n            this.refPanDD.y.lo = 0;\r\n        }\r\n        // else: keep current refPan for stability\r\n\r\n        this.bestScore = bestScore;\r\n        this.probeIters = probeIters;\r\n    }\r\n\r\n    computeReferenceOrbit() {\r\n        if (!this.orbitData || !this.orbitTex) return;\r\n\r\n        const cx = this.refPan[0];\r\n        const cy = this.refPan[1];\r\n\r\n        let zx = 0.0, zy = 0.0;\r\n\r\n        for (let n = 0; n < this.MAX_ITER; n++) {\r\n            const sx = splitFloat(zx);\r\n            const sy = splitFloat(zy);\r\n\r\n            const idx = n * 4;\r\n            this.orbitData[idx] = sx.high;\r\n            this.orbitData[idx + 1] = sx.low;\r\n            this.orbitData[idx + 2] = sy.high;\r\n            this.orbitData[idx + 3] = sy.low;\r\n\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2;\r\n            zy = zy2;\r\n\r\n            if (zx * zx + zy * zy > 4.0) {\r\n                // Fill remainder with last value (keeps texture defined)\r\n                const fx = splitFloat(zx);\r\n                const fy = splitFloat(zy);\r\n                for (let k = n + 1; k < this.MAX_ITER; k++) {\r\n                    const j = k * 4;\r\n                    this.orbitData[j] = fx.high;\r\n                    this.orbitData[j + 1] = fx.low;\r\n                    this.orbitData[j + 2] = fy.high;\r\n                    this.orbitData[j + 3] = fy.low;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        // Upload 1D orbit texture: width=MAX_ITER, height=1\r\n        this.gl.texImage2D(\r\n            this.gl.TEXTURE_2D,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.MAX_ITER,\r\n            1,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.gl.FLOAT,\r\n            this.orbitData\r\n        );\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Iteration strategy avoids exploding to infinity at tiny zooms\r\n        // TODO Tune! main point is: clamp to MAX_ITER.\r\n        const safe = Math.max(this.zoom, 1e-300);\r\n        const log2Depth = Math.log2(this.DEFAULT_ZOOM / safe);\r\n        const baseIters = Math.floor(200 + 50 * log2Depth);\r\n        this.iterations = Math.max(50, Math.min(this.MAX_ITER, baseIters + this.extraIterations));\r\n\r\n        const mustRebaseNow = this.needsRebase();\r\n        const canRebaseNow = !this.interactionActive || mustRebaseNow;\r\n\r\n        if (this.orbitDirty && canRebaseNow) {\r\n            this.pickReferenceNearViewCenter();\r\n            this.computeReferenceOrbit();\r\n            this.orbitDirty = false;\r\n        }\r\n\r\n        // Compute deltaPan = panDD - refPanDD on JS side (float64) for precision\r\n        // This avoids float32 precision loss when the shader subtracts viewPan - refPan\r\n        const deltaPanX = ddSubDD(this.panDD.x, this.refPanDD.x);\r\n        const deltaPanY = ddSubDD(this.panDD.y, this.refPanDD.y);\r\n\r\n        // Upload deltaPan hi/lo\r\n        if (this.deltaPanHLoc) this.gl.uniform2f(this.deltaPanHLoc, deltaPanX.hi, deltaPanY.hi);\r\n        if (this.deltaPanLLoc) this.gl.uniform2f(this.deltaPanLLoc, deltaPanX.lo, deltaPanY.lo);\r\n\r\n        // Upload zoom hi/lo\r\n        const z = splitFloat(this.zoom);\r\n        if (this.zoomHLoc) this.gl.uniform1f(this.zoomHLoc, z.high);\r\n        if (this.zoomLLoc) this.gl.uniform1f(this.zoomLLoc, z.low);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    needsRebase() {\r\n        const dx = this.pan[0] - this.refPan[0];\r\n        const dy = this.pan[1] - this.refPan[1];\r\n\r\n        // Rebase threshold is proportional to zoom (view scale).\r\n        // 0.75 is consistent with the Julia policy.\r\n        return Math.hypot(dx, dy) > this.zoom * 0.75;\r\n    }\r\n\r\n    // region > ANIMATION METHODS\r\n\r\n    /**\r\n     * Applies a specific palette by index\r\n     * @param {number} index - Palette index (-1 for random)\r\n     * @param {number} [duration=250] - Transition duration in ms\r\n     * @param {Function} [coloringCallback] - Callback when done\r\n     * @return {Promise<void>}\r\n     */\r\n    async applyPaletteByIndex(index, duration = 250, coloringCallback = null) {\r\n        this.currentPaletteIndex = index;\r\n        // Always use random for Mandelbrot (index -1 or if no palettes)\r\n        await this.animateColorPaletteTransition(null, duration, coloringCallback);\r\n    }\r\n\r\n    async animateColorPaletteTransition(newPalette, duration = 250, coloringCallback = null) {\r\n        const clamp = (x, a, b) => Math.max(a, Math.min(b, x));\r\n\r\n        // Robustly normalize whatever hsbToRgb returns:\r\n        // - [r,g,b] or {r,g,b}\r\n        // - either in 0..1 or 0..255\r\n        const normalizeRgb = (c) => {\r\n            let r, g, b;\r\n            if (Array.isArray(c)) [r, g, b] = c;\r\n            else ({r, g, b} = c);\r\n\r\n            // If it looks like 0..255, normalize.\r\n            if (r > 1 || g > 1 || b > 1) {\r\n                r /= 255;\r\n                g /= 255;\r\n                b /= 255;\r\n            }\r\n            return [r, g, b];\r\n        };\r\n\r\n        // Generate a vivid hue in HSV, but output as a MULTIPLIER palette:\r\n        // values intentionally > 1 to keep results bright after multiplication.\r\n        const randomBrightMultiplierPalette = () => {\r\n            const hue = Math.random();\r\n            const sat = 0.85 + Math.random() * 0.15; // vivid\r\n            const val = 0.90 + Math.random() * 0.10; // bright\r\n\r\n            let [r, g, b] = normalizeRgb(hsbToRgb(hue, sat, val));\r\n\r\n            // Avoid palettes that are effectively gray multipliers (kills vividness)\r\n            const maxCh = Math.max(r, g, b);\r\n            const minCh = Math.min(r, g, b);\r\n            const chroma = maxCh - minCh;\r\n            if (chroma < 0.25) {\r\n                // force a more saturated hue by nudging channels\r\n                r = clamp(r * 1.15, 0, 1);\r\n                g = clamp(g * 1.15, 0, 1);\r\n                b = clamp(b * 1.15, 0, 1);\r\n            }\r\n\r\n            // Convert 0..1 RGB into a \"gain\" (multiplier) palette.\r\n            // Base gain keeps everything bright; color gain adds hue tint.\r\n            const baseGain = 1.20 + Math.random() * 0.50; // 1.20..1.70\r\n            const colorGain = 0.90 + Math.random() * 1.10; // 0.90..2.00\r\n\r\n            // Lift darker channels so no channel is near-zero multiplier (avoids dim output).\r\n            const lift = 0.25;\r\n\r\n            return [\r\n                baseGain + (lift + r * (1 - lift)) * colorGain,\r\n                baseGain + (lift + g * (1 - lift)) * colorGain,\r\n                baseGain + (lift + b * (1 - lift)) * colorGain,\r\n            ];\r\n        };\r\n\r\n        newPalette ||= randomBrightMultiplierPalette();\r\n        await super.animateColorPaletteTransition(newPalette, duration, coloringCallback);\r\n    }\r\n\r\n    /**\r\n     * Animates travel to a preset. It first zooms out to the default zoom, then rotates, then animates pan and zoom-in.\r\n     * If any of the final params is the same as the target, it won't animate it.\r\n     *\r\n     * @param {MANDELBROT_PRESET} preset An instance-specific object to define exact spot in the fractal\r\n     * @param {number} [zoomOutDuration=2000] Duration (ms) for zoom-out stage\r\n     * @param {number} [panDuration=1000] Duration (ms) for pan stage\r\n     * @param {number} [zoomInDuration=3500] Duration (ms) for zoom-in stage\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateTravelToPreset(preset, zoomOutDuration = 2000, panDuration = 1000, zoomInDuration = 3500) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateTravelToPreset`, CONSOLE_GROUP_STYLE);\r\n        log(`Traveling to preset: ${JSON.stringify(preset)}`);\r\n\r\n        const presetRotation = normalizeRotation(preset.rotation ?? this.DEFAULT_ROTATION);\r\n\r\n        // Check if we're already at the target\r\n        const atTargetZoom = Math.abs(this.zoom - preset.zoom) < 1e-35;\r\n        const atTargetPan = compareComplex(preset.pan, this.pan);\r\n\r\n        if (atTargetZoom && atTargetPan) {\r\n            // Only need to rotate\r\n            await this.animateRotationTo(presetRotation, zoomOutDuration, EASE_TYPE.QUINT);\r\n        } else if (atTargetPan) {\r\n            // Same position, just zoom and rotate with cinematic spin\r\n            const extraSpins = (Math.random() > 0.5 ? 1 : -1) * (PI * 2 + Math.random() * PI * 2);\r\n            const cinematicRotation = presetRotation + extraSpins;\r\n            await this.animateZoomRotationTo(preset.zoom, cinematicRotation, zoomInDuration * (preset.speed ?? 1), EASE_TYPE.QUINT);\r\n        } else {\r\n            // Full 3-stage cinematic animation:\r\n\r\n            // Stage 1: Zoom out to default zoom with random rotation (if significantly zoomed in)\r\n            const needsZoomOut = this.zoom < this.DEFAULT_ZOOM * 0.9;\r\n            if (needsZoomOut) {\r\n                const zoomOutRotation = this.rotation + (Math.random() * PI * 2 - PI);\r\n                await this.animateZoomRotationTo(this.DEFAULT_ZOOM, zoomOutRotation, zoomOutDuration, EASE_TYPE.QUINT);\r\n            }\r\n\r\n            // Stage 2: Pan to target coordinates\r\n            await this.animatePanTo(preset.pan, panDuration, EASE_TYPE.CUBIC);\r\n\r\n            // Stage 3: Zoom in with cinematic rotation (1-2 extra spins ending at preset rotation)\r\n            const extraSpins = (Math.random() > 0.5 ? 1 : -1) * (PI * 2 + Math.random() * PI * 2);\r\n            const cinematicFinalRotation = presetRotation + extraSpins;\r\n            await this.animateZoomRotationTo(preset.zoom, cinematicFinalRotation, zoomInDuration * (preset.speed ?? 1), EASE_TYPE.NONE);\r\n        }\r\n\r\n        this.currentPresetIndex = preset.id || 0;\r\n\r\n        console.log(`Travel complete.`);\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates infinite demo loop of traveling to the presets\r\n     * @param {boolean} random Determines whether presets are looped in order from 1-9 or ordered randomly\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDemo(random = true) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateDemo`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        if (!this.PRESETS.length) {\r\n            console.warn('No presets defined for Mandelbrot mode ');\r\n            return;\r\n        }\r\n\r\n        this.demoActive = true;\r\n\r\n        const getNextPresetIndex = (random) => {\r\n            if (random) {\r\n                let index;\r\n                do {\r\n                    index = Math.floor(Math.random() * this.PRESETS.length);\r\n                } while (index === this.currentPresetIndex || index === 0);\r\n                return index;\r\n            } else {\r\n                // Sequential: increment index, but if it wraps to 0, skip to 1.\r\n                const nextIdx = (this.currentPresetIndex + 1) % this.PRESETS.length;\r\n                return nextIdx === 0 ? 1 : nextIdx;\r\n            }\r\n        };\r\n\r\n        // Continue cycling through presets while demo is active.\r\n        while (this.demoActive) {\r\n            this.currentPresetIndex = getNextPresetIndex(random);\r\n            const currentPreset = this.PRESETS[this.currentPresetIndex];\r\n            console.log(`Animating to preset ${this.currentPresetIndex}`);\r\n\r\n            await this.animateTravelToPreset(currentPreset, 3000, 1000, 3000);\r\n            await asyncDelay(3500);\r\n        }\r\n\r\n        console.log(`Demo interrupted.`);\r\n        console.groupEnd();\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}\r\n\r\nexport default MandelbrotRenderer","import FractalRenderer from \"./fractalRenderer\";\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/riemann.frag';\r\n\r\nclass RiemannRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.termCount = 10000;\r\n        this.MIN_ZOOM = 4000;\r\n\r\n        this.useAnalyticExtension = true;\r\n\r\n        this.init();\r\n    }\r\n\r\n    updateUniforms() {\r\n        this.termCountLoc = this.gl.getUniformLocation(this.program, 'u_termCount');\r\n        this.useAnalyticExtensionLoc = this.gl.getUniformLocation(this.program, 'u_useAnalyticExtension');\r\n\r\n        super.updateUniforms();\r\n    }\r\n\r\n    draw() {\r\n        this.gl.uniform1i(this.termCountLoc, this.termCount);\r\n        this.gl.uniform1i(this.useAnalyticExtensionLoc, this.useAnalyticExtension ? 1 : 0);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw;\r\n\r\n    }\r\n\r\n    onProgramCreated() {\r\n\r\n    }\r\n\r\n    needsRebase() {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nexport default RiemannRenderer;","/**\r\n * @module JuliaSlidersController\r\n * @author Radim Brnka\r\n * @description Controller of Julia slider elements directly interacting with the c-value of Julia fractal.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE} from \"../global/constants\";\r\nimport {isJuliaMode, resetPresetAndDiveButtonStates, updateInfo} from \"./ui\";\r\nimport {clearURLParams} from \"../global/utils\";\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\n\r\n/**\r\n * Throttle limit in milliseconds.\r\n * 50ms = 20 updates/sec - smooth enough for visual feedback, reduces DOM thrash during animations.\r\n * @type {number}\r\n */\r\nconst SLIDER_UPDATE_THROTTLE_LIMIT = 50;\r\n\r\nlet sliderContainer;\r\nlet realSlider;\r\nlet imagSlider;\r\nlet realSliderValue;\r\nlet imagSliderValue;\r\nlet lastSliderUpdate = 0; // Tracks the last time the sliders were updated\r\n\r\nlet fractalApp;\r\n\r\n/**\r\n * Initializes the elements and their event listeners\r\n * @param {FractalRenderer} app\r\n */\r\nexport function initJuliaSliders(app) {\r\n    if (!(app instanceof JuliaRenderer)) {\r\n        console.error(`%c initJuliaSliders: %c Can only attach to JuliaRenderer, not ${app}!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    fractalApp = app;\r\n\r\n    realSlider = document.getElementById('realSlider');\r\n    realSliderValue = document.getElementById('realSliderValue');\r\n    imagSlider = document.getElementById('imagSlider');\r\n    imagSliderValue = document.getElementById('imagSliderValue');\r\n\r\n    realSlider.addEventListener('input', onRealSliderChange);\r\n    imagSlider.addEventListener('input', onImagSliderChange);\r\n\r\n    sliderContainer = document.getElementById('sliders');\r\n    sliderContainer.style.display = 'flex';\r\n\r\n    console.log(`%c initJuliaSliders: %c Initialized.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n}\r\n\r\nfunction onSliderChangeFinished() {\r\n    fractalApp.draw();\r\n    updateInfo();\r\n    clearURLParams();\r\n    resetPresetAndDiveButtonStates();\r\n    fractalApp.demoTime = 0;\r\n}\r\n\r\nconst onRealSliderChange = () => {\r\n    fractalApp.c[0] = parseFloat(realSlider.value);\r\n    // Increased to 4 decimals to match the new step\r\n    realSliderValue.textContent = fractalApp.c[0].toFixed(4);\r\n    onSliderChangeFinished();\r\n};\r\n\r\nconst onImagSliderChange = () => {\r\n    fractalApp.c[1] = parseFloat(imagSlider.value);\r\n    // Using 4 decimals and template literals for cleaner code\r\n    imagSliderValue.textContent = `${fractalApp.c[1].toFixed(4)}i`;\r\n    onSliderChangeFinished();\r\n};\r\n\r\n// region > External methods ------------------------------------------------------------------------------------------\r\n/** Destructor. Removes listeners and hides elements. */\r\nexport function destroyJuliaSliders() {\r\n    if (realSlider && imagSlider && sliderContainer) {\r\n        realSlider.removeEventListener('input', onRealSliderChange);\r\n        imagSlider.removeEventListener('input', onImagSliderChange);\r\n\r\n        sliderContainer.style.display = 'none';\r\n\r\n        console.log(`%c destroyJuliaSliders: %c Destroyed.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    } else {\r\n        console.warn(`%c destroyJuliaSliders: %c Called on not initialized state!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    }\r\n}\r\n\r\n/** Resets sliders */\r\nexport function resetJuliaSliders() {\r\n    if (!isJuliaMode()) {\r\n        console.warn(`%c resetJuliaSliders: %c Not in Julia mode!`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    realSlider.value = parseFloat(fractalApp.c[0].toFixed(2));\r\n    imagSlider.value = parseFloat(fractalApp.c[1].toFixed(2));\r\n    realSliderValue.innerText = realSlider.value;\r\n    imagSliderValue.innerText = imagSlider.value + 'i';\r\n    fractalApp.demoTime = 0;\r\n}\r\n\r\n/** Updates the real/imaginary sliders appropriately */\r\nexport function updateJuliaSliders() {\r\n    const now = performance.now();\r\n    const timeSinceLastUpdate = now - lastSliderUpdate;\r\n\r\n    if (timeSinceLastUpdate < SLIDER_UPDATE_THROTTLE_LIMIT) {\r\n        return; // Skip update if called too soon\r\n    }\r\n\r\n    // Update the last update time\r\n    lastSliderUpdate = now;\r\n    realSliderValue.innerText = fractalApp.c[0].toFixed(4);\r\n    imagSliderValue.innerText = fractalApp.c[1].toFixed(4) + 'i';\r\n    realSlider.value = parseFloat(fractalApp.c[0].toFixed(4));\r\n    imagSlider.value = parseFloat(fractalApp.c[1].toFixed(4));\r\n}\r\n\r\n/** Disable slider controls */\r\nexport const disableJuliaSliders = () => {\r\n    imagSlider.disabled = realSlider.disabled = true;\r\n    realSlider.classList.add('thumbDisabled');\r\n    imagSlider.classList.add('thumbDisabled');\r\n};\r\n\r\n/** Enable slider controls */\r\nexport const enableJuliaSliders = () => {\r\n    imagSlider.disabled = realSlider.disabled = false;\r\n    realSlider.classList.remove('thumbDisabled');\r\n    imagSlider.classList.remove('thumbDisabled');\r\n};\r\n\r\n// endregion -----------------------------------------------------------------------------------------------------------","import {ddValue, isTouchDevice} from \"../global/utils\";\r\nimport {log, LOG_LEVEL} from \"../global/constants\";\r\nimport {getFractalMode, isJuliaMode} from \"./ui\";\r\n\r\n/**\r\n * Debug Panel\r\n *\r\n * @author Radim Brnka\r\n * @description Provides an on-screen debugging panel for monitoring real-time application performance,\r\n * GPU capabilities, and rendering diagnostics related to WebGL fractal rendering.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nexport class DebugPanel {\r\n\r\n    panelSelector = 'debugInfo';\r\n\r\n    constructor(canvas, fractalApp) {\r\n        this.canvas = canvas;\r\n        this.fractalApp = fractalApp;\r\n        this.gl = fractalApp?.gl;\r\n\r\n        this.debugInfo = document.getElementById(this.panelSelector);\r\n        if (!this.debugInfo) {\r\n            console.warn(`DebugPanel: #${this.panelSelector} element not found.`);\r\n            return;\r\n        }\r\n\r\n        if (isTouchDevice()) {\r\n            let lastTap = 0;\r\n            this.debugInfo.addEventListener(\"pointerdown\", (e) => {\r\n                const now = Date.now();\r\n                if (now - lastTap < 300) { // Double tap detected\r\n                    this.toggle();\r\n                }\r\n                lastTap = now;\r\n                e.preventDefault();\r\n            });\r\n        }\r\n\r\n        this.debugInfo.addEventListener(\"auxclick\", (event) => {\r\n            if (event.button === 1) {\r\n                console.group('> DEBUG PANEL DUMP');\r\n                log(this.debugInfo.innerText, this.constructor.name, LOG_LEVEL.DEBUG);\r\n                console.groupEnd();\r\n\r\n                let dump = this.debugInfo.innerText.substring(this.debugInfo.innerText.indexOf('FRAG'));\r\n\r\n                navigator.clipboard.writeText(dump).then(function () {\r\n                    console.log('Debug dump copied to clipboard!');\r\n                }, function (err) {\r\n                    console.error('Debug dump not copied to clipboard! ' + err.toString());\r\n                });\r\n            }\r\n        });\r\n\r\n        // ---- Extensions / GPU info (cached) ----\r\n        this.extTimer =\r\n            this.gl?.getExtension(\"EXT_disjoint_timer_query\") ||\r\n            this.gl?.getExtension(\"EXT_disjoint_timer_query_webgl2\") ||\r\n            null;\r\n\r\n        // Renderer info (optional, blocked in some browsers unless allowed)\r\n        this.extRendererInfo =\r\n            this.gl?.getExtension(\"WEBGL_debug_renderer_info\") || null;\r\n\r\n        this.gpu = {\r\n            vendor: \"unknown\",\r\n            renderer: \"unknown\",\r\n            unmaskedVendor: null,\r\n            unmaskedRenderer: null,\r\n            webglVersion: \"unknown\",\r\n            shadingLanguageVersion: \"unknown\",\r\n            maxTextureSize: null,\r\n            maxVaryings: null,\r\n            maxFragUniforms: null,\r\n            maxVertUniforms: null,\r\n            maxViewportDims: null,\r\n        };\r\n\r\n        this._initGpuInfo();\r\n\r\n        // ---- Persistent perf state ----\r\n        this.perf = {\r\n            // rAF timing\r\n            lastRafTs: performance.now(),\r\n            fps: 0,\r\n            frameMs: 0,\r\n            frameMsSmoothed: NaN,\r\n\r\n            // CPU timing of this panel update itself (not your fractal draw)\r\n            panelCpuMs: 0,\r\n            panelCpuMsSmoothed: NaN,\r\n\r\n            // GPU timing via timer query (requires beginGpuTimer/endGpuTimer around draw)\r\n            gpuSupported: !!this.extTimer,\r\n            gpuMs: NaN,\r\n            gpuMsSmoothed: NaN,\r\n            gpuDisjoint: false,\r\n\r\n            // Timer query bookkeeping\r\n            queryInFlight: null,\r\n            pendingQueries: [],\r\n        };\r\n\r\n        // Toggle visibility on creation\r\n        this.toggle();\r\n\r\n        // Bind-safe update loop\r\n        requestAnimationFrame(this.update);\r\n    }\r\n\r\n    setRenderer(renderer) {\r\n        this.fractalApp = renderer || null;\r\n        this.gl = renderer?.gl || null;\r\n\r\n        // refresh cached precision safely\r\n        this.precisionInfo = null;\r\n        const gl = this.gl;\r\n        if (gl && typeof gl.getShaderPrecisionFormat === \"function\") {\r\n            const hp = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n            this.precisionInfo = hp\r\n                ? {precision: hp.precision, rangeMin: hp.rangeMin, rangeMax: hp.rangeMax}\r\n                : null;\r\n        }\r\n    }\r\n\r\n    _initGpuInfo() {\r\n        const gl = this.gl;\r\n        if (!gl) return;\r\n\r\n        try {\r\n            this.gpu.webglVersion = gl.getParameter(gl.VERSION) || \"unknown\";\r\n            this.gpu.shadingLanguageVersion =\r\n                gl.getParameter(gl.SHADING_LANGUAGE_VERSION) || \"unknown\";\r\n            this.gpu.vendor = gl.getParameter(gl.VENDOR) || \"unknown\";\r\n            this.gpu.renderer = gl.getParameter(gl.RENDERER) || \"unknown\";\r\n\r\n            this.gpu.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n            this.gpu.maxVaryings = gl.getParameter(gl.MAX_VARYING_VECTORS);\r\n            this.gpu.maxFragUniforms = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\r\n            this.gpu.maxVertUniforms = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n            this.gpu.maxViewportDims = gl.getParameter(gl.MAX_VIEWPORT_DIMS);\r\n\r\n            if (this.extRendererInfo) {\r\n                const v = gl.getParameter(\r\n                    this.extRendererInfo.UNMASKED_VENDOR_WEBGL\r\n                );\r\n                const r = gl.getParameter(\r\n                    this.extRendererInfo.UNMASKED_RENDERER_WEBGL\r\n                );\r\n                this.gpu.unmaskedVendor = v || null;\r\n                this.gpu.unmaskedRenderer = r || null;\r\n            }\r\n        } catch (e) {\r\n            // Some browsers throw on blocked params; keep defaults\r\n            console.warn(\"DebugPanel: GPU info query failed:\", e);\r\n        }\r\n    }\r\n\r\n    // ---- GPU timer query helpers ----\r\n    beginGpuTimer() {\r\n        if (!this.extTimer || !this.gl) return;\r\n        if (this.perf.queryInFlight) return; // keep it simple: one in flight\r\n\r\n        // EXT_disjoint_timer_query is async; begin/end must bracket the draw call\r\n        const q = this.extTimer.createQueryEXT();\r\n        this.extTimer.beginQueryEXT(this.extTimer.TIME_ELAPSED_EXT, q);\r\n        this.perf.queryInFlight = q;\r\n    }\r\n\r\n    endGpuTimer() {\r\n        if (!this.extTimer || !this.gl) return;\r\n        if (!this.perf.queryInFlight) return;\r\n\r\n        this.extTimer.endQueryEXT(this.extTimer.TIME_ELAPSED_EXT);\r\n        this.perf.pendingQueries.push(this.perf.queryInFlight);\r\n        this.perf.queryInFlight = null;\r\n    }\r\n\r\n    pollGpuTimers() {\r\n        if (!this.extTimer || !this.gl) return;\r\n\r\n        // disjoint means the result is unreliable (clock reset / driver event)\r\n        const disjoint = this.gl.getParameter(this.extTimer.GPU_DISJOINT_EXT);\r\n        this.perf.gpuDisjoint = !!disjoint;\r\n\r\n        if (this.perf.pendingQueries.length === 0) return;\r\n\r\n        // Read the oldest query only (avoid stalls)\r\n        const q = this.perf.pendingQueries[0];\r\n        const available = this.extTimer.getQueryObjectEXT(\r\n            q,\r\n            this.extTimer.QUERY_RESULT_AVAILABLE_EXT\r\n        );\r\n        if (!available) return;\r\n\r\n        const ns = this.extTimer.getQueryObjectEXT(q, this.extTimer.QUERY_RESULT_EXT);\r\n        this.extTimer.deleteQueryEXT(q);\r\n        this.perf.pendingQueries.shift();\r\n\r\n        if (!this.perf.gpuDisjoint) {\r\n            const ms = ns / 1e6;\r\n            this.perf.gpuMs = ms;\r\n            this.perf.gpuMsSmoothed = this.smooth(this.perf.gpuMsSmoothed, ms, 0.15);\r\n        } else {\r\n            this.perf.gpuMs = NaN;\r\n            // keep previous smoothed value; disjoint is a transient condition\r\n        }\r\n    }\r\n\r\n    smooth(prev, next, alpha) {\r\n        if (!Number.isFinite(next)) return prev;\r\n        if (!Number.isFinite(prev)) return next;\r\n        return prev + (next - prev) * alpha;\r\n    }\r\n\r\n    update = (ts) => {\r\n        if (!this.debugInfo || !this.fractalApp) return;\r\n\r\n        const t0 = performance.now();\r\n\r\n        // Poll GPU timers first (results arrive later)\r\n        this.pollGpuTimers();\r\n\r\n        // rAF timing / FPS\r\n        const dt = ts - this.perf.lastRafTs;\r\n        this.perf.lastRafTs = ts;\r\n        this.perf.frameMs = dt;\r\n        this.perf.frameMsSmoothed = this.smooth(this.perf.frameMsSmoothed, dt, 0.1);\r\n        this.perf.fps = dt > 0 ? 1000 / dt : 0;\r\n\r\n        const dpr = window.devicePixelRatio || 1;\r\n        const rect = this.canvas.getBoundingClientRect();\r\n\r\n        const gl = this.gl;\r\n        if (!gl || typeof gl.getShaderPrecisionFormat !== \"function\") return;\r\n\r\n\r\n        const hp = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n\r\n        const hpInfo = {precision: hp.precision, rangeMin: hp.rangeMin, rangeMax: hp.rangeMax};\r\n\r\n        const viewPanX = ddValue(this.fractalApp.panDD.x);\r\n        const viewPanY = ddValue(this.fractalApp.panDD.y);\r\n        const cx = isJuliaMode() ? this.fractalApp.c[0] : 0;\r\n        const cy = isJuliaMode() ? this.fractalApp.c[1] : 0;\r\n\r\n        const refPanX = this.fractalApp.pan[0];\r\n        const refPanY = this.fractalApp.pan[1];\r\n\r\n        const zoom = this.fractalApp.zoom;\r\n        const safeZoom = Math.max(zoom, 1e-300);\r\n\r\n        // Scale diagnostics\r\n        const pxPerUnit = this.canvas.width / safeZoom;\r\n        const unitPerPx = safeZoom / this.canvas.width;\r\n\r\n        // Precision stress heuristics\r\n        const absPan = Math.hypot(viewPanX, viewPanY);\r\n        const panOverZoom = absPan / safeZoom;\r\n        const mantissaUsedApprox = Math.log2(Math.max(panOverZoom, 1e-300));\r\n\r\n        // Perturbation drift\r\n        const driftAbs = Math.hypot(viewPanX - refPanX, viewPanY - refPanY);\r\n        const driftViewUnits = driftAbs / safeZoom;\r\n\r\n        const orbitStatus = this.fractalApp.orbitDirty ? \"DIRTY\" : \"cached\";\r\n        const zoomBucket = Math.floor(-Math.log10(safeZoom));\r\n\r\n        // ---------- Coloring helpers ----------\r\n        const esc = (s) =>\r\n            String(s)\r\n                .replaceAll(\"&\", \"&amp;\")\r\n                .replaceAll(\"<\", \"&lt;\")\r\n                .replaceAll(\">\", \"&gt;\");\r\n\r\n        const levelClass = (level) => {\r\n            if (level === \"bad\") return \"dbg-bad\";\r\n            if (level === \"warn\") return \"dbg-warn\";\r\n            return \"dbg-ok\";\r\n        };\r\n\r\n        // ---------- Precision health model ----------\r\n        let score = 100;\r\n\r\n        let panLevel = \"ok\";\r\n        if (mantissaUsedApprox > 44) {\r\n            panLevel = \"bad\";\r\n            score -= 40;\r\n        } else if (mantissaUsedApprox > 34) {\r\n            panLevel = \"warn\";\r\n            score -= 20;\r\n        } else if (mantissaUsedApprox > 28) {\r\n            panLevel = \"warn\";\r\n            score -= 10;\r\n        }\r\n\r\n        let driftLevel = \"ok\";\r\n        if (driftViewUnits > 1.0) {\r\n            driftLevel = \"bad\";\r\n            score -= 25;\r\n        } else if (driftViewUnits > 0.5) {\r\n            driftLevel = \"warn\";\r\n            score -= 12;\r\n        } else if (driftViewUnits > 0.25) {\r\n            driftLevel = \"warn\";\r\n            score -= 6;\r\n        }\r\n\r\n        let scaleLevel = \"ok\";\r\n        if (pxPerUnit < 0.75) {\r\n            scaleLevel = \"warn\";\r\n            score -= 10;\r\n        }\r\n        if (pxPerUnit < 0.25) {\r\n            scaleLevel = \"bad\";\r\n            score -= 20;\r\n        }\r\n\r\n        score = Math.max(0, Math.min(100, Math.round(score)));\r\n\r\n        let healthLevel = \"ok\";\r\n        if (score < 70) healthLevel = \"warn\";\r\n        if (score < 45) healthLevel = \"bad\";\r\n\r\n        const worst =\r\n            healthLevel === \"bad\" || healthLevel === \"warn\"\r\n                ? ` (pan:${panLevel}, drift:${driftLevel}, scale:${scaleLevel})`\r\n                : \"\";\r\n\r\n        // ---------- Performance / bottleneck heuristics ----------\r\n        // Typical: if GPU_ms_smooth is close to frame budget, you're GPU-bound.\r\n        const frameBudgetMs = 1000 / 60; // 16.67ms\r\n        const gpuSmooth = this.perf.gpuMsSmoothed;\r\n        const gpuLevel =\r\n            !Number.isFinite(gpuSmooth) ? \"ok\"\r\n                : gpuSmooth > 22 ? \"bad\"\r\n                    : gpuSmooth > 14 ? \"warn\"\r\n                        : \"ok\";\r\n\r\n        const fpsLevel =\r\n            this.perf.fps < 30 ? \"bad\"\r\n                : this.perf.fps < 50 ? \"warn\"\r\n                    : \"ok\";\r\n\r\n        // panel CPU time (debug UI overhead)\r\n        const panelCpuMs = performance.now() - t0;\r\n        this.perf.panelCpuMs = panelCpuMs;\r\n        this.perf.panelCpuMsSmoothed = this.smooth(this.perf.panelCpuMsSmoothed, panelCpuMs, 0.2);\r\n\r\n        const gpuHint =\r\n            this.perf.gpuSupported\r\n                ? (Number.isFinite(gpuSmooth)\r\n                    ? (gpuSmooth > frameBudgetMs ? \"Likely GPU-bound\" : \"GPU OK\")\r\n                    : \"GPU timer available (wrap draw with begin/end)\")\r\n                : \"No GPU timer support\";\r\n\r\n        // ---------- Output ----------\r\n        const gpuVendor =\r\n            this.gpu.unmaskedVendor || this.gpu.vendor || \"unknown\";\r\n        const gpuRenderer =\r\n            this.gpu.unmaskedRenderer || this.gpu.renderer || \"unknown\";\r\n\r\n        this.debugInfo.innerHTML = `\r\n            <span class=\"dbg-title\" id=\"copyDebugInfo\">DEBUG PANEL</span><span class=\"dbg-dim\"> ('L' to toggle, draggable, middle-click to log)</span>|<br/>\r\n            <span class=\"dbg-dim\"></span><br/>\r\n            <span class=\"dbg-title\">FRAG highp</span>: precision=${esc(hpInfo.precision)} range=[${esc(hpInfo.rangeMin)}, ${esc(hpInfo.rangeMax)}]<br/>\r\n            <span class=\"dbg-title\">mode:</span> <span class=\"dbg-dim\">${getFractalMode()}</span> <span class=\"dbg-title\">css</span>=${esc(rect.width.toFixed(1))}x${esc(rect.height.toFixed(1))} <span class=\"dbg-dim\">dpr=${esc(dpr)}<span class=\"dbg-title\"> \r\n            buf</span>=${esc(this.canvas.width)}x${esc(this.canvas.height)}<br/>\r\n            <br/>\r\n            <span class=\"dbg-title\">viewPan</span>=[${esc(viewPanX.toFixed(24))}, ${esc(viewPanY.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">refPan</span>     =[${esc(refPanX.toFixed(24))}, ${esc(refPanY.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">c</span>=[${esc(cx.toFixed(24))}, ${esc(cy.toFixed(24))}]<br/>\r\n            <span class=\"dbg-title\">zoom</span>=${esc(zoom.toFixed(20))}<br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Scale </span><br/>\r\n            zoomExp=[${esc(zoom.toExponential(1))}]  <span class=\"dbg-dim\">zoomBucket=1e-${esc(zoomBucket)}</span><br/>\r\n            px/unit=<span class=\"${levelClass(scaleLevel)}\">${esc(pxPerUnit.toExponential(3))}</span><br/>\r\n            unit/px=<span class=\"${levelClass(scaleLevel)}\">${esc(unitPerPx.toExponential(3))}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Precision Stress (heuristics) </span><br/>\r\n            <span class=\"dbg-title\">iters</span>=${esc(this.fractalApp.iterations.toFixed(0))} (MAX_ITER=${esc(this.fractalApp.MAX_ITER)})<br/>\r\n            Precision health:<span class=\"dbg-badge ${levelClass(healthLevel)}\">${score}/100</span><span class=\"dbg-dim\">${esc(worst)}</span><br/>\r\n            |pan|=${esc(absPan.toExponential(3))}<br/>\r\n            |pan|/zoom=<span class=\"${levelClass(panLevel)}\">${esc(panOverZoom.toExponential(3))}</span><br/>\r\n            log2(|pan|/zoom)<span class=\"${levelClass(panLevel)}\">${esc(mantissaUsedApprox.toFixed(1))}</span> <span class=\"dbg-dim\">(larger  cancellation risk )</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Perturbation </span><br/>\r\n            ref drift (abs)=${esc(driftAbs.toExponential(3))}<br/>\r\n            ref drift/zoom=<span class=\"${levelClass(driftLevel)}\">${esc(driftViewUnits.toFixed(3))}</span> <span class=\"dbg-dim\">view-units</span><br/>\r\n            refPick=${esc(this.fractalApp ? (this.fractalApp.bestScore + \"/\" + this.fractalApp.probeIters) : \"cached\")}<br/>\r\n            orbit=<span class=\"${this.fractalApp.orbitDirty ? \"dbg-warn\" : \"dbg-ok\"}\">${esc(orbitStatus)}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Performance </span><br/>\r\n            FPS=<span class=\"${levelClass(fpsLevel)}\">${esc(this.perf.fps.toFixed(1))}</span> <span class=\"dbg-dim\">(frame ${esc(this.perf.frameMsSmoothed?.toFixed?.(2) ?? \"n/a\")} ms)</span><br/>\r\n            debugUI=<span class=\"dbg-dim\">${esc(this.perf.panelCpuMsSmoothed?.toFixed?.(2) ?? \"n/a\")} ms</span><br/>\r\n            gpuTimer=${esc(this.perf.gpuSupported ? \"yes\" : \"no\")}<br/>\r\n            gpuMs=<span class=\"${levelClass(gpuLevel)}\">${esc(Number.isFinite(gpuSmooth) ? gpuSmooth.toFixed(2) : \"n/a\")}</span> <span class=\"dbg-dim\">${esc(this.perf.gpuDisjoint ? \"(disjoint)\" : \"\")}</span><br/>\r\n            hint=<span class=\"dbg-dim\">${esc(gpuHint)}</span><br/>\r\n            <br/>\r\n            <span class=\"dbg-title\"> Renderer </span><br/>\r\n            Vendor: ${esc(gpuVendor)}<br/>\r\n            GPU: ${esc(gpuRenderer)}<br/>\r\n            <span class=\"dbg-dim\">${esc(this.gpu.webglVersion)} on ${navigator?.userAgentData?.platform || navigator?.platform}</span><br/>\r\n            `;\r\n\r\n        requestAnimationFrame(this.update);\r\n    };\r\n\r\n    /** Toggle the visibility of the debug panel. */\r\n    toggle = () => {\r\n        if (!this.debugInfo) return; // Safety check\r\n        this.debugInfo.style.display = this.debugInfo.style.display === 'block' ? 'none' : 'block';\r\n    }\r\n}\r\n","import {\r\n    clearURLParams,\r\n    ddValue,\r\n    destroyArrayOfButtons,\r\n    getAnimationDuration,\r\n    getFractalName,\r\n    hsbToRgb,\r\n    isMobileDevice,\r\n    isTouchDevice,\r\n    normalizeRotation,\r\n    updateURLParams\r\n} from '../global/utils.js';\r\nimport {initMouseHandlers, registerMouseEventHandlers, unregisterMouseEventHandlers} from \"./mouseEventHandlers\";\r\nimport {initTouchHandlers, registerTouchEventHandlers, unregisterTouchEventHandlers} from \"./touchEventHandlers\";\r\nimport {JuliaRenderer} from \"../renderers/juliaRenderer\";\r\nimport {takeScreenshot} from \"./screenshotController\";\r\nimport {\r\n    CONSOLE_GROUP_STYLE,\r\n    CONSOLE_MESSAGE_STYLE,\r\n    DEBUG_LEVEL,\r\n    DEBUG_MODE,\r\n    DEFAULT_ACCENT_COLOR,\r\n    DEFAULT_BG_COLOR,\r\n    DEFAULT_JULIA_THEME_COLOR,\r\n    DEFAULT_MANDELBROT_THEME_COLOR,\r\n    FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED,\r\n    FF_USER_INPUT_ALLOWED,\r\n    FRACTAL_TYPE,\r\n    log,\r\n    PI\r\n} from \"../global/constants\";\r\nimport {destroyHotKeys, initHotKeys} from \"./hotkeyController\";\r\nimport MandelbrotRenderer from \"../renderers/mandelbrotRenderer\";\r\nimport RiemannRenderer from \"../renderers/riemannRenderer\";\r\nimport {\r\n    destroyJuliaSliders,\r\n    disableJuliaSliders,\r\n    enableJuliaSliders,\r\n    initJuliaSliders,\r\n    resetJuliaSliders,\r\n    updateJuliaSliders\r\n} from \"./juliaSlidersController\";\r\nimport {DebugPanel} from \"./debugPanel\";\r\nimport {destroyJuliaPreview, initJuliaPreview, recolorJuliaPreview, resetJuliaPreview} from \"./juliaPreview\";\r\n\r\n/**\r\n * @module UI\r\n * @author Radim Brnka\r\n * @description Contains code to manage the UI (header interactions, buttons, infoText update, etc.).\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nlet canvas;\r\nlet fractalApp;\r\n\r\nlet fractalMode = FRACTAL_TYPE.MANDELBROT;\r\n\r\nconst DEMO_BUTTON_DEFAULT_TEXT = 'Demo';\r\nconst DEMO_BUTTON_STOP_TEXT = 'Stop';\r\n\r\nlet accentColor = DEFAULT_ACCENT_COLOR;\r\nlet midColor = DEFAULT_BG_COLOR; // TODO use?\r\nlet bgColor = DEFAULT_BG_COLOR;\r\n\r\nlet headerMinimizeTimeout = null;\r\nlet uiInitialized = false;\r\n/** @type {boolean} */\r\nlet headerVisible = true;\r\n\r\nlet animationActive = false;\r\nlet activeJuliaDiveIndex = -1;\r\nlet activePresetIndex = 0;\r\nlet resizeTimeout;\r\n\r\n// HTML elements\r\nlet header;\r\nlet logo; // H1\r\nlet mandelbrotSwitch;\r\nlet juliaSwitch;\r\nlet persistSwitch;\r\nlet resetButton;\r\nlet screenshotButton;\r\nlet demoButton;\r\nlet presetsToggle;\r\nlet presetsMenu;\r\nlet divesToggle;\r\nlet divesMenu;\r\nlet divesDropdown;\r\nlet paletteToggle;\r\nlet paletteMenu;\r\nlet paletteDropdown;\r\nlet presetButtons = [];\r\nlet diveButtons = [];\r\nlet paletteButtons = [];\r\nlet allButtons = [];\r\nlet infoLabel;\r\nlet infoText;\r\nexport let debugPanel;\r\n\r\nlet lastInfoUpdate = 0; // Tracks the last time the sliders were updated\r\nconst infoUpdateThrottleLimit = 100; // Throttle limit in milliseconds\r\n\r\nlet pendingInfoTimer = null;\r\n\r\n\r\nexport const getFractalMode = () => getFractalName(fractalMode);\r\n\r\n/**\r\n * Switches among fractal modes\r\n * @param {FRACTAL_TYPE} mode\r\n * @param {PRESET} [preset] If present, it's set as the default state through travelToPreset\r\n */\r\nexport async function switchFractalMode(mode, preset = null) {\r\n    console.groupCollapsed(`%c switchFractalMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (mode === fractalMode) {\r\n        console.warn(`Switching to the same mode? Why?`);\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    exitAnimationMode();\r\n\r\n    fractalApp.destroy();\r\n\r\n    switch (mode) {\r\n        case FRACTAL_TYPE.MANDELBROT:\r\n            enableMandelbrotMode();\r\n            break;\r\n\r\n        case FRACTAL_TYPE.JULIA:\r\n            enableJuliaMode();\r\n            break;\r\n\r\n        case FRACTAL_TYPE.RIEMANN:\r\n            enableRiemannMode();\r\n            break;\r\n\r\n        default:\r\n            console.error(`Unknown fractal mode \"${mode}\"!`);\r\n            console.groupEnd();\r\n            return;\r\n    }\r\n\r\n    // Detach debug panel from old renderer BEFORE destroy\r\n    debugPanel?.setRenderer?.(null);\r\n\r\n    // Attach debug panel to new renderer AFTER init/constructor\r\n    debugPanel?.setRenderer?.(fractalApp);\r\n\r\n    // Register control events\r\n    if (isTouchDevice()) {\r\n        unregisterTouchEventHandlers();\r\n        initTouchHandlers(fractalApp);\r\n    } else {\r\n        destroyHotKeys();\r\n        initHotKeys(fractalApp);\r\n\r\n        unregisterMouseEventHandlers();\r\n        initMouseHandlers(fractalApp);\r\n    }\r\n\r\n    fractalApp.reset();\r\n\r\n    if (preset) {\r\n        resetPresetAndDiveButtonStates();\r\n        initAnimationMode();\r\n\r\n        console.log(`Preset found, setting: ${JSON.stringify(preset)}`)\r\n        if (isJuliaMode()) {\r\n            await fractalApp.animateTravelToPreset({\r\n                pan: [0, 0], c: preset.c, zoom: preset.zoom, rotation: 0\r\n            }, 1000);\r\n        } else {\r\n            await fractalApp.animateTravelToPreset({\r\n                pan: preset.pan, zoom: preset.zoom, rotation: 0\r\n            }, 500, 1000);\r\n        }\r\n\r\n        exitAnimationMode();\r\n        updateURLParams(fractalMode, fractalApp.pan[0], fractalApp.pan[1], fractalApp.zoom, fractalApp.rotation, fractalApp.c ? fractalApp.c[0] : null, fractalApp.c ? fractalApp.c[1] : null);\r\n    }\r\n\r\n    console.log(`Switched to ${mode === FRACTAL_TYPE.MANDELBROT ? 'Mandelbrot' : 'Julia'}`);\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Switches among fractal modes but keeps the c/pan settings so the fractals match each other.\r\n * @param {FRACTAL_TYPE} targetType\r\n * @return {Promise<void>}\r\n */\r\nexport async function switchFractalTypeWithPersistence(targetType) {\r\n    console.groupCollapsed(`%c switchFractalTypeWithPersistence`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (targetType === fractalMode) {\r\n        console.warn(`Switching to the same fractal? Why?`);\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    if (targetType === FRACTAL_TYPE.MANDELBROT) {\r\n        const targetZoom = Math.max(fractalApp.MAX_ZOOM, fractalApp.zoom * 0.1);\r\n\r\n        await switchFractalMode(FRACTAL_TYPE.MANDELBROT, {\r\n            pan: fractalApp.c.slice(), zoom: targetZoom, rotation: 0\r\n        });\r\n    } else {\r\n        await switchFractalMode(FRACTAL_TYPE.JULIA, {\r\n            pan: [0, 0], c: fractalApp.pan.slice(), zoom: 1.5, rotation: 0\r\n        });\r\n    }\r\n    console.groupEnd();\r\n}\r\n\r\nexport const isJuliaMode = () => fractalMode === FRACTAL_TYPE.JULIA;\r\n\r\n/**\r\n * Implemented in a way it's not needed to be called at the first render. Everything should be pre-initialized\r\n * for Mandelbrot mode.\r\n */\r\nexport function enableMandelbrotMode() {\r\n    juliaSwitch.classList.remove('active');\r\n    mandelbrotSwitch.classList.add('active');\r\n\r\n    destroyArrayOfButtons(diveButtons);\r\n    divesDropdown.style.display = 'none';\r\n\r\n    destroyJuliaSliders();\r\n    destroyJuliaPreview();\r\n\r\n    fractalApp.destroy();\r\n    fractalApp = new MandelbrotRenderer(canvas);\r\n    fractalMode = FRACTAL_TYPE.MANDELBROT;\r\n\r\n    // Remove each button from the DOM and reinitialize\r\n    destroyArrayOfButtons(presetButtons);\r\n    if (activePresetIndex !== 0) resetActivePresetIndex();\r\n    initPresetButtonEvents();\r\n\r\n    // Update palette dropdown for new renderer\r\n    initPaletteButtonEvents();\r\n\r\n    updateColorTheme(DEFAULT_MANDELBROT_THEME_COLOR);\r\n\r\n    updatePaletteDropdownState();\r\n\r\n    window.location.hash = ''; // Update URL hash\r\n}\r\n\r\nexport function enableJuliaMode() {\r\n    fractalApp.destroy();\r\n    fractalApp = new JuliaRenderer(canvas);\r\n    fractalMode = FRACTAL_TYPE.JULIA;\r\n\r\n    juliaSwitch.classList.add('active');\r\n    mandelbrotSwitch.classList.remove('active');\r\n\r\n    // Remove each button from the DOM and reinitialize\r\n    destroyArrayOfButtons(presetButtons);\r\n    initPresetButtonEvents();\r\n\r\n    initJuliaSliders(fractalApp);\r\n    updateJuliaSliders();\r\n\r\n    destroyArrayOfButtons(diveButtons);\r\n    initDiveButtons();\r\n\r\n    // Update palette dropdown for new renderer\r\n    initPaletteButtonEvents();\r\n\r\n    if (activePresetIndex !== 0) resetActivePresetIndex();\r\n\r\n    updateColorTheme(DEFAULT_JULIA_THEME_COLOR);\r\n    // Darker backgrounds for Julia as it renders on white\r\n    header.style.background = 'rgba(20, 20, 20, 0.8)';\r\n    infoLabel.style.background = 'rgba(20, 20, 20, 0.8)';\r\n\r\n    updatePaletteDropdownState();\r\n\r\n    window.location.hash = '#julia'; // Update URL hash\r\n}\r\n\r\nexport function enableRiemannMode() {\r\n    fractalApp = new RiemannRenderer(canvas);\r\n    fractalApp.useAnalyticExtension = false;\r\n    fractalMode = FRACTAL_TYPE.RIEMANN;\r\n\r\n    destroyArrayOfButtons(presetButtons);\r\n\r\n    window.location.hash = '#zeta'; // Update URL hash\r\n}\r\n\r\nexport function updatePaletteDropdownState() {\r\n    if (!paletteToggle) return;\r\n\r\n    // Update button text to show current palette\r\n    const palettes = fractalApp.PALETTES || [];\r\n    if (palettes.length > 0 && fractalApp.currentPaletteIndex >= 0) {\r\n        const currentPalette = palettes[fractalApp.currentPaletteIndex];\r\n        paletteToggle.title = `Current: \"${currentPalette.id}\" (T to cycle)`;\r\n    } else {\r\n        paletteToggle.title = 'Change Color Palette (T)';\r\n    }\r\n}\r\n\r\n/**\r\n * Updates color scheme\r\n * @param {PALETTE} [palette] defaults to the fractal palette\r\n */\r\nexport function updateColorTheme(palette) {\r\n    palette ||= [...fractalApp.colorPalette];\r\n\r\n    const adjustChannel = (value, brightnessFactor = 1.9) => Math.min(255, Math.floor(value * 255 * brightnessFactor));\r\n\r\n    accentColor = `rgba(${adjustChannel(palette[0])}, ${adjustChannel(palette[1])}, ${adjustChannel(palette[2])}, 1)`;\r\n    midColor = `rgba(${adjustChannel(palette[0], .5)}, ${adjustChannel(palette[1], .5)}, ${adjustChannel(palette[2], .5)}, 0.2)`;\r\n    bgColor = `rgba(${Math.floor(palette[0] * 200)}, ${Math.floor(palette[1] * 200)}, ${Math.floor(palette[2] * 200)}, 0.1)`; // Slightly dimmed for borders\r\n\r\n    let root = document.querySelector(':root');\r\n    root.style.setProperty('--bg-color', bgColor);\r\n    root.style.setProperty('--mid-color', midColor);\r\n    root.style.setProperty('--accent-color', accentColor);\r\n\r\n    recolorJuliaPreview(palette);\r\n}\r\n\r\n/** Resets buttons, active presets and URL */\r\nexport function resetAppState() {\r\n    resetPresetAndDiveButtonStates();\r\n    resetActivePresetIndex();\r\n    clearURLParams();\r\n}\r\n\r\n/**\r\n * Updates the bottom info bar.\r\n * Throttled to avoid layout thrashing during animations (max ~10 updates/sec).\r\n * @param {boolean} force - If true, ensures an update is scheduled even if throttled (won't be dropped)\r\n */\r\nexport function updateInfo(force = false) {\r\n    const now = performance.now();\r\n    const timeSinceLastUpdate = now - lastInfoUpdate;\r\n\r\n    // Always apply throttle - even force=true respects timing to prevent layout thrash\r\n    if (timeSinceLastUpdate < infoUpdateThrottleLimit) {\r\n        // If force=true, ensure we schedule a deferred update (don't drop it)\r\n        if (force && !pendingInfoTimer) {\r\n            const delay = Math.max(infoUpdateThrottleLimit - timeSinceLastUpdate, 0);\r\n\r\n            pendingInfoTimer = setTimeout(() => {\r\n                pendingInfoTimer = null;\r\n                updateInfo(true);\r\n            }, delay);\r\n        }\r\n        return;\r\n    }\r\n\r\n    lastInfoUpdate = now;\r\n\r\n    if (!canvas || !fractalApp) {\r\n        return;\r\n    }\r\n\r\n    let text = (animationActive ? ` [AUTO] ` : ``);\r\n\r\n    const panX = ddValue(fractalApp.panDD.x) ?? 0;\r\n    const panY = ddValue(fractalApp.panDD.y) ?? 0;\r\n\r\n    text += `p: [${panX.toFixed(8)}, ${panY.toFixed(8)}i]  `;\r\n\r\n    if (fractalMode === FRACTAL_TYPE.JULIA) {\r\n        const cx = fractalApp.c[0] ?? 0;\r\n        const cy = fractalApp.c[1] ?? 0;\r\n\r\n        text += `c: [${cx.toFixed(4)}, ${cy.toFixed(4)}i]  `;\r\n    }\r\n\r\n    const currentZoom = fractalApp.zoom ?? 0;\r\n    const currentRotation = (fractalApp.rotation * 180 / PI) % 360;\r\n    const normalizedRotation = currentRotation < 0 ? currentRotation + 360 : currentRotation;\r\n    text += `r: ${normalizedRotation.toFixed(0)}  zoom:&nbsp;${currentZoom.toExponential(0)}`;\r\n\r\n    if (animationActive) {\r\n        if (!infoText.classList.contains('animationActive')) infoText.classList.add('animationActive');\r\n    } else {\r\n        if (infoText.classList.contains('animationActive')) infoText.classList.remove('animationActive');\r\n    }\r\n\r\n    if (FF_USER_INPUT_ALLOWED) {\r\n        if (document.activeElement !== infoText) {\r\n            if (infoText.innerHTML !== text) infoText.innerHTML = text;\r\n        }\r\n    } else {\r\n        if (infoText.innerHTML !== text) infoText.innerHTML = text;\r\n    }\r\n}\r\n\r\n/** @returns {boolean} */\r\nexport const isAnimationActive = () => animationActive;\r\n\r\n/** Enables controls, resets demo button */\r\nfunction exitAnimationMode() {\r\n    console.groupCollapsed(`%c exitAnimationMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (!animationActive) {\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    animationActive = false;\r\n    infoText.classList.remove('animation');\r\n\r\n    fractalApp.stopAllNonColorAnimations();\r\n\r\n    demoButton.innerText = DEMO_BUTTON_DEFAULT_TEXT;\r\n    demoButton.classList.remove('active');\r\n\r\n    presetsToggle.disabled = false;\r\n    divesToggle.disabled = false;\r\n\r\n    if (isTouchDevice()) {\r\n        registerTouchEventHandlers();\r\n    } else {\r\n        registerMouseEventHandlers();\r\n    }\r\n\r\n    if (isJuliaMode()) {\r\n        enableJuliaSliders();\r\n    }\r\n\r\n    setTimeout(() => {\r\n        updateInfo();\r\n    }, 150);\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/** Disables controls, activates demo button */\r\nfunction initAnimationMode() {\r\n    console.groupCollapsed(`%c initAnimationMode`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    animationActive = true;\r\n    infoText.classList.add('animation');\r\n\r\n    // resetPresetAndDiveButtons();\r\n    demoButton.innerText = DEMO_BUTTON_STOP_TEXT;\r\n    demoButton.classList.add('active');\r\n\r\n    closePresetsDropdown();\r\n    presetsToggle.disabled = true;\r\n    closeDivesDropdown();\r\n    divesToggle.disabled = true;\r\n\r\n    // Unregister control events\r\n    if (isTouchDevice()) {\r\n        unregisterTouchEventHandlers();\r\n    } else {\r\n        unregisterMouseEventHandlers();\r\n    }\r\n\r\n    if (isJuliaMode()) {\r\n        disableJuliaSliders();\r\n    }\r\n\r\n    clearURLParams();\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Turns demo on/off and/or stops current animation\r\n * @return {Promise<void>}\r\n */\r\nexport async function toggleDemo() {\r\n    console.groupCollapsed(`%c toggleDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        resetPresetAndDiveButtonStates();\r\n        activeJuliaDiveIndex = -1;\r\n        fractalApp.stopDemo();\r\n        exitAnimationMode();\r\n        console.groupEnd();\r\n        return;\r\n    }\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    initAnimationMode();\r\n\r\n    switch (fractalMode) {\r\n        // @formatter:off\r\n        case FRACTAL_TYPE.MANDELBROT: await startMandelbrotDemo(); break;\r\n\r\n        case FRACTAL_TYPE.JULIA: await startJuliaDemo(); break;\r\n\r\n        default:\r\n            console.warn(`No demo defined for mode ${fractalMode}`);\r\n            exitAnimationMode();\r\n            break;\r\n        // @formatter:on\r\n    }\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/** Starts the Mandelbrot demo */\r\nasync function startMandelbrotDemo() {\r\n    console.groupCollapsed(`%c startMandelbrotDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    await fractalApp.animateDemo();\r\n\r\n    console.log(\"Demo ended\");\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Starts the Julia dive infinite animation\r\n * @param {Array<DIVE>} dives\r\n * @param {number} index Index of the dive\r\n * @return {Promise<void>}\r\n */\r\nexport async function startJuliaDive(dives, index) {\r\n    if (animationActive && index === activeJuliaDiveIndex) {\r\n        console.log(`%c startJuliaDive: %c Dive ${index} already in progress. Skipping.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    if (animationActive) {\r\n        exitAnimationMode();\r\n    }\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    activeJuliaDiveIndex = index;\r\n    diveButtons[index].classList.add('active');\r\n\r\n    const dive = dives[index];\r\n\r\n    // Validate configuration:\r\n    if (dive.cxDirection < 0 && dive.endC[0] >= dive.startC[0]) {\r\n        console.error(\"For negative cxDirection, endC[0] must be lower than startC[0].\");\r\n        return;\r\n    } else if (dive.cxDirection > 0 && dive.endC[0] <= dive.startC[0]) {\r\n        console.error(\"For positive cxDirection, endC[0] must be higher than startC[0].\");\r\n        return;\r\n    }\r\n    if (dive.cyDirection < 0 && dive.endC[1] >= dive.startC[1]) {\r\n        console.error(\"For negative cyDirection, endC[1] must be lower than startC[1].\");\r\n        return;\r\n    } else if (dive.cyDirection > 0 && dive.endC[1] <= dive.startC[1]) {\r\n        console.error(\"For positive cyDirection, endC[1] must be higher than startC[1].\");\r\n        return;\r\n    }\r\n\r\n    initAnimationMode();\r\n\r\n    //if (DEBUG_MODE) dive.step *= 10;\r\n\r\n    // Transition to the initial preset first.\r\n    const duration = getAnimationDuration(500, fractalApp, {c: dive.startC, pan: dive.pan, zoom: dive.zoom},\r\n        {pan: 0.5, zoom: 2, c: 1});\r\n    console.log(duration);\r\n\r\n    // Phase 1: Set initial state\r\n    // await fractalApp.animateTravelToPreset({\r\n    //     pan: dive.pan, c: dive.startC.slice(), // copy initial c\r\n    //     zoom: dive.zoom, rotation: dive.rotation\r\n    // }, 1500, EASE_TYPE.QUINT);\r\n    // Alternatively:\r\n    await fractalApp.animateToZoomAndC(fractalApp.DEFAULT_ZOOM, dive.startC, 1500);\r\n\r\n    // Phase 2: Enter dive mode\r\n    await Promise.all([\r\n        fractalApp.animateDive(dive),\r\n        fractalApp.animatePanZoomRotationTo(dive.pan, dive.zoom, dive.rotation, 1500)\r\n    ]);\r\n}\r\n\r\n/** Starts the Julia demo */\r\nasync function startJuliaDemo() {\r\n    console.groupCollapsed(`%c startJuliaDemo`, CONSOLE_GROUP_STYLE);\r\n\r\n    if (animationActive) {\r\n        console.log(`Animation already in progress. Stopping.`);\r\n        exitAnimationMode();\r\n    }\r\n\r\n    initAnimationMode();\r\n\r\n    resetPresetAndDiveButtonStates();\r\n\r\n    // Initialize or continue the demo?\r\n    if (fractalApp.demoTime === 0) {\r\n        await fractalApp.animateTravelToPreset({\r\n            pan: fractalApp.DEFAULT_PAN, c: [-0.25, 0.7], // For smooth c transition\r\n            zoom: fractalApp.DEFAULT_ZOOM, rotation: fractalApp.DEFAULT_ROTATION\r\n        }, 1000);\r\n    }\r\n\r\n    await fractalApp.animateDemo();\r\n\r\n    exitAnimationMode();\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n/**\r\n * Travels to preset at given index\r\n * @param {Array<PRESET>} presets\r\n * @param {number} index Preset array index\r\n * @return {Promise<void>}\r\n */\r\nexport async function travelToPreset(presets, index) {\r\n    if (animationActive) {\r\n        console.log(`%c travelToPreset: %c Travel to preset ${index} requested, active animation in progress, interrupting...`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        exitAnimationMode();\r\n    }\r\n\r\n    if (index === activePresetIndex) {\r\n        console.log(`%c travelToPreset: %c Already on preset ${index}, skipping.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n        return;\r\n    }\r\n\r\n    console.log(`%c travelToPreset: %c Executing travel to preset ${index}`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n    resetPresetAndDiveButtonStates();\r\n    initAnimationMode();\r\n\r\n    presetButtons[index].classList.add('active');\r\n\r\n    if (isJuliaMode()) {\r\n        fractalApp.demoTime = 0;\r\n        await fractalApp.animateTravelToPreset(presets[index], 1500);\r\n    } else {\r\n        // Cinematic animation with zoom-out, pan, zoom-in with rotation\r\n        await fractalApp.animateTravelToPreset(presets[index], 2000, 500, 1500);\r\n    }\r\n    activePresetIndex = index;\r\n\r\n    exitAnimationMode();\r\n    updateURLParams(fractalMode, fractalApp.pan[0], fractalApp.pan[1], fractalApp.zoom, fractalApp.rotation, fractalApp.c ? fractalApp.c[0] : null, fractalApp.c ? fractalApp.c[1] : null);\r\n}\r\n\r\n/** Inits debug bar with various information permanently shown on the screen */\r\nexport function toggleDebugMode() {\r\n    if (debugPanel) {\r\n        debugPanel.toggle();\r\n    } else {\r\n        debugPanel = new DebugPanel(canvas, fractalApp, accentColor);\r\n        toggleCenterLines();\r\n    }\r\n}\r\n\r\n/** Toggles x/y axes */\r\nexport function toggleCenterLines() {\r\n    const verticalLine = document.getElementById('verticalLine');\r\n    const horizontalLine = document.getElementById('horizontalLine');\r\n\r\n    if (verticalLine.style.display === 'block' && horizontalLine.style.display === 'block') {\r\n        verticalLine.style.display = 'none';\r\n        horizontalLine.style.display = 'none';\r\n    } else {\r\n        verticalLine.style.display = 'block';\r\n        horizontalLine.style.display = 'block';\r\n    }\r\n}\r\n\r\nexport function resetPresetAndDiveButtonStates() {\r\n    if (DEBUG_MODE) console.log(`%c resetPresetAndDiveButtonStates: %c Button states reset.`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n    presetButtons.concat(diveButtons).forEach(b => b.classList.remove('active'));\r\n}\r\n\r\n/**\r\n * This needs to happen on any fractal change\r\n */\r\nexport function resetActivePresetIndex() {\r\n    activePresetIndex = -1;\r\n}\r\n\r\nexport async function randomizeColors() {\r\n    if (isJuliaMode()) {\r\n        await fractalApp.animateColorPaletteTransition(250, updateColorTheme);\r\n        updatePaletteDropdownState();\r\n    } else {\r\n        // Generate a bright random color palette\r\n        // Generate colors with better separation and higher brightness\r\n        const hue = Math.random(); // Hue determines the \"base color\" (red, green, blue, etc.)\r\n        const saturation = Math.random() * 0.5 + 0.5; // Ensure higher saturation (more vivid colors)\r\n        const brightness = Math.random() * 0.5 + 0.5; // Ensure higher brightness\r\n\r\n        // Convert HSB/HSV to RGB\r\n        const newPalette = hsbToRgb(hue, saturation, brightness);\r\n\r\n        await fractalApp.animateColorPaletteTransition(newPalette, 250, () => {\r\n            updateColorTheme(newPalette);\r\n        }); // Update app colors\r\n\r\n        recolorJuliaPreview(newPalette);\r\n    }\r\n}\r\n\r\nexport function captureScreenshot() {\r\n    takeScreenshot(canvas, fractalApp, accentColor);\r\n}\r\n\r\n/**\r\n * Shows/hides/toggles header.\r\n * @param {boolean|null} show Show header? If null, then toggles current state\r\n */\r\nexport function toggleHeader(show = null) {\r\n    let header = document.getElementById('headerContainer');\r\n\r\n    if (show === null) show = !headerVisible;\r\n\r\n    if (show) {\r\n        header.classList.remove('minimized');\r\n    } else {\r\n        header.classList.add('minimized');\r\n    }\r\n\r\n    headerVisible = show;\r\n}\r\n\r\nexport async function reset() {\r\n    console.groupCollapsed(`%c reset`, CONSOLE_GROUP_STYLE);\r\n\r\n    updateColorTheme(isJuliaMode() ? DEFAULT_JULIA_THEME_COLOR : DEFAULT_MANDELBROT_THEME_COLOR);\r\n\r\n    exitAnimationMode();\r\n\r\n    fractalApp.reset();\r\n    if (isJuliaMode()) {\r\n        resetJuliaSliders();\r\n    } else {\r\n        resetJuliaPreview();\r\n    }\r\n    resetAppState();\r\n    updatePaletteDropdownState();\r\n    presetButtons[0].classList.add('active');\r\n\r\n    console.groupEnd();\r\n}\r\n\r\n// region > INITIALIZERS -----------------------------------------------------------------------------------------------\r\n\r\nfunction initHeaderEvents() {\r\n\r\n    let lastPointerType = 'mouse';\r\n\r\n    logo.addEventListener('pointerdown', (e) => {\r\n        lastPointerType = e.pointerType;\r\n    });\r\n\r\n    logo.addEventListener('pointerenter', (e) => {\r\n        // Skip hover behavior for touch - handled by click\r\n        if (e.pointerType === 'touch') return;\r\n\r\n        if (headerMinimizeTimeout) {\r\n            clearTimeout(headerMinimizeTimeout);\r\n            headerMinimizeTimeout = null;\r\n        }\r\n        toggleHeader(true);\r\n    });\r\n\r\n    // Toggle on tap/click for touch devices (and debug mode)\r\n    logo.addEventListener('click', () => {\r\n        if (lastPointerType === 'touch' || DEBUG_MODE > DEBUG_LEVEL.NONE) {\r\n            toggleHeader();\r\n        }\r\n    });\r\n\r\n    header.addEventListener('pointerleave', (e) => {\r\n        // Skip auto-hide for touch - handled by tapping outside\r\n        if (e.pointerType === 'touch') return;\r\n\r\n        // Only minimize if it hasn't been toggled manually\r\n        if (headerVisible && !DEBUG_MODE) {\r\n            headerMinimizeTimeout = setTimeout(() => {\r\n                toggleHeader(false);\r\n                headerMinimizeTimeout = null;\r\n            }, 3000);\r\n        }\r\n    });\r\n\r\n    // When user clicks/taps outside of the header\r\n    canvas.addEventListener('pointerdown', () => {\r\n        if (DEBUG_MODE) return;\r\n        toggleHeader(false);\r\n    });\r\n\r\n    log('Initialized.', 'initHeaderEvents');\r\n}\r\n\r\nfunction initControlButtonEvents() {\r\n    resetButton.addEventListener('click', async () => {\r\n        await reset();\r\n    });\r\n\r\n    demoButton.addEventListener('click', toggleDemo);\r\n\r\n    screenshotButton.addEventListener('click', captureScreenshot);\r\n\r\n    log('Initialized.', 'initControlButtonEvents');\r\n}\r\n\r\nfunction initPresetButtonEvents() {\r\n    const presetBlock = document.getElementById('presets');\r\n    presetButtons = [];\r\n\r\n    const presets = [...fractalApp.PRESETS];\r\n    presets.forEach((preset, index) => {\r\n        const btn = document.createElement('button');\r\n        btn.id = 'preset' + (index);\r\n        btn.className = 'preset';\r\n        btn.title = (preset.title || ('Preset ' + index)) + (index < 10 ? ` (Num ${index})` : ` (${index})`);\r\n        btn.textContent = (preset.title || index).toString();\r\n        btn.addEventListener('click', async () => {\r\n            closePresetsDropdown();\r\n            await travelToPreset(presets, index);\r\n        });\r\n\r\n        presetBlock.appendChild(btn);\r\n        presetButtons.push(btn);\r\n        presetButtons[0].classList.add('active');\r\n    });\r\n\r\n    log('Initialized.', 'initPresetButtonEvents');\r\n}\r\n\r\n/** Toggles the presets dropdown menu */\r\nfunction togglePresetsDropdown() {\r\n    presetsMenu.classList.toggle('show');\r\n    const isOpen = presetsMenu.classList.contains('show');\r\n    presetsToggle.textContent = isOpen ? 'View ' : 'View ';\r\n}\r\n\r\n/** Closes the presets dropdown menu */\r\nfunction closePresetsDropdown() {\r\n    presetsMenu.classList.remove('show');\r\n    presetsToggle.textContent = 'View ';\r\n}\r\n\r\nfunction initPresetsDropdown() {\r\n    presetsToggle.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        closeDivesDropdown();\r\n        closePaletteDropdown();\r\n        togglePresetsDropdown();\r\n    });\r\n\r\n    // Close dropdown when clicking outside\r\n    document.addEventListener('click', (e) => {\r\n        if (!presetsMenu.contains(e.target) && e.target !== presetsToggle) {\r\n            closePresetsDropdown();\r\n        }\r\n    });\r\n\r\n    log('Initialized.', 'initPresetsDropdown');\r\n}\r\n\r\n/** Toggles the dives dropdown menu */\r\nfunction toggleDivesDropdown() {\r\n    divesMenu.classList.toggle('show');\r\n    const isOpen = divesMenu.classList.contains('show');\r\n    divesToggle.textContent = isOpen ? 'Dive ' : 'Dive ';\r\n}\r\n\r\n/** Closes the dives dropdown menu */\r\nfunction closeDivesDropdown() {\r\n    divesMenu.classList.remove('show');\r\n    divesToggle.textContent = 'Dive ';\r\n}\r\n\r\nfunction initDivesDropdown() {\r\n    divesToggle.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        closePresetsDropdown();\r\n        closePaletteDropdown();\r\n        toggleDivesDropdown();\r\n    });\r\n\r\n    // Close dropdown when clicking outside\r\n    document.addEventListener('click', (e) => {\r\n        if (!divesMenu.contains(e.target) && e.target !== divesToggle) {\r\n            closeDivesDropdown();\r\n        }\r\n    });\r\n\r\n    log('Initialized.', 'initDivesDropdown');\r\n}\r\n\r\n/** Toggles the palette dropdown menu */\r\nfunction togglePaletteDropdown() {\r\n    paletteMenu.classList.toggle('show');\r\n    const isOpen = paletteMenu.classList.contains('show');\r\n    paletteToggle.textContent = isOpen ? 'Palette ' : 'Palette ';\r\n}\r\n\r\n/** Closes the palette dropdown menu */\r\nfunction closePaletteDropdown() {\r\n    paletteMenu.classList.remove('show');\r\n    paletteToggle.textContent = 'Palette ';\r\n}\r\n\r\nfunction initPaletteButtonEvents() {\r\n    paletteButtons = [];\r\n    paletteMenu.innerHTML = ''; // Clear existing\r\n\r\n    const palettes = fractalApp.PALETTES || [];\r\n\r\n    // Always add \"Random\" option first\r\n    const randomBtn = document.createElement('button');\r\n    randomBtn.id = 'palette-random';\r\n    randomBtn.className = 'palette';\r\n    randomBtn.title = 'Random color palette';\r\n    randomBtn.innerHTML = '<span class=\"color-swatch\" style=\"background: linear-gradient(135deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);\"></span>Random';\r\n    randomBtn.addEventListener('click', async () => {\r\n        closePaletteDropdown();\r\n        await randomizeColors();\r\n    });\r\n    paletteMenu.appendChild(randomBtn);\r\n    paletteButtons.push(randomBtn);\r\n\r\n    // Add palette options if available\r\n    palettes.forEach((palette, index) => {\r\n        const btn = document.createElement('button');\r\n        btn.id = 'palette-' + index;\r\n        btn.className = 'palette';\r\n        btn.title = palette.id;\r\n\r\n        // Create color swatch from keyColor\r\n        const swatchColor = palette.keyColor || '#888';\r\n        btn.innerHTML = `<span class=\"color-swatch\" style=\"background: ${swatchColor};\"></span>${palette.id}`;\r\n\r\n        btn.addEventListener('click', async () => {\r\n            closePaletteDropdown();\r\n            await fractalApp.applyPaletteByIndex(index, 250, updateColorTheme);\r\n            updatePaletteDropdownState();\r\n        });\r\n\r\n        paletteMenu.appendChild(btn);\r\n        paletteButtons.push(btn);\r\n    });\r\n\r\n    log('Initialized.', 'initPaletteButtonEvents');\r\n}\r\n\r\nfunction initPaletteDropdown() {\r\n    paletteToggle.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        closePresetsDropdown();\r\n        closeDivesDropdown();\r\n        togglePaletteDropdown();\r\n    });\r\n\r\n    // Close dropdown when clicking outside\r\n    document.addEventListener('click', (e) => {\r\n        if (!paletteMenu.contains(e.target) && e.target !== paletteToggle) {\r\n            closePaletteDropdown();\r\n        }\r\n    });\r\n\r\n    log('Initialized.', 'initPaletteDropdown');\r\n}\r\n\r\n/**\r\n * Inits behavior common for all buttons\r\n */\r\nfunction initCommonButtonEvents() {\r\n    allButtons = diveButtons.concat(presetButtons).concat(paletteButtons);\r\n    allButtons.push(resetButton, screenshotButton, demoButton);\r\n\r\n    allButtons.forEach((btn) => {\r\n        btn.addEventListener('mouseleave', () => {\r\n            btn.blur();\r\n        });\r\n\r\n        btn.addEventListener('mouseup', () => {\r\n            btn.blur();\r\n        });\r\n    });\r\n\r\n    log('Initialized.', 'initCommonButtonEvents');\r\n}\r\n\r\nfunction initDiveButtons() {\r\n    if (isJuliaMode()) {\r\n        const diveBlock = document.getElementById('dives');\r\n        diveButtons = [];\r\n\r\n        const dives = [...fractalApp.DIVES];\r\n        dives.forEach((dive, index) => {\r\n            const btn = document.createElement('button');\r\n            btn.id = 'dive' + (index);\r\n            btn.className = 'dive';\r\n            btn.title = (dive.title || ('Preset ' + index)) + ` (Shift+${index})`;\r\n            btn.textContent = dive.title || (index).toString();\r\n            btn.addEventListener('click', async () => {\r\n                closeDivesDropdown();\r\n                await startJuliaDive(dives, index);\r\n            });\r\n\r\n            diveBlock.appendChild(btn);\r\n            diveButtons.push(btn);\r\n        });\r\n\r\n        divesDropdown.style.display = 'inline-block';\r\n    }\r\n\r\n    log('Initialized.', 'initDiveButtons');\r\n}\r\n\r\nfunction initFractalSwitchButtons() {\r\n    mandelbrotSwitch.addEventListener('click', async (e) => {\r\n        if (e.ctrlKey) {\r\n            console.log('mandelbrotSwitch clicked (with persistence).');\r\n            await switchFractalTypeWithPersistence(FRACTAL_TYPE.MANDELBROT);\r\n        } else {\r\n            console.log('mandelbrotSwitch clicked.');\r\n            await switchFractalMode(FRACTAL_TYPE.MANDELBROT);\r\n        }\r\n    });\r\n\r\n    juliaSwitch.addEventListener('click', async (e) => {\r\n        if (e.ctrlKey) {\r\n            console.log('juliaSwitch clicked (with persistence).');\r\n            await switchFractalTypeWithPersistence(FRACTAL_TYPE.JULIA);\r\n        } else {\r\n            await switchFractalMode(FRACTAL_TYPE.JULIA);\r\n        }\r\n    });\r\n\r\n    if (FF_PERSISTENT_FRACTAL_SWITCHING_BUTTON_DISPLAYED) {\r\n        persistSwitch.addEventListener('click', async () => {\r\n            console.log('persistSwitch clicked.');\r\n            if (isJuliaMode()) {\r\n                await switchFractalTypeWithPersistence(FRACTAL_TYPE.MANDELBROT)\r\n            } else {\r\n                await switchFractalTypeWithPersistence(FRACTAL_TYPE.JULIA);\r\n            }\r\n        });\r\n\r\n        persistSwitch.style.display = 'inline-flex';\r\n    }\r\n\r\n    log('Initialized.', 'initFractalSwitchButtons');\r\n}\r\n\r\nfunction initWindowEvents() {\r\n    // Resize canvas on window resize\r\n    window.addEventListener('resize', () => {\r\n        clearTimeout(resizeTimeout);\r\n        resizeTimeout = setTimeout(() => {\r\n            fractalApp.resizeCanvas(); // Adjust canvas dimensions\r\n        }, 200); // Adjust delay as needed\r\n    });\r\n\r\n    // Initialize draggable elements (debug info)\r\n    const dragElements = document.querySelectorAll(\".draggable\");\r\n\r\n    const move = (event, element) => {\r\n        let leftValue = parseInt(window.getComputedStyle(element).left);\r\n        let topValue = parseInt(window.getComputedStyle(element).top);\r\n        element.style.left = `${leftValue + event.movementX}px`;\r\n        element.style.top = `${topValue + event.movementY}px`;\r\n    }\r\n\r\n    dragElements.forEach((element) => {\r\n        element.addEventListener(\"mousedown\", () => {\r\n            const onMove = (event) => move(event, element);\r\n\r\n            document.addEventListener(\"mousemove\", onMove);\r\n            document.addEventListener(\"mouseup\", () => {\r\n                document.removeEventListener(\"mousemove\", onMove);\r\n            }, {once: true});\r\n        });\r\n    });\r\n\r\n    log('Initialized.', 'initWindowEvents');\r\n}\r\n\r\n/**\r\n * Parses a string of the form:\r\n *   p = [<panX>, <panY>i] c = [<cX>, <cY>i] zoom = <zoom> r = <rotation>\r\n * and returns an object with the parsed numbers.\r\n * If a part is invalid or missing, an error message is returned.\r\n *\r\n * @param {string} input The input string.\r\n * @returns {PRESET|Object}\r\n */\r\nexport function parseUserInput(input) {\r\n\r\n    // https://regex101.com/\r\n    const panRegex = /\\s*p\\s*=\\s*[\\[\\(]?\\s*(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*[\\]\\)]?/i;\r\n    const cRegex = /\\s*c\\s*=\\s*[\\[\\(]?\\s*(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*[\\]\\)]?/i;\r\n    const zoomRegex = /\\s*zoom\\s*=\\s*([\\d.]+)/i;\r\n    const rotationRegex = /\\s*r\\s*=\\s*([\\d.]+)/i;\r\n\r\n    let errors = [];\r\n\r\n    // Validate and extract pan.\r\n    const panMatch = input.match(panRegex);\r\n    if (!panMatch) {\r\n        errors.push(`Pan coordinates (p) are missing or invalid.`);\r\n    }\r\n    // Validate and extract Julia c in Julia mode\r\n    const cMatch = input.match(cRegex);\r\n    if (!cMatch && isJuliaMode()) {\r\n        errors.push(`Julia constant (c) is missing or invalid.`);\r\n    }\r\n    // Validate and extract zoom.\r\n    const zoomMatch = input.match(zoomRegex);\r\n    if (!zoomMatch) {\r\n        errors.push(`Zoom (zoom) value is missing or invalid.`);\r\n    }\r\n    // Validate and extract rotation.\r\n    const rotationMatch = input.match(rotationRegex);\r\n    if (!rotationMatch) {\r\n        errors.push(`Rotation (r) value is missing or invalid.`);\r\n    }\r\n\r\n    // If any errors, return error object.\r\n    if (errors.length > 0) {\r\n        return {error: errors.join(\" \")};\r\n    }\r\n\r\n    // Otherwise, parse values.\r\n    const panX = parseFloat(panMatch[1]);\r\n    const panY = parseFloat(panMatch[2]);\r\n    const z = parseFloat(zoomMatch[1]);\r\n    const r = normalizeRotation(parseFloat(rotationMatch[1]) * Math.PI / 180);\r\n\r\n    // Optionally check for isNaN here too.\r\n    // if ([panX, panY, cX, cY, z, r].some(v => isNaN(v))) {\r\n    //     return { error: \"One or more numeric values could not be parsed.\" };\r\n    // }\r\n\r\n    if (isJuliaMode()) {\r\n        const cX = parseFloat(cMatch[1]);\r\n        const cY = parseFloat(cMatch[2]);\r\n\r\n        return {pan: [panX, panY], c: [cX, cY], zoom: z, rotation: r};\r\n    } else {\r\n        return {pan: [panX, panY], zoom: z, rotation: r};\r\n    }\r\n\r\n}\r\n\r\nfunction initInfoText() {\r\n    if (!FF_USER_INPUT_ALLOWED) {\r\n\r\n        infoText.addEventListener('mouseenter', () => {\r\n            infoText.innerHTML = 'Click to copy fractal state to clipboard.';\r\n        });\r\n\r\n        infoText.addEventListener('mouseleave', () => {\r\n            updateInfo();\r\n        });\r\n\r\n        infoText.addEventListener('click', () => {\r\n            let text = `\"pan\": [${fractalApp.pan}], \"rotation\": ${normalizeRotation(fractalApp.rotation)}, \"zoom\": ${fractalApp.zoom}`\r\n                + (isJuliaMode() ? `, \"c\": [${fractalApp.c}]}` : `}`);\r\n\r\n            navigator.clipboard.writeText(text).then(function () {\r\n                infoText.innerHTML = 'Copied to clipboard!';\r\n            }, function (err) {\r\n                console.error('Not copied to clipboard! ' + err.toString());\r\n            });\r\n        });\r\n    } else {\r\n        infoText.setAttribute(\"contenteditable\", true);\r\n        infoText.style.cursor = 'auto';\r\n        infoText.removeAttribute(\"readonly\");\r\n\r\n        infoText.addEventListener('focus', () => {\r\n            infoLabel.style.zoom = '200%';\r\n        })\r\n\r\n        infoText.addEventListener('blur', () => {\r\n            infoLabel.style.zoom = '120%';\r\n        })\r\n\r\n        infoText.addEventListener(\"keydown\", function (e) {\r\n            e.stopPropagation();\r\n\r\n            if (e.key === \"Enter\") {\r\n                e.preventDefault(); // Prevent a newline\r\n\r\n                //const regex = /\\s*p\\s*=\\s*\\[(-?[\\d.]+)\\s*[,|\\s+]\\s*(-?[\\d.]+)\\s*i?\\s*\\]\\s*?\\s*r\\s*=\\s*(-?[\\d.]+)\\s*?\\s*?\\s*zoom\\s*=\\s*(-?[\\d.]+)/;\r\n                /* for C capture the same as for P\r\n                    Allowed complex notations:\r\n                    p = [ -0.500000000000, 0.000000000000i]  r = 0  zoom = 3.000000\r\n                    p = [-0.500000000000 + 2i]  r = 0  zoom = 3.000000\r\n                    p = [ 0.500000000000, 0.000000000000]  r = 0  zoom = 3.000000\r\n                    p = [0.500000000000 + 0.000000000000]  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 + 0.000000000001)  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 - 0.000000000001)  r = 0  zoom = 3.000000\r\n                    p = (0.500000000000 - 0.000000000001i)  r = 0  zoom = -3.000000 (No match)\r\n                 */\r\n\r\n                const result = parseUserInput(infoText.innerHTML);\r\n                if (result.error) {\r\n                    infoLabel.style.color = '#f00';\r\n                    alert(result.error);\r\n                } else {\r\n                    infoLabel.style.color = '#fff';\r\n                    fractalApp.animateTravelToPreset(result);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction bindHTMLElements() {\r\n    // Element binding\r\n    mandelbrotSwitch = document.getElementById('mandelbrotSwitch');\r\n    juliaSwitch = document.getElementById('juliaSwitch');\r\n    persistSwitch = document.getElementById('persistSwitch');\r\n    header = document.getElementById('headerContainer');\r\n    logo = document.getElementById('logo');\r\n    infoLabel = document.getElementById('infoLabel');\r\n    infoText = document.getElementById('infoText');\r\n    resetButton = document.getElementById('reset');\r\n    screenshotButton = document.getElementById('screenshot');\r\n    demoButton = document.getElementById('demo');\r\n    presetsToggle = document.getElementById('presets-toggle');\r\n    presetsMenu = document.getElementById('presets');\r\n    divesToggle = document.getElementById('dives-toggle');\r\n    divesMenu = document.getElementById('dives');\r\n    divesDropdown = document.getElementById('dives-dropdown');\r\n    paletteToggle = document.getElementById('palette-toggle');\r\n    paletteMenu = document.getElementById('palettes');\r\n    paletteDropdown = document.getElementById('palette-dropdown');\r\n}\r\n\r\n/**\r\n * Initializes the UI and registers UI event handlers\r\n * @param fractalRenderer\r\n */\r\nexport async function initUI(fractalRenderer) {\r\n    if (uiInitialized) {\r\n        console.warn(\"UI already initialized!\");\r\n        return;\r\n    }\r\n\r\n    fractalApp = fractalRenderer;\r\n    canvas = fractalApp.canvas;\r\n\r\n    bindHTMLElements();\r\n\r\n    if (fractalRenderer instanceof JuliaRenderer) {\r\n        fractalMode = FRACTAL_TYPE.JULIA;\r\n        juliaSwitch.classList.add('active');\r\n        mandelbrotSwitch.classList.remove('active');\r\n\r\n        initJuliaSliders(fractalApp);\r\n        updateJuliaSliders();\r\n        initDiveButtons();\r\n\r\n        updateColorTheme(DEFAULT_JULIA_THEME_COLOR);\r\n        // Darker backgrounds for Julia as it renders on white\r\n        header.style.background = 'rgba(20, 20, 20, 0.8)';\r\n        infoLabel.style.background = 'rgba(20, 20, 20, 0.8)';\r\n\r\n        window.location.hash = '#julia'; // Update URL hash\r\n    } else {\r\n        initJuliaPreview();\r\n    }\r\n\r\n    initPresetButtonEvents();\r\n    initPresetsDropdown();\r\n    initDivesDropdown();\r\n    initPaletteButtonEvents();\r\n    initPaletteDropdown();\r\n    initWindowEvents();\r\n    initHeaderEvents();\r\n    initControlButtonEvents();\r\n    initInfoText();\r\n    initFractalSwitchButtons();\r\n    initCommonButtonEvents(); // After all dynamic buttons are set\r\n\r\n    // Register control events\r\n    if (isTouchDevice()) {\r\n        initTouchHandlers(fractalApp);\r\n    } else {\r\n        initHotKeys(fractalApp);\r\n        initMouseHandlers(fractalApp);\r\n    }\r\n\r\n    updatePaletteDropdownState();\r\n\r\n    if (DEBUG_MODE === DEBUG_LEVEL.FULL && !isMobileDevice()) {\r\n        toggleDebugMode();\r\n    }\r\n\r\n    uiInitialized = true;\r\n}\r\n\r\n// endregion------------------------------------------------------------------------------------------------------------","import {updateInfo} from \"../ui/ui\";\r\nimport FractalRenderer from \"./fractalRenderer\";\r\nimport {compareComplex, ddSubDD, degToRad, hexToRGB, lerp, normalizeRotation, splitFloat,} from \"../global/utils\";\r\nimport \"../global/types\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEFAULT_JULIA_PALETTE, EASE_TYPE,} from \"../global/constants\";\r\nimport {updateJuliaSliders} from \"../ui/juliaSlidersController\";\r\n/** @type {string} */\r\nimport fragmentShaderRaw from '../shaders/julia.frag';\r\nimport data from '../data/julia.json' with {type: 'json'};\r\n\r\n/**\r\n * JuliaRenderer (Rebased Perturbation)\r\n *\r\n * @author Radim Brnka\r\n * @description This module defines a JuliaRenderer class that inherits from fractalRenderer, implements the shader fragment code for the Julia set fractal, and sets preset zoom-ins.\r\n * Reference orbit is for current c and a chosen z0_ref (near the view center).\r\n * For each pixel:\r\n *   z0 = pan + zoom * rotated(st)\r\n *   dz0 = z0 - z0_ref\r\n *   dz_{n+1} = 2*zref*dz + dz^2 (NO +dc each step for Julia!)\r\n * @extends FractalRenderer\r\n * @see MandelbrotRenderer\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\nexport class JuliaRenderer extends FractalRenderer {\r\n\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        this.DEFAULT_ZOOM = data.presets[0].zoom;\r\n        this.MAX_ZOOM = 1e-17;\r\n        this.zoom = this.DEFAULT_ZOOM;\r\n\r\n        this.DEFAULT_ROTATION = data.presets[0].rotation;\r\n        this.rotation = this.DEFAULT_ROTATION;\r\n\r\n        // TODO Use less detailed initial set for less performant devices\r\n        /** @type COMPLEX */\r\n        this.DEFAULT_C = [data.presets[0].c[0], data.presets[0].c[1]];\r\n        /** @type COMPLEX */\r\n        this.c = [...this.DEFAULT_C];\r\n\r\n        // IMPORTANT: use setPan (syncs DD + array)  keep this.pan canonical (TODO remove pan completely at some point)\r\n        this.setPan(this.DEFAULT_PAN[0], this.DEFAULT_PAN[1]);\r\n\r\n        this.colorPalette = [...this.DEFAULT_PALETTE];\r\n\r\n        // --- Perturbation state with DD precision ---\r\n        this.refZ0 = [0, 0];\r\n        this.refZ0DD = {\r\n            x: { hi: 0, lo: 0 },\r\n            y: { hi: 0, lo: 0 }\r\n        };\r\n        this.refPan = [...this.DEFAULT_PAN];\r\n        this.refPanDD = {\r\n            x: { hi: this.DEFAULT_PAN[0], lo: 0 },\r\n            y: { hi: this.DEFAULT_PAN[1], lo: 0 }\r\n        };\r\n        this.orbitDirty = true;\r\n\r\n        this._prevPan0 = NaN;\r\n        this._prevPan1 = NaN;\r\n        this._prevZoom = NaN;\r\n        this._prevC0 = NaN;\r\n        this._prevC1 = NaN;\r\n\r\n        this.MAX_ITER = 5000;\r\n        this.REF_SEARCH_GRID = 7;\r\n        this.REF_SEARCH_RADIUS = 0.50;\r\n\r\n        this.orbitTex = null;\r\n        this.orbitData = null;\r\n        this.floatTexExt = null;\r\n\r\n        this.rebaseArmed = true;\r\n\r\n        /** @type {Array.<JULIA_PRESET>} */\r\n        this.PRESETS = data.presets.map(p => ({\r\n            ...p,\r\n            rotation: degToRad(p.rotation || 0)\r\n        }));\r\n\r\n        /** @type {Array.<DIVE>} */\r\n        this.DIVES = data.dives.map(d => ({\r\n            ...d,\r\n            rotation: degToRad(d.rotation || 0)\r\n        }));\r\n\r\n        /** @type {Array.<JULIA_PALETTE>} */\r\n        this.PALETTES = data.palettes || [];\r\n\r\n        this.currentPaletteIndex = 0;\r\n        this.innerStops = this.PALETTES.length > 0\r\n            ? new Float32Array(this.PALETTES[this.currentPaletteIndex].theme)\r\n            : new Float32Array(DEFAULT_JULIA_PALETTE.theme);\r\n\r\n        this.currentCAnimationFrame = null;\r\n        this.cAnimationActive = false; // Defers orbit rebuild during C-animation for performance\r\n        this.demoTime = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    markOrbitDirty = () => this.orbitDirty = true;\r\n\r\n    onProgramCreated() {\r\n        this.floatTexExt = this.gl.getExtension(\"OES_texture_float\");\r\n        if (!this.floatTexExt) {\r\n            console.error(\"Missing OES_texture_float. Julia deep zoom perturbation requires it.\");\r\n            return;\r\n        }\r\n\r\n        this.orbitTex = this.gl.createTexture();\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n\r\n        this.orbitData = new Float32Array(this.MAX_ITER * 4);\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n\r\n        this.orbitDirty = true;\r\n    }\r\n\r\n    createFragmentShaderSource() {\r\n        return fragmentShaderRaw.replace('__MAX_ITER__', this.MAX_ITER).toString();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    updateUniforms() {\r\n        super.updateUniforms();\r\n\r\n        this.cLoc = this.gl.getUniformLocation(this.program, \"u_c\");\r\n        this.innerStopsLoc = this.gl.getUniformLocation(this.program, \"u_innerStops\");\r\n\r\n        // delta z0 (pan - refZ0) computed on JS side for float64 precision\r\n        this.deltaZ0HLoc = this.gl.getUniformLocation(this.program, \"u_delta_z0_h\");\r\n        this.deltaZ0LLoc = this.gl.getUniformLocation(this.program, \"u_delta_z0_l\");\r\n        this.zoomHLoc = this.gl.getUniformLocation(this.program, \"u_zoom_h\");\r\n        this.zoomLLoc = this.gl.getUniformLocation(this.program, \"u_zoom_l\");\r\n\r\n        this.orbitTexLoc = this.gl.getUniformLocation(this.program, \"u_orbitTex\");\r\n        this.orbitWLoc = this.gl.getUniformLocation(this.program, \"u_orbitW\");\r\n    }\r\n\r\n    // --- Reference orbit building ---\r\n\r\n    escapeItersJulia(zx0, zy0, iters) {\r\n        let zx = zx0, zy = zy0;\r\n        const cx = this.c[0], cy = this.c[1];\r\n        for (let i = 0; i < iters; i++) {\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2; zy = zy2;\r\n            if (zx * zx + zy * zy > 4.0) return i;\r\n        }\r\n        return iters;\r\n    }\r\n\r\n    /**\r\n     * Choose a good refZ0 near view center:\r\n     * - sample a grid around view center (radius scales with zoom)\r\n     * - pick the point with the highest escape iteration (prefer inside / late escape)\r\n     * - prefer keeping the current reference to avoid jitter unless a significantly better one is found\r\n     * @param {boolean} useViewCenter - If true, skip grid search and use view center directly (for stability during interaction)\r\n     */\r\n    pickReferenceNearViewCenter(useViewCenter = false) {\r\n        // During interaction, use view center directly to prevent jitter from grid search\r\n        // Copy DD components to preserve deep zoom precision\r\n        if (useViewCenter) {\r\n            this.refZ0[0] = this.pan[0];\r\n            this.refZ0[1] = this.pan[1];\r\n            this.refZ0DD.x.hi = this.panDD.x.hi;\r\n            this.refZ0DD.x.lo = this.panDD.x.lo;\r\n            this.refZ0DD.y.hi = this.panDD.y.hi;\r\n            this.refZ0DD.y.lo = this.panDD.y.lo;\r\n            // Keep refPan in sync for needsRebase() to work correctly\r\n            this.refPan[0] = this.pan[0];\r\n            this.refPan[1] = this.pan[1];\r\n            this.refPanDD.x.hi = this.panDD.x.hi;\r\n            this.refPanDD.x.lo = this.panDD.x.lo;\r\n            this.refPanDD.y.hi = this.panDD.y.hi;\r\n            this.refPanDD.y.lo = this.panDD.y.lo;\r\n            return;\r\n        }\r\n\r\n        const grid = this.REF_SEARCH_GRID;\r\n        const half = (grid - 1) / 2;\r\n        const step = (2.0 * this.REF_SEARCH_RADIUS) / (grid - 1);\r\n\r\n        const base = this.zoom;\r\n        const probeIters = Math.min(this.MAX_ITER, Math.max(200, Math.floor(this.iterations)));\r\n\r\n        // Evaluate current reference point's score (if we have one within reasonable distance)\r\n        let currentRefScore = -1;\r\n        const currentRefDist = Math.hypot(this.refZ0[0] - this.pan[0], this.refZ0[1] - this.pan[1]);\r\n        const maxRefDist = base * this.REF_SEARCH_RADIUS * 2.5; // Allow some margin beyond search radius\r\n\r\n        if (currentRefDist < maxRefDist) {\r\n            currentRefScore = this.escapeItersJulia(this.refZ0[0], this.refZ0[1], probeIters);\r\n        }\r\n\r\n        // Start with view center as fallback\r\n        let bestX = this.pan[0];\r\n        let bestY = this.pan[1];\r\n        let bestScore = this.escapeItersJulia(this.pan[0], this.pan[1], probeIters);\r\n\r\n        for (let j = 0; j < grid; j++) {\r\n            for (let i = 0; i < grid; i++) {\r\n                const ox = (i - half) * step;\r\n                const oy = (j - half) * step;\r\n\r\n                const zx0 = this.pan[0] + ox * base;\r\n                const zy0 = this.pan[1] + oy * base;\r\n\r\n                const score = this.escapeItersJulia(zx0, zy0, probeIters);\r\n                if (score > bestScore) {\r\n                    bestScore = score;\r\n                    bestX = zx0;\r\n                    bestY = zy0;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Stability: only switch reference if the new one is significantly better.\r\n        // This prevents jitter from small score differences between frames.\r\n        // Require at least 10% improvement or 50 iterations better to switch.\r\n        const improvementThreshold = Math.max(currentRefScore * 0.10, 50);\r\n        const shouldSwitch = currentRefScore < 0 || (bestScore - currentRefScore) > improvementThreshold;\r\n\r\n        if (shouldSwitch) {\r\n            this.refZ0[0] = bestX;\r\n            this.refZ0[1] = bestY;\r\n            // New reference point from grid search - no DD precision accumulated yet\r\n            this.refZ0DD.x.hi = bestX;\r\n            this.refZ0DD.x.lo = 0;\r\n            this.refZ0DD.y.hi = bestY;\r\n            this.refZ0DD.y.lo = 0;\r\n            // Keep refPan in sync for needsRebase() to work correctly\r\n            this.refPan[0] = bestX;\r\n            this.refPan[1] = bestY;\r\n            this.refPanDD.x.hi = bestX;\r\n            this.refPanDD.x.lo = 0;\r\n            this.refPanDD.y.hi = bestY;\r\n            this.refPanDD.y.lo = 0;\r\n        }\r\n        // else: keep current refZ0 for stability\r\n    }\r\n\r\n    computeReferenceOrbit() {\r\n        if (!this.orbitData || !this.orbitTex) return;\r\n\r\n        const cx = this.c[0];\r\n        const cy = this.c[1];\r\n\r\n        let zx = this.refZ0[0];\r\n        let zy = this.refZ0[1];\r\n\r\n        for (let n = 0; n < this.MAX_ITER; n++) {\r\n            const sx = splitFloat(zx);\r\n            const sy = splitFloat(zy);\r\n\r\n            const idx = n * 4;\r\n            this.orbitData[idx] = sx.high;\r\n            this.orbitData[idx + 1] = sx.low;\r\n            this.orbitData[idx + 2] = sy.high;\r\n            this.orbitData[idx + 3] = sy.low;\r\n\r\n            const zx2 = zx * zx - zy * zy + cx;\r\n            const zy2 = 2.0 * zx * zy + cy;\r\n            zx = zx2; zy = zy2;\r\n\r\n            if (zx * zx + zy * zy > 4.0) {\r\n                const fx = splitFloat(zx);\r\n                const fy = splitFloat(zy);\r\n                for (let k = n + 1; k < this.MAX_ITER; k++) {\r\n                    const j = k * 4;\r\n                    this.orbitData[j] = fx.high;\r\n                    this.orbitData[j + 1] = fx.low;\r\n                    this.orbitData[j + 2] = fy.high;\r\n                    this.orbitData[j + 3] = fy.low;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.gl.activeTexture(this.gl.TEXTURE0);\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.orbitTex);\r\n\r\n        this.gl.texImage2D(\r\n            this.gl.TEXTURE_2D,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.MAX_ITER,\r\n            1,\r\n            0,\r\n            this.gl.RGBA,\r\n            this.gl.FLOAT,\r\n            this.orbitData\r\n        );\r\n\r\n        if (this.orbitTexLoc) this.gl.uniform1i(this.orbitTexLoc, 0);\r\n        if (this.orbitWLoc) this.gl.uniform1f(this.orbitWLoc, this.MAX_ITER);\r\n    }\r\n\r\n    /**\r\n     * Julia \"needsRebase\": keep reference initial condition close to view center.\r\n     * Same intent as Mandelbrot, but for z0 reference.\r\n     */\r\n    needsRebase() {\r\n        const REBASE_ON = 1.75;\r\n        const REBASE_OFF = 0.90;\r\n\r\n        if (this.rebaseArmed === undefined) this.rebaseArmed = true;\r\n\r\n        if (!this.refPan) return true;\r\n        if (!Number.isFinite(this.zoom)) return false;\r\n\r\n        const z = Math.max(this.zoom, 1e-300);\r\n\r\n        const dx = this.pan[0] - this.refPan[0];\r\n        const dy = this.pan[1] - this.refPan[1];\r\n        const deltaView = Math.hypot(dx, dy) / z;\r\n\r\n        if (!this.rebaseArmed && deltaView < REBASE_OFF) {\r\n            this.rebaseArmed = true;\r\n            return false;\r\n        }\r\n\r\n        if (this.rebaseArmed && deltaView > REBASE_ON) {\r\n            this.rebaseArmed = false;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    draw() {\r\n        this.gl.useProgram(this.program);\r\n\r\n        // Iteration strategy avoids exploding to infinity at tiny zooms\r\n        const safe = Math.max(this.zoom, 1e-300);\r\n        const log2Depth = Math.log2(this.DEFAULT_ZOOM / safe);\r\n        const baseIters = Math.floor(200 + 50 * log2Depth);\r\n        this.iterations = Math.max(50, Math.min(this.MAX_ITER, baseIters + this.extraIterations));\r\n\r\n        // Detect view changes -> mark orbit dirty (use tolerant checks to avoid noise)\r\n        const panMoved =\r\n            Number.isFinite(this._prevPan0) && Number.isFinite(this._prevPan1)\r\n                ? (Math.abs(this.pan[0] - this._prevPan0) + Math.abs(this.pan[1] - this._prevPan1)) > (this.zoom * 1e-6)\r\n                : true;\r\n\r\n        const zoomChanged =\r\n            Number.isFinite(this._prevZoom)\r\n                ? Math.abs(this.zoom - this._prevZoom) > (this.zoom * 1e-8)\r\n                : true;\r\n\r\n        const cChanged =\r\n            Number.isFinite(this._prevC0) && Number.isFinite(this._prevC1)\r\n                ? (Math.abs(this.c[0] - this._prevC0) + Math.abs(this.c[1] - this._prevC1)) > 0.0\r\n                : true;\r\n\r\n        if (panMoved || zoomChanged || cChanged) {\r\n            this.orbitDirty = true;\r\n            this._prevPan0 = this.pan[0];\r\n            this._prevPan1 = this.pan[1];\r\n            this._prevZoom = this.zoom;\r\n            this._prevC0 = this.c[0];\r\n            this._prevC1 = this.c[1];\r\n        }\r\n\r\n        // Rebase policy for Julia:\r\n        // - c changes REQUIRE orbit rebuild (orbit depends on c) - cannot be deferred\r\n        // - during C-animation, skip expensive grid search (use view center directly)\r\n        // - pan/zoom during interaction can defer until settled\r\n        const mustRebaseNow = cChanged || this.needsRebase();\r\n        const isDeferringForAnimation = this.cAnimationActive || this.interactionActive;\r\n        const canRebaseNow = !isDeferringForAnimation || mustRebaseNow;\r\n\r\n        if (this.orbitDirty && canRebaseNow) {\r\n            // During interaction/animation, skip grid search (use view center directly)\r\n            this.pickReferenceNearViewCenter(isDeferringForAnimation);\r\n            this.computeReferenceOrbit();\r\n            this.orbitDirty = false;\r\n        }\r\n\r\n        // Compute deltaZ0 = panDD - refZ0DD on JS side (float64) for precision\r\n        // This avoids float32 precision loss when the shader subtracts pan - refZ0\r\n        const deltaZ0X = ddSubDD(this.panDD.x, this.refZ0DD.x);\r\n        const deltaZ0Y = ddSubDD(this.panDD.y, this.refZ0DD.y);\r\n\r\n        // Upload deltaZ0 hi/lo\r\n        if (this.deltaZ0HLoc) this.gl.uniform2f(this.deltaZ0HLoc, deltaZ0X.hi, deltaZ0Y.hi);\r\n        if (this.deltaZ0LLoc) this.gl.uniform2f(this.deltaZ0LLoc, deltaZ0X.lo, deltaZ0Y.lo);\r\n\r\n        // Upload zoom hi/lo\r\n        const z = splitFloat(this.zoom);\r\n        if (this.zoomHLoc) this.gl.uniform1f(this.zoomHLoc, z.high);\r\n        if (this.zoomLLoc) this.gl.uniform1f(this.zoomLLoc, z.low);\r\n\r\n        if (this.cLoc) this.gl.uniform2fv(this.cLoc, this.c);\r\n        if (this.innerStopsLoc) this.gl.uniform3fv(this.innerStopsLoc, this.innerStops);\r\n\r\n        super.draw();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    reset() {\r\n        this.c = [...this.DEFAULT_C];\r\n        this.currentPaletteIndex = 0;\r\n        this.innerStops = this.PALETTES.length > 0\r\n            ? new Float32Array(this.PALETTES[0].theme)\r\n            : new Float32Array([0, 0, 0, 1, 0.647, 0, 0, 0, 0, 1.2, 1.2, 1.0, 0.1, 0.1, 0.1]);\r\n\r\n        this.orbitDirty = true;\r\n        this._prevPan0 = NaN;\r\n        this._prevPan1 = NaN;\r\n        this._prevZoom = NaN;\r\n        this._prevC0 = NaN;\r\n        this._prevC1 = NaN;\r\n\r\n        super.reset();\r\n    }\r\n\r\n    // region > ANIMATION METHODS --------------------------------------------------------------------------------------\r\n\r\n    /** Stops currently running C animation and triggers final orbit rebuild */\r\n    stopCurrentCAnimation() {\r\n        console.log(`%c ${this.constructor.name}: %c stopCurrentCAnimation`, CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        if (this.currentCAnimationFrame !== null) {\r\n            cancelAnimationFrame(this.currentCAnimationFrame);\r\n            this.currentCAnimationFrame = null;\r\n        }\r\n\r\n        // Clear animation flag and force accurate orbit rebuild\r\n        if (this.cAnimationActive) {\r\n            this.cAnimationActive = false;\r\n            this.markOrbitDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     * @override\r\n     */\r\n    stopAllNonColorAnimations() {\r\n        this.stopCurrentCAnimation();\r\n\r\n        super.stopAllNonColorAnimations();\r\n    }\r\n\r\n    /**\r\n     * Smoothly transitions the inner color stops (used by the shader for inner coloring)\r\n     * from the current value to the provided toPalette over the specified duration.\r\n     * Also updates the colorPalette to match the theme (using the first stop, for example).\r\n     *\r\n     * @param {JULIA_PALETTE} toPalette - The target theme as an array of numbers (e.g., 15 numbers for 5 stops).\r\n     * @param {number} [duration=250] - Duration of the transition in milliseconds.\r\n     * @param {Function} [callback] - A callback invoked when the transition completes.\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateInnerStopsTransition(toPalette, duration = 250, callback = null) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateInnerStopsTransition`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentColorAnimations();\r\n\r\n        // Save the starting stops as a plain array.\r\n        const startStops = Array.from(this.innerStops);\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                // Interpolate each component of the inner stops.\r\n                const interpolated = startStops.map((v, i) => lerp(v, toPalette.theme[i], progress));\r\n                this.innerStops = new Float32Array(interpolated);\r\n\r\n                let keyColor;\r\n\r\n                if (toPalette.keyColor) {\r\n                    keyColor = hexToRGB(toPalette.keyColor);\r\n                    if (keyColor) this.colorPalette = [keyColor.r, keyColor.g, keyColor.b];\r\n                }\r\n\r\n                if (!keyColor) {\r\n                    const stopIndex = 3;\r\n                    this.colorPalette = [\r\n                        toPalette.theme[stopIndex * 3] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 1] * 1.5,\r\n                        toPalette.theme[stopIndex * 3 + 2] * 1.5\r\n                    ];\r\n                }\r\n\r\n                this.draw();\r\n\r\n                if (callback) callback();\r\n\r\n                if (progress < 1) {\r\n                    this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.stopCurrentColorAnimations();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n\r\n            this.currentColorAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    async animateColorPaletteTransition(duration = 250, coloringCallback = null) {\r\n        if (this.PALETTES.length === 0) {\r\n            // No palettes defined - just trigger random color (handled by base class)\r\n            return super.animateColorPaletteTransition(duration, coloringCallback);\r\n        }\r\n        this.currentPaletteIndex = (this.currentPaletteIndex + 1) % this.PALETTES.length;\r\n        await this.animateInnerStopsTransition(this.PALETTES[this.currentPaletteIndex], duration, coloringCallback);\r\n    }\r\n\r\n    /**\r\n     * Applies a specific palette by index\r\n     * @param {number} index - Palette index\r\n     * @param {number} [duration=250] - Transition duration in ms\r\n     * @param {Function} [coloringCallback] - Callback when done\r\n     * @return {Promise<void>}\r\n     */\r\n    async applyPaletteByIndex(index, duration = 250, coloringCallback = null) {\r\n        if (this.PALETTES.length === 0 || index < 0 || index >= this.PALETTES.length) {\r\n            return;\r\n        }\r\n        this.currentPaletteIndex = index;\r\n        await this.animateInnerStopsTransition(this.PALETTES[index], duration, coloringCallback);\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    async animateFullColorSpaceCycle(duration = 15000, coloringCallback = null) {\r\n        await new Promise(() => {\r\n            this.animateColorPaletteTransition(duration, coloringCallback);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates Julia from current C to target C\r\n     *\r\n     * @param {COMPLEX} [targetC] Defaults to default C\r\n     * @param {number} [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateToC(targetC = [...this.DEFAULT_C], duration = 500, easeFunction = EASE_TYPE.QUINT) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateToC`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        if (compareComplex(this.c, targetC)) {\r\n            console.log(`Already at the target c. Skipping.`);\r\n            console.groupEnd();\r\n            return;\r\n        }\r\n\r\n        console.log(`Animating c from ${this.c} to ${targetC}.`);\r\n\r\n        const startC = [...this.c];\r\n        this.cAnimationActive = true; // Defer orbit rebuilds during animation\r\n\r\n        await new Promise((resolve) => {\r\n            let startTime = null;\r\n\r\n            const step = (timestamp) => {\r\n                if (!startTime) startTime = timestamp;\r\n                const progress = Math.min((timestamp - startTime) / duration, 1);\r\n\r\n                // Interpolate `c` smoothly\r\n                const easedProgress = easeFunction(progress);\r\n                this.c[0] = lerp(startC[0], targetC[0], easedProgress);\r\n                this.c[1] = lerp(startC[1], targetC[1], easedProgress);\r\n\r\n                this.draw();\r\n\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                if (progress < 1) {\r\n                    this.currentCAnimationFrame = requestAnimationFrame(step);\r\n                } else {\r\n                    this.cAnimationActive = false;\r\n                    // Force final orbit rebuild with accurate reference\r\n                    this.markOrbitDirty();\r\n                    this.draw();\r\n\r\n                    this.stopCurrentCAnimation();\r\n                    this.onAnimationFinished();\r\n                    console.groupEnd();\r\n                    resolve();\r\n                }\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates Julia from current C and zoom to target C and zoom\r\n     *\r\n     * @param {number} [targetZoom] Target zoom\r\n     * @param {COMPLEX} [targetC] Defaults to default C\r\n     * @param {number} [duration] in ms\r\n     * @param {EASE_TYPE|Function} easeFunction\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateToZoomAndC(targetZoom, targetC = [...this.DEFAULT_C], duration = 500, easeFunction = EASE_TYPE.QUINT) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateToZoomAndC`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        await Promise.all([\r\n            this.animateZoomTo(targetZoom, duration, easeFunction),\r\n            this.animateToC(targetC, duration, easeFunction)\r\n        ]);\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Animates travel to a preset.\r\n     * @param {JULIA_PRESET} preset\r\n     * @param {number} [duration] in ms\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateTravelToPreset(preset, duration = 500) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateTravelToPreset`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        // Phase 1: Setting default params.\r\n        await this.animatePanAndZoomTo(this.DEFAULT_PAN, this.DEFAULT_ZOOM, 1000);\r\n\r\n        // Phase 2: Animating to preset.\r\n        await Promise.all([\r\n            this.animateZoomTo(preset.zoom, duration, EASE_TYPE.QUINT),\r\n            this.animateToC(preset.c, duration),\r\n            this.animateRotationTo(preset.rotation, duration, EASE_TYPE.QUINT),\r\n            this.animatePanTo(preset.pan, duration, EASE_TYPE.QUINT)\r\n        ]);\r\n\r\n        this.currentPresetIndex = preset.id || 0;\r\n\r\n        console.groupEnd();\r\n    }\r\n\r\n    /**\r\n     * Infinite animation of the dive (c-param interpolations)\r\n     * @param {DIVE} dive\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDive(dive) {\r\n        console.groupCollapsed(`%c ${this.constructor.name}: animateDive`, CONSOLE_GROUP_STYLE);\r\n        this.stopCurrentCAnimation();\r\n\r\n        console.log(`Diving to ${dive}.`);\r\n        // Note: Do NOT set cAnimationActive for continuous animations.\r\n        // The grid search in pickReferenceNearViewCenter is needed for stability\r\n        // when c changes to values where view center might escape immediately.\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            // Ensure phases are defined\r\n            dive.phases ||= [1, 2, 3, 4];\r\n            let phase = dive.phases[0];\r\n\r\n            const diveStep = () => {\r\n                const step = dive.step;\r\n                // Phase 1: Animate cx (real part) toward endC[0]\r\n                if (phase === 1) {\r\n                    this.c[0] += dive.cxDirection * step;\r\n                    if ((dive.cxDirection < 0 && this.c[0] <= dive.endC[0]) || (dive.cxDirection > 0 && this.c[0] >= dive.endC[0])) {\r\n                        this.c[0] = dive.endC[0];\r\n                        phase = 2;\r\n                    }\r\n                }\r\n                // Phase 2: Animate cy (imaginary part) toward endC[1]\r\n                else if (phase === 2) {\r\n                    this.c[1] += dive.cyDirection * step;\r\n                    if ((dive.cyDirection < 0 && this.c[1] <= dive.endC[1]) || (dive.cyDirection > 0 && this.c[1] >= dive.endC[1])) {\r\n                        this.c[1] = dive.endC[1];\r\n                        phase = 3;\r\n                    }\r\n                }\r\n                // Phase 3: Animate cx back toward startC[0]\r\n                else if (phase === 3) {\r\n                    this.c[0] -= dive.cxDirection * step;\r\n                    if ((dive.cxDirection < 0 && this.c[0] >= dive.startC[0]) || (dive.cxDirection > 0 && this.c[0] <= dive.startC[0])) {\r\n                        this.c[0] = dive.startC[0];\r\n                        phase = 4;\r\n                    }\r\n                }\r\n                // Phase 4: Animate cy back toward startC[1]\r\n                else if (phase === 4) {\r\n                    this.c[1] -= dive.cyDirection * step;\r\n                    if ((dive.cyDirection < 0 && this.c[1] >= dive.startC[1]) || (dive.cyDirection > 0 && this.c[1] <= dive.startC[1])) {\r\n                        this.c[1] = dive.startC[1];\r\n                        phase = 1; // Loop back to start phase.\r\n                    }\r\n                }\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                this.currentCAnimationFrame = requestAnimationFrame(diveStep);\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(diveStep);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Animates infinite demo loop with oscillating c between predefined values\r\n     * @return {Promise<void>}\r\n     */\r\n    async animateDemo() {\r\n        console.log(`%c ${this.constructor.name}: animateDemo`, CONSOLE_GROUP_STYLE);\r\n        this.stopAllNonColorAnimations();\r\n\r\n        this.demoActive = true;\r\n        // Note: Do NOT set cAnimationActive for continuous animations - grid search needed for stability\r\n\r\n        // Return a Promise that never resolves (continuous animation)\r\n        await new Promise(() => {\r\n            const step = () => {\r\n                this.c = [\r\n                    ((Math.sin(this.demoTime) + 1) / 2) * 1.5 - 1,   // Oscillates between -1 and 0.5\r\n                    ((Math.cos(this.demoTime) + 1) / 2) * 1.4 - 0.7  // Oscillates between -0.7 and 0.7\r\n                ];\r\n                this.rotation = normalizeRotation(this.rotation - 0.001);\r\n                this.demoTime += 0.0005; // Speed\r\n\r\n                this.draw();\r\n                updateInfo(true);\r\n                updateJuliaSliders();\r\n\r\n                this.currentCAnimationFrame = requestAnimationFrame(step);\r\n            };\r\n            this.currentCAnimationFrame = requestAnimationFrame(step);\r\n        });\r\n    }\r\n\r\n    // endregion--------------------------------------------------------------------------------------------------------\r\n}","/**\r\n * @module Main\r\n * @author Radim Brnka\r\n * @description The entry point that imports modules, creates the fractal renderer instance (passing the canvas ID), initializes the UI and the fractal.\r\n * @copyright Synaptory Fractal Traveler, 2025-2026\r\n * @license MIT\r\n */\r\n\r\nimport './css/style.css';\r\nimport './css/debugPanel.css';\r\nimport {JuliaRenderer} from \"./renderers/juliaRenderer\";\r\nimport MandelbrotRenderer from \"./renderers/mandelbrotRenderer\";\r\nimport RiemannRenderer from \"./renderers/riemannRenderer\";\r\nimport {initUI, resetActivePresetIndex, resetPresetAndDiveButtonStates, updateInfo} from \"./ui/ui\";\r\nimport {asyncDelay, clearURLParams, loadFractalParamsFromURL} from \"./global/utils\";\r\nimport {CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE, DEBUG_LEVEL, DEBUG_MODE, FRACTAL_TYPE} from \"./global/constants\";\r\n\r\n/**\r\n * Initializes the canvas, reads URL params and triggers respective fractal rendering\r\n */\r\nasync function initFractalApp() {\r\n    if (DEBUG_MODE > DEBUG_LEVEL.VERBOSE) console.warn(' --- FULL DEBUG MODE ACTIVE! ---');\r\n    console.groupCollapsed(`%c initFractalApp`, CONSOLE_GROUP_STYLE);\r\n\r\n    const canvas = document.getElementById('fractalCanvas');\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n\r\n    const params = loadFractalParamsFromURL();\r\n    console.log(`URL Params found:  ${JSON.stringify(params)}`);\r\n\r\n    // Do we have all the params needed for initial travel?\r\n    const validMandelbrotTravelPreset = params.px != null && params.py != null && params.zoom != null && params.r != null;\r\n    const validJuliaTravelPreset = validMandelbrotTravelPreset && params.cx != null && params.cy != null;\r\n    const preset = {\r\n        pan: [params.px, params.py],\r\n        zoom: params.zoom,\r\n        c: [params.cx, params.cy],\r\n        rotation: params.r\r\n    };\r\n\r\n    const onDefault = () => {\r\n        console.log(`Default fractal settings used.`);\r\n        fractalApp.resizeCanvas();\r\n        clearURLParams();\r\n    }\r\n\r\n    let fractalApp;\r\n\r\n    switch (params.mode) {\r\n        /************\r\n         * JULIA SET\r\n         ************/\r\n        case FRACTAL_TYPE.JULIA:\r\n            console.log(`Constructing Julia.`);\r\n            fractalApp = new JuliaRenderer(canvas);\r\n            break;\r\n\r\n        /****************\r\n         * MANDELBROT SET\r\n         ****************/\r\n        case FRACTAL_TYPE.MANDELBROT:\r\n            console.log(`Constructing Mandelbrot.`);\r\n            fractalApp = new MandelbrotRenderer(canvas);\r\n            break;\r\n\r\n        /****************\r\n         * RIEMANN ZETA\r\n         ****************/\r\n        case FRACTAL_TYPE.RIEMANN:\r\n            console.log(`Constructing Riemann Zeta.`);\r\n            fractalApp = new RiemannRenderer(canvas);\r\n            break;\r\n\r\n        default:\r\n            console.error('Unknown fractal mode: ' + params.mode);\r\n            break;\r\n    }\r\n\r\n    await asyncDelay(100); // Wait a moment for things to stabilize\r\n    await initUI(fractalApp); // TODO consider initializing after travel\r\n\r\n    if (validJuliaTravelPreset) {\r\n        console.log(`Traveling to URL params.`);\r\n        await fractalApp.animateTravelToPreset(preset, 1000);\r\n    } else if (validMandelbrotTravelPreset) {\r\n        console.log(`Traveling to URL params.`);\r\n        await fractalApp.animateTravelToPreset(preset, 100, 1000);\r\n    } else {\r\n        onDefault();\r\n    }\r\n\r\n    await asyncDelay(100); // Wait a moment for things to stabilize\r\n\r\n    await new Promise(resolve => {\r\n        document.getElementById('headerContainer').classList.add('ready');\r\n        document.getElementById('infoLabel').classList.add('ready');\r\n        resolve();\r\n    });\r\n\r\n    // If URL contains a preset, reset buttons\r\n    if (validMandelbrotTravelPreset || validJuliaTravelPreset) {\r\n        resetPresetAndDiveButtonStates();\r\n        resetActivePresetIndex();\r\n    }\r\n\r\n    console.groupEnd();\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n        if (DEBUG_MODE) console.log('%c DOMContentLoaded: %c Initializing fractal.', CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        await initFractalApp();\r\n        console.log('%c DOMContentLoaded: %c Fractal init complete.', CONSOLE_GROUP_STYLE, CONSOLE_MESSAGE_STYLE);\r\n\r\n        await asyncDelay(2000); // Wait a moment for things to stabilize\r\n        updateInfo();\r\n    }, {\r\n        once: true\r\n    }\r\n);"],"names":["DEBUG_LEVEL","DEBUG_MODE","LOG_LEVEL","log","message","scope","arguments","length","undefined","concat","FRACTAL_TYPE","MANDELBROT","JULIA","RIEMANN","EASE_TYPE","NONE","x","QUAD","time","CUBIC","Math","pow","QUINT","ROTATION_DIRECTION","DEFAULT_ACCENT_COLOR","DEFAULT_BG_COLOR","DEFAULT_JULIA_PALETTE","id","keyColor","theme","DEFAULT_MANDELBROT_THEME_COLOR","DEFAULT_JULIA_THEME_COLOR","hex","normalize","rgb","hexToRGB","r","g","b","hexToRGBArray","PI","e","t","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_slicedToArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_nonIterableRest","toString","slice","constructor","name","test","urlParamsSet","updateURLParams","mode","px","py","zoom","rotation","cx","cy","formatNumber","Number","toPrecision","params","toFixed","some","el","encodedParams","btoa","JSON","stringify","hashPath","window","history","pushState","loadFractalParamsFromURL","hash","URL","location","href","_hash$slice$split2","split","queryString","URLSearchParams","get","decodedParams","parse","atob","parseFloat","clearURLParams","newUrl","origin","isTouchDevice","navigator","maxTouchPoints","msMaxTouchPoints","isMobileDevice","toMatchItem","userAgent","match","expandComplexToString","precision","withI","invalidValues","NaN","isNumber","isFinite","expanded","trimmedReal","trimmedImag","SPLIT_FLOAT_METHOD","splitFloat","high","fround","low","splitFloatED","temp","VELTKAMP_DEKKER_K","splitFloatVD","ddMake","hi","lo","twoSum","s","bb","err","quickTwoSum","ddAdd","dd","ddSet","ddValue","ddSubDD","ddAddDD","compareComplex","c1","c2","comparePalettes","p1","p2","hsbToRgb","h","bl","floor","q","hslToRgb","hue2rgb","rgbToHsl","max","min","toLowerCase","replace","map","char","join","parseInt","substring","lerp","start","end","degToRad","degrees","normalizeRotation","twoPi","getAnimationDuration","seed","current","target","weights","compositeDistance","_loop","hasOwnProperty","key","currVal","targVal","diff","abs","hypot","apply","round","asyncDelay","_x","_asyncDelay","_callee","timeout","_context","setTimeout","_next","_throw","destroyArrayOfButtons","buttons","forEach","btn","parentNode","removeChild","Renderer","canvas","_classCallCheck","this","gl","getContext","antialias","alpha","depth","stencil","preserveDrawingBuffer","powerPreference","onWebGLContextLost","addEventListener","alert","event","preventDefault","init","Error","_asyncToGenerator","_defineProperties","_toPropertyKey","_typeof","toPrimitive","String","_toPrimitive","_callSuper","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","Boolean","valueOf","_get","_superPropBase","getOwnPropertyDescriptor","_setPrototypeOf","FractalRenderer","_Renderer","_this","MAX_ITER","DEFAULT_ROTATION","DEFAULT_ZOOM","DEFAULT_PAN","DEFAULT_PALETTE","MAX_ZOOM","MIN_ZOOM","PRESETS","pan","panDD","currentPanAnimationFrame","currentZoomAnimationFrame","currentRotationAnimationFrame","currentColorAnimationFrame","demoActive","currentPresetIndex","interactionActive","interactionTimer","iterations","extraIterations","bestScore","probeIters","colorPalette","_uniformCache","resW","resH","pan0","pan1","color0","color1","color2","vertexShaderSource","_inherits","dx","dy","fxAnchor","fyAnchor","vx","vy","setPan","targetZoom","anchorX","anchorY","_this$screenToViewVec2","screenToViewVector","deltaZoom","addPan","_this2","settleMs","clearTimeout","markOrbitDirty","draw","updateInfo","stopAllNonColorAnimations","stopCurrentColorAnimations","removeEventListener","program","deleteProgram","vertexShader","deleteShader","fragmentShader","preset","index","generatePresetIDs","initGLProgram","useProgram","oldRect","getBoundingClientRect","width","height","_this$screenToFractal2","screenToFractal","centerFx","centerFy","dpr","devicePixelRatio","viewport","resolutionLoc","uniform2f","_this$screenToViewVec4","setPanFromAnchor","source","type","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","VERTEX_SHADER","createFragmentShaderSource","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","positions","Float32Array","bufferData","STATIC_DRAW","positionLoc","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","updateUniforms","invalidateUniformCache","onProgramCreated","panLoc","getUniformLocation","zoomLoc","iterLoc","colorLoc","rotationLoc","uc","uniform2fv","uniform1f","uniform3fv","clearColor","clear","COLOR_BUFFER_BIT","debugPanel","beginGpuTimer","drawArrays","TRIANGLE_STRIP","endGpuTimer","resizeCanvas","screenX","screenY","rect","stX","stY","cosR","cos","sinR","sin","rotatedY","stopCurrentPanAnimation","stopCurrentZoomAnimation","stopCurrentRotationAnimation","cancelAnimationFrame","_animateColorPaletteTransition","newPalette","duration","coloringCallback","startPalette","_this3","_args","startTime","step","timestamp","progress","requestAnimationFrame","_animateFullColorSpaceCycle","_callee2","currentRGB","hsl","startHue","_this4","_args2","_context2","newHue","_animatePanTo","_callee3","targetPan","easeFunction","startPan","_this5","_args3","_context3","k","nx","ny","onAnimationFinished","_x2","_animatePanBy","_callee4","deltaPan","_this6","_args4","_context4","prevK","dk","_x3","_animateZoomTo","_callee5","_this$getCanvasCssCen","_this$getCanvasCssCen2","startZoom","ratio","_this$screenToViewVec5","_this$screenToViewVec6","_this7","_args5","_context5","getCanvasCssCenter","_x4","_animateZoomToNoPan","_callee6","_this8","_args6","_context6","_x5","_animateRotationTo","_callee7","targetRotation","startRotation","_this9","_args7","_context7","_x6","_animatePanThenZoomTo","_callee8","panDuration","zoomDuration","_args8","_context8","animatePanTo","animateZoomTo","_x7","_x8","_x9","_x0","_animatePanAndZoomTo","_callee9","_args9","_context9","all","animateZoomToNoPan","_x1","_x10","_animateZoomRotationTo","_callee0","_args0","_context0","animateRotationTo","_x11","_x12","_animatePanZoomRotationTo","_callee1","_args1","_context1","_x13","_x14","_x15","_animateInfiniteRotation","_callee10","direction","dir","_this0","_args10","_context10","rotationStep","_x16","_superPropGet","JuliaPreviewRenderer","_FractalRenderer","DEFAULT_C","data","DIVES","innerStops","currentCAnimationFrame","demoTime","cLoc","innerStopsLoc","baseIters","log2","stopIndex","floatingCanvas","previewRenderer","previewActive","pendingInnerStops","PREVIEW_WIDTH","PREVIEW_HEIGHT","initJuliaPreview","document","getElementById","style","updatePreviewPosition","viewportWidth","innerWidth","viewportHeight","innerHeight","left","top","hideJuliaPreview","display","recolorJuliaPreview","palette","animateColorPaletteTransition","resetJuliaPreview","reset","fractalApp","handleWheelEvent","handleMouseDownEvent","handleMouseMoveEvent","handleMouseUpEvent","handleMouseLeaveEvent","DOUBLE_CLICK_THRESHOLD","ZOOM_STEP","mouseHandlersRegistered","mouseDownX","mouseDownY","lastX","lastY","clickTimeout","wheelResetTimeout","isDragging","wasRotated","isRightDragging","startX","isMiddleButtonHeld","dragRectLeft","dragRectTop","hasDragRect","wheelAccum","wheelAnchorX","wheelAnchorY","wheelRAF","wheelRectLeft","wheelRectTop","hasWheelRect","markOrbitDirtySafe","initMouseHandlers","app","registerMouseEventHandlers","deltaY","clientX","clientY","flushWheelZoom","resetAppState","noteInteraction","handleWheel","button","isJuliaMode","mouseX","mouseY","_fractalApp$screenToF2","fx","fy","handleMouseDown","cursor","lastRelX","lastRelY","nowRelX","nowRelY","_fractalApp$screenToV2","vLastX","vLastY","_fractalApp$screenToV4","vNowX","vNowY","deltaX","_fractalApp$screenToF4","handleMouseMove","includes","stopPropagation","_fractalApp$screenToF6","animatePanAndZoomTo","clipboard","writeText","_fractalApp$screenToF8","handleMouseUp","passive","unregisterMouseEventHandlers","zoomFactor","setZoomKeepingAnchor","handleTouchStartEvent","handleTouchMoveEvent","handleTouchEndEvent","touchHandlersRegistered","touchDownX","touchDownY","lastTouchX","lastTouchY","touchClickTimeout","isTouchDragging","isPinching","pinchStartDistance","pinchStartAngle","initTouchHandlers","registerTouchEventHandlers","touches","touch","touch0","touch1","atan2","handleTouchStart","currentDistance","currentAngle","centerClientX","centerClientY","centerX","centerY","angleDifference","handleTouchMove","changedTouches","touchX","touchY","handleTouchEnd","unregisterTouchEventHandlers","takeScreenshot","accentColor","offscreenCanvas","createElement","ctx","drawImage","watermarkText","fractalType","toExponential","JuliaRenderer","getWatermarkText","font","textAlign","textBaseline","rectWidth","measureText","padding","borderWidth","fontSize","fillStyle","radius","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","drawRoundRect","fill","textX","textY","rectHeight","fillText","now","pad","link","setAttribute","Date","padStart","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","toDataURL","click","ANIMATION_KEYS_BLACKLIST","PAN_STEP","PAN_SMOOTH_STEP","JULIA_HOTKEY_C_STEP","JULIA_HOTKEY_C_SMOOTH_MULTIPLIER","rotationActive","initialized","onKeyDown","_onKeyDown","_target$tagName","tag","handled","rotationSpeed","rotationDirection","deltaPanX","deltaPanY","deltaCx","deltaCy","altKey","_fractalApp$PALETTES","increment","effectiveDeltaX","effectiveDeltaY","effectiveDeltaCx","effectiveDeltaCy","_t","tagName","isContentEditable","shiftKey","code","isAnimationActive","animateInfiniteRotation","toggleCenterLines","toggleDebugMode","switchFractalTypeWithPersistence","PALETTES","applyPaletteByIndex","updateColorTheme","updatePaletteDropdownState","animateFullColorSpaceCycle","randomizeColors","captureScreenshot","toggleDemo","switchFractalMode","useAnalyticExtension","ctrlKey","toggleHeader","startJuliaDive","travelToPreset","animatePanBy","animateToC","initHotKeys","destroyHotKeys","MandelbrotRenderer","orbitDirty","refPan","refPanDD","REF_SEARCH_GRID","REF_SEARCH_RADIUS","rebaseArmed","orbitTex","orbitData","floatTexExt","presetsData","currentPaletteIndex","getExtension","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","orbitTexLoc","uniform1i","orbitWLoc","deltaPanHLoc","deltaPanLLoc","zoomHLoc","zoomLLoc","iters","zx","zy","zy2","grid","half","base","currentRefScore","escapeItersDouble","bestCx","bestCy","j","ox","oy","score","improvementThreshold","sx","sy","idx","texImage2D","RGBA","safe","log2Depth","mustRebaseNow","needsRebase","canRebaseNow","pickReferenceNearViewCenter","computeReferenceOrbit","z","_applyPaletteByIndex","clamp","normalizeRgb","randomBrightMultiplierPalette","_c","hue","random","sat","val","_normalizeRgb2","baseGain","colorGain","lift","_animateTravelToPreset","_preset$rotation","zoomOutDuration","zoomInDuration","presetRotation","atTargetZoom","atTargetPan","_preset$speed","extraSpins","cinematicRotation","_preset$speed2","zoomOutRotation","_extraSpins","cinematicFinalRotation","animateZoomRotationTo","speed","_animateDemo","getNextPresetIndex","currentPreset","nextIdx","animateTravelToPreset","RiemannRenderer","termCount","termCountLoc","useAnalyticExtensionLoc","sliderContainer","realSlider","imagSlider","realSliderValue","imagSliderValue","lastSliderUpdate","initJuliaSliders","onRealSliderChange","onImagSliderChange","onSliderChangeFinished","resetPresetAndDiveButtonStates","textContent","resetJuliaSliders","innerText","updateJuliaSliders","performance","DebugPanel","_this$gl","_this$gl2","_this$gl3","_defineProperty","ts","_this$perf$frameMsSmo","_this$perf$frameMsSmo2","_this$perf$frameMsSmo3","_this$perf$panelCpuMs","_this$perf$panelCpuMs2","_this$perf$panelCpuMs3","_navigator","_navigator2","debugInfo","t0","pollGpuTimers","dt","perf","lastRafTs","frameMs","frameMsSmoothed","smooth","fps","getShaderPrecisionFormat","hp","HIGH_FLOAT","hpInfo","rangeMin","rangeMax","viewPanX","viewPanY","refPanX","refPanY","safeZoom","pxPerUnit","unitPerPx","absPan","panOverZoom","mantissaUsedApprox","driftAbs","driftViewUnits","orbitStatus","zoomBucket","log10","esc","replaceAll","levelClass","level","panLevel","driftLevel","scaleLevel","healthLevel","worst","gpuSmooth","gpuMsSmoothed","gpuLevel","fpsLevel","panelCpuMs","panelCpuMsSmoothed","gpuHint","gpuSupported","gpuVendor","gpu","unmaskedVendor","vendor","gpuRenderer","unmaskedRenderer","renderer","innerHTML","getFractalMode","gpuDisjoint","webglVersion","userAgentData","platform","update","panelSelector","lastTap","toggle","dump","indexOf","extTimer","extRendererInfo","shadingLanguageVersion","maxTextureSize","maxVaryings","maxFragUniforms","maxVertUniforms","maxViewportDims","_initGpuInfo","gpuMs","queryInFlight","pendingQueries","precisionInfo","getParameter","VERSION","SHADING_LANGUAGE_VERSION","VENDOR","RENDERER","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","createQueryEXT","beginQueryEXT","TIME_ELAPSED_EXT","endQueryEXT","disjoint","GPU_DISJOINT_EXT","getQueryObjectEXT","QUERY_RESULT_AVAILABLE_EXT","ns","QUERY_RESULT_EXT","deleteQueryEXT","shift","ms","prev","resizeTimeout","header","logo","mandelbrotSwitch","juliaSwitch","persistSwitch","resetButton","screenshotButton","demoButton","presetsToggle","presetsMenu","divesToggle","divesMenu","divesDropdown","paletteToggle","paletteMenu","infoLabel","infoText","fractalMode","midColor","bgColor","headerMinimizeTimeout","uiInitialized","headerVisible","animationActive","activeJuliaDiveIndex","activePresetIndex","presetButtons","diveButtons","paletteButtons","allButtons","lastInfoUpdate","infoUpdateThrottleLimit","pendingInfoTimer","keys","find","_switchFractalMode","_debugPanel","_debugPanel$setRender","_debugPanel2","_debugPanel2$setRende","exitAnimationMode","destroy","enableMandelbrotMode","enableJuliaMode","enableRiemannMode","setRenderer","initAnimationMode","_switchFractalTypeWithPersistence","targetType","classList","remove","add","resetActivePresetIndex","initPresetButtonEvents","initPaletteButtonEvents","initDiveButtons","background","palettes","currentPalette","title","adjustChannel","brightnessFactor","root","querySelector","setProperty","_ddValue","_ddValue2","_fractalApp$zoom","force","timeSinceLastUpdate","delay","text","panX","panY","_fractalApp$c$","_fractalApp$c$2","currentZoom","currentRotation","contains","disabled","closePresetsDropdown","closeDivesDropdown","_toggleDemo","_t2","stopDemo","startMandelbrotDemo","startJuliaDemo","_startMandelbrotDemo","animateDemo","_startJuliaDive","_callee11","dives","dive","_context11","cxDirection","endC","startC","cyDirection","animateToZoomAndC","animateDive","animatePanZoomRotationTo","_startJuliaDemo","_callee12","_context12","_travelToPreset","_callee13","presets","_context13","verticalLine","horizontalLine","_randomizeColors","_callee14","saturation","brightness","_context14","show","_reset","_callee15","_context15","initHeaderEvents","lastPointerType","pointerType","initControlButtonEvents","presetBlock","className","appendChild","initPresetsDropdown","closePaletteDropdown","isOpen","togglePresetsDropdown","initDivesDropdown","toggleDivesDropdown","randomBtn","swatchColor","initPaletteDropdown","togglePaletteDropdown","initCommonButtonEvents","blur","diveBlock","initFractalSwitchButtons","_ref6","_ref7","initWindowEvents","dragElements","querySelectorAll","element","onMove","leftValue","getComputedStyle","topValue","movementX","movementY","move","once","initInfoText","bindHTMLElements","initUI","_initUI","_callee16","fractalRenderer","_context16","ownKeys","getOwnPropertySymbols","filter","_objectSpread","getOwnPropertyDescriptors","defineProperties","refZ0","refZ0DD","_prevPan0","_prevPan1","_prevZoom","_prevC0","_prevC1","cAnimationActive","deltaZ0HLoc","deltaZ0LLoc","zx0","zy0","escapeItersJulia","bestX","bestY","deltaView","panMoved","zoomChanged","cChanged","isDeferringForAnimation","deltaZ0X","deltaZ0Y","stopCurrentCAnimation","_animateInnerStopsTransition","toPalette","callback","startStops","interpolated","animateInnerStopsTransition","_animateToC","targetC","easedProgress","_animateToZoomAndC","_animateDive","phases","phase","diveStep","initFractalApp","_initFractalApp","validMandelbrotTravelPreset","validJuliaTravelPreset","onDefault"],"ignoreList":[],"sourceRoot":""}